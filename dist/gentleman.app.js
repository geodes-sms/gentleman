/*! For license information please see gentleman.app.js.LICENSE.txt */
(()=>{var t={684:(t,e,n)=>{"use strict";n.r(e),n.d(e,{App:()=>fe});var i=n(835),s=n(491),a=n(241);const r=(t,e)=>t.getAttributeByName(e).target,o=(t,e)=>r(t,e).getReference(),l=(t,e,n=!1)=>r(t,e).getValue(n),c=(t,e)=>r(t,e).hasValue(),h=(t,e)=>t.isAttributeCreated(e),u=t=>(0,i.valOrDefault)(l(t,"name"),"").toLowerCase();function d(t,e){const{id:n,name:s}=e;let a=(0,i.createEmphasis)({class:["link","error-message__link"],title:s},t);const r=`.projection[data-concept="${n}"]`;return a.addEventListener("mouseenter",(t=>{let e=(0,i.getElement)(r,this.body);e&&this.highlight(e)})),a.addEventListener("mouseleave",(t=>{this.unhighlight()})),a.addEventListener("click",(t=>{let e=this.resolveElement((0,i.getElement)(r,this.body));e&&e.focus()})),a}const p="attributes",m="base",f="name",g="required",y="properties",b="prototype";function v(t={}){const e=[],{conceptModel:n}=this;this.logs.clear();const s=Object.assign({name:"metamodel",download:!0},t),r=n.getConcepts(["prototype-concept","concrete-concept","derivative-concept"]);return(0,i.isEmpty)(r)?(this.notify("<strong>Empty model</strong>: Please create at least one concept.",a.k$.WARNING),!1):(this.__errors=[],r.forEach((t=>{const{message:n}=x.call(this,t);e.find((t=>t.name===n.name))?this.__errors.push(`The model has two concepts with the same name: ${n.name}`):e.push(n)})),(0,i.isEmpty)(this.__errors)?(this.notify("The concept model was <strong>successfully</strong> built",a.k$.SUCCESS,2e3),s.download&&this.download(JSON.stringify({type:"concept",concept:e,definition:n.export()}),s.name,"JSON"),delete this.__errors,e):(this.notify("<strong>Validation failed</strong>: The model could not be built.<br> <em>See Log for more details</em>.",a.k$.ERROR),this.logs.add(this.__errors,"Validation error",a.hi.ERROR),delete this.__errors,!1))}function x(t){const e=u(t),n=t.getProperty("nature"),s=l(t,"root"),a=[],h=[];if((0,i.isNullOrWhitespace)(e)){let e=d.call(this,"name",r(t,f)),s=(0,i.createSpan)({class:["error-message"]},[`${(0,i.capitalizeFirstLetter)(n)} concept: `,e," is missing a value"]);this.__errors.push(s)}t.isAttributeCreated(p)&&l(t,p).forEach((t=>{const{message:e}=w.call(this,t);a.find((t=>t.name===e.name))?this.__errors.push(`The concept has two attributes with the same name: ${e.name}`):a.push(e)})),t.isAttributeCreated(y)&&l(t,y).forEach((t=>{const{message:e}=j.call(this,t);h.find((t=>t.name===e.name))?this.__errors.push(`The concept has two properties with the same name: ${e.name}`):h.push(e)}));let g={id:t.id,name:e,nature:n,root:s,attributes:a,properties:h};return t.isAttributeCreated(b)&&c(t,b)&&(g.prototype=u(o(t,b))),t.isAttributeCreated(m)&&c(t,m)&&Object.assign(g,E.call(this,l(t,m,!0),"base")),{message:g}}function w(t){const e=u(t),n=!h(t,g)||!c(t,g)||l(t,g);if((0,i.isNullOrWhitespace)(e)){let e=d.call(this,"name",r(t,f)),n=(0,i.createSpan)({class:["error-message"]},["Attribute: ",e," is missing a value"]);this.__errors.push(n)}if(!c(t,"target")){let e=d.call(this,"target",r(t,"target")),n=(0,i.createSpan)({class:["error-message"]},["Attribute: ",e," is missing a value"]);this.__errors.push(n)}return{message:{name:e,target:E.call(this,l(t,"target",!0)),required:n}}}function E(t,e="name"){if((0,i.isNullOrUndefined)(t))return null;let n=t.getProperty("cname");if("concept"===n)if(c(t,"concept"))n=r(t,"concept").value;else{let e=d.call(this,"concept",r(t,"concept")),n=(0,i.createSpan)({class:["error-message"]},[`${(0,i.capitalizeFirstLetter)(t.getName())}: `,e," is missing a value"]);this.__errors.push(n)}const s={[e]:n};if(h(t,"accept")){let e=l(t,"accept",!0);(0,i.isObject)(e)?s.accept=E.call(this,e):s.accept={name:e.toLowerCase()}}if(["default","ordered","rel"].filter((e=>h(t,e)&&c(t,e))).forEach((e=>{s[e]=l(t,e)})),h(t,"constraints")){let e=[];l(t,"constraints").forEach((t=>{const n=A.call(this,t);e.push(n)})),s.constraint=e}return s}function A(t){const e={};if(!c(t,"type"))return e;e.property=l(t,"property");let n=l(t,"type",!0);return"constraint-number-value"===n.name?(e.type="value",e.value=l(n,"value")):"constraint-number-range"===n.name?(e.type="range",e.range={min:l(n,"min"),max:l(n,"max")}):"constraint-string-pattern"===n.name?(e.type="pattern",e.pattern={insensitive:l(n,"insensitive"),global:l(n,"global"),value:l(n,"value")}):"constraint-string-values"===n.name&&(e.type="values",e.values=l(n,"values",!0)),h(t,"scope")&&c(t,"scope")&&(e.scope=u(o(t,"scope"))),e}function j(t){const e=u(t);if((0,i.isNullOrWhitespace)(e)){let e=d.call(this,"name",r(t,f)),n=(0,i.createSpan)({class:["error-message"]},["Property: ",e," is missing a value"]);this.__errors.push(n)}h(t,"target")&&c(t,"target")||this.__errors.push(`Property ${(0,i.isNullOrWhitespace)(e)?"N/A":`'${e}'`}: <<target>> is missing a value.`);const n=l(t,"target",!0),s=n.getProperty("type");return(0,i.isNullOrUndefined)(s)&&this.__errors.push(`The property '${e}' target's type is missing a value.`),{message:{name:u(t),type:s,value:l(n,"value")}}}function k(t){let e={};return h(t,"css")&&c(t,"css")&&(e.css=l(t,"css",!0)),h(t,"ref")&&c(t,"ref")&&(e.ref=l(t,"ref",!0).map((t=>u(this.conceptModel.getConcept(t))))),h(t,"gss")&&(e.gss=N.call(this,r(t,"gss"))),h(t,"text")&&(e.text=_.call(this,r(t,"text"))),h(t,"box")&&(e.box=O.call(this,r(t,"box"))),e}function N(t){let e={};return h(t,"text")&&(e.text=_.call(this,r(t,"text"))),h(t,"box")&&(e.box=O.call(this,r(t,"box"))),e}function _(t){let e={};if(h(t,"bold")&&l(t,"bold")&&(e.bold=!0),h(t,"italic")&&l(t,"italic")&&(e.italic=!0),h(t,"underline")&&l(t,"underline")&&(e.underline=!0),h(t,"strikethrough")&&l(t,"strikethrough")&&(e.strikethrough=!0),h(t,"nonbreakable")&&l(t,"nonbreakable")&&(e.nonbreakable=!0),h(t,"transform")&&c(t,"transform")&&(e.transform=l(t,"transform")),h(t,"color")&&c(t,"color")){let n=T.call(this,r(t,"color"));n&&(e.color=n)}if(h(t,"opacity")&&c(t,"opacity")&&(e.opacity=l(t,"opacity")),h(t,"size")){let n=I.call(this,r(t,"size"));n&&(e.size=n)}return e}function O(t){let e={};if(h(t,"inner")){let n=L.call(this,r(t,"inner"));n&&(e.inner=n)}if(h(t,"outer")){let n=L.call(this,r(t,"outer"));n&&(e.outer=n)}if(h(t,"background")&&(e.background=S.call(this,r(t,"background"))),h(t,"width")){let n=I.call(this,r(t,"width"));n&&(e.width=n)}if(h(t,"height")){let n=I.call(this,r(t,"height"));n&&(e.height=n)}if(h(t,"border")&&(e.border=M.call(this,r(t,"border"))),h(t,"corner")&&(e.corner=C.call(this,r(t,"corner"))),h(t,"shadow")){let n=U.call(this,r(t,"shadow"));n&&(e.shadow=n)}return h(t,"opacity")&&c(t,"opacity")&&(e.opacity=l(t,"opacity")),e}function L(t){let e={},n=!1;return["all","top","right","bottom","left"].forEach((s=>{if(h(t,s)){let a=I.call(this,r(t,s));(0,i.isNullOrUndefined)(a)||(e[s]=a,n=!0)}})),n?e:null}function M(t){let e={};return["all","top","right","bottom","left"].forEach((n=>{if(h(t,n)){let i=r(t,n),s=I.call(this,r(i,"width"));if(s){let t=r(i,"color");e[n]={width:s,color:T.call(this,t),type:l(i,"type")}}}})),e}function C(t){let e={},n=!1;return["all","top-left","top-right","bottom-right","bottom-left"].forEach((s=>{if(h(t,s)){let a=I.call(this,r(t,s));(0,i.isNullOrUndefined)(a)||(e[s]=a,n=!0)}})),n?e:null}function S(t){let e={};if(h(t,"color")){let n=r(t,"color"),i=r(n,"value");e.color=T.call(this,i)}if(h(t,"image")){let n=r(t,"image");e.image=l(n,"url")}return e}function T(t){let e={};if((0,i.isNullOrUndefined)(t))return e;if("hex-color"===t.name){if(!c(t,"value"))return null;e.type="hex";let n=l(t,"value")||"";e.value=n.startsWith("#")?n:`#${n}`}else"rgb-color"===t.name&&(e.type="rgb",e.value={red:l(t,"red"),green:l(t,"green"),blue:l(t,"blue")});return e}function I(t){return(0,i.isNullOrUndefined)(t)||!c(t,"value")?null:{value:l(t,"value"),unit:l(t,"unit")}}function U(t){if((0,i.isNullOrUndefined)(t))return null;const e="offsetX",n="offsetY",s="blur",a="spread",o="inset";let c=3,u={};if(h(t,e)){let n=I.call(this,r(t,e));(0,i.isNullOrUndefined)(n)||(u.offsetX=n,c--)}if(h(t,n)){let e=I.call(this,r(t,n));(0,i.isNullOrUndefined)(e)||(u.offsetY=e,c--)}if(h(t,s)){let e=I.call(this,r(t,s));(0,i.isNullOrUndefined)(e)||(u.blur=e,c--)}if(h(t,a)){let e=I.call(this,r(t,a));(0,i.isNullOrUndefined)(e)||(u.spread=e,c--)}if(c>0)return null;if(h(t,o)&&l(t,o)&&(u.inset=!0),h(t,"color")){let e=r(t,"color");u.color=T.call(this,e)}return u}const D="content",H="concept",P="name",R="style",B="required",V="prototype",z="tag",F="tags",q="value",$="focusable",W="hidden",Z={projection:Y,template:G,style:J};function X(t={}){const e={type:"projection",projection:[],template:[],style:[]},{conceptModel:n}=this;this.logs.clear();const s=Object.assign({name:"projection",download:!0,notify:"always"},t),r=n.getConcepts(["projection","template","style rule"]);return(0,i.isEmpty)(r)?(this.notify("<strong>Empty model</strong>: Please create at least one projection.",a.k$.WARNING,2e3),!1):(this.__errors=[],r.forEach((t=>{let n=(0,i.valOrDefault)(t.getProperty("handler"),"");const s=Z[n],{message:a}=s.call(this,t);e[n].push(a)})),(0,i.isEmpty)(this.__errors)?("always"===s.notify&&this.notify("The projection model was <strong>successfully</strong> built",a.k$.SUCCESS,2e3),s.download&&this.download(JSON.stringify(e),s.name,"JSON"),delete this.__errors,e):(this.notify("<strong>Validation failed</strong>: The model could not be built.<br> <em>See Log for more details</em>.",a.k$.ERROR),this.logs.add(this.__errors,"Validation error",a.hi.ERROR),delete this.__errors,!1))}function Y(t){const e=h(t,F)?l(t,F,!0):[];let n=r(t,H);if(t.hasParent()){let e=t.getParent("collection");n=r(e,H)}const s=K.call(this,n);if((0,i.isEmpty)(Object.keys(s))){let e=d.call(this,"concept",r(t,H)),n=(0,i.createSpan)({class:["error-message"]},["Projection error: ",e," is missing a value"]);this.__errors.push(n)}const a=r(t,"container");let o={concept:s,tags:e,container:et.call(this,a)};return h(t,P)&&c(t,P)&&(o.name=u(t)),{success:!0,message:o}}function G(t){const e=u(t);if((0,i.isNullOrWhitespace)(e)){let e=d.call(this,"name",r(t,P)),n=(0,i.createSpan)({class:["error-message"]},["Template error: ",e," is missing a value"]);this.__errors.push(n)}if(!c(t,D)){let e=d.call(this,"content",r(t,D)),n=(0,i.createSpan)({class:["error-message"]},["Template error: ",e," is missing a value"]);this.__errors.push(n)}const n=[];return l(t,D).filter((t=>t.hasValue())).forEach((t=>{const e=t.getValue(!0);n.push(tt.call(this,e))})),{success:!0,message:{id:t.id,type:"template",name:e,content:n}}}function J(t){const e=u(t);if((0,i.isNullOrWhitespace)(e)){let e=d.call(this,"name",r(t,P)),n=(0,i.createSpan)({class:["error-message"]},["StyleRule error: ",e," is missing a value"]);this.__errors.push(n)}const n=N.call(this,r(t,R));return{success:!0,message:{id:t.id,type:"style",name:e,style:n}}}function K(t){const e={};return h(t,P)&&c(t,P)&&(e.name=l(t,P).toLowerCase()),h(t,V)&&c(t,V)&&(e.prototype=l(t,V).toLowerCase()),e}const Q={static:function(t){const e=t.getProperty("elementType");let n={type:e};const s=lt[e];return(0,i.isFunction)(s)?(n.focusable=l(t,$),n.hidden=l(t,W),Object.assign(n,s.call(this,t)),h(t,R)&&(n.style=k.call(this,r(t,R))),n):null},layout:st,dynamic:rt,field:function(t){const e=t.getProperty("elementType");var n={type:e};n.focusable=l(t,$),n.readonly=l(t,"readonly"),n.disabled=l(t,"disabled"),n.hidden=l(t,W),n.source=l(t,"source");const s=ct[e];return(0,i.isFunction)(s)?(Object.assign(n,s.call(this,t)),h(t,R)&&(n.style=k.call(this,r(t,R))),n):null},container:et,"svg-container":function(t){const e={type:"svg"};return h(t,"content")&&(e.content=l(t,"content")),h(t,"p-link")&&(e.link=function(t){const e={};return h(t,"tag")&&(e.tag=l(t,"tag")),h(t,"marker")&&(e.marker=l(t,"marker")),h(t,"external")&&(e.external=l(t,"external")),e}(r(t,"p-link"))),h(t,"attributes")&&!(0,i.isEmpty)(r(t,"attributes"))&&(e.attributes=[],l(t,"attributes").forEach((t=>{e.attributes.push(function(t){const e={};return h(t,"value")&&(e.value=l(t,"value")),h(t,"placement")&&(e.placement=function(t){const e={};switch(e.type=t.name,e.type){case"in-place":return h(t,"marker")&&(e.marker=l(t,"marker")),h(t,"tag")&&(e.tag=l(t,"tag")),e;case"link-place":return h(t,"static-dependents")&&!(0,i.isEmpty)(l(t,"static-dependents"))&&(e.sd=[],l(t,"static-dependents").forEach((t=>{e.sd.push(nt(t))}))),h(t,"dynamic-dependents")&&!(0,i.isEmpty)(l(t,"dynamic-dependents"))&&(e.dd=[],l(t,"dynamic-dependents").forEach((t=>{e.dd.push(nt(t))}))),e}}(l(t,"placement",!0))),h(t,"property")&&(e.property=l(t,"property")),e}(t))}))),e}};function tt(t){const e=t.getProperty("contentType"),n=Q[e];if(!(0,i.isFunction)(n))return null;let s=e;return Object.assign({kind:s},n.call(this,t))}function et(t){const e={type:"container"};let n=[];return l(t,"elements").filter((t=>t.hasValue())).forEach((t=>{const e=t.getValue(!0);n.push(tt.call(this,e))})),e.content=n,e.layout=st.call(this,l(t,"layout",!0)),e.focusable=l(t,$),h(t,"style")&&(e.style=k.call(this,r(t,"style"))),e}function nt(t){const e={};return h(t,"marker")&&(e.marker=l(t,"marker")),h(t,"template")&&(e.template=l(t,"template")),e}const it={flex:function(t){const e={},n="align-items",s="justify-content";return e.orientation=l(t,"orientation"),e.wrappable=l(t,"wrappable"),e[(0,i.camelCase)(n)]=l(t,n),e[(0,i.camelCase)(s)]=l(t,s),e},table:function(t){const e={};var n=[];return e.orientation=l(t,"orientation"),l(t,"rows").forEach((t=>{const e=[];l(t,"cells").forEach((t=>{let n=(0,i.valOrDefault)(l(t,"span"),1);if(c(t,"content")){let i=l(t,"content",!0);e.push({type:"cell",span:n,content:tt.call(this,i)})}})),n.push(e)})),e.disposition=n,e}};function st(t){const e=t.getProperty("elementType");var n={type:e};const s=it[e];return(0,i.isFunction)(s)?(Object.assign(n,s.call(this,t)),h(t,"style")&&(n.style=k.call(this,r(t,"style"))),n):null}const at={attribute:ot,projection:ot,template:function(t){return c(t,q)?{type:"template",name:(e=t,q,u(o(e,"value")))}:null;var e}};function rt(t){const e=t.getProperty("elementType");var n={type:e};const s=at[e];return(0,i.isFunction)(s)?(Object.assign(n,s.call(this,t)),n):null}function ot(t){const e={type:"attribute",name:l(t,"src")},n="tag",i="placeholder";if(h(t,n)&&c(t,n)&&(e.tag=l(t,n)),h(t,B)&&(e.required=l(t,B)),h(t,"listen")&&(e.listen=l(t,"listen")),h(t,i)&&c(t,i)){const n=[];let s=r(t,i);l(s,D).filter((t=>t.hasValue())).forEach((t=>{const e=t.getValue(!0);n.push(tt.call(this,e))})),e.placeholder=n}return e}const lt={text:function(t){const e={};return e.asHTML=l(t,"asHTML"),e.content=l(t,D,!0),e},image:function(t){const e={};return e.url=l(t,"url"),e.alt=l(t,"alt"),e},link:function(t){const e={};return e.url=l(t,"url"),e.urlType=l(t,"type"),e.content=l(t,D).filter((t=>t.hasValue())).map((t=>{const e=t.getValue(!0);return tt.call(this,e)})),e},plink:function(t){const e={};return e.tag=l(t,"tag"),e.content=l(t,D).filter((t=>t.hasValue())).map((t=>{const e=t.getValue(!0);return tt.call(this,e)})),e},button:function(t){const e={};return e.trigger=l(t,"trigger"),e.disabled=l(t,"disabled"),e.content=l(t,D).filter((t=>t.hasValue())).map((t=>{const e=t.getValue(!0);return tt.call(this,e)})),e}},ct={text:function(t){const e={},n="input";return e.multiline=l(t,"multiline"),e.resizable=l(t,"resizable"),h(t,n)&&(e.input=pt.call(this,r(t,n))),e},binary:function(t){const e={},n="checkbox";e.state={};let i=r(t,"true");c(i,D)&&(e.state.true={content:l(i,D).filter((t=>t.hasValue())).map((t=>tt.call(this,t.getValue(!0))))});let s=r(t,"false");return c(s,D)&&(e.state.false={content:l(s,D).filter((t=>t.hasValue())).map((t=>tt.call(this,t.getValue(!0))))}),h(t,n)&&(e.checkbox=mt.call(this,r(t,n))),e},choice:function(t){const e={},n="placeholder",i="expanded",s="input",a="choice template";return e.choice={},h(t,n)&&(e.placeholder=l(t,n)),h(t,i)&&(e.expanded=l(t,i)),h(t,s)&&(e.input=pt.call(this,r(t,s))),h(t,a)&&(e.choice.option={template:gt.call(this,r(t,a))}),e},list:function(t){const e={},n="action",i="item template";if(e.list={},h(t,i)&&(e.list.item={template:gt.call(this,r(t,i))}),h(t,n)){let i=r(t,n);e.action={};const s="add";if(h(i,s)){let t=r(i,s);e.action[s]={position:l(t,"position")};const n=[{type:"static",static:{type:"text",content:l(t,D)}}];e.action.add.content=n}}return e},table:function(t){const e={},n="row template",i="header",s="body",a="footer";return e.table={},h(t,n)&&(e.table.row={template:gt.call(this,r(t,n))}),h(t,i)&&(e.header=k.call(this,r(t,i))),h(t,s)&&(e.body=k.call(this,r(t,s))),h(t,a)&&(e.footer=k.call(this,r(t,a))),e},interactive:function(t){const e={};return h(t,"content")&&(e.content=l(t,"content")),h(t,"field")&&(e.source=function(t){const e={};return h(t,"marker")&&(e.marker=l(t,"marker")),h(t,"tag")&&(e.tag=l(t,"tag")),e}(r(t,"field"))),h(t,"static-dependents")&&!(0,i.isEmpty)(l(t,"static-dependents"))&&(e.sd=[],l(t,"static-dependents").forEach((t=>{e.sd.push(nt(t))}))),h(t,"dynamic-dependents")&&!(0,i.isEmpty)(l(t,"dynamic-dependents"))&&(e.dd=[],l(t,"dynamic-dependents").forEach((t=>{e.dd.push(nt(t))}))),h(t,"marker")&&(e.marker=l(t,"marker")),h(t,"markers")&&(e.markers=[],l(t,"markers").forEach((t=>{e.markers.push(ht(t))}))),h(t,"self")&&(e.self=[],l(t,"self").forEach((t=>{e.self.push(l(t,"property"))}))),e},dynamic:function(t){const e={};return h(t,"content")&&(e.content=l(t,"content")),h(t,"marker")&&(e.marker=l(t,"marker")),h(t,"markers")&&(e.markers=[],l(t,"markers").forEach((t=>{e.markers.push(ht(t))}))),h(t,"self")&&(e.self=[],l(t,"self").forEach((t=>{e.self.push(l(t,"property"))}))),e},static:function(t){const e={};return h(t,"content")&&(e.content=l(t,"content")),h(t,"model-value")&&(e.mv=l(t,"model-value")),e},add:function(t){const e={type:"add"};return h(t,"content")&&(e.content=l(t,"content")),h(t,"items")&&(e.items=gt.call(this,r(t,"items"))),h(t,"ratio")&&(e.ratio=l(t,"ratio")),e},arrow:function(t){const e={type:"arrow"};return h(t,"source")&&(e.source=l(t,"source")),h(t,"target")&&(e.target=l(t,"target")),h(t,"decorator")&&(e.decorator=ut.call(this,r(t,"decorator"))),h(t,"arrow-style")&&(e.arrowStyle=dt.call(this,r(t,"arrow-style"))),e},svg:function(t){const e={};return h(t,"content")&&(e.content=l(t,"content")),h(t,"x")&&(e.x=l(t,"x")),h(t,"x")&&(e.x=l(t,"x")),e}};function ht(t){const e={};return h(t,"model-value")&&(e.mv=l(t,"model-value")),h(t,"aliases")&&(e.aliases=[],l(t,"aliases").forEach((t=>{e.aliases.push(function(t){const e={};return h(t,"marker-value")&&(e.mv=l(t,"marker-value")),h(t,"properties")&&(e.props=function(t){let e={props:[]};if(h(t,"bold")&&l(t,"bold")){const t={props:"font-weight",value:"bold"};e.props.push(t)}if(h(t,"italic")&&l(t,"italic")){const t={props:"font-style",value:"italic"};e.props.push(t)}if(h(t,"underline")&&l(t,"underline")){const t={props:"text-decoration",value:"underline"};e.props.push(t)}if(h(t,"color")){let n=r(t,"color"),s=l(n,"value");if(!(0,i.isNullOrUndefined)(s)){const t={props:"fill"};t.value=s,e.props.push(t)}}if(h(t,"size")){let n=r(t,"size");if(!(0,i.isNullOrUndefined)(n)&&c(n,"value")){const t={props:"font-size"};t.value=l(n,"value")+l(n,"unit"),e.props.push(t)}}if(h(t,"text-content")){let n=l(t,"text-content");(0,i.isNullOrUndefined)(n)||""===n||e.props.push({props:"textContent",value:n})}return h(t,"others")&&l(t,"others").forEach((t=>{e.props.push(function(t){const e={};return e.property=l(t,"property"),e.value=l(t,"value"),e}(t))})),e.props}(r(t,"properties"))),e}(t))}))),e}function ut(t){const e={};return h(t,"attribute")&&(e.attribute={type:"dynamic",dynamic:rt.call(this,r(t,"attribute"))}),h(t,"base")&&(e.base=l(t,"base")),e}function dt(t){const e={};if(h(t,"stroke")){let n=r(t,"stroke"),s=l(n,"value");(0,i.isNullOrUndefined)(s)?e.stroke="#000000":e.stroke=s.startsWith("#")?s:`#${s}`}return h(t,"stroke-width")&&(e.width=l(t,"stroke-width")),h(t,"stroke-dasharray")&&(e.dasharray=l(t,"stroke-dasharray")),h(t,"stroke-linecap")&&(e.linecap=l(t,"stroke-linecap")),h(t,"marker-end")&&(e.end=l(t,"marker-end")),h(t,"marker-start")&&(e.start=l(t,"marker-start")),e}function pt(t){let e={type:l(t,"type"),placeholder:l(t,"placeholder")};return h(t,R)&&(e.style=k.call(this,r(t,R))),e}function mt(t){let e={position:l(t,"position"),label:ft.call(this,r(t,"label"))};return h(t,R)&&(e.style=k.call(this,r(t,R))),e}function ft(t){let e={content:l(t,"content")};return h(t,R)&&(e.style=k.call(this,r(t,R))),e}function gt(t){const e={};return h(t,z)&&c(t,z)&&(e.tag=l(t,z)),h(t,P)&&c(t,P)&&(e.name=l(t,P)),h(t,R)&&(e.style=k.call(this,r(t,R))),e}const yt="elementType",bt="concept",vt="name",xt="required",wt="tags",Et={graphical:function(t){const e=h(t,wt)?l(t,wt,!0):[];let n,s=l(t,"element",!0);h(s,"treeId")&&(n=l(s,"treeId"));let a=r(t,bt);if(t.hasParent()){let e=t.getParent("collection");a=r(e,bt)}const o=K.call(this,a);if((0,i.isEmpty)(Object.keys(o))){let e=d.call(this,"concept",r(t,bt)),n=(0,i.createSpan)({class:["error-message"]},["Projection error: ",e," is missing a value"]);this.__errors.push(n)}const p=l(t,"element",!0);let m={concept:o,tags:e};(0,i.isNullOrUndefined)(n)||(m.rtag=n);const f=p.getProperty("handlerType");return m.type=f,m.content=At[f].call(this,p),h(t,vt)&&c(t,vt)&&(m.name=u(t)),{success:!0,message:m}},projection:Y,template:G,style:J},At={algorithm:_t,arrow:function(t){const e=t.getProperty(yt);var n={type:e};const s=kt[e];return(0,i.isFunction)(s)?(Object.assign(n,s.call(this,t)),n):null},field:Ht};function jt(t={}){const e={type:"projection",projection:[],template:[],style:[]},{conceptModel:n}=this;this.logs.clear();const s=Object.assign({name:"projection",download:!0,notify:"always"},t),r=n.getConcepts(["graphical","projection","template","style rule"]);return(0,i.isEmpty)(r)?(this.notify("<strong>Empty model</strong>: Please create at least one projection.",a.k$.WARNING,2e3),!1):(this.__errors=[],r.forEach((t=>{let n=(0,i.valOrDefault)(t.getProperty("handler"),"");const s=Et[n],{message:a}=s.call(this,t);"graphical"===n?e.projection.push(a):e[n].push(a)})),(0,i.isEmpty)(this.__errors)?("always"===s.notify&&this.notify("The projection model was <strong>successfully</strong> built",a.k$.SUCCESS,2e3),s.download&&this.download(e,s.name,"JSON"),delete this.__errors,e):(this.notify("<strong>Validation failed</strong>: The model could not be built.<br> <em>See Log for more details</em>.",a.k$.ERROR),this.logs.add(this.__errors,"Validation error",a.hi.ERROR),delete this.__errors,!1))}const kt={force:function(t){const e={};if(!c(t,"from")){let e=d.call(this,"from",r(t,"from")),n=(0,i.createSpan)({class:["error-message"]},["Projection error: ",e," is missing a value"]);this.__errors.push(n)}if(e.from={name:l(t,"from")},!c(t,"to")){let e=d.call(this,"to",r(t,"from")),n=(0,i.createSpan)({class:["error-message"]},["Projection error: ",e," is missing a value"]);this.__errors.push(n)}return e.to={name:l(t,"to")},h(t,"decorator")&&(e.decorator=Tt.call(this,r(t,"decorator"))),e}},Nt={decoration:function(t){const e={};h(t,"dimensions")&&(e.dimensions=Bt.call(this,r(t,"dimensions"))),h(t,"coordinates")&&(e.coordinates=Ft.call(this,r(t,"coordinates")));const n=r(t,"shape");if((0,i.isEmpty)(l(n,"elements"))||(e.background=$t.call(this,n)),(0,i.isNullOrUndefined)(e.background)&&l(t,"background")&&(e.background=l(t,"background")),!(0,i.isEmpty)(l(t,"content"))){let n=[];l(t,"content").forEach((t=>{let e=l(t,"render",!0);const i={};i.dimension=Vt.call(this,l(e,"dimension",!0)),i.coordinates=Ft.call(this,r(e,"coordinates")),i.render=Ct.call(this,e),n.push(i)})),e.content=n}return h(t,"rmv")&&(e.rmv=Ot.call(this,l(t,"rmv",!0))),e},force:function(t){const e={};return e.dimensions=Vt.call(this,r(r(t,"force"),"dimension")),e.force=Lt.call(this,r(t,"force")),e.tag=l(t,"tag"),e},tree:function(t){const e={};return e.depth=l(t,"depth"),e.dimensions={width:l(t,"width"),height:l(t,"height")},e.tag=l(t,"tag"),e.treeId=l(t,"treeId"),e.duration=500,e}};function _t(t){const e=t.getProperty(yt);var n={type:e};const s=Nt[e];return(0,i.isFunction)(s)?(Object.assign(n,s.call(this,t)),n):null}function Ot(t){const e={};switch(t.name){case"rmv-single":e.render={kind:"static",type:"svg",content:l(t,"background")},e.dimensions=Vt.call(this,l(t,"dimensions",!0)),e.coordinates=Ft.call(this,r(t,"coordinates"))}return e}function Lt(t){const e={};return e.intensity=Math.min(l(t,"intensity"),-1*l(t,"intensity")),e.linkVal=l(t,"linkVal"),e}const Mt={layout:_t,dynamic:Tt,field:Ht,static:function(t){const e=t.getProperty(yt),n=It[e];return(0,i.isNullOrUndefined)(n)?null:Object.assign({type:e},n.call(this,t))}};function Ct(t){const e=t.getProperty("contentType"),n=Mt[e];if(!(0,i.isFunction)(n))return null;let s=e;return Object.assign({kind:s},n.call(this,t))}const St={projection:function(t){const e={type:"attribute",name:l(t,"src")},n="tag",i="placeholder";if(h(t,n)&&c(t,n)&&(e.tag=l(t,n)),h(t,xt)&&(e.required=l(t,xt)),h(t,"listen")&&(e.listen=l(t,"listen")),h(t,i)&&c(t,i)){const n=[];let s=r(t,i);l(s,"content").filter((t=>t.hasValue())).forEach((t=>{const e=t.getValue(!0);n.push(Ct.call(this,e))})),e.placeholder=n}return e}};function Tt(t){const e=t.getProperty("elementType");var n={type:e};const s=St[e];return(0,i.isFunction)(s)?(Object.assign(n,s.call(this,t)),n):null}const It={"svg-text":function(t){const e={};return e.content=l(t,"content"),e.style=Rt.call(this,r(t,"style")),e},"svg-button":function(t){const e={};return r(t,"shape"),(0,i.isNullOrUndefined)(e.content)&&l(t,"content")&&(e.content=l(t,"content")),e.action=Ut.call(this,l(t,"action",!0)),"SIDE"===e.action.type&&(e.action.target=l(t,"tag")),e},svg:function(t){const e={};return e.content=l(t,"content"),e}};function Ut(t){const e={};switch(t.name){case"tree-action":e.type="CREATE-TREE",e.target=l(t,"treeId"),e.value=l(t,"item")}return e}const Dt={svg:function(t){const e={};return e.placeholder=l(t,"placeholder"),e.readonly=(0,i.valOrDefault)(l(t,"readonly"),!1),e.break=l(t,"break"),e.style=Rt.call(this,r(t,"style")),e},"svg-choice":function(t){console.log("BuildingChoice");const e={};return e.tag=l(t,"tag"),e.selection=Pt.call(this,r(t,"selection")),e},"svg-switch":function(t){const e={};if(h(t,"order")&&!(0,i.isEmpty)(l(t,"order"))){let n=[];l(t,"order").forEach((t=>{n.push(t.value)})),e.order=n}return h(t,"dimensions")&&(e.dimensions=Vt.call(this,r(t,"dimension"))),e}};function Ht(t){const e=t.getProperty(yt),n=Dt[e];return(0,i.isNullOrUndefined)(n)?null:Object.assign({type:e},n.call(this,t))}function Pt(t){const e={};return e.orientation=l(t,"orientation"),e.breakDown=l(t,"break"),e.dimensions=zt.call(this,r(t,"dimensions")),e}function Rt(t){const e={};return e.font=l(t,"font"),e.baseline=l(t,"baseline"),e.size=l(t,"size"),e.anchor=l(t,"anchor"),h(t,"weight")&&c(t,"weight")&&(e.weight=l(t,"weight")),e}function Bt(t){const e={};return e.width=l(t,"width"),e.height=l(t,"height"),e}function Vt(t){const e={};switch(e.type=t.name,t.name){case"absolute":e.width=l(t,"width"),e.height=l(t,"height");break;case"fixed":e.value=l(t,"width")}return e}function zt(t){const e={};return e.width=l(t,"width"),e.height=l(t,"height"),e}function Ft(t){const e={};return e.x=l(t,"x"),e.y=l(t,"y"),e}const qt={circle:function(t){let e="<circle ";e+='cx="'+l(t,"cx")+'" ';e+='cy="'+l(t,"cy")+'" ';return e+='r="'+l(t,"r")+'" ',e+=Wt.call(this,r(t,"style")),e+="></circle>",e},rectangle:function(t){let e="<rect ";e+='x="'+l(t,"x")+'" ';e+='y="'+l(t,"y")+'" ';e+='width="'+l(t,"width")+'" ';return e+='height="'+l(t,"height")+'" ',e+=function(t){let e="";e+='fill="'+(0,i.valOrDefault)(l(t,"fill"),"black")+'" ',e+='stroke="'+(0,i.valOrDefault)(l(t,"stroke"),"black")+'" ',e+='stroke-width="'+(0,i.valOrDefault)(l(t,"s-width"),0)+'" ';const n=l(t,"s-dash");(0,i.isNullOrUndefined)(n)||(e+='stroke-dasharray="'+n+'" ');const s=l(t,"rx");(0,i.isNullOrUndefined)(s)||(e+='rx="'+s+'" ');const a=l(t,"ry");return(0,i.isNullOrUndefined)(a)||(e+='ry="'+a+'" '),e}(r(t,"style")),e+="></rect>",e},ellipse:function(t){let e="<ellipse ";e+='cx="'+l(t,"cx")+'" ';e+='cy="'+l(t,"cy")+'" ';e+='rx="'+l(t,"rx")+'" ';return e+='ry="'+l(t,"ry")+'" ',e+=Wt(r(t,"style")),e+="></ellipse>",e},polygon:function(t){let e="<polygon ";return e+='points="'+l(t,"points")+'" ',e+=Wt(r(t,"style")),e},path:function(t){let e="<path ";return e+='d="'+l(t,"d")+'" ',e+=Wt(r(t,"style")),e+="></path>",e}};function $t(t){let e='<svg xmlns="http://www.w3.org/2000/svg" ';const n=l(t,"width");e+='width="'+n+'" ';const s=l(t,"height");e+='height="'+s+'" ';const a=l(t,"minX"),r=l(t,"minY"),o=l(t,"windowW"),c=l(t,"windowH");return e+='viewBox="'+a+" "+r+" "+(0,i.valOrDefault)(o,n)+" "+(0,i.valOrDefault)(c,s)+'">',l(t,"elements").forEach((t=>{let n=t.getValue(!0);e+=qt[n.name].call(this,n)})),e+="</svg>",e}function Wt(t){let e="";e+='fill="'+(0,i.valOrDefault)(l(t,"fill"),"black")+'" ',e+='stroke="'+(0,i.valOrDefault)(l(t,"stroke"),"black")+'" ',e+='stroke-width="'+(0,i.valOrDefault)(l(t,"s-width"),0)+'" ';const n=l(t,"s-dash");return(0,i.isNullOrUndefined)(n)||(e+='stroke-dasharray="'+n+'"'),e}const Zt={PRIMITIVE:"E",CONCRETE:"C",PROTOTYPE:"P",DERIVATIVE:"D"},Xt={container:null,header:null,body:null,schema:null,name:null,nature:null,prototype:null,btnCreate:null,instances:null,attributes:null,selectedAttribute:null,extras:null,tag:"",init(t){return this.schema=t,this.instances=[],this.extras=[],this.attributes=new Map,"primitive"===t.nature&&(this.tag=t.name),this},getName(){return this.schema.name},addInstance(t){this.instances.push(t)},render(){const{name:t,nature:e,attributes:n}=this.schema;(0,i.isHTMLElement)(this.container)||(this.container=(0,i.createDiv)({class:["app-model-concept"]})),this.header=(0,i.createDiv)({class:["app-model-concept-header"]});let s=(0,i.createI)({class:["app-model-concept-nature"],dataset:{name:e}},Zt[e.toUpperCase()]),a=(0,i.createSpan)({class:["app-model-concept-name"]},t);this.header.append(s,a);let r=(0,i.createUnorderedList)({class:["bare-list","app-model-concept-attributes"]});return Array.isArray(n)&&n.forEach((t=>{let e=(0,i.createListItem)({class:["app-model-concept-attribute"],dataset:{name:t.name,type:"attribute"}},t.name);this.attributes.set(t.name,e),r.append(e)})),this.body=(0,i.createDiv)({class:["app-model-concept-body"]}),this.body.append(r),this.container.append(this.header,this.body),this.bindEvents(),this.container},select(){this.container.classList.add("selected"),this.instances.forEach((t=>{t.show()})),this.refresh()},unselect(){this.container.classList.remove("selected"),this.instances.forEach((t=>{t.hide()})),this.refresh()},selectAttribute(t){return!(0,i.isNullOrUndefined)(t)&&(this.selectedAttribute!==t&&(this.selectedAttribute&&this.attributes.get(this.selectedAttribute).classList.remove("selected"),!!this.attributes.has(t)&&(this.selectedAttribute=t,this.attributes.get(t).classList.add("selected"),this.displayAttribute(t),this.refresh(),!0)))},displayAttribute(t){const{name:e,target:n,required:s=!0}=this.schema.attributes.find((e=>e.name===t));let a=(0,i.createSpan)({class:["app-model__attribute-name"]},e),r=(0,i.createDiv)({class:["app-model__attribute-header"]},[a]);if(s){let t=(0,i.createI)({class:["app-model__attribute-required"]},(0,i.createSpan)({class:["help"]},"required"));r.append(t)}let o=(0,i.createDiv)({class:["app-model__attribute-target"]},Yt(n)),l=(0,i.createDiv)({class:["app-model__attribute-info"]},[r,o]);this.body.append(l),this.extras.forEach((t=>(0,i.removeChildren)(t).remove())),this.extras=[],this.extras.push(l),this.refresh()},clear(){this.selectedAttribute&&(this.attributes.get(this.selectedAttribute).classList.remove("selected"),this.selectedAttribute=null),this.extras.forEach((t=>(0,i.removeChildren)(t).remove())),this.extras=[],this.refresh()},destroy(){(0,i.removeChildren)(this.container),this.container.remove()},refresh(){},bindEvents(){this.container.addEventListener("click",(t=>{this.parent.selectConcept(this);const{target:e}=t,{type:n,name:i}=e.dataset;"attribute"===n?this.selectAttribute(i):"concept"===n?this.parent.selectConcept(i)||(0,a.lL)(e):this.clear()}))}};function Yt(t){const e=(0,i.createDocFragment)();if((0,i.isNullOrUndefined)(t))return e;const{name:n,accept:s}=t;let a=(0,i.createSpan)({class:["target-name"],dataset:{type:"concept",name:n}},n);if(e.append(a),s){let t=(0,i.createDiv)({class:["target-accept"]});Array.isArray(s)?(t.append(...s.map((t=>Yt(t)))),t.classList.add("array")):t.append(Yt(s)),e.append(t)}return e}var Gt=0;const Jt=t=>a.WV.list().includes(t.toLowerCase()),Kt=(t,e,n)=>c(t,e)?l(t,e):n,Qt={container:null,editor:null,init(t){return this.editor=t,this.aside=Object.create(ne).init(null,t),this.editor.attach(this),this},show(){(0,a.$Z)(this.container)},hide(){(0,a.Cp)(this.container)},render(){return(0,i.isHTMLElement)(this.container)||(this.container=(0,i.createDiv)({class:["app-editor"]})),this.container.append(this.aside.render()),this.container.append(this.editor.container),this.container},refresh(){},bindEvents(){}},te={container:null,editor:null,init(t){return this.editor=t,this.aside=Object.create(ee).init(null,t),this.editor.attach(this),this},show(){(0,a.$Z)(this.container)},hide(){(0,a.Cp)(this.container)},render(){return(0,i.isHTMLElement)(this.container)||(this.container=(0,i.createDiv)({class:["app-editor"]})),this.container.append(this.aside.render()),this.container.append(this.editor.container),this.container},refresh(){},bindEvents(){}},ee={container:null,header:null,body:null,nav:null,model:null,userConceptSection:null,primitiveConceptSection:null,editor:null,uploader:null,btnModel:null,concepts:null,selectedConcept:null,tabs:null,selectedNav:null,init(t,e){return this.model=t,this.editor=e,this.tabs=new Map,this.concepts=[],this},show(){(0,a.$Z)(this.container)},hide(){(0,a.Cp)(this.container)},addModel(t){this.model=t,this.model.concept.forEach((t=>{let e=this.createConcept(t).init(t);this.concepts.push(e),this.userConceptSection.append((0,i.createDiv)({class:["app-concept"]},e.render()))})),a.WV.list().forEach((t=>{let e=this.createConcept(t).init({nature:"primitive",name:t});this.concepts.push(e),this.primitiveConceptSection.append((0,i.createDiv)({class:["app-concept"]},e.render()))})),this.refresh()},createConcept(t){return Object.create(Xt,{parent:{value:this},id:{value:Gt++},editor:{value:this.editor,writable:!0}})},clear(){this.concepts.forEach((t=>{t.destroy()})),this.concepts=[]},findConcept(t){return(0,i.isNullOrUndefined)(t)?null:t.parent===this?t:Jt(t)?(this.notify(`'${t}' is a primitive.`,a.k$.NORMAL),null):this.concepts.find((e=>e.getName()===t))},selectConcept(t){if((0,i.isNullOrUndefined)(t))return!1;let e=this.findConcept(t);return!(0,i.isNullOrUndefined)(e)&&this.selectedConcept!==e&&(this.selectedConcept&&this.selectedConcept.unselect(),this.selectedConcept=e,this.selectedConcept.select(),this.refresh(),!0)},removeModel(){},selectTab(t){if((0,i.isNullOrUndefined)(t))return!1;if(this.selectedNav===t)return!1;if(this.selectedNav){const{tab:t,window:e}=this.tabs.get(this.selectedNav);t.classList.remove("selected"),(0,a.Cp)(e)}const{tab:e,window:n}=this.tabs.get(t);e.classList.add("selected"),this.selectedNav=t,(0,a.$Z)(n)},update(){},notify(t,e,n=4500){let s=(0,i.createParagraph)({class:["notify"],html:t});const a="open";e&&s.classList.add(e),this.header.append(s),setTimeout((()=>{s.classList.add(a)}),50),setTimeout((()=>{s.classList.remove(a),setTimeout((()=>{s.remove()}),500)}),n)},refresh(){},render(){(0,i.isHTMLElement)(this.container)||(this.container=(0,i.createDiv)({class:["app-editor-aside"]}));const t=(0,i.createDocFragment)();return(0,i.isHTMLElement)(this.header)||(this.header=(0,i.createDiv)({class:["app-editor-aside-header"]}),t.append(this.header)),(0,i.isHTMLElement)(this.input)||(this.uploader=(0,i.createLabel)({class:["app-uploader"]},[(0,i.createInput)({type:"file",class:["app-uploader-input","hidden"],accept:".json,.jsoncp"}),(0,i.createSpan)({class:["app-uploader-label"]},"Upload concepts")]),this.header.append(this.uploader)),(0,i.isHTMLElement)(this.body)||(this.body=(0,i.createDiv)({class:["app-editor-aside-body"]}),t.append(this.body)),(0,i.isHTMLElement)(this.nav)||(this.nav=(0,i.createUnorderedList)({class:["bare-list","app-editor-aside-nav"]}),["User-defined","Primitive"].forEach((t=>{this.nav.append((0,i.createListItem)({class:["app-editor-aside-nav-item"],dataset:{type:"nav",name:t.toLowerCase()}},t))})),this.body.append(this.nav)),this.userConceptSection=(0,i.createDiv)({class:["app-editor-aside-body-userconcept","hidden"]}),this.primitiveConceptSection=(0,i.createDiv)({class:["app-editor-aside-body-primitiveconcept","hidden"]}),this.tabs.set("user-defined",{tab:this.nav.children[0],window:this.userConceptSection}),this.tabs.set("primitive",{tab:this.nav.children[1],window:this.primitiveConceptSection}),this.body.append(this.userConceptSection,this.primitiveConceptSection),(0,i.isNullOrUndefined)(this.selectedNav)&&this.selectTab("user-defined"),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},bindEvents(){this.uploader.addEventListener("change",(t=>{let e=t.target.files[0],n=new FileReader;n.onload=t=>{const e=JSON.parse(n.result);this.addModel(e)},n.readAsText(e)})),this.container.addEventListener("click",(t=>{const{target:e}=t,{type:n,name:i}=e.dataset;"nav"===n&&this.selectTab(i)})),this.editor.actions.set("create-instance",(t=>{const{concept:e}=t.dataset;let n=this.editor.createConcept(e);console.log(this.selectedConcept.tag);let i=this.editor.createProjection(n,this.selectedConcept.tag),s=this.editor.createInstance(n,i);"projection"!==e&&"general"!==e&&"graphical"!==e||s.concept.getAttribute("concept").getTarget().getAttribute("name").getTarget().setValue(this.selectedConcept.getName()),this.selectedConcept.addInstance(s)})),this.editor.actions.set("extract-instance",(t=>{const e=t;let n=this.editor.createConcept(e);console.log(this.selectedConcept.tag);let i=this.editor.createProjection(n,this.selectedConcept.tag),s=this.editor.createInstance(n,i);return"projection"!==e&&"general"!==e&&"graphical"!==e||s.concept.getAttribute("concept").getTarget().getAttribute("name").getTarget().setValue(this.selectedConcept.getName()),this.selectedConcept.addInstance(s),n.getAttributeByName("element").target.getValue(!0)}))}},ne={container:null,header:null,body:null,model:null,placeholder:null,editor:null,uploader:null,btnModel:null,btnBuild:null,concepts:null,selectedConcept:null,init(t,e){return this.model=t,this.editor=e,this.concepts=new Map,this},show(){(0,a.$Z)(this.container)},hide(){(0,a.Cp)(this.container)},addModelConcept(t){const{id:e,schema:n}=t,s=t.getProperty("nature");let a=(0,i.createDiv)({class:["outline-concept"],dataset:{id:e,nature:s}}),r=(0,i.createDiv)({class:["outline-concept-header"]}),o=(0,i.createI)({class:["outline-concept-nature",`outline-concept-nature--${s}`],title:s,dataset:{name:s}},s[0]),l=(0,i.createSpan)({class:["outline-concept-name"]},`Undefined ${s}`);r.append(o,l);let c=(0,i.createUnorderedList)({class:["bare-list","outline-concept-attrs"]});a.append(r,c),t.register(this),t.watch("value.changed",((e,n)=>{this.updateModelConcept(t)})),this.concepts.set(e,a),this.body.append(a),this.refresh()},removeModelConcept(t){if(!this.concepts.has(t))return void console.error("Concept not found");let e=this.concepts.get(t);return(0,i.removeChildren)(e).remove(),this.refresh(),this},updateModelConcept(t){let e=this.concepts.get(t.id),n=(0,i.getElement)(".outline-concept-name",e),s=(0,i.getElement)(".outline-concept-attrs",e);n.textContent=Kt(t,"name","Undefined"),(0,i.removeChildren)(s),l(t,"attributes").forEach((t=>{let e=(0,i.createListItem)({class:["outline-concept-attr"]}),n=(0,i.createSpan)({class:["outline-concept-name"]},`${Kt(t,"name","Undefined")}`);if(e.append(n),c(t,"target")){let n=function(t){let e=`${t.getProperty("cname")}`;return"concept"===e?(0,i.createSpan)({class:["outline-concept-type"]},`${Kt(t,"concept","Undefined")}`):(0,i.createSpan)({class:["outline-concept-type"]},`${e}`)}(r(t,"target").target);e.append(n)}s.append(e)}))},clear(){this.concepts.forEach((t=>{t.destroy()})),this.concepts=[]},findConcept(t){return(0,i.isNullOrUndefined)(t)?null:t.parent===this?t:Jt(t)?(this.notify(`'${t}' is a primitive.`,a.k$.NORMAL),null):this.concepts.find((e=>e.getName()===t))},selectConcept(t){if((0,i.isNullOrUndefined)(t))return!1;let e=this.findConcept(t);return!(0,i.isNullOrUndefined)(e)&&this.selectedConcept!==e&&(this.selectedConcept&&this.selectedConcept.unselect(),this.selectedConcept=e,this.selectedConcept.select(),this.refresh(),!0)},update(t,e,n){"delete"===t&&this.removeModelConcept(n.id)},notify(t,e,n=4500){let s=(0,i.createParagraph)({class:["notify"],html:t});const a="open";e&&s.classList.add(e),this.header.append(s),setTimeout((()=>{s.classList.add(a)}),50),setTimeout((()=>{s.classList.remove(a),setTimeout((()=>{s.remove()}),500)}),n)},refresh(){(0,i.isEmpty)(this.concepts)?(0,a.$Z)(this.placeholder):(0,a.Cp)(this.placeholder)},render(){(0,i.isHTMLElement)(this.container)||(this.container=(0,i.createDiv)({class:["app-editor-aside"]}));const t=(0,i.createDocFragment)();if((0,i.isHTMLElement)(this.header)||(this.header=(0,i.createDiv)({class:["app-editor-aside-header"]}),t.append(this.header)),!(0,i.isHTMLElement)(this.input)){let t=(0,i.createSpan)({class:["app-editor-aside-title"]},"Model");this.header.append(t)}return(0,i.isHTMLElement)(this.btnBuild)||(this.btnBuild=(0,i.createButton)({class:["btn","app-editor-header__button"],dataset:{name:"button-build",action:"build-concept"}},"Build"),this.header.append(this.btnBuild)),(0,i.isHTMLElement)(this.body)||(this.body=(0,i.createDiv)({class:["app-editor-aside-body"]}),t.append(this.body)),(0,i.isHTMLElement)(this.placeholder)||(this.placeholder=(0,i.createParagraph)({class:["empty-text"],text:"No concept declared yet."}),this.body.append(this.placeholder)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},bindEvents(){this.editor.actions.set("create-instance",(t=>{const{concept:e}=t.dataset;let n=this.editor.createConcept(e),i=this.editor.createProjection(n);this.editor.createInstance(n,i),this.addModelConcept(n)})),this.btnBuild.addEventListener("click",(t=>{v.call(this.editor)}))}};let ie=null,se=null,ae=null,re=null;const oe=n(868),le=n(547),ce=n(535),he=n(221),ue=n(843),de=n(521),pe=n(276);ae=n(425),re=n(445);var me=0;const fe={header:null,menu:null,body:null,editorSection:null,btnNew:null,tabList:null,editors:null,tabs:null,activeEditor:null,activeTab:null,init(){return this.editors=[],this.tabs=new Map,this.bindDOM(),this.bindEvents(),this.render(),this},refresh(){return this},render(){this.refresh()},createEditor(t){let e=(0,s.createEditor)().init(t);return e.id="GE"+me++,this.addEditor(e),e},addEditor(t){return this.editors.push(t),this.editorSection.append(t.container),this.refresh(),this},getEditors(t){const e=this.editors;return(0,i.isFunction)(t)?this.editors.filter((e=>t(e))):e},getEditor(t){return this.editors.find((e=>e.id===t))},deleteEditor(t){let e=this.editors.findIndex((e=>e.id===t));return-1!==e&&(this.getEditor(t).destroy(),this.editors.splice(e,1),this.refresh(),!0)},addTab(t,e){return t.parentElement!==this.tabList&&this.tabList.append(t),this.tabs.set(t,e),e.registerHandler("editor.close@post",(()=>this.closeTab(t))),this},closeTab(t){if((0,i.isNullOrUndefined)(t)||!this.tabs.has(t))return!1;let e=this.tabs.get(t);return this.deleteEditor(e.id),this.tabs.delete(t),t===this.activeTab&&(this.activeTab=null,this.tabList.hasChildNodes()&&this.changeTab(t.previousElementSibling||t.nextElementSibling)),t.remove(),this.refresh(),!0},changeTab(t){if(!(0,i.isNullOrUndefined)(t)){if(this.activeTab){if(this.activeTab===t)return this;this.activeTab.classList.remove("selected"),this.tabs.get(this.activeTab).hide()}return this.activeTab=t,this.activeTab.classList.add("selected"),this.tabs.get(this.activeTab).show(),this.refresh(),this}},notify(t,e,n=4500){let s=(0,i.createParagraph)({class:["notify"],html:t});const a="open";e&&s.classList.add(e),this.body.append(s),setTimeout((()=>{s.classList.add(a)}),50),setTimeout((()=>{s.classList.remove(a),setTimeout((()=>{s.remove()}),500)}),n)},bindModel(){},bindDOM(){this.header=(0,i.getElement)('[data-component="header"]'),this.menu=(0,i.getElement)('[data-component="menu"]'),this.body=(0,i.getElement)('[data-component="body"]'),this.editorSection=(0,i.getElement)('[data-component="editor"]'),this.tabSection=(0,i.getElement)('[data-component="nav"]'),this.tabList=(0,i.getElement)('[data-component="nav-list"]'),(0,i.isHTMLElement)(this.tabList)||(this.tabList=(0,i.createUnorderedList)({class:["bare-list","app-tabs"]}),this.tabSection.append(this.tabList));const t={concept:xe,projection:we,graphic:Ee};for(let e=0;e<this.tabList.childElementCount;e++){const n=this.tabList.children.item(e),{editor:i}=n.dataset;t[i].call(this).then((t=>{t.hide(),this.addTab(n,t),n.classList.contains("selected")&&(this.activeTab=n,this.tabs.get(this.activeTab).show())})).catch((t=>{console.log(t)}))}return this},bindEvents(){this.menu.addEventListener("click",(t=>{let e=function(t,e){return(0,i.isNullOrUndefined)(t)||t===e?null:(0,i.hasOwn)(t.dataset,"action")?t:t.parentElement===e?(0,i.getElement)("[data-action]",t):(0,i.findAncestor)(t,(t=>(0,i.hasOwn)(t.dataset,"action")),5)}(t.target,this.menu);if(!(0,i.isHTMLElement)(e))return!1;const{action:n}=e.dataset;if("new"===n){let t=ge.call(this,"EX");this.addTab(t,this.createEditor({config:{toolbar:[{type:"button",name:"button-export",action:"export.model",class:["btn","editor-toolbar__button","editor-toolbar__button--save"]}]},handlers:{"export.model":function(){console.log(this),this.export()},"open.menu":function(){this.home.open()},"close.editor":function(){this.close()},"build-concept":function(t){v.call(this)},"build-projection":function(t){X.call(this)}}})),this.changeTab(t)}else"new-template"===n&&this.notify("Cette fonction n'est pas encore implémentée")})),this.tabList.addEventListener("click",(t=>{let e=function(t,e){return t.parentElement===e?t:(0,i.findAncestor)(t,(t=>t.parentElement===e))}(t.target,this.tabList);if(!(0,i.isHTMLElement)(e))return!1;this.changeTab(e)}))}};function ge(t){let e=(0,i.createSpan)({class:["nav-item-title"]},t);return(0,i.createListItem)({class:["nav-item","has-helper"]},[e])}const ye={"open-constraint":function(t){let e=t[0],n=this.createProjection(e,"constraint"),s=this.findWindow("side-instance");(0,i.isNullOrUndefined)(s)&&(s=this.createWindow("side-instance"),s.container.classList.add("concept-constraint-sideview")),s.instances.size>0&&Array.from(s.instances)[0].delete();let a=this.createInstance(e,n,{type:"projection",close:"DELETE-PROJECTION"});s.addInstance(a)},"build-concept":function(t){v.call(this)}},be={"build-projection":function(t){X.call(this)},"value.changed":function(){if(!this.__previewStarted)return!1},"value.added":function(){if(!this.__previewStarted)return!1},"value.removed":function(){if(!this.__previewStarted)return!1},"open-style":function(t){let e=t[0],n=this.createProjection(e,"style"),s=this.findWindow("side-instance");(0,i.isNullOrUndefined)(s)&&(s=this.createWindow("side-instance"),s.container.classList.add("model-projection-sideview")),s.instances.size>0&&Array.from(s.instances)[0].delete();let a=this.createInstance(e,n,{type:"projection",close:"DELETE-PROJECTION"});s.addInstance(a)},"open-state":function(t){let e=t[0],n=this.createProjection(e,"state"),s=this.findWindow("side-instance");(0,i.isNullOrUndefined)(s)&&(s=this.createWindow("side-instance"),s.container.classList.add("model-projection-sideview")),s.instances.size>0&&Array.from(s.instances)[0].delete();let a=this.createInstance(e,n,{type:"projection",close:"DELETE-PROJECTION"});s.addInstance(a)},"open-layout":function(t){let e=t[0],n=this.createProjection(e,"layout"),s=this.findWindow("side-instance");(0,i.isNullOrUndefined)(s)&&(s=this.createWindow("side-instance"),s.container.classList.add("model-projection-sideview")),s.instances.size>0&&Array.from(s.instances)[0].delete();let a=this.createInstance(e,n,{type:"projection",close:"DELETE-PROJECTION"});s.addInstance(a)}},ve={"build-graphical":function(t){return jt.call(this)},"open-state":function(t){let e=t[0],n=this.createProjection(e,"state"),s=this.findWindow("side-instance");(0,i.isNullOrUndefined)(s)&&(s=this.createWindow("side-instance"),s.container.classList.add("model-projection-sideview")),s.instances.size>0&&Array.from(s.instances)[0].delete();let a=this.createInstance(e,n,{type:"projection",close:"DELETE-PROJECTION"});s.addInstance(a)},"open-sibling":function(t){let e=t[0],n=this.createProjection(e,"sibling"),s=this.findWindow("side-instance");(0,i.isNullOrUndefined)(s)&&(s=this.createWindow("side-instance"),s.container.classList.add("model-projection-sideview")),s.instances.size>0&&Array.from(s.instances)[0].delete();let a=this.createInstance(e,n,{type:"projection",close:"DELETE-PROJECTION"});s.addInstance(a)},"open-style":function(t){let e=t[0],n=this.createProjection(e,"style"),s=this.findWindow("side-instance");(0,i.isNullOrUndefined)(s)&&(s=this.createWindow("side-instance"),s.container.classList.add("model-projection-sideview")),s.instances.size>0&&Array.from(s.instances)[0].delete();let a=this.createInstance(e,n,{type:"projection",close:"DELETE-PROJECTION"});s.addInstance(a)},"open-area":function(t){let e=t[0],n=this.createProjection(e,"area"),s=this.findWindow("side-instance");(0,i.isNullOrUndefined)(s)&&(s=this.createWindow("side-instance"),s.container.classList.add("model-projection-sideview")),s.instances.size>0&&Array.from(s.instances)[0].delete();let a=this.createInstance(e,n,{type:"projection",close:"DELETE-PROJECTION"});s.addInstance(a)},"open-draw":function(t){let e=t[0],n=this.createProjection(e,"draw"),s=this.findWindow("side-instance");(0,i.isNullOrUndefined)(s)&&(s=this.createWindow("side-instance"),s.container.classList.add("model-projection-sideview")),s.instances.size>0&&Array.from(s.instances)[0].delete();let a=this.createInstance(e,n,{type:"projection",close:"DELETE-PROJECTION"});s.addInstance(a)},"open-layout":function(t){let e=t[0],n=this.createProjection(e,"layout"),s=this.findWindow("side-instance");(0,i.isNullOrUndefined)(s)&&(s=this.createWindow("side-instance"),s.container.classList.add("model-projection-sideview")),s.instances.size>0&&Array.from(s.instances)[0].delete();let a=this.createInstance(e,n,{type:"projection",close:"DELETE-PROJECTION"});s.addInstance(a)}};function xe(){return(0,i.isNullOrUndefined)(ie)?Promise.all([fetch("https://geodes.iro.umontreal.ca/gentleman/models/concept-model/concept.json"),fetch("https://geodes.iro.umontreal.ca/gentleman/models/concept-model/projection.json")]).then((async([t,e])=>{ie=await t.json(),se=await e.json();let n=this.createEditor({conceptModel:ie,projectionModel:se,config:oe,handlers:ye}),i=Object.create(Qt).init(n);return this.editorSection.append(i.render()),n})):new Promise((()=>this.createEditor({conceptModel:ie,projectionModel:se,config:oe,handlers:ye})))}function we(){return(0,i.isNullOrUndefined)(ie)?Promise.all([fetch("https://geodes.iro.umontreal.ca/gentleman/models/projection-model/concept.json"),fetch("https://geodes.iro.umontreal.ca/gentleman/models/projection-model/projection.json"),fetch("https://geodes.iro.umontreal.ca/gentleman/models/style-model/concept.json"),fetch("https://geodes.iro.umontreal.ca/gentleman/models/style-model/projection.json")]).then((async([t,e,n,i])=>{let s=this.createEditor({conceptModel:de,projectionModel:pe,config:Object.assign({},le),handlers:be});s.addConcept(he),s.addProjection(ue);let a=Object.create(te).init(s);return this.editorSection.append(a.render()),s})):new Promise((()=>{let t=this.createEditor({conceptModel:de,projectionModel:pe,config:Object.assign({},le),handlers:be});t.addConcept(he),t.addProjection(ue);let e=Object.create(te).init(t);return this.editorSection.append(e.render()),t}))}function Ee(){return(0,i.isNullOrUndefined)(ie)?Promise.all([fetch("https://geodes.iro.umontreal.ca/gentleman/models/projection-model/concept.json"),fetch("https://geodes.iro.umontreal.ca/gentleman/models/projection-model/projection.json"),fetch("https://geodes.iro.umontreal.ca/gentleman/models/style-model/concept.json"),fetch("https://geodes.iro.umontreal.ca/gentleman/models/style-model/projection.json")]).then((async([t,e,n,i])=>{let s=this.createEditor({conceptModel:[ae,de,he],projectionModel:[re,pe,ue],config:Object.assign({},ce),handlers:ve}),a=Object.create(te).init(s);return this.editorSection.append(a.render()),s})):new Promise((()=>{let t=this.createEditor({conceptModel:ae,projectionModel:re,config:Object.assign({}),handlers:ve}),e=Object.create(te).init(t);return this.editorSection.append(e.render()),t}))}},839:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Preview:()=>a});var i=n(835),s=n(241);const a={menu:null,editorSection:null,editor:null,channel:null,init(t){return this.channel=new BroadcastChannel(t),this.editor=Gentleman.createEditor().init({config:{settings:!1}}),this.bindDOM(),this.render(),this.bindEvents(),this},refresh(){return this.editor.isReady?this.editor.open():this.editor.close(),this},render(){this.editorSection.append(this.editor.container),this.refresh()},getEditor(){return this.editor},bindDOM(){this.menu=(0,i.getElement)('[data-component="menu"]'),this.editorSection=(0,i.getElement)('[data-component="editor"]'),(0,s.Cp)(this.menu)},bindEvents(){this.channel.addEventListener("message",(t=>{const{concept:e,projection:n}=t.data;let i=[];this.editor.conceptModel&&(i=this.editor.conceptModel.export()),this.editor.unload().freeze().loadConceptModel(e,i).loadProjectionModel(n).unfreeze().open()}))}}},868:t=>{"use strict";t.exports=JSON.parse('{"concept":{"concrete-concept":{"name":"concrete concept"},"prototype-concept":{"name":"prototype concept"},"derivative-concept":{"name":"derivative concept"}},"toolbar":[{"type":"button","name":"button-export","action":"export.model","class":["btn","editor-toolbar__button","editor-toolbar__button--save"]}]}')},425:t=>{"use strict";t.exports=JSON.parse('{"type":"concept","concept":[{"name":"proto-graphical","nature":"prototype","attributes":[{"name":"concept","target":{"name":"concept"},"required":true},{"name":"tags","target":{"name":"set","accept":{"name":"g-tag"}}}]},{"name":"g-tag","nature":"derivative","base":"string","constraint":{"value":{"type":"pattern","pattern":{"insensitive":true,"global":true,"value":"^\\\\w+(-\\\\w+)*$"}}}},{"name":"graphical","nature":"concrete","root":true,"prototype":"proto-graphical","attributes":[{"name":"name","target":{"name":"name"},"required":false},{"name":"element","target":{"name":"graphics","default":{"name":"decoration-layout"}},"required":true}],"properties":[{"name":"handler","type":"string","value":"graphical"}]},{"name":"graphics","nature":"prototype","attributes":[]},{"name":"graphical-field","nature":"prototype","attributes":[{"name":"dimensions","target":{"name":"dimensions"}},{"name":"coordinates","target":{"name":"coordinates"}}]},{"name":"svg-choice","nature":"concrete","prototype":"graphical-field","attributes":[{"name":"dimension","target":{"name":"dimensions","accept":[{"name":"pure"},{"name":"absolute"},{"name":"fixed"}],"default":{"name":"pure"}}},{"name":"coordinates","target":{"name":"coordinates"}},{"name":"dimensions","target":{"name":"absolute"},"required":false},{"name":"tag","target":{"name":"g-tag"}},{"name":"selection","target":{"name":"choice-selection"}}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"svg-choice"}]},{"name":"choice-selection","nature":"concrete","attributes":[{"name":"orientation","target":{"name":"string","values":["horizontal","vertical"],"default":"horizontal"}},{"name":"break","target":{"name":"number"},"required":true},{"name":"nbItem","target":{"name":"number","default":2}},{"name":"dimensions","target":{"name":"absolute-default"}}]},{"name":"svg-placeholder","nature":"concrete","prototype":"graphical-field","attributes":[{"name":"dimensions","target":{"name":"absolute"},"required":false},{"name":"tag","target":{"name":"g-tag"}}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"svg-placeholder"}]},{"name":"svg-switch","nature":"concrete","attributes":[{"name":"tag","target":{"name":"string"}},{"name":"order","target":{"name":"set","accept":{"name":"string"}}},{"name":"dimension","target":{"name":"dimensions","accept":[{"name":"pure"},{"name":"absolute"},{"name":"fixed"}],"default":{"name":"pure"}}},{"name":"coordinates","target":{"name":"coordinates"}}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"svg-switch"}]},{"name":"arrow","nature":"prototype","attributes":[{"name":"arrow-style","target":{"name":"arrow-style"}},{"name":"decorator","target":{"name":"projection-dynamic"},"required":false}]},{"name":"force-arrow","nature":"concrete","prototype":"arrow","attributes":[{"name":"from","target":{"name":"string"}},{"name":"to","target":{"name":"attribute"}}],"properties":[{"name":"handlerType","type":"string","value":"arrow"},{"name":"elementType","type":"string","value":"force"}]},{"name":"anchor-arrow","nature":"concrete","prototype":"arrow","attributes":[{"name":"aiming","target":{"name":"string"}},{"name":"model","target":{"name":"string"}},{"name":"offSet","target":{"name":"coordinates"}},{"name":"self","target":{"name":"set","accept":{"name":"coordinates"}}},{"name":"move","target":{"name":"string"},"required":false}],"properties":[{"name":"handlerType","type":"string","value":"arrow"},{"name":"elementType","type":"string","value":"pattern"}]},{"name":"multi-arrow","nature":"concrete","prototype":"arrow","attributes":[{"name":"meet","target":{"name":"string","values":["free","maxX","minX","maxY","minY"],"default":"free"}},{"name":"offSet","target":{"name":"coordinates"}},{"name":"sub-paths","target":{"name":"sub-path"}}],"properties":[{"name":"handlerType","type":"string","value":"arrow"},{"name":"elementType","type":"string","value":"multi"}]},{"name":"sub-path","nature":"concrete","attributes":[{"name":"type","target":{"name":"string"}},{"name":"arrow-style","target":{"name":"arrow-style"}}]},{"name":"shape","nature":"concrete","attributes":[{"name":"elements","target":{"name":"set","accept":{"name":"shape-element","accept":[{"name":"circle"},{"name":"rectangle"},{"name":"ellipse"},{"name":"polygon"},{"name":"path"},{"name":"text"}]}}},{"name":"current","target":{"name":"reference","accept":{"name":"shape-element"}}},{"name":"width","target":{"name":"number","default":200}},{"name":"height","target":{"name":"number","default":200}},{"name":"minX","target":{"name":"number","default":0}},{"name":"minY","target":{"name":"number","default":0}},{"name":"windowW","target":{"name":"number"}},{"name":"windowH","target":{"name":"number"}}]},{"name":"shape-style","nature":"concrete","attributes":[{"name":"fill","target":{"name":"string","default":"black"}},{"name":"stroke","target":{"name":"string","default":"black"}},{"name":"s-width","target":{"name":"number","default":0}},{"name":"s-dash","target":{"name":"string","default":"0"}},{"name":"rx","target":{"name":"number"}},{"name":"ry","target":{"name":"number"}}]},{"name":"shape-element","nature":"prototype","attributes":[]},{"name":"circle","nature":"concrete","prototype":"shape-element","attributes":[{"name":"cx","target":{"name":"number"}},{"name":"cy","target":{"name":"number"}},{"name":"r","target":{"name":"number"}},{"name":"fill","target":{"name":"string"}},{"name":"style","target":{"name":"shape-style"}}]},{"name":"rectangle","nature":"concrete","prototype":"shape-element","attributes":[{"name":"x","target":{"name":"number"}},{"name":"y","target":{"name":"number"}},{"name":"width","target":{"name":"number"}},{"name":"height","target":{"name":"number"}},{"name":"style","target":{"name":"shape-style"}}]},{"name":"polygon","nature":"concrete","prototype":"shape-element","attributes":[{"name":"points","target":{"name":"string"}},{"name":"style","target":{"name":"shape-style"}}]},{"name":"ellipse","nature":"concrete","prototype":"shape-element","attributes":[{"name":"cx","target":{"name":"number"}},{"name":"cy","target":{"name":"number"}},{"name":"rx","target":{"name":"number"}},{"name":"ry","target":{"name":"number"}},{"name":"style","target":{"name":"shape-style"}}]},{"name":"text","nature":"concrete","prototype":"shape-element","attributes":[{"name":"content","target":{"name":"string"}}]},{"name":"path","nature":"concrete","prototype":"shape-element","attributes":[{"name":"d","target":{"name":"string"}},{"name":"style","target":{"name":"shape-style"}}]},{"name":"svg-text","nature":"concrete","prototype":"graphical-field","attributes":[{"name":"placeholder","target":{"name":"string"}},{"name":"readonly","target":{"name":"boolean","default":false}},{"name":"break","target":{"name":"number"},"required":false},{"name":"style","target":{"name":"textSVG-style"}},{"name":"dimension","target":{"name":"dimensions","accept":[{"name":"pure"},{"name":"absolute"},{"name":"fixed"}],"default":{"name":"pure"}}},{"name":"coordinates","target":{"name":"coordinates"}}],"properties":[{"name":"handlerType","type":"string","value":"field"},{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"svg"}]},{"name":"graphical-static","nature":"prototype","prototype":"graphics","attributes":[{"name":"dimensions","target":{"name":"dimensions"}},{"name":"coordinates","target":{"name":"coordinates"}}]},{"name":"svg-button","nature":"concrete","prototype":"graphical-static","attributes":[{"name":"content","target":{"name":"string"}},{"name":"shape","target":{"name":"shape"}},{"name":"action","target":{"name":"button-action","accept":[{"name":"add-action"},{"name":"side-action"},{"name":"tree-action"}],"default":"add-action"}},{"name":"dimension","target":{"name":"dimensions","accept":[{"name":"pure"},{"name":"absolute"},{"name":"fixed"}],"default":{"name":"pure"}}},{"name":"coordinates","target":{"name":"coordinates"}}],"properties":[{"name":"contentType","type":"string","value":"static"},{"name":"elementType","type":"string","value":"svg-button"}]},{"name":"button-action","nature":"prototype","attributes":[]},{"name":"tree-action","nature":"concrete","prototype":"button-action","attributes":[{"name":"treeId","target":{"name":"string"}},{"name":"item","target":{"name":"string"}}]},{"name":"add-action","nature":"concrete","prototype":"button-action","attributes":[]},{"name":"side-action","nature":"concrete","prototype":"button-action","attributes":[{"name":"tag","target":{"name":"string"}}]},{"name":"open-selection","nature":"concrete","prototype":"button-action","attributes":[]},{"name":"alt-view","nature":"concrete","prototype":"graphical-static","attributes":[{"name":"content","target":{"name":"string"}},{"name":"shape","target":{"name":"shape"}},{"name":"tag","target":{"name":"tag"}},{"name":"dimension","target":{"name":"dimensions","accept":[{"name":"pure"},{"name":"absolute"},{"name":"fixed"}],"default":{"name":"pure"}}},{"name":"coordinates","target":{"name":"coordinates"}},{"name":"action","target":{"name":"string","default":"SIDE"}}],"properties":[{"name":"contentType","type":"string","value":"static"},{"name":"elementType","type":"string","value":"svg-button"}]},{"name":"svg-static","nature":"concrete","prototype":"graphical-static","attributes":[{"name":"content","target":{"name":"string"}},{"name":"dimension","target":{"name":"dimensions","accept":[{"name":"pure"},{"name":"absolute"},{"name":"fixed"}],"default":{"name":"pure"}}},{"name":"coordinates","target":{"name":"coordinates"}},{"name":"shape","target":{"name":"shape"}}],"properties":[{"name":"contentType","type":"string","value":"static"},{"name":"elementType","type":"string","value":"svg"}]},{"name":"svgText-static","nature":"concrete","prototype":"graphical-static","attributes":[{"name":"content","target":{"name":"string"}},{"name":"style","target":{"name":"textSVG-style"}},{"name":"dimension","target":{"name":"dimensions","accept":[{"name":"pure"},{"name":"absolute"},{"name":"fixed"}],"default":{"name":"pure"}}},{"name":"coordinates","target":{"name":"coordinates"}}],"properties":[{"name":"contentType","type":"string","value":"static"},{"name":"elementType","type":"string","value":"svg-text"}]},{"name":"graphical-layout","nature":"prototype","prototype":"graphics","attributes":[{"name":"rtag","target":{"name":"rtag"}}]},{"name":"tree-layout","nature":"concrete","prototype":"graphical-layout","attributes":[{"name":"tag","target":{"name":"g-tag"}},{"name":"treeId","target":{"name":"string"}},{"name":"direction","target":{"name":"string","values":["horizontal","vertical"],"default":"horizontal"}},{"name":"width","target":{"name":"number","default":400}},{"name":"height","target":{"name":"number","default":400}},{"name":"depth","target":{"name":"number","default":100}}],"properties":[{"name":"handlerType","type":"string","value":"algorithm"},{"name":"elementType","type":"string","value":"tree"}]},{"name":"force-layout","nature":"concrete","prototype":"graphical-layout","attributes":[{"name":"force","target":{"name":"force"}},{"name":"tag","target":{"name":"g-tag"}}],"properties":[{"name":"handlerType","type":"string","value":"algorithm"},{"name":"elementType","type":"string","value":"force"}]},{"name":"force","nature":"concrete","attributes":[{"name":"dimension","target":{"name":"absolute"}},{"name":"intensity","target":{"name":"number","default":500}},{"name":"linkVal","target":{"name":"number","default":300}},{"name":"radius","target":{"name":"number","default":50}},{"name":"width","target":{"name":"number","default":700}},{"name":"height","target":{"name":"number","default":700}}]},{"name":"pattern-layout","nature":"concrete","prototype":"graphical-layout","attributes":[{"name":"saturation","target":{"name":"number"}},{"name":"create","target":{"name":"boolean","default":"false"}},{"name":"pattern","target":{"name":"anchors"}},{"name":"item","target":{"name":"g-tag"}}]},{"name":"anchors","nature":"concrete","attributes":[{"name":"first","target":{"name":"coordinates-first"}},{"name":"next","target":{"name":"coordinates-next"}},{"name":"nbItem","target":{"name":"number","default":3}},{"name":"width","target":{"name":"number","default":350}},{"name":"height","target":{"name":"number","default":350}},{"name":"itemWidth","target":{"name":"number","default":50}}]},{"name":"decoration-layout","nature":"concrete","prototype":"graphical-layout","attributes":[{"name":"dimensions","target":{"name":"absolute"},"required":false},{"name":"coordinates","target":{"name":"coordinates"},"required":false},{"name":"background","target":{"name":"string"},"required":true},{"name":"shape","target":{"name":"shape"},"required":true},{"name":"reference","target":{"name":"boolean"},"default":false},{"name":"rmv","target":{"name":"rmv"},"required":false},{"name":"content","target":{"name":"set","accept":{"name":"graphical-component"}}}],"properties":[{"name":"handlerType","type":"string","value":"algorithm"},{"name":"elementType","type":"string","value":"decoration"}]},{"name":"rmv","nature":"prototype","attributes":[]},{"name":"rmv-single","nature":"concrete","prototype":"rmv","attributes":[{"name":"background","target":{"name":"string"}},{"name":"shape","target":{"name":"shape"}},{"name":"dimensions","target":{"name":"dimensions","accept":[{"name":"pure"},{"name":"absolute"},{"name":"fixed"}],"default":{"name":"pure"}}},{"name":"coordinates","target":{"name":"coordinates"}}]},{"name":"rmv-bind","prototype":"rmv","nature":"concrete","attributes":[]},{"name":"graphical-component","nature":"concrete","attributes":[{"name":"render","target":{"name":"graphics"}}]},{"name":"dimensions","nature":"prototype","attributes":[]},{"name":"absolute-default","nature":"concrete","prototype":"dimensions","attributes":[{"name":"width","target":{"name":"number","default":50},"default":50},{"name":"height","target":{"name":"number","default":50},"default":50}]},{"name":"absolute","nature":"concrete","prototype":"dimensions","attributes":[{"name":"width","target":{"name":"number"}},{"name":"height","target":{"name":"number"}}]},{"name":"fixed","nature":"concrete","prototype":"dimensions","attributes":[{"name":"width","target":{"name":"number"}}]},{"name":"pure","nature":"concrete","prototype":"dimensions","attributes":[]},{"name":"coordinates","nature":"concrete","attributes":[{"name":"x","target":{"name":"number","default":0}},{"name":"y","target":{"name":"number","default":0}},{"name":"anchor","target":{"name":"string","values":["left","middle","right","center"]}}]},{"name":"coordinates-first","nature":"concrete","attributes":[{"name":"x","target":{"name":"number","default":50}},{"name":"y","target":{"name":"number","default":150}}]},{"name":"coordinates-next","nature":"concrete","attributes":[{"name":"x","target":{"name":"number","default":100}},{"name":"y","target":{"name":"number","default":0}}]},{"name":"rtag","nature":"derivative","base":"string","constraint":{"value":{"type":"pattern","pattern":{"insensitive":true,"global":true,"value":"^\\\\w+(-\\\\w+)*$"}}}},{"name":"textSVG-style","nature":"concrete","attributes":[{"name":"font","target":{"name":"string","default":"Verdana"}},{"name":"size","target":{"name":"number","default":11}},{"name":"anchor","target":{"name":"string","values":["left","middle","right"],"default":"middle"}},{"name":"weight","target":{"name":"number"},"required":false},{"name":"baseline","target":{"name":"string","values":["auto","text-bottom","alphabetic","ideographic","middle","central","mathematical","hanging","text-top"],"default":"auto"}}]},{"name":"arrow-style","nature":"concrete","attributes":[{"name":"stroke","target":{"name":"hex-color__black"}},{"name":"dasharray","target":{"name":"string"}},{"name":"width","target":{"name":"number","default":1}},{"name":"linecap","target":{"name":"string","default":"butt"}},{"name":"end","target":{"name":"markerArrow"},"required":false},{"name":"start","target":{"name":"markerArrow"},"required":false}]},{"name":"markerArrow","nature":"concrete","attributes":[{"name":"id","target":{"name":"string"}},{"name":"minX","target":{"name":"number"}},{"name":"minY","target":{"name":"number"}},{"name":"width","target":{"name":"number"}},{"name":"height","target":{"name":"number"}},{"name":"refX","target":{"name":"number"}},{"name":"refY","target":{"name":"number"}},{"name":"markerWidth","target":{"name":"number"}},{"name":"markerHeight","target":{"name":"number"}},{"name":"d","target":{"name":"string"}}]},{"name":"projection-dynamic","nature":"concrete","prototype":"graphics","attributes":[{"name":"src","target":{"name":"name"}},{"name":"attribute","target":{"name":"string"}},{"name":"tag","target":{"name":"g-tag"}},{"name":"dimension","target":{"name":"dimensions","accept":[{"name":"pure"},{"name":"absolute"},{"name":"fixed"}],"default":{"name":"pure"}}},{"name":"coordinates","target":{"name":"coordinates"}}],"properties":[{"name":"contentType","type":"string","value":"dynamic"},{"name":"elementType","type":"string","value":"projection"}]}]}')},535:t=>{"use strict";t.exports=JSON.parse('{"name":"Gentleman graphical","concepts":[{"name":"graphical"}],"toolbar":[{"type":"button","name":"button-build","action":"build-graphical","class":["btn","app-editor-header__button"],"content":"Build"},{"type":"button","name":"button-export","action":"export.model","class":["btn","editor-toolbar__button","editor-toolbar__button--save"]}]}')},445:t=>{"use strict";t.exports=JSON.parse('{"type":"projection","projection":[{"concept":{"name":"graphical"},"type":"container","tags":["default"],"container":{"content":[{"type":"container","content":[{"kind":"static","type":"text","content":"Tags","style":{"css":["title","mp-header__title"]}},{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"tags"}},"content":[{"kind":"static","type":"text","content":"+","style":{"css":["mp-header__button-content"]}}],"style":{"css":["mp-header__button","mp-header__button--add"]}},{"type":"attribute","name":"tags","tag":"tag-set","style":{"css":["mp-header__tags"]}},{"type":"attribute","name":"element","tag":"available-default"}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["model-projection-header"]}},{"type":"container","content":[{"type":"attribute","name":"element","tag":"default"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"graphical"},"type":"container","tags":["string","number"],"container":{"content":[{"type":"container","content":[{"kind":"static","type":"text","content":"Tags","style":{"css":["title","mp-header__title"]}},{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"tags"}},"content":[{"kind":"static","type":"text","content":"+","style":{"css":["mp-header__button-content"]}}],"style":{"css":["mp-header__button","mp-header__button--add"]}},{"type":"attribute","name":"tags","tag":"tag-set","style":{"css":["mp-header__tags"]}},{"type":"attribute","name":"element","tag":"available-string"}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["model-projection-header"]}},{"type":"container","content":[{"type":"attribute","name":"element","tag":"string"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"graphical"},"type":"container","tags":["boolean"],"container":{"content":[{"type":"container","content":[{"kind":"static","type":"text","content":"Tags","style":{"css":["title","mp-header__title"]}},{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"tags"}},"content":[{"kind":"static","type":"text","content":"+","style":{"css":["mp-header__button-content"]}}],"style":{"css":["mp-header__button","mp-header__button--add"]}},{"type":"attribute","name":"tags","tag":"tag-set","style":{"css":["mp-header__tags"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["model-projection-header"]}},{"type":"container","content":[{"type":"attribute","name":"element","tag":"boolean"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"graphical"},"type":"container","tags":["reference"],"container":{"content":[{"type":"container","content":[{"kind":"static","type":"text","content":"Tags","style":{"css":["title","mp-header__title"]}},{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"tags"}},"content":[{"kind":"static","type":"text","content":"+","style":{"css":["mp-header__button-content"]}}],"style":{"css":["mp-header__button","mp-header__button--add"]}},{"type":"attribute","name":"tags","tag":"tag-set","style":{"css":["mp-header__tags"]}},{"type":"attribute","name":"element","tag":"available-reference"}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["model-projection-header"]}},{"type":"container","content":[{"type":"attribute","name":"element","tag":"reference"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"graphical"},"type":"container","tags":["prototype"],"container":{"content":[{"type":"container","content":[{"kind":"static","type":"text","content":"Tags","style":{"css":["title","mp-header__title"]}},{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"tags"}},"content":[{"kind":"static","type":"text","content":"+","style":{"css":["mp-header__button-content"]}}],"style":{"css":["mp-header__button","mp-header__button--add"]}},{"type":"attribute","name":"tags","tag":"tag-set","style":{"css":["mp-header__tags"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["model-projection-header"]}},{"type":"container","content":[{"type":"attribute","name":"element","tag":"reference"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"graphical"},"type":"container","tags":["set"],"container":{"content":[{"type":"container","content":[{"kind":"static","type":"text","content":"Tags","style":{"css":["title","mp-header__title"]}},{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"tags"}},"content":[{"kind":"static","type":"text","content":"+","style":{"css":["mp-header__button-content"]}}],"style":{"css":["mp-header__button","mp-header__button--add"]}},{"type":"attribute","name":"tags","tag":"tag-set","style":{"css":["mp-header__tags"]}},{"type":"attribute","name":"element","tag":"available-set"}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["model-projection-header"]}},{"type":"container","content":[{"type":"attribute","name":"element","tag":"set"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["available-default"],"projection":{"type":"flex","orientation":"row","wrappable":false,"disposition":[{"type":"template","name":"mp-button3","param":[{"name":"type","value":"decoration-layout"},{"name":"name","value":"Decoration Layout"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"tree-layout"},{"name":"name","value":"Tree Layout"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"force-arrow"},{"name":"name","value":"Force Arrow"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"anchor-arrow"},{"name":"name","value":"Anchor Arrow"}]}],"style":{"css":["container-config"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["available-set"],"projection":{"type":"flex","orientation":"row","wrappable":false,"disposition":[{"type":"template","name":"mp-button3","param":[{"name":"type","value":"decoration-layout"},{"name":"name","value":"Decoration Layout"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"force-layout"},{"name":"name","value":"Force Layout"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"pattern-layout"},{"name":"name","value":"Pattern Layout"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"multi-arrow"},{"name":"name","value":"Multi Arrow"}]}],"style":{"css":["container-config"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["available-string"],"projection":{"type":"flex","orientation":"row","wrappable":false,"disposition":[{"type":"template","name":"mp-button3","param":[{"name":"type","value":"decoration-layout"},{"name":"name","value":"Decoration Layout"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"svg-text"},{"name":"name","value":"Text Field"}]}],"style":{"css":["container-config"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["available-reference"],"projection":{"type":"flex","orientation":"row","wrappable":false,"disposition":[{"type":"template","name":"mp-button3","param":[{"name":"type","value":"anchor-arrow"},{"name":"name","value":"Anchor Arrow"}]}],"style":{"css":["container-config"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["choice-selection_default","config"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection_default","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["choice-selection","config","default"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection__default","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["component","config","default"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["choice-selection","config","string","number"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection__string","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["choice-selection","config","boolean"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection__boolean","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["choice-selection","config","set"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection__set","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["choice-selection","config","reference"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection__reference","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"graphics"},"type":"layout","tags":["choice-selection","config","set"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","wrappable":false,"disposition":[{"type":"template","name":"mp-button3","param":[{"name":"type","value":"decoration-layout"},{"name":"name","value":"Decoration"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"pattern-layout"},{"name":"name","value":"Pattern"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"force-layout"},{"name":"name","value":"Force"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"svg-button"},{"name":"name","value":"Button"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"svgText-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button3","param":[{"name":"type","value":"svg-alt"},{"name":"name","value":"Alt"}]}],"style":{"css":["container-config-header"]}}},{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"tree-layout"},"tags":["choice-selection__default"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"center","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"width","tag":"textual--labelled"},{"type":"attribute","name":"height","tag":"textual--labelled"}]}},{"type":"attribute","name":"depth","tag":"textual--labelled"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"15\\" height=\\"15\\" viewBox=\\"0 0 20 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}}],"style":{"css":["editor-concept-toolbar"]}}}],"style":{"css":["container-config-header"]}}},{"type":"simulation","simulation":{"type":"tree"}}]}},{"concept":{"name":"tree-layout"},"tags":["layout-setting"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Item","style":{"css":["mp-style__title"]}},{"type":"attribute","name":"tag","tag":"text-string","options":{"placeholder":"g-tag"},"style":{"css":["mp-tag"]}},{"kind":"static","type":"text","content":"ID","style":{"css":["mp-style__title"]}},{"type":"attribute","name":"treeId","tag":"text-string","options":{"placeholder":"treeId"},"style":{"css":["mp-tag"]}}]}},{"concept":{"name":"tree"},"tags":["settings"],"type":"layout","projection":{"type":"flex","orientation":"row","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"width","tag":"textual--labelled"},{"type":"attribute","name":"height","tag":"textual--labelled"}]}},{"type":"attribute","name":"depth","tag":"textual--labelled"}]}},{"concept":{"name":"tree"},"tags":["simulation"],"type":"simulation","simulation":{"type":"tree"}},{"concept":{"name":"decoration-layout"},"tags":["layout-setting"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"rtag","tag":"label-string"},{"kind":"static","type":"text","content":"Position","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"coordinates","placeholder":{"content":{"kind":"static","type":"text","content":"Add Coordinates","help":"Specify customed coordinates","style":{"css":["field-config-option","font-ui"],"ref":["box-top"]}}},"tag":"layout-coordinates"},{"kind":"static","type":"text","content":"Dimensions","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"dimensions","placeholder":{"content":{"kind":"static","type":"text","content":"Add Dimensions","help":"Specify customed dimensions","style":{"css":["field-config-option","font-ui"],"ref":["box-top"]}}},"tag":"layout-dimensions"},{"kind":"static","type":"text","content":"Delete","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"rmv","placeholder":{"content":{"kind":"static","type":"text","content":"Add Delete","help":"Specify customed dimensions","style":{"css":["field-config-option","font-ui"],"ref":["box-top"]}}},"tag":"layout-rmv"}]}},{"concept":{"name":"rmv"},"tags":["layout-rmv"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"field","field":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["select-choice__list-option"]}},"style":{"css":["select-choice__list"]}},"placeholder":"Select a delete","expanded":false,"input":false,"style":{"css":["select-choice"]}}},{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection"}]}},{"concept":{"name":"rmv-single"},"tags":["choice"],"type":"layout","projection":{"type":"wrap","disposition":[{"kind":"static","type":"text","content":"Single"}]}},{"concept":{"name":"rmv-single"},"tags":["choice-selection","create"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"coordinates","tag":"layout-coordinates"},{"type":"attribute","name":"dimensions","tag":"component-dimensions_wl"}]}},{"type":"template","name":"tpl-options-nav--create"},{"type":"layout","layout":{"type":"flex","orientation":"column","alignItems":"center","disposition":[{"type":"attribute","name":"shape","tag":"shape"}]}},{"type":"attribute","name":"shape","tag":"interact"}]}},{"concept":{"name":"rmv-single"},"tags":["choice-selection","import"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"coordinates","tag":"layout-coordinates"},{"type":"attribute","name":"dimensions","tag":"component-dimensions_wl"}]}},{"type":"template","name":"tpl-options-nav--import"},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Background","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"background","tag":"fixed"}]}},{"type":"attribute","name":"background","tag":"simulation-content"}]}},{"concept":{"name":"rmv-bind"},"tags":["choice"],"type":"layout","projection":{"type":"wrap","disposition":[{"kind":"static","type":"text","content":"Bind"}]}},{"concept":{"name":"coordinates-first"},"tags":["anchor-coord"],"type":"layout","projection":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"x"},{"type":"attribute","name":"y"}]}},{"concept":{"name":"coordinates-next"},"tags":["anchor-coord"],"type":"layout","projection":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"x"},{"type":"attribute","name":"y"}]}},{"concept":{"name":"coordinates"},"tags":["layout-coordinates"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"X","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"x"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Y","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"y"}]}}]}},{"concept":{"name":"coordinates"},"tags":["horizontal-coordinates"],"type":"layout","projection":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"x"},{"type":"attribute","name":"y"}]}},{"concept":{"name":"coordinates"},"tags":["list-item"],"type":"layout","projection":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"("},{"type":"attribute","name":"x"},{"kind":"static","type":"text","content":","},{"type":"attribute","name":"y"},{"kind":"static","type":"text","content":")"}]}},{"concept":{"name":"absolute"},"tags":["layout-dimensions"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Width","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"width"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Height","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"height"}]}}]}},{"concept":{"name":"absolute"},"tags":["layout-dimensions_row"],"type":"layout","projection":{"type":"flex","orientation":"row","justifyContent":"start","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Width","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"width"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Height","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"height"}]}}]}},{"concept":{"name":"absolute-default"},"tags":["layout-dimensions"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Width","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"width"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Height","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"height"}]}}]}},{"concept":{"name":"anchor-arrow"},"tags":["choice-selection__default","default"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"center","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"OffSet","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"offSet","tag":"horizontal-coordinates"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 20 20\\" width=\\"15\\" height=\\"15\\"><circle stroke=\\"#1f75fe\\" stroke-width=\\"1\\" cx=\\"7.5\\" cy=\\"12.5\\" r=\\"6\\" fill=\\"white\\"></circle><rect stroke=\\"#1f75fe\\" stroke-width=\\"1\\" x=\\"7.5\\" y=\\"2.5\\" width=\\"10\\" height=\\"10\\" fill=\\"white\\"></rect></svg>","action":{"type":"SIDE","target":"layout-background"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}},{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"15\\" height=\\"15\\" viewBox=\\"0 0 20 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}}],"style":{"css":["editor-concept-toolbar"]}}}],"style":{"css":["container-config-header"]}}},{"type":"algorithm","algorithm":{"type":"decoration","dimensions":{"width":400,"height":50},"background":false,"style":"overflow:visible;","content":[{"dimension":{"type":"pure"},"coordinates":{"x":0,"y":0},"render":{"type":"simulation","simulation":{"type":"anchor"}}},{"dimension":{"type":"pure"},"coordinates":{"x":20,"y":20},"render":{"kind":"static","type":"svg","content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"10\\" height=\\"10\\" viewBox=\\"0 0 20 20\\"><line stroke=\\"black\\" stroke-width=\\"3\\" x1=\\"0\\" x2=\\"20\\" y1=\\"0\\" y2=\\"20\\"></line><line  stroke=\\"black\\" stroke-width=\\"3\\" x1=\\"0\\" x2=\\"20\\" y1=\\"20\\" y2=\\"0\\"></line></svg>"}},{"dimension":{"type":"pure"},"coordinates":{"x":300,"y":20},"render":{"kind":"static","type":"svg","content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"10\\" height=\\"10\\" viewBox=\\"0 0 20 20\\"><circle r=\\"10\\" cx=\\"10\\" cy=\\"10\\" fill=\\"red\\"></circle></svg>"}},{"dimension":{"type":"pure"},"coordinates":{"x":302,"y":5},"render":{"type":"attribute","name":"aiming","tag":"arrow-aim"}}]}}]}},{"concept":{"name":"anchor-arrow"},"tags":["layout-background"],"type":"layout","projection":{"type":"flex","disposition":[{"type":"attribute","name":"arrow-style","tag":"arrow-s"}]}},{"concept":{"name":"anchor-arrow"},"tags":["layout-setting"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"decorator","placeholder":{"content":{"kind":"static","type":"text","content":"Add Decorator","help":"Specify customed coordinates","style":{"css":["field-config-option","font-ui"],"ref":["box-top"]}}},"tag":"arrow-decorator"},{"type":"layout","layout":{"type":"flex","orientation":"column","alignItems":"center","disposition":[{"kind":"static","type":"text","content":"Self Reference","style":{"css":["title","mp-style__title"]}},{"type":"attribute","name":"self","tag":"simulation"}]}},{"type":"attribute","name":"self","tag":"action"},{"type":"attribute","name":"self","tag":"element-set"}]}},{"concept":{"name":"set"},"tags":["simulation"],"type":"simulation","content":{"type":"set"}},{"concept":{"name":"force-arrow"},"tags":["choice-selection__default","default"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"center","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 20 20\\" width=\\"15\\" height=\\"15\\"><circle stroke=\\"#1f75fe\\" stroke-width=\\"1\\" cx=\\"7.5\\" cy=\\"12.5\\" r=\\"6\\" fill=\\"white\\"></circle><rect stroke=\\"#1f75fe\\" stroke-width=\\"1\\" x=\\"7.5\\" y=\\"2.5\\" width=\\"10\\" height=\\"10\\" fill=\\"white\\"></rect></svg>","action":{"type":"SIDE","target":"layout-background"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}},{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"15\\" height=\\"15\\" viewBox=\\"0 0 20 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}}],"style":{"css":["editor-concept-toolbar"]}}}],"style":{"css":["container-config-header"]}}},{"type":"algorithm","algorithm":{"type":"decoration","dimensions":{"width":400,"height":50},"background":false,"style":"overflow:visible;","content":[{"dimension":{"type":"pure"},"coordinates":{"x":25,"y":25},"render":{"type":"attribute","name":"from","tag":"arrow-from"}},{"dimension":{"type":"pure"},"coordinates":{"x":375,"y":25},"render":{"type":"attribute","name":"to","tag":"arrow-to"}},{"dimension":{"type":"pure"},"coordinates":{"x":100,"y":0},"render":{"type":"attribute","name":"arrow-style","tag":"simulation"}}]}}]}},{"concept":{"name":"force-arrow"},"tags":["layout-setting"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"decorator","placeholder":{"content":{"kind":"static","type":"text","content":"Add Decorator","help":"Specify customed coordinates","style":{"css":["field-config-option","font-ui"],"ref":["box-top"]}}},"tag":"arrow-decorator"}]}},{"concept":{"name":"force-arrow"},"tags":["layout-background"],"type":"layout","projection":{"type":"flex","disposition":[{"type":"attribute","name":"arrow-style","tag":"arrow-s"}]}},{"concept":{"name":"arrow-style"},"tags":["simulation"],"type":"simulation","content":{"type":"arrow","wider":false}},{"concept":{"name":"arrow-style"},"tags":["simulation-wider"],"type":"simulation","content":{"type":"arrow","wider":true}},{"concept":{"name":"arrow-style"},"tags":["arrow-s"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Arrow-style","style":{"css":["title","mp-style__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"stroke","tag":"color-simple"}]}},{"type":"attribute","name":"linecap","tag":"label-string"},{"type":"attribute","name":"dasharray","tag":"label-string"},{"type":"attribute","name":"width","tag":"textual--labelled"},{"type":"layout","layout":{"type":"flex","justifyContent":"center","disposition":[{"kind":"static","type":"text","content":"Marker-start","style":{"css":["title","mp-style__title"]}}]}},{"type":"attribute","name":"start","placeholder":{"content":{"kind":"static","type":"text","content":"Add Marker","help":"Specify customed coordinates","style":{"css":["field-config-option","font-ui"],"ref":["box-top"]}}},"tag":"marker"},{"type":"layout","layout":{"type":"flex","justifyContent":"center","disposition":[{"kind":"static","type":"text","content":"Marker-end","style":{"css":["title","mp-style__title"]}}]}},{"type":"attribute","name":"end","placeholder":{"content":{"kind":"static","type":"text","content":"Add Marker","help":"Specify customed coordinates","style":{"css":["field-config-option","font-ui"],"ref":["box-top"]}}},"tag":"marker"}],"style":{"css":["mp-style"]}}},{"concept":{"name":"markerArrow"},"tags":["simulation-start"],"type":"simulation","content":{"type":"marker","start":true}},{"concept":{"name":"markerArrow"},"tags":["simulation-end"],"type":"simulation","content":{"type":"marker","start":false}},{"concept":{"name":"markerArrow"},"type":"layout","tags":["marker"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","justifyContent":"start","disposition":[{"kind":"static","content":"ViewBox","type":"text","style":{"css":["title","mp-style__title"]}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","justifyContent":"space-between","wrappable":false,"disposition":[{"type":"attribute","name":"minX","tag":"textual--labelled"},{"type":"attribute","name":"minY","tag":"textual--labelled"},{"type":"attribute","name":"width","tag":"textual--labelled"},{"type":"attribute","name":"height","tag":"textual--labelled"}]}},{"type":"layout","layout":{"type":"flex","justifyContent":"center","disposition":[{"kind":"static","content":"Definition","type":"text","style":{"css":["title","mp-style__title"]}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","wrappable":false,"justifyContent":"space-between","disposition":[{"type":"attribute","name":"refX","tag":"textual--labelled"},{"type":"attribute","name":"refY","tag":"textual--labelled"},{"type":"attribute","name":"markerWidth","tag":"textual--labelled"},{"type":"attribute","name":"markerHeight","tag":"textual--labelled"}]}},{"type":"attribute","name":"id","tag":"label-string"},{"type":"attribute","name":"d","tag":"label-string"}]}},{"concept":{"name":"projection-dynamic"},"type":"layout","tags":["arrow-decorator"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"attribute","tag":"label-string"},{"type":"attribute","name":"tag","tag":"label-string"}]}},{"concept":{"name":"string"},"tags":["arrow-from"],"type":"field","content":{"type":"svg","placeholder":"From","readonly":false,"style":{"anchor":"middle","baseline":"middle","font":"Segoe UI","size":10,"weight":500,"fill":"black"}}},{"concept":{"name":"string"},"tags":["arrow-to"],"type":"field","content":{"type":"svg","placeholder":"To","readonly":false,"style":{"anchor":"end","baseline":"middle","font":"Segoe UI","size":10,"weight":500,"fill":"black"}}},{"concept":{"name":"string"},"tags":["arrow-aim"],"type":"field","content":{"type":"svg","placeholder":"Target","readonly":false,"style":{"anchor":"middle","baseline":"end","font":"Segoe UI","size":10,"weight":500,"fill":"black"}}},{"concept":{"name":"decoration-layout"},"tags":["choice-selection__default"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"template","name":"mp-button4","param":[{"name":"type","value":"projection-dynamic"},{"name":"name","value":"Proj"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-button"},{"name":"name","value":"Button"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svgText-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-static"},{"name":"name","value":"Image"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"alt-view"},{"name":"name","value":"Alt"}]},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 20 20\\" width=\\"15\\" height=\\"15\\"><circle stroke=\\"#1f75fe\\" stroke-width=\\"1\\" cx=\\"7.5\\" cy=\\"12.5\\" r=\\"6\\" fill=\\"white\\"></circle><rect stroke=\\"#1f75fe\\" stroke-width=\\"1\\" x=\\"7.5\\" y=\\"2.5\\" width=\\"10\\" height=\\"10\\" fill=\\"white\\"></rect></svg>","action":{"type":"SIDE","target":"layout-background"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}},{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"15\\" height=\\"15\\" viewBox=\\"0 0 20 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}}],"style":{"css":["editor-concept-toolbar"]}}}],"style":{"css":["container-config-header"]}}},{"type":"attribute","name":"content","tag":"element-set","style":{"css":["container-config-content"]}}]}},{"concept":{"name":"decoration-layout"},"tags":["choice-selection__set"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-button"},{"name":"name","value":"Button"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svgText-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-static"},{"name":"name","value":"Image"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"alt-view"},{"name":"name","value":"Alt"}]},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 20 20\\" width=\\"15\\" height=\\"15\\"><circle stroke=\\"#1f75fe\\" stroke-width=\\"1\\" cx=\\"7.5\\" cy=\\"12.5\\" r=\\"6\\" fill=\\"white\\"></circle><rect stroke=\\"#1f75fe\\" stroke-width=\\"1\\" x=\\"7.5\\" y=\\"2.5\\" width=\\"10\\" height=\\"10\\" fill=\\"white\\"></rect></svg>","action":{"type":"SIDE","target":"layout-background"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}},{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"15\\" height=\\"15\\" viewBox=\\"0 0 20 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}}],"style":{"css":["editor-concept-toolbar"]}}}],"style":{"css":["container-config-header"]}}},{"type":"attribute","name":"content","tag":"element-set","style":{"css":["container-config-content"]}}]}},{"concept":{"name":"decoration-layout"},"tags":["choice-selection__string"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-text"},{"name":"name","value":"TextField"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svgText-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-button"},{"name":"name","value":"Button"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-static"},{"name":"name","value":"Image"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"alt-view"},{"name":"name","value":"Alt"}]},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 20 20\\" width=\\"15\\" height=\\"15\\"><circle stroke=\\"#1f75fe\\" stroke-width=\\"1\\" cx=\\"7.5\\" cy=\\"12.5\\" r=\\"6\\" fill=\\"white\\"></circle><rect stroke=\\"#1f75fe\\" stroke-width=\\"1\\" x=\\"7.5\\" y=\\"2.5\\" width=\\"10\\" height=\\"10\\" fill=\\"white\\"></rect></svg>","action":{"type":"SIDE","target":"layout-background"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}},{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"15\\" height=\\"15\\" viewBox=\\"0 0 20 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}}],"style":{"css":["editor-concept-toolbar"]}}}],"style":{"css":["container-config-header"]}}},{"type":"attribute","name":"content","tag":"element-set","style":{"css":["container-config-content"]}}]}},{"concept":{"name":"decoration-layout"},"tags":["choice-selection__reference"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-placeholder"},{"name":"name","value":"PlaceholderField"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-choice"},{"name":"name","value":"ChoiceField"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-switch"},{"name":"name","value":"SwitchField"}]},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 20 20\\" width=\\"15\\" height=\\"15\\"><circle stroke=\\"#1f75fe\\" stroke-width=\\"1\\" cx=\\"7.5\\" cy=\\"12.5\\" r=\\"6\\" fill=\\"white\\"></circle><rect stroke=\\"#1f75fe\\" stroke-width=\\"1\\" x=\\"7.5\\" y=\\"2.5\\" width=\\"10\\" height=\\"10\\" fill=\\"white\\"></rect></svg>","action":{"type":"SIDE","target":"layout-background"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}},{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"15\\" height=\\"15\\" viewBox=\\"0 0 20 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}}],"style":{"css":["editor-concept-toolbar"]}}}],"style":{"css":["container-config-header"]}}},{"type":"attribute","name":"content","tag":"element-set","style":{"css":["container-config-content"]}}]}},{"concept":{"name":"decoration-layout"},"tags":["choice-selection__boolean"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-switch"},{"name":"name","value":"SwitchField"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svgText-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-button"},{"name":"name","value":"Button"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"svg-static"},{"name":"name","value":"Image"}]},{"type":"template","name":"mp-button4","param":[{"name":"type","value":"alt-view"},{"name":"name","value":"Alt"}]},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 20 20\\" width=\\"15\\" height=\\"15\\"><circle stroke=\\"#1f75fe\\" stroke-width=\\"1\\" cx=\\"7.5\\" cy=\\"12.5\\" r=\\"6\\" fill=\\"white\\"></circle><rect stroke=\\"#1f75fe\\" stroke-width=\\"1\\" x=\\"7.5\\" y=\\"2.5\\" width=\\"10\\" height=\\"10\\" fill=\\"white\\"></rect></svg>","action":{"type":"SIDE","target":"layout-background"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}},{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"15\\" height=\\"15\\" viewBox=\\"0 0 20 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}}],"style":{"css":["editor-concept-toolbar"]}}}],"style":{"css":["container-config-header"]}}},{"type":"attribute","name":"content","tag":"element-set","style":{"css":["container-config-content"]}}]}},{"concept":{"name":"graphical-component"},"tags":["list-item"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"render","tag":"component"}]}},{"concept":{"name":"coordinates"},"tags":["component-dimensions"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"center","justifyContent":"center","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"x","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"x"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"y","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"y"}]}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Anchor","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"anchor","tag":"anchor-label"}]}}]}},{"concept":{"name":"dimensions"},"tags":["component-dimensions"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Dimensions","style":{"css":["title"]}},{"type":"container","content":[{"kind":"static","type":"text","content":"Type","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"field","field":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["select-choice__list-option"]}},"style":{"css":["select-choice__list"]}},"placeholder":"Select a layout","expanded":false,"input":false,"style":{"css":["select-choice"]}}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["mp-fieldwrap","mp-fieldwrap--layout"]}},{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection"}]}},{"concept":{"name":"dimensions"},"tags":["component-dimensions_wl"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"container","content":[{"kind":"static","type":"text","content":"Type","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"field","field":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["select-choice__list-option"]}},"style":{"css":["select-choice__list"]}},"placeholder":"Select a layout","expanded":false,"input":false,"style":{"css":["select-choice"]}}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["mp-fieldwrap","mp-fieldwrap--layout"]}},{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection"}]}},{"concept":{"name":"absolute"},"tags":["choice"],"type":"layout","projection":{"type":"wrap","disposition":[{"kind":"static","type":"text","content":"Absolute"}]}},{"concept":{"name":"absolute"},"tags":["choice"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Absolute"}]}},{"concept":{"name":"set"},"tags":["new-component"],"type":"field","content":{"type":"list","list":false,"action":{"add":{"content":[{"type":"static","static":{"type":"text","content":"+","focusable":false}}],"help":"Add an element","style":{"css":["list-action__btn-add"]}}},"style":{"css":["list-action"]}}},{"concept":{"name":"decoration-layout"},"tags":["layout-background","create"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--create"},{"type":"layout","layout":{"type":"flex","orientation":"column","alignItems":"center","disposition":[{"type":"attribute","name":"shape","tag":"shape"}]}},{"type":"attribute","name":"shape","tag":"interact"}]}},{"concept":{"name":"decoration-layout"},"tags":["layout-background","import"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--import"},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Background","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"background","tag":"fixed"}]}},{"type":"attribute","name":"background","tag":"simulation-content"}]}},{"concept":{"name":"string"},"tags":["simulation-content"],"type":"simulation","content":{"type":"content"}},{"concept":{"name":"force-layout"},"tags":["choice-selection__set"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"rtag","tag":"label-string"},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Tag","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"tag","tag":"text-string","options":{"placeholder":"g-tag"},"style":{"css":["mp-tag"]}}]}},{"type":"attribute","name":"force","tag":"interact"}]}},{"type":"attribute","name":"force","tag":"simulation"}]}},{"concept":{"name":"force"},"tags":["interact"],"type":"layout","projection":{"type":"flex","orientation":"row","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Intensity","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"intensity"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"linkVal","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"linkVal"}]}}]}},{"concept":{"name":"force"},"tags":["simulation"],"type":"simulation","content":{"type":"force"}},{"concept":{"name":"force-layout"},"tags":["choice-selection"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Settings","style":{"css":["title","mp-header__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Intensity","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"intensity"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"L-Distance","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"linkDistance"}]}}]}},{"type":"attribute","name":"dimension","tag":"force-dim"}]}},{"kind":"static","type":"text","content":"Nodes","style":{"css":["title","mp-header__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Item","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"item","tag":"tag-reference"}]}}]}},{"concept":{"name":"multi-arrow"},"tags":["choice-selection__set"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"meet","tag":"label-string"},{"kind":"static","type":"text","content":"Offset","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"offSet","tag":"horizontal-coordinates"}]}},{"type":"simulation","simulation":{"type":"multi"}}]}},{"concept":{"name":"sub-path"},"type":"simulation","tags":["simulation"],"content":{"type":"sub-path"}},{"concept":{"name":"pattern-layout"},"tags":["choice-selection__set"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"rtag","tag":"label-string"},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Tag","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"item","tag":"text-string","options":{"placeholder":"g-tag"},"style":{"css":["mp-tag"]}}]}},{"type":"attribute","name":"pattern","tag":"interact"}]}},{"type":"layout","layout":{"type":"flex","justifyContent":"center","disposition":[{"type":"attribute","name":"pattern","tag":"simulation"}]}}]}},{"concept":{"name":"anchors"},"tags":["simulation"],"type":"simulation","content":{"type":"pattern"}},{"concept":{"name":"anchors"},"tags":["interact"],"type":"layout","projection":{"type":"flex","orientation":"row","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"First","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"first","tag":"anchor-coord"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Next","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"next","tag":"anchor-coord"}]}}]}},{"concept":{"name":"svgText-static"},"tags":["layout-background"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","tag":"draw"},{"type":"attribute","name":"style","tag":"textual"}]}},{"concept":{"name":"projection-dynamic"},"tags":["layout-setting"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Coordinates","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"coordinates","tag":"layout-coordinates"},{"kind":"static","type":"text","content":"Dimension","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"dimension","tag":"layout-dimensions"}]}},{"concept":{"name":"svg-static"},"tags":["layout-setting"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Coordinates","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"coordinates","tag":"layout-coordinates"},{"kind":"static","type":"text","content":"Dimension","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"dimension","tag":"layout-dimensions"}]}},{"concept":{"name":"alt-view"},"tags":["layout-setting"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Coordinates","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"coordinates","tag":"layout-coordinates"},{"kind":"static","type":"text","content":"Dimension","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"dimension","tag":"layout-dimensions"}]}},{"concept":{"name":"svg-text"},"tags":["layout-setting"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Coordinates","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"coordinates","tag":"layout-coordinates"},{"kind":"static","type":"text","content":"Dimension","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"dimension","tag":"layout-dimensions"}]}},{"concept":{"name":"svg-text"},"tags":["layout-setting_unit"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Coordinates","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"coordinates","tag":"layout-coordinates"}]}},{"concept":{"name":"svgText-static"},"tags":["layout-setting"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Coordinates","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"coordinates","tag":"layout-coordinates"},{"kind":"static","type":"text","content":"Dimension","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"dimension","tag":"layout-dimensions"}]}},{"concept":{"name":"svg-button"},"tags":["layout-setting"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Coordinates","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"coordinates","tag":"layout-coordinates"},{"kind":"static","type":"text","content":"Dimension","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"dimension","tag":"layout-dimensions"}]}},{"concept":{"name":"projection-dynamic"},"tags":["choice-selection","config"],"type":"container","container":{"content":[{"type":"template","name":"tpl-element-header_graph","param":[{"name":"type","value":"Prj"}]},{"type":"attribute","name":"src","tag":"text-string","options":{"placeholder":"attribute"}},{"type":"attribute","name":"tag","tag":"text-string","options":{"placeholder":"g-tag"},"style":{"css":["mp-tag"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["dynamic-config","dynamic-config--attribute"]}}},{"concept":{"name":"svg-button"},"type":"layout","tags":["layout-background","create"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--create"},{"type":"layout","layout":{"type":"flex","orientation":"column","alignItems":"center","disposition":[{"type":"attribute","name":"shape","tag":"shape"}]}},{"type":"attribute","name":"shape","tag":"interact"}]}},{"concept":{"name":"svg-button"},"type":"layout","tags":["layout-background","import"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--import"},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Background","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"content","tag":"fixed"}]}},{"type":"attribute","name":"content","tag":"simulation-content"}]}},{"concept":{"name":"svgText-static"},"type":"container","tags":["choice-selection","config"],"container":{"content":[{"type":"template","name":"tpl-element-header_graphd","param":[{"name":"type","value":"Txt"}]},{"type":"attribute","name":"content","tag":"text-string","options":{"resizable":true,"placeholder":"Content..."},"style":{"css":["text-static"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config","static-config--text"]}}},{"concept":{"name":"svg-text"},"type":"container","tags":["choice-selection","config"],"container":{"content":[{"type":"template","name":"tpl-element-header_graphd","param":[{"name":"type","value":"TxF"}]},{"type":"attribute","name":"placeholder","tag":"text-string","options":{"resizable":true,"placeholder":"Placeholder..."},"style":{"css":["text-static"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config","static-config--text"]}}},{"concept":{"name":"svg-text"},"type":"container","tags":["choice-selection__string","config"],"container":{"content":[{"type":"attribute","name":"placeholder","tag":"text-string","options":{"resizable":true,"placeholder":"Placeholder..."},"style":{"css":["text-static"]}},{"kind":"static","type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 20 20\\" width=\\"15\\" height=\\"15\\"><circle stroke=\\"#1f75fe\\" stroke-width=\\"1\\" cx=\\"7.5\\" cy=\\"12.5\\" r=\\"6\\" fill=\\"white\\"></circle><rect stroke=\\"#1f75fe\\" stroke-width=\\"1\\" x=\\"7.5\\" y=\\"2.5\\" width=\\"10\\" height=\\"10\\" fill=\\"white\\"></rect></svg>","action":{"type":"SIDE","target":"layout-background"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}},{"kind":"static","type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"15\\" height=\\"15\\" viewBox=\\"0 0 20 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting_unit"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config","static-config--text"]}}},{"concept":{"name":"svg-static"},"type":"layout","tags":["layout-background"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","alignItems":"center","disposition":[{"type":"attribute","name":"shape","tag":"shape"}]}},{"type":"attribute","name":"shape","tag":"interact"}]}},{"concept":{"name":"svg-static"},"type":"container","tags":["choice-selection","config"],"container":{"content":[{"type":"template","name":"tpl-element-header_graphd","param":[{"name":"type","value":"Img"}]},{"type":"attribute","name":"content","tag":"text-string","options":{"resizable":true,"placeholder":"Content..."},"style":{"css":["text-static"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config","static-config--text"]}}},{"concept":{"name":"svg-switch"},"type":"container","tags":["choice-selection","config"],"container":{"content":[{"type":"template","name":"tpl-element-header_graph","param":[{"name":"type","value":"Sw"}]}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config","static-config--text"]}}},{"concept":{"name":"svg-switch"},"tags":["layout-setting"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Coordinates","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"coordinates","tag":"layout-coordinates"},{"kind":"static","type":"text","content":"Dimension","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"dimension","tag":"layout-dimensions"},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Order","style":{"css":["mp-style__title","title"]}},{"type":"attribute","name":"order","tag":"action"}]}},{"type":"attribute","name":"order","tag":"element-set"}]}},{"concept":{"name":"svg-static"},"type":"layout","tags":["layout-background"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","alignItems":"center","disposition":[{"type":"attribute","name":"shape","tag":"shape"}]}},{"type":"attribute","name":"shape","tag":"interact"}]}},{"concept":{"name":"alt-view"},"type":"layout","tags":["layout-background"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","alignItems":"center","disposition":[{"type":"attribute","name":"shape","tag":"shape"}]}},{"type":"attribute","name":"shape","tag":"interact"}]}},{"concept":{"name":"alt-view"},"type":"container","tags":["choice-selection","config"],"container":{"content":[{"type":"template","name":"tpl-element-header_graphd","param":[{"name":"type","value":"Alt"}]},{"type":"attribute","name":"content","tag":"text-string","options":{"resizable":true,"placeholder":"Content..."},"style":{"css":["text-static"]}},{"type":"attribute","name":"tag","tag":"text-string","options":{"placeholder":"tag"},"style":{"css":["mp-tag"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config","static-config--text"]}}},{"concept":{"name":"svg-placeholder"},"type":"container","tags":["choice-selection","config"],"container":{"content":[{"type":"template","name":"tpl-element-header_graph","param":[{"name":"type","value":"Plc"}]},{"type":"attribute","name":"tag","tag":"text-string","options":{"resizable":true,"placeholder":"Item..."},"style":{"css":["text-static"]}},{"type":"attribute","name":"tag","tag":"text-string","options":{"placeholder":"tag"},"style":{"css":["mp-tag"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config","static-config--text"]}}},{"concept":{"name":"svg-button"},"type":"container","tags":["choice-selection","config"],"container":{"content":[{"type":"template","name":"tpl-element-header_graphd","param":[{"name":"type","value":"Btn"}]},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Action","style":{"css":["label"]}},{"type":"attribute","name":"action","tag":"choice"}]}},{"type":"attribute","name":"action","tag":"choice-selection"}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config","static-config--text"]}}},{"concept":{"name":"button-action"},"tags":["choice"],"type":"field","content":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["select-choice__list-option"]}},"style":{"css":["select-choice__list"]}},"placeholder":"Select an action","expanded":false,"input":false,"style":{"css":["select-choice"]}}},{"concept":{"name":"button-action"},"type":"layout","tags":["choice-selection"],"projection":{"type":"wrap","disposition":[{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection"}]}},{"concept":{"name":"add-action"},"tags":["choice"],"type":"layout","projection":{"type":"wrap","disposition":[{"kind":"static","type":"text","content":"Add"}]}},{"concept":{"name":"add-action"},"tags":["choice-selection"],"type":"layout","projection":{"type":"wrap","disposition":[]}},{"concept":{"name":"tree-action"},"tags":["choice"],"type":"layout","projection":{"type":"wrap","disposition":[{"kind":"static","type":"text","content":"Tree-add"}]}},{"concept":{"name":"tree-action"},"tags":["choice-selection"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"treeId","tag":"text-string","options":{"placeholder":"treeId"},"style":{"css":["mp-tag"]}},{"type":"attribute","name":"item","tag":"text-string","options":{"placeholder":"tag"},"style":{"css":["mp-tag"]}}]}},{"concept":{"name":"side-action"},"tags":["choice"],"type":"layout","projection":{"type":"wrap","disposition":[{"kind":"static","type":"text","content":"Open-side"}]}},{"concept":{"name":"side-action"},"tags":["choice-selection"],"type":"layout","projection":{"type":"wrap","disposition":[{"type":"attribute","name":"tag","tag":"text-string","options":{"placeholder":"treeId"},"style":{"css":["mp-tag"]}}]}},{"concept":{"name":"svg-button"},"type":"layout","tags":["layout-background"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","alignItems":"center","disposition":[{"type":"attribute","name":"shape","tag":"shape"}]}},{"type":"attribute","name":"shape","tag":"interact"}]}},{"concept":{"name":"svg-text"},"tags":["layout-background"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","tag":"draw"},{"type":"attribute","name":"style","tag":"textual"}]}},{"concept":{"name":"svg-choice"},"type":"container","tags":["choice-selection","config"],"container":{"content":[{"type":"template","name":"tpl-element-header_graphd","param":[{"name":"type","value":"ChF"}]},{"type":"attribute","name":"tag","tag":"text-string","options":{"placeholder":"tag"},"style":{"css":["mp-tag"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config","static-config--text"]}}},{"concept":{"name":"svg-choice"},"type":"layout","tags":["layout-setting","config"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"dimensions","placeholder":{"content":{"kind":"static","type":"text","content":"Add dimensions","help":"Specify customed coordinates","style":{"css":["field-config-option","font-ui"],"ref":["box-top"]}}},"tag":"layout-dimensions_row"},{"type":"layout","layout":{"type":"flex","justifyContent":"center","disposition":[{"kind":"static","type":"text","content":"Selection","style":{"css":["mp-style__title","title"]}}]}},{"type":"layout","layout":{"type":"flex","justifyContent":"center","disposition":[{"type":"attribute","name":"selection","tag":"simulation"}]}},{"type":"attribute","name":"selection","tag":"interact"}]}},{"concept":{"name":"choice-selection"},"type":"simulation","tags":["simulation"],"projection":{"type":"selection"}},{"concept":{"name":"choice-selection"},"type":"layout","tags":["interact"],"projection":{"type":"flex","orientation":"row","justifyContent":"space-evenly","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"orientation","tag":"label-string"},{"type":"attribute","name":"break","tag":"textual--labelled"},{"type":"attribute","name":"nbItem","tag":"textual--labelled"}]}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"dimensions"}]}}]}},{"concept":{"name":"dimensions"},"tags":["layout-dimensions"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"container","content":[{"kind":"static","type":"text","content":"Type","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"field","field":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["select-choice__list-option"]}},"style":{"css":["select-choice__list"]}},"placeholder":"Select a layout","expanded":false,"input":false,"style":{"css":["select-choice"]}}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["mp-fieldwrap","mp-fieldwrap--layout"]}},{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection"}]}},{"concept":{"name":"dimensions"},"tags":["layout-dimensions_row"],"type":"layout","projection":{"type":"flex","orientation":"row","disposition":[{"type":"container","content":[{"kind":"static","type":"text","content":"Type","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"field","field":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["select-choice__list-option"]}},"style":{"css":["select-choice__list"]}},"placeholder":"Select a layout","expanded":false,"input":false,"style":{"css":["select-choice"]}}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["mp-fieldwrap","mp-fieldwrap--layout"]}},{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection"}]}},{"concept":{"name":"absolute"},"tags":["choice"],"type":"layout","projection":{"type":"wrap","disposition":[{"kind":"static","type":"text","content":"Absolute"}]}},{"concept":{"name":"absolute"},"tags":["choice-selection"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"width","tag":"textual--labelled"},{"type":"attribute","name":"height","tag":"textual--labelled"}]}},{"concept":{"name":"pure"},"tags":["choice"],"type":"layout","projection":{"type":"wrap","disposition":[{"kind":"static","type":"text","content":"Pure"}]}},{"concept":{"name":"pure"},"tags":["choice-selection"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[]}},{"concept":{"name":"fixed"},"tags":["choice"],"type":"layout","projection":{"type":"wrap","disposition":[{"kind":"static","type":"text","content":"Fixed"}]}},{"concept":{"name":"fixed"},"tags":["choice-selection"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"width","tag":"textual--labelled"}]}},{"concept":{"name":"absolute"},"tags":["force-dim"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Width","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"width"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Height","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"height"}]}}]}},{"concept":{"name":"shape"},"tags":["shape"],"type":"shape","content":{"type":"canvas","content":[{"type":"attribute","name":"elements","tag":"g-element"}]}},{"concept":{"name":"set"},"tags":["g-element"],"type":"shape","content":{"type":"group","add":true}},{"concept":{"name":"shape"},"tags":["interact"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","justifyContent":"center","alignItems":"center","disposition":[{"kind":"static","type":"text","content":"Dimensions","style":{"css":["mp-style__title"]}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","justifyContent":"space-evenly","alignItems":"center","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Width","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"width"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Height","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"height"}]}}]}}]}},{"type":"layout","layout":{"type":"flex","orientation":"column","justifyContent":"center","alignItems":"center","disposition":[{"kind":"static","type":"text","content":"ViewBox","style":{"css":["mp-style__title"]}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","justifyContent":"space-evenly","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","alignItems":"center","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Width","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"windowW"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Height","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"windowH"}]}}]}},{"type":"layout","layout":{"type":"flex","orientation":"column","alignItems":"center","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"X","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"minX"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Y","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"minY"}]}}]}}]}},{"type":"attribute","name":"current","tag":"current-interact"}]}},{"concept":{"name":"reference"},"tags":"current-interact","type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"projection","bind":"value","placeholder":false,"tag":"current-selection"}]}},{"concept":{"name":"circle"},"tags":["current-selection"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Current selection","style":{"css":["mp-style__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"center","disposition":[{"kind":"static","type":"svg-button","content":"<svg width =\\"15\\" height=\\"15\\" version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\"><rect width=\\"15\\" height=\\"15\\" rx=\\"2\\" ry=\\"2\\" fill=\\"#fff\\"></rect><polygon points=\\"0.5 6, 10 6, 10 2.5, 14.5 7.5, 10 12.5, 10 9, 0.5 9\\" fill=\\"#87a1ff\\"></polygon></svg>","action":{"type":"EXTRACT"},"help":"Create new projection","dimensions":{"width":20,"height":20}},{"kind":"static","type":"svg-button","content":"<svg width =\\"15\\" height=\\"15\\" version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\"><rect width=\\"15\\" height=\\"15\\" rx=\\"2\\" ry=\\"2\\" fill=\\"red\\"></rect><line x1=\\"3\\" x2=\\"12\\" y1=\\"3\\" y2=\\"12\\" stroke=\\"#edeae1\\" stroke-width=\\"1.5\\"></line><line x1=\\"3\\" x2=\\"12\\" y1=\\"12\\" y2=\\"3\\" stroke=\\"#edeae1\\" stroke-width=\\"1.5\\"></line></svg>","action":{"type":"DELETE"},"help":"Remove shape","dimensions":{"width":20,"height":20}}],"style":{"css":["selected-panel"]}}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"cx","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"cx"},{"kind":"static","type":"text","content":"cy","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"cy"},{"kind":"static","type":"text","content":"Radius","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"r"}]}},{"type":"attribute","name":"style","tag":"circle-style"}]}},{"concept":{"name":"rectangle"},"tags":["current-selection"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Current selection","style":{"css":["mp-style__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"center","disposition":[{"kind":"static","type":"svg-button","content":"<svg width =\\"15\\" height=\\"15\\" version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\"><rect width=\\"15\\" height=\\"15\\" rx=\\"2\\" ry=\\"2\\" fill=\\"#fff\\"></rect><polygon points=\\"0.5 6, 10 6, 10 2.5, 14.5 7.5, 10 12.5, 10 9, 0.5 9\\" fill=\\"#87a1ff\\"></polygon></svg>","action":{"type":"EXTRACT"},"help":"Create new projection","dimensions":{"width":20,"height":20}},{"kind":"static","type":"svg-button","content":"<svg width =\\"15\\" height=\\"15\\" version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\"><rect width=\\"15\\" height=\\"15\\" rx=\\"2\\" ry=\\"2\\" fill=\\"red\\"></rect><line x1=\\"3\\" x2=\\"12\\" y1=\\"3\\" y2=\\"12\\" stroke=\\"#edeae1\\" stroke-width=\\"1.5\\"></line><line x1=\\"3\\" x2=\\"12\\" y1=\\"12\\" y2=\\"3\\" stroke=\\"#edeae1\\" stroke-width=\\"1.5\\"></line></svg>","action":{"type":"DELETE"},"help":"Remove shape","dimensions":{"width":20,"height":20}}],"style":{"css":["selected-panel"]}}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"x","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"x"},{"kind":"static","type":"text","content":"y","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"y"},{"kind":"static","type":"text","content":"Width","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"width"},{"kind":"static","type":"text","content":"Height","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"height"}]}},{"type":"attribute","name":"style","tag":"rect-style"}]}},{"concept":{"name":"path"},"tags":["current-selection"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Current selection","style":{"css":["mp-style__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"center","disposition":[{"kind":"static","type":"svg-button","content":"<svg width =\\"15\\" height=\\"15\\" version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\"><rect width=\\"15\\" height=\\"15\\" rx=\\"2\\" ry=\\"2\\" fill=\\"#fff\\"></rect><polygon points=\\"0.5 6, 10 6, 10 2.5, 14.5 7.5, 10 12.5, 10 9, 0.5 9\\" fill=\\"#87a1ff\\"></polygon></svg>","action":{"type":"EXTRACT"},"help":"Create new projection","dimensions":{"width":20,"height":20}},{"kind":"static","type":"svg-button","content":"<svg width =\\"15\\" height=\\"15\\" version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\"><rect width=\\"15\\" height=\\"15\\" rx=\\"2\\" ry=\\"2\\" fill=\\"red\\"></rect><line x1=\\"3\\" x2=\\"12\\" y1=\\"3\\" y2=\\"12\\" stroke=\\"#edeae1\\" stroke-width=\\"1.5\\"></line><line x1=\\"3\\" x2=\\"12\\" y1=\\"12\\" y2=\\"3\\" stroke=\\"#edeae1\\" stroke-width=\\"1.5\\"></line></svg>","action":{"type":"DELETE"},"help":"Remove shape","dimensions":{"width":20,"height":20}}],"style":{"css":["selected-panel"]}}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"d","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"d","tag":"fixed"}]}},{"type":"attribute","name":"style","tag":"path-style"}]}},{"concept":{"name":"polygon"},"tags":["current-selection"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Current selection","style":{"css":["mp-style__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"center","disposition":[{"kind":"static","type":"svg-button","content":"<svg width =\\"15\\" height=\\"15\\" version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\"><rect width=\\"15\\" height=\\"15\\" rx=\\"2\\" ry=\\"2\\" fill=\\"#fff\\"></rect><polygon points=\\"0.5 6, 10 6, 10 2.5, 14.5 7.5, 10 12.5, 10 9, 0.5 9\\" fill=\\"#87a1ff\\"></polygon></svg>","action":{"type":"EXTRACT"},"help":"Create new projection","dimensions":{"width":20,"height":20}},{"kind":"static","type":"svg-button","content":"<svg width =\\"15\\" height=\\"15\\" version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\"><rect width=\\"15\\" height=\\"15\\" rx=\\"2\\" ry=\\"2\\" fill=\\"red\\"></rect><line x1=\\"3\\" x2=\\"12\\" y1=\\"3\\" y2=\\"12\\" stroke=\\"#edeae1\\" stroke-width=\\"1.5\\"></line><line x1=\\"3\\" x2=\\"12\\" y1=\\"12\\" y2=\\"3\\" stroke=\\"#edeae1\\" stroke-width=\\"1.5\\"></line></svg>","action":{"type":"DELETE"},"help":"Remove shape","dimensions":{"width":20,"height":20}}],"style":{"css":["selected-panel"]}}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Points","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"points","tag":"fixed"}]}},{"type":"attribute","name":"style","tag":"polygon-style"}]}},{"concept":{"name":"shape-style"},"tags":["path-style"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Style","style":{"css":["mp-style__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Fill","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"fill","tag":"fixed"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"stroke","tag":"fixed"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke-width","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"s-width"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke-dasharray","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"s-dash","tag":"fixed"}]}}]}},{"concept":{"name":"shape-style"},"tags":["polygon-style"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Style","style":{"css":["mp-style__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Fill","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"fill","tag":"fixed"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"stroke","tag":"fixed"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke-width","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"s-width"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke-dasharray","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"s-dash","tag":"fixed"}]}}]}},{"concept":{"name":"shape-style"},"tags":["circle-style"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Style","style":{"css":["mp-style__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Fill","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"fill","tag":"fixed"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"stroke","tag":"fixed"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke-width","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"s-width"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke-dasharray","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"s-dash","tag":"fixed"}]}}]}},{"concept":{"name":"shape-style"},"tags":["rect-style"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"kind":"static","type":"text","content":"Style","style":{"css":["mp-style__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Fill","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"fill","tag":"fixed"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"stroke","tag":"fixed"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke-width","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"s-width"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Stroke-dasharray","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"s-dash","tag":"fixed"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"rx","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"rx"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"ry","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"ry"}]}}]}},{"concept":{"name":"shape-element"},"tags":["list-item"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"field","field":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["select-choice__list-option"]}},"style":{"css":["select-choice__list"]}},"expanded":false,"input":false,"style":{"css":["select-choice"]}}},{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection"}]}},{"concept":{"name":"shape-element"},"tags":["shape"],"type":"field","content":{"type":"svg-choice","dimensions":false,"selection":{"item":{"dimension":{"width":40,"height":40},"tag":"choice-shape"},"breakPoint":2,"direction":"horizontal","close":true}}},{"concept":{"name":"circle"},"tags":["choice-shape"],"type":"algorithm","content":{"type":"decoration","content":[],"background":"<svg version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"40\\" height=\\"40\\"><circle cx=\\"20\\" cy=\\"20\\" r=\\"15\\" fill=\\"black\\"></circle><text x=\\"20\\" y=\\"20\\" text-anchor=\\"middle\\" font-family=\\"Segoe UI\\" font-size=\\"8\\" style=\\"dominant-baseline:middle\\" fill=\\"white\\">Circle</text></svg>"}},{"concept":{"name":"polygon"},"tags":["choice-shape"],"type":"algorithm","content":{"type":"decoration","content":[],"background":"<svg version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"40\\" height=\\"40\\"><polygon points=\\"12.5, 2.5 27.5, 2.5 37.5, 12.5 37.5, 27.5 27.5, 37.5 12.5, 37.5 2.5, 27.5 2.5, 12.5\\" fill=\\"black\\"></polygon><text x=\\"20\\" y=\\"20\\" text-anchor=\\"middle\\" font-size=\\"9\\" font-family=\\"Segoe UI\\" fill=\\"white\\" style=\\"dominant-baseline:middle\\">Polygon</text></svg>"}},{"concept":{"name":"polygon"},"tags":["shape"],"type":"shape","content":{"type":"polygon"}},{"concept":{"name":"ellipse"},"tags":["choice-shape"],"type":"algorithm","content":{"type":"decoration","content":[],"background":"<svg version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"40\\" height=\\"40\\"><ellipse cx=\\"20\\" cy=\\"20\\" rx=\\"19.5\\" ry=\\"15\\" fill=\\"black\\"></ellipse><text x=\\"20\\" y=\\"20\\" text-anchor=\\"middle\\" font-size=\\"9\\" font-family=\\"Segoe UI\\" fill=\\"white\\" style=\\"dominant-baseline:middle\\">Ellipse</text></svg>"}},{"concept":{"name":"ellipse"},"tags":["choice"],"type":"layout","projection":{"type":"wrap","disposition":[{"kind":"static","type":"text","content":"Ellipse"}]}},{"concept":{"name":"ellipse"},"tags":["shape"],"type":"shape","content":{"type":"ellipse"}},{"concept":{"name":"ellipse"},"tags":["current-selection"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Current selection","style":{"css":["mp-style__title"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"center","disposition":[{"kind":"static","type":"svg-button","content":"<svg width =\\"15\\" height=\\"15\\" version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\"><rect width=\\"15\\" height=\\"15\\" rx=\\"2\\" ry=\\"2\\" fill=\\"#fff\\"></rect><polygon points=\\"0.5 6, 10 6, 10 2.5, 14.5 7.5, 10 12.5, 10 9, 0.5 9\\" fill=\\"#87a1ff\\"></polygon></svg>","action":{"type":"EXTRACT"},"help":"Create new projection","dimensions":{"width":20,"height":20}},{"kind":"static","type":"svg-button","content":"<svg width =\\"15\\" height=\\"15\\" version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\"><rect width=\\"15\\" height=\\"15\\" rx=\\"2\\" ry=\\"2\\" fill=\\"red\\"></rect><line x1=\\"3\\" x2=\\"12\\" y1=\\"3\\" y2=\\"12\\" stroke=\\"#edeae1\\" stroke-width=\\"1.5\\"></line><line x1=\\"3\\" x2=\\"12\\" y1=\\"12\\" y2=\\"3\\" stroke=\\"#edeae1\\" stroke-width=\\"1.5\\"></line></svg>","action":{"type":"DELETE"},"help":"Remove shape","dimensions":{"width":20,"height":20}}],"style":{"css":["selected-panel"]}}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"cx","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"cx"},{"kind":"static","type":"text","content":"cy","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"cy"},{"kind":"static","type":"text","content":"rx","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"rx"},{"kind":"static","type":"text","content":"ry","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"ry"}]}},{"type":"attribute","name":"style","tag":"circle-style"}]}},{"concept":{"name":"ellipse"},"tags":["choice-selection"],"type":"layout","projection":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"cx","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"cx"},{"kind":"static","type":"text","content":"cy","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"cy"},{"kind":"static","type":"text","content":"rx","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"rx"},{"kind":"static","type":"text","content":"ry","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"ry"},{"kind":"static","type":"text","content":"fill","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"fill","tag":"fixed"}]}},{"concept":{"name":"circle"},"tags":["shape"],"type":"shape","content":{"type":"circle"}},{"concept":{"name":"circle"},"tags":["choice-selection"],"type":"layout","projection":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"cx","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"cx"},{"kind":"static","type":"text","content":"cy","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"cy"},{"kind":"static","type":"text","content":"r","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"r"},{"kind":"static","type":"text","content":"fill","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"fill","tag":"fixed"}]}},{"concept":{"name":"text"},"tags":["choice-shape"],"type":"algorithm","content":{"type":"decoration","content":[],"background":"<svg version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"40\\" height=\\"40\\"><text x=\\"20\\" y=\\"20\\" text-anchor=\\"middle\\" font-size=\\"9\\" font-family=\\"Segoe UI\\" fill=\\"black\\" style=\\"dominant-baseline:middle\\">Text</text></svg>"}},{"concept":{"name":"text"},"tags":["shape"],"type":"shape","content":{"type":"text"}},{"concept":{"name":"path"},"tags":["choice-shape"],"type":"algorithm","content":{"type":"decoration","content":[],"background":"<svg version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"40\\" height=\\"40\\"><path d=\\"M2.5 20 C 2.5 20, 11.25 -5, 20 20 C 20 20, 31.25 40, 37.5 20\\" fill=\\"white\\" stroke=\\"grey\\"></path><text x=\\"20\\" y=\\"20\\" text-anchor=\\"middle\\" font-size=\\"9\\" font-family=\\"Segoe UI\\" font-weight=\\"500\\" fill=\\"black\\" style=\\"dominant-baseline:middle\\">Path</text></svg>"}},{"concept":{"name":"path"},"tags":["shape"],"type":"shape","content":{"type":"path"}},{"concept":{"name":"rectangle"},"tags":["choice-shape"],"type":"algorithm","content":{"type":"decoration","content":[],"background":"<svg version=\\"1.0\\" xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"40\\" height=\\"40\\"><rect x=\\"2.5\\" y=\\"7.5\\" width=\\"35\\" height=\\"25\\" fill=\\"black\\"></rect><text x=\\"20\\" y=\\"20\\" text-anchor=\\"middle\\" font-size=\\"8\\" font-family=\\"Segoe UI\\" fill=\\"white\\" style=\\"dominant-baseline:middle\\">Rectangle</text></svg>"}},{"concept":{"name":"rectangle"},"tags":["choice"],"type":"layout","projection":{"type":"wrap","disposition":[{"kind":"static","type":"text","content":"Rectangle"}]}},{"concept":{"name":"rectangle"},"tags":["shape"],"type":"shape","content":{"type":"rectangle"}},{"concept":{"name":"rectangle"},"tags":["choice-selection"],"type":"layout","projection":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"x","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"x"},{"kind":"static","type":"text","content":"y","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"y"},{"kind":"static","type":"text","content":"width","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"width"},{"kind":"static","type":"text","content":"height","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"height"},{"kind":"static","type":"text","content":"fill","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"attribute","name":"fill","tag":"fixed"}]}},{"concept":{"name":"textSVG-style"},"tags":["draw"],"type":"layout","projection":{"type":"flex","orientation":"column","justifyContent":"center","alignItems":"center","disposition":[{"type":"simulation","simulation":{"type":"text"}}]}},{"concept":{"name":"textSVG-style"},"tags":["textual"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","justifyContent":"center","disposition":[{"kind":"static","type":"text","content":"Text Style","style":{"css":["mp-style__title"]}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Font-family","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"font","tag":"fixed"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Font-size","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"size"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Text-anchor","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"anchor","tag":"fixed"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"kind":"static","type":"text","content":"Dominant-Baseline","style":{"css":["mp-fieldwrap__label","label"]}},{"type":"attribute","name":"baseline","tag":"fixed"}]}}]}}]}')},521:t=>{"use strict";t.exports=JSON.parse('{"type":"concept","concept":[{"name":"proto-projection","nature":"prototype","attributes":[{"name":"concept","target":{"name":"concept"},"required":true},{"name":"tags","target":{"name":"set","accept":{"name":"tag"}},"required":true}]},{"name":"projection","nature":"concrete","root":true,"prototype":"proto-projection","attributes":[{"name":"name","target":{"name":"name"},"required":false},{"name":"container","target":{"name":"container"},"required":true}],"properties":[{"name":"handler","type":"string","value":"projection"}]},{"name":"container-projection","nature":"concrete","root":false,"prototype":"proto-projection","attributes":[{"name":"container","target":{"name":"container"},"required":true}],"properties":[{"name":"handler","type":"string","value":"container-projection"}]},{"name":"static-projection","nature":"concrete","root":false,"prototype":"proto-projection","attributes":[{"name":"static","target":{"name":"static"}}],"properties":[{"name":"handler","type":"string","value":"static-projection"}]},{"name":"field-projection","nature":"concrete","root":false,"prototype":"proto-projection","attributes":[{"name":"field","target":{"name":"field"}}],"properties":[{"name":"handler","type":"string","value":"field-projection"}]},{"name":"graphic-projection","nature":"concrete","root":false,"prototype":"proto-projection","attributes":[{"name":"content","target":{"name":"set","accept":{"name":"render","accept":[{"name":"interactive-svg"},{"name":"add-field"},{"name":"arrow"},{"name":"svg-container"},{"name":"svg-text"}]}},"required":true}],"properties":[{"name":"handler","type":"string","value":"field-projection"}]},{"name":"template","nature":"concrete","root":true,"attributes":[{"name":"name","target":{"name":"name"},"required":true},{"name":"param","target":{"name":"set","accept":{"name":"parameter"}},"required":false},{"name":"content","target":{"name":"set","accept":{"name":"render","accept":[{"name":"container"},{"name":"text-field"},{"name":"binary-field"},{"name":"choice-field"},{"name":"list-field"},{"name":"text-static"},{"name":"image-static"},{"name":"link-static"},{"name":"plink-static"},{"name":"button-static"},{"name":"projection-dynamic"}]}}}],"properties":[{"name":"handler","type":"string","value":"template"}]},{"name":"parameter","nature":"concrete","attributes":[{"name":"name","target":{"name":"string"},"required":true},{"name":"type","target":{"name":"value"},"required":true}]},{"name":"value","nature":"prototype","attributes":[]},{"name":"string-value","nature":"concrete","prototype":"value","attributes":[{"name":"value","target":{"name":"string"}}]},{"name":"number-value","nature":"concrete","prototype":"value","attributes":[{"name":"value","target":{"name":"number"}}]},{"name":"boolean-value","nature":"concrete","prototype":"value","attributes":[{"name":"value","target":{"name":"boolean"}}]},{"name":"argument","nature":"concrete","attributes":[{"name":"name","target":{"name":"reference","accept":{"name":"parameter"}},"required":true},{"name":"value","target":{"name":"value"},"required":true}]},{"name":"concept","nature":"concrete","attributes":[{"name":"name","target":{"name":"name","src":["string","number","boolean","set","reference",{"type":"reference","target":{"value":"name"},"source":{"type":"resource","name":"metamodel"}}]}},{"name":"prototype","target":{"name":"name"}}]},{"name":"render","nature":"prototype","attributes":[{"name":"style","target":{"name":"style"},"required":false},{"name":"help","target":{"name":"string"},"required":false},{"name":"focusable","target":{"name":"boolean","default":true}},{"name":"hidden","target":{"name":"boolean","default":false}},{"name":"sibling","target":{"name":"sibling"},"required":false}]},{"name":"element","nature":"prototype","prototype":"render","attributes":[{"name":"name","target":{"name":"string"}}]},{"name":"container","nature":"concrete","prototype":"element","attributes":[{"name":"layout","target":{"name":"layout","default":"simple-layout"}},{"name":"elements","target":{"name":"set","accept":{"name":"render","accept":[{"name":"container"},{"name":"text-field"},{"name":"binary-field"},{"name":"choice-field"},{"name":"list-field"},{"name":"text-static"},{"name":"image-static"},{"name":"link-static"},{"name":"plink-static"},{"name":"button-static"},{"name":"projection-dynamic"},{"name":"template element"}]}}},{"name":"resizable","target":{"name":"boolean","default":false}},{"name":"sibling","target":{"name":"sibling"},"required":false}],"properties":[{"name":"contentType","type":"string","value":"container"}]},{"name":"field","nature":"prototype","prototype":"element","attributes":[{"name":"readonly","target":{"name":"boolean","default":false}},{"name":"disabled","target":{"name":"boolean","default":false}},{"name":"source","target":{"name":"string","src":[{"type":"meta-reference","target":{"name":"attributes","rel":"children","value":"name"},"query":{"type":"resource","resource":"concepts","params":[{"type":"eq","eq":[{"type":"property","value":"name"},{"type":"reference","rel":"parent","name":"projection","value":{"type":"reference","rel":"children","name":"concept","value":{"type":"attribute","name":"name"}}}]}]}}]}}]},{"name":"text-field","nature":"concrete","prototype":"field","attributes":[{"name":"input","target":{"name":"input"}},{"name":"multiline","target":{"name":"boolean","default":false}},{"name":"resizable","target":{"name":"boolean","default":false}}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"text"}]},{"name":"input","nature":"concrete","prototype":"render","attributes":[{"name":"type","target":{"name":"string","default":"text","constraint":{"values":["text","number","email","tel","url","color","date","range"]}}},{"name":"placeholder","target":{"name":"string"}}]},{"name":"binary-field","nature":"concrete","prototype":"field","attributes":[{"name":"checkbox","target":{"name":"checkbox"},"required":false},{"name":"true","target":{"name":"static-content"}},{"name":"false","target":{"name":"static-content"}}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"binary"}]},{"name":"checkbox","nature":"concrete","prototype":"render","attributes":[{"name":"position","target":{"name":"string","constraint":{"values":["before","after"]},"default":"before"}},{"name":"label","target":{"name":"label"}}]},{"name":"label","nature":"concrete","prototype":"render","attributes":[{"name":"content","target":{"name":"string"}}]},{"name":"static-content","nature":"concrete","attributes":[{"name":"content","target":{"name":"set","accept":{"name":"element","accept":[{"name":"text-static"},{"name":"image-static"}]}}}]},{"name":"choice-field","nature":"concrete","prototype":"field","attributes":[{"name":"choice template","target":{"name":"template reference"},"required":true},{"name":"expanded","target":{"name":"boolean"},"required":true},{"name":"placeholder","target":{"name":"string"},"required":false},{"name":"input","target":{"name":"input"},"required":false}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"choice"}]},{"name":"list-field","nature":"concrete","prototype":"field","attributes":[{"name":"orientation","target":{"name":"string","constraint":{"values":["horizontal","vertical"]}}},{"name":"action","target":{"name":"list-field-action"}},{"name":"item template","target":{"name":"template reference"}}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"list"}]},{"name":"interactive-svg","nature":"concrete","prototype":"field","attributes":[{"name":"content","target":{"name":"string"}},{"name":"field","target":{"name":"source-svg"}},{"name":"static-dependents","target":{"name":"set","accept":{"name":"external-svg"}}},{"name":"dynamic-dependents","target":{"name":"set","accept":{"name":"external-svg"}}},{"name":"marker","target":"string"},{"name":"markers","target":{"name":"set","accept":{"name":"marker"}}},{"name":"self","target":{"name":"set","accept":{"name":"pure-marker"}}}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"interactive"}]},{"name":"source-svg","nature":"concrete","attributes":[{"name":"tag","target":{"name":"tag"}},{"name":"marker","target":{"name":"string"}}]},{"name":"static-svg","nature":"concrete","prototype":"field","attributes":[{"name":"content","target":{"name":"string"}},{"name":"model-value","target":"string"}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"static"}]},{"name":"dynamic-svg","nature":"concrete","prototype":"field","attributes":[{"name":"content","target":{"name":"string"}},{"name":"marker","target":"string"},{"name":"markers","target":{"name":"set","accept":{"name":"marker"}}},{"name":"self","target":{"name":"set","accept":{"name":"pure-marker"}}}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"dynamic"}]},{"name":"marker","nature":"concrete","attributes":[{"name":"model-value","target":"string"},{"name":"aliases","target":{"name":"set","accept":{"name":"alias"}}}]},{"name":"pure-marker","nature":"concrete","attributes":[{"name":"property","target":"string"}]},{"name":"alias","nature":"concrete","attributes":[{"name":"marker-value","target":"string"},{"name":"properties","target":"svg-properties"}]},{"name":"svg-properties","nature":"concrete","attributes":[{"name":"bold","target":"boolean","default":false},{"name":"italic","target":"boolean","default":false},{"name":"underline","target":"boolean","default":false},{"name":"text-content","target":"string"},{"name":"color","target":"hex-color"},{"name":"size","target":"size"},{"name":"others","target":{"name":"set","accept":{"name":"other"}}}]},{"name":"other","nature":"concrete","attributes":[{"name":"property","target":"string"},{"name":"value","target":"string"}]},{"name":"list-field-action","nature":"concrete","attributes":[{"name":"add","target":{"name":"action"}},{"name":"remove","target":{"name":"action"}}]},{"name":"action","nature":"concrete","prototype":"render","attributes":[{"name":"position","target":{"name":"string","constraint":{"values":["before","after"]},"default":"before"}},{"name":"content","target":{"name":"string"}}]},{"name":"table-field","nature":"concrete","prototype":"field","attributes":[{"name":"orientation","target":{"name":"string","constraint":{"values":["column","row"]}}},{"name":"row template","target":{"name":"template reference"}},{"name":"header","target":{"name":"style"},"required":false},{"name":"body","target":{"name":"style"},"required":true},{"name":"footer","target":{"name":"style"},"required":false}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"table"}]},{"name":"add-field","prototype":"field","nature":"concrete","attributes":[{"name":"content","target":{"name":"string","default":"Add"}},{"name":"items","target":{"name":"template reference"}}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"add"}]},{"name":"arrow","prototype":"field","nature":"concrete","attributes":[{"name":"source","target":{"name":"attribute element"}},{"name":"target","target":{"name":"attribute element"}},{"name":"decorator","target":{"name":"decorator element"}},{"name":"arrow-style","target":{"name":"arrow-style"}}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"arrow"}]},{"name":"decorator element","nature":"concrete","attributes":[{"name":"attribute","target":{"name":"attribute element"}},{"name":"base","target":{"name":"string","constraint":{"values":["source","target","center"]},"default":"center"}}]},{"name":"arrow-target","nature":"prototype","attributes":[]},{"name":"self-target","nature":"concrete","prototype":"arrow-target","attributes":[]},{"name":"attribute-target","nature":"concrete","prototype":"arrow-target","attributes":[{"name":"attribute","target":{"name":"string"}}]},{"name":"svg-text","nature":"concrete","prototype":"field","attributes":[{"name":"x","target":{"name":"number"}},{"name":"y","target":{"name":"number"}},{"name":"content","target":{"name":"string"}}],"properties":[{"name":"contentType","type":"string","value":"field"},{"name":"elementType","type":"string","value":"svg"}]},{"name":"svg-link","nature":"concrete","attributes":[{"name":"tag","target":{"name":"tag"}},{"name":"marker","target":{"name":"string"}},{"name":"external","target":{"name":"boolean","default":false}}]},{"name":"svg-attribute","nature":"concrete","attributes":[{"name":"value","target":{"name":"attribute","src":[{"type":"reference","target":{"name":"attributes","rel":"children","value":"name","source":{"type":"reference","rel":"parent","name":"projection","value":{"type":"reference","rel":"children","name":"concept","value":{"type":"attribute","name":"name"}}}},"source":{"type":"resource","name":"metamodel"}}]}},{"name":"placement","target":{"name":"placement","accept":[{"name":"in-place"},{"name":"link-place"}],"default":"in-place"}},{"name":"property","target":{"name":"string"},"required":false}]},{"name":"placement","nature":"prototype"},{"name":"in-place","prototype":"placement","nature":"concrete","attributes":[{"name":"marker","target":{"name":"string"}},{"name":"tag","target":{"name":"tag"}},{"name":"visible","target":{"name":"boolean"},"default":true}]},{"name":"link-place","prototype":"placement","nature":"concrete","attributes":[{"name":"static-dependents","target":{"name":"set","accept":{"name":"external-svg"}}},{"name":"dynamic-dependents","target":{"name":"set","accept":{"name":"external-svg"}}}]},{"name":"external-svg","nature":"concrete","attributes":[{"name":"template","target":{"name":"string"}},{"name":"marker","target":{"name":"string"}}]},{"name":"template reference","nature":"concrete","prototype":"render","attributes":[{"name":"tag","target":{"name":"reference","accept":{"name":"tag"}}},{"name":"name","target":{"name":"string"}}]},{"name":"layout","nature":"prototype","prototype":"element","attributes":[]},{"name":"simple-layout","nature":"concrete","prototype":"layout","attributes":[{"name":"orientation","target":{"name":"string","default":"row","constraint":{"values":["row","column"]}}},{"name":"wrappable","target":{"name":"boolean","default":true}},{"name":"align-items","target":{"name":"string","default":"start","constraint":{"values":["start","end","center","stretch","baseline"]}}},{"name":"justify-content","target":{"name":"string","default":"start","constraint":{"values":["start","end","center","space-between","space-around","space-evenly"]}}}],"properties":[{"name":"contentType","type":"string","value":"layout"},{"name":"elementType","type":"string","value":"flex"}]},{"name":"table-layout","nature":"concrete","prototype":"layout","attributes":[{"name":"orientation","target":{"name":"string","default":"row","constraint":{"values":["row","column"]}}},{"name":"rows","target":{"name":"set","accept":{"name":"row"},"constraint":{"cardinality":{"type":"range","range":{"min":{"value":1}}}}}}],"properties":[{"name":"contentType","type":"string","value":"layout"},{"name":"elementType","type":"string","value":"table"}]},{"name":"row","nature":"concrete","prototype":"render","attributes":[{"name":"cells","target":{"name":"set","accept":{"name":"cell"}}}]},{"name":"cell","nature":"concrete","prototype":"render","attributes":[{"name":"span","target":{"name":"number"}},{"name":"content","target":{"name":"render","accept":[{"name":"container"},{"name":"text-field"},{"name":"binary-field"},{"name":"choice-field"},{"name":"list-field"},{"name":"text-static"},{"name":"image-static"},{"name":"link-static"},{"name":"plink-static"},{"name":"button-static"},{"name":"attribute element"}]}}]},{"name":"static element","nature":"prototype","prototype":"element","attributes":[{"name":"editable","target":{"name":"boolean","default":false}}]},{"name":"atomic element","nature":"prototype","prototype":"static element","attributes":[{"name":"content","target":{"name":"string"}}]},{"name":"text-static","nature":"concrete","prototype":"atomic element","attributes":[{"name":"asHTML","target":{"name":"boolean"}}],"properties":[{"name":"contentType","type":"string","value":"static"},{"name":"elementType","type":"string","value":"text"}]},{"name":"image-static","nature":"concrete","prototype":"atomic element","attributes":[{"name":"url","alias":"src","target":{"name":"string"}},{"name":"alt","target":{"name":"string"}}],"properties":[{"name":"contentType","type":"string","value":"static"},{"name":"elementType","type":"string","value":"image"}]},{"name":"link-static","nature":"concrete","prototype":"static element","attributes":[{"name":"url","alias":"href","target":{"name":"string"}},{"name":"type","alias":"urlType","target":{"name":"string","constraint":{"values":["link","email","phone"]},"default":"link"}},{"name":"content","target":{"name":"set","accept":{"name":"render","accept":[{"name":"text-static"},{"name":"image-static"}]}}}],"properties":[{"name":"contentType","type":"string","value":"static"},{"name":"elementType","type":"string","value":"link"}]},{"name":"plink-static","nature":"concrete","prototype":"element","attributes":[{"name":"tag","alias":"href","target":{"name":"string"}},{"name":"content","target":{"name":"set","accept":{"name":"render","accept":[{"name":"text-static"},{"name":"image-static"}]}}}],"properties":[{"name":"contentType","type":"string","value":"static"},{"name":"elementType","type":"string","value":"plink"}]},{"name":"button-static","nature":"concrete","prototype":"element","attributes":[{"name":"trigger","target":{"name":"name","default":false}},{"name":"disabled","target":{"name":"boolean","default":false}},{"name":"content","target":{"name":"set","accept":{"name":"render","accept":[{"name":"text-static"},{"name":"image-static"}]}}}],"properties":[{"name":"contentType","type":"string","value":"static"},{"name":"elementType","type":"string","value":"button"}]},{"name":"attribute element","nature":"concrete","prototype":"element","attributes":[{"name":"value","target":{"name":"attribute","src":[{"type":"reference","target":{"name":"attributes","rel":"children","value":"name","source":{"type":"reference","rel":"parent","name":"projection","value":{"type":"reference","rel":"children","name":"concept","value":{"type":"attribute","name":"name"}}}},"source":{"type":"resource","name":"metamodel"}}]}},{"name":"tag","target":{"name":"tag"},"required":true},{"name":"placeholder","target":{"name":"static-content"}},{"name":"required","target":{"name":"boolean"}}],"properties":[{"name":"contentType","type":"string","value":"dynamic"},{"name":"elementType","type":"string","value":"attribute"}]},{"name":"template element","nature":"concrete","prototype":"element","attributes":[{"name":"value","target":{"name":"reference","accept":{"name":"template"}}}],"properties":[{"name":"contentType","type":"string","value":"dynamic"},{"name":"elementType","type":"string","value":"template"}]},{"name":"projection-dynamic","nature":"concrete","prototype":"element","attributes":[{"name":"src","target":{"name":"name"}},{"name":"tag","target":{"name":"tag"}},{"name":"placeholder","target":{"name":"static-content"}},{"name":"required","target":{"name":"boolean"}},{"name":"listen","target":{"name":"boolean","default":false}}],"properties":[{"name":"contentType","type":"string","value":"dynamic"},{"name":"elementType","type":"string","value":"projection"}]},{"name":"external element","nature":"prototype","prototype":"element","attributes":[{"name":"content","target":{"name":"string"}}]},{"name":"html-external","nature":"concrete","prototype":"external element","attributes":[{"name":"selector","target":{"name":"string"}}],"properties":[{"name":"contentType","type":"string","value":"external"},{"name":"elementType","type":"string","value":"html"}]},{"name":"property-content","nature":"concrete","attributes":[{"name":"content","target":{"name":"string","src":["refname","value",{"type":"reference","target":{"name":"properties","rel":"children","value":"name","source":{"type":"reference","rel":"parent","name":"projection","value":{"type":"reference","rel":"children","name":"concept","value":{"type":"attribute","name":"name"}}}},"source":{"type":"resource","name":"metamodel"}}]}}],"properties":[{"name":"contentType","type":"string","value":"property"},{"name":"elementType","type":"string","value":"content"}]},{"name":"name","nature":"derivative","base":"string","constraint":{"length":{"type":"range","range":{"min":{"value":1},"max":{"value":50}}}}},{"name":"tag","nature":"derivative","base":"string","constraint":{"value":{"type":"pattern","pattern":{"insensitive":true,"global":true,"value":"^\\\\w+(-\\\\w+)*$"}}}},{"name":"attribute","nature":"derivative","base":"string","constraint":{"length":{"type":"range","range":{"min":1}}}},{"name":"property","nature":"derivative","base":"string","constraint":{"length":{"type":"range","range":{"min":1}}}},{"name":"sibling","nature":"concrete","attributes":[{"name":"tag","target":{"name":"string"}},{"name":"r-tag","target":{"name":"string"}}]}]}')},547:t=>{"use strict";t.exports=JSON.parse('{"toolbar":[{"type":"button","name":"button-build","action":"build-projection","class":["btn","app-editor-header__button","editor-toolbar__button--build"],"content":"Build"},{"type":"button","name":"button-export","action":"export.model","class":["btn","editor-toolbar__button","editor-toolbar__button--save"]}]}')},276:t=>{"use strict";t.exports=JSON.parse('{"type":"projection","projection":[{"concept":{"name":"template"},"type":"layout","tags":[],"content":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","style":{"ref":["pad-left"]},"disposition":[{"type":"static","static":{"type":"text","content":"Template","style":{"text":{"bold":true}}}},{"type":"attribute","name":"name","tag":"textual"}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","style":{"ref":["pad-left"]},"disposition":[{"type":"static","static":{"type":"text","content":"Content","style":{"css":["section-title","font-ui"]}}},{"type":"attribute","name":"content","tag":"action"}]}},{"type":"attribute","name":"content","tag":"element-set","style":{"css":["container-config-content"]}}],"style":{"css":["model-projection"]}}},{"concept":{"name":"template"},"type":"layout","tags":["choice","choice-selection"],"content":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"name","tag":"readonly"}]}},{"concept":{"name":"projection"},"type":"container","tags":["default"],"container":{"content":[{"type":"container","content":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"concept","help":"Target concept","style":{"ref":["box-left"]}}]}},{"kind":"static","type":"text","content":"Tags","style":{"css":["title","mp-header__title"]}},{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"tags"}},"content":[{"kind":"static","type":"text","content":"+","style":{"css":["mp-header__button-content"]}}],"style":{"css":["mp-header__button","mp-header__button--add"]}},{"type":"attribute","name":"tags","tag":"tag-set","style":{"css":["mp-header__tags"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["model-projection-header"]}},{"type":"container","content":[{"type":"attribute","name":"container"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"concept"},"tags":[],"type":"container","container":{"content":[{"type":"attribute","name":"name"}],"layout":{"type":"flex","orientation":"row"}}},{"concept":{"name":"projection"},"type":"container","tags":["string"],"container":{"content":[{"type":"template","name":"tpl-projection-header"},{"type":"container","content":[{"type":"attribute","name":"container","tag":"string"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"projection"},"type":"container","tags":["number"],"container":{"content":[{"type":"template","name":"tpl-projection-header"},{"type":"container","content":[{"type":"attribute","name":"container","tag":"number"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"projection"},"type":"container","tags":["boolean"],"container":{"content":[{"type":"template","name":"tpl-projection-header"},{"type":"container","content":[{"type":"attribute","name":"container","tag":"boolean"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"projection"},"type":"container","tags":["reference"],"container":{"content":[{"type":"template","name":"tpl-projection-header"},{"type":"container","content":[{"type":"attribute","name":"container","tag":"reference"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"projection"},"type":"container","tags":["set"],"container":{"content":[{"type":"template","name":"tpl-projection-header"},{"type":"container","content":[{"type":"attribute","name":"container","tag":"set"}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection-body"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["model-projection"]}}},{"concept":{"name":"projection"},"type":"layout","tags":["edit"],"content":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"tags","tag":"tag-set"}],"style":{"css":["model-projection","model-projection--edit"]}}},{"concept":{"name":"render"},"tags":["list-item"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"projection","bind":"value","placeholder":false,"required":true,"tag":"choice-selection"}],"style":{"html":[{"name":"etype","value":{"type":"property","name":"value"}}]}}},{"concept":{"name":"render"},"tags":["select-list-item"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"projection","bind":"value","placeholder":false,"tag":"choice","style":{"css":["list-choice__selection"]}},{"type":"field","field":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["list-choice__option"]}},"style":{"css":["list-choice__options"]}},"expanded":true,"input":{"placeholder":"Filter","style":{"css":["list-choice__input"]}},"style":{"css":["list-choice","list-choice--render"]}}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"button","trigger":"open-content","bind":"value","content":[{"kind":"static","type":"text","content":"Content"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--content"]}}},{"type":"static","static":{"type":"button","trigger":"open-action","bind":"value","content":[{"kind":"static","type":"text","content":"Action"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--action"]}}},{"type":"static","static":{"type":"button","trigger":"open-state","bind":"value","content":[{"kind":"static","type":"text","content":"State"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}},{"type":"static","static":{"type":"button","trigger":"open-style","bind":"value","content":[{"kind":"static","type":"text","content":"Style"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}],"style":{"css":["mp-element__header-navbar"],"html":[{"name":"etype","value":{"type":"property","name":"value"}}]}}}],"style":{"css":["mp-element__header"],"html":[{"name":"etype","value":{"type":"property","name":"value"}}]}}},{"type":"projection","bind":"value","placeholder":false,"required":true,"tag":"choice-selection"}],"style":{"html":[{"name":"etype","value":{"type":"property","name":"value"}}]}}},{"concept":{"name":"container"},"type":"layout","tags":["choice-selection","config"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","wrappable":false,"disposition":[{"type":"template","name":"mp-button","param":[{"name":"type","value":"container"},{"name":"name","value":"Container"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"svg-container"},{"name":"name","value":"Svg"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"text-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"link-static"},{"name":"name","value":"Link"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"image-static"},{"name":"name","value":"Image"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"plink-static"},{"name":"name","value":"Viewswitch"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"button-static"},{"name":"name","value":"Button"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"projection-dynamic"},{"name":"name","value":"Projection"}]},{"kind":"static","type":"button","trigger":"open-layout","help":"Layout","content":[{"kind":"static","type":"text","content":"Layout"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--layout"]}},{"type":"static","static":{"type":"button","trigger":"open-style","help":"Style","content":[{"kind":"static","type":"text","content":"Style"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}],"style":{"css":["container-config-header"]}}},{"type":"attribute","name":"elements","tag":"element-set","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"container"},"type":"layout","tags":["string","number"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","wrappable":false,"disposition":[{"type":"template","name":"mp-button","param":[{"name":"type","value":"text-field"},{"name":"name","value":"TextField"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"text-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"image-static"},{"name":"name","value":"Image"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"button-static"},{"name":"name","value":"Button"}]},{"kind":"static","type":"button","trigger":"open-layout","help":"Layout","content":[{"kind":"static","type":"text","content":"L"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--layout"]}},{"kind":"static","type":"button","trigger":"open-style","help":"Style","content":[{"kind":"static","type":"text","content":"S"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}],"style":{"css":["container-config-header"]}}},{"type":"attribute","name":"elements","tag":"element-set","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"container"},"type":"layout","tags":["boolean"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","wrappable":false,"disposition":[{"type":"template","name":"mp-button","param":[{"name":"type","value":"binary-field"},{"name":"name","value":"BinaryField"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"text-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"image-static"},{"name":"name","value":"Image"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"button-static"},{"name":"name","value":"Button"}]},{"kind":"static","type":"button","trigger":"open-layout","help":"Layout","content":[{"kind":"static","type":"text","content":"L"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--layout"]}},{"type":"static","static":{"type":"button","trigger":"open-style","help":"Style","content":[{"kind":"static","type":"text","content":"S"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}],"style":{"css":["container-config-header"]}}},{"type":"attribute","name":"elements","tag":"element-set","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"container"},"type":"layout","tags":["reference"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","wrappable":false,"disposition":[{"type":"template","name":"mp-button","param":[{"name":"type","value":"choice-field"},{"name":"name","value":"ChoiceField"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"text-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"image-static"},{"name":"name","value":"Image"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"button-static"},{"name":"name","value":"Button"}]},{"kind":"static","type":"button","trigger":"open-layout","help":"Layout","content":[{"kind":"static","type":"text","content":"L"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--layout"]}},{"type":"static","static":{"type":"button","trigger":"open-style","help":"Style","content":[{"kind":"static","type":"text","content":"S"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}],"style":{"css":["container-config-header"]}}},{"type":"attribute","name":"elements","tag":"element-set","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"container"},"type":"layout","tags":["set"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","wrappable":false,"disposition":[{"type":"template","name":"mp-button","param":[{"name":"type","value":"list-field"},{"name":"name","value":"ListField"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"text-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"image-static"},{"name":"name","value":"Image"}]},{"type":"template","name":"mp-button","param":[{"name":"type","value":"button-static"},{"name":"name","value":"Button"}]},{"kind":"static","type":"button","trigger":"open-layout","help":"Layout","content":[{"kind":"static","type":"text","content":"L"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--layout"]}},{"type":"static","static":{"type":"button","trigger":"open-style","help":"Style","content":[{"kind":"static","type":"text","content":"S"}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}],"style":{"css":["container-config-header"]}}},{"type":"attribute","name":"elements","tag":"element-set","style":{"css":["container-config-content"]}}],"style":{"css":["container-config"]}}},{"concept":{"name":"container"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Co","style":{"css":["container-choice-icon"]}}},{"type":"static","static":{"type":"text","content":"Container","style":{"css":["container-choice-value"]}}}],"style":{"css":["container-choice"]}}},{"concept":{"name":"container"},"type":"layout","tags":["layout"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"layout"}],"style":{"css":["container-config","container-config--attribute"]}}},{"concept":{"name":"container"},"type":"layout","tags":["state","dynamic-state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"wrappable","tag":"switch-field"},{"type":"attribute","name":"focusable","tag":"switch-field"}],"style":{"css":["container-config","container-config--attribute"]}}},{"concept":{"name":"container"},"type":"layout","tags":["style","field-style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","required":true}],"style":{"css":["container-config","container--binary"]}}},{"concept":{"name":"layout"},"tags":["list-item"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"container","content":[{"kind":"static","type":"text","content":"Layout","style":{"css":["label","mp-fieldwrap__label"]}},{"type":"field","field":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["select-choice__list-option"]}},"style":{"css":["select-choice__list"]}},"placeholder":"Select a layout","expanded":false,"input":false,"style":{"css":["select-choice"]}}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["mp-fieldwrap","mp-fieldwrap--layout"]}},{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection"}],"style":{"css":["layout-config"]}}},{"concept":{"name":"simple-layout"},"tags":["choice-selection","config"],"type":"container","container":{"content":[{"type":"attribute","name":"orientation","tag":"label-string"},{"type":"attribute","name":"align-items","tag":"label-string"},{"type":"attribute","name":"justify-content","tag":"label-string"},{"type":"attribute","name":"wrappable","tag":"switch-field"},{"type":"attribute","name":"sibling","placeholder":{"content":{"kind":"static","type":"text","content":"Add Shadow","help":"Specify customed coordinates","style":{"css":["field-config-option","font-ui"],"ref":["box-top"]}}}}],"layout":{"type":"flex","orientation":"column"}}},{"concept":{"name":"sibling"},"tags":[],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"r-tag","tag":"label-string"},{"type":"attribute","name":"tag","tag":"label-string"}]}},{"concept":{"name":"simple-layout"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"Flex layout","content":"Flex layout"}}]}},{"concept":{"name":"table-layout"},"type":"layout","tags":["choice-selection","field-config","config"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"rows","tag":"row-set"}],"style":{"css":["layout-config","layout-config--table"]}}},{"concept":{"name":"table-layout"},"type":"layout","tags":["choice-selection","field-state","state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"nav-bar","param":[{"name":"tabs","value":"layout-tabs"},{"name":"tab","value":"state"}]},{"type":"attribute","name":"orientation","tag":"label-string","style":{"ref":["pad-top"]}},{"type":"attribute","name":"focusable","tag":"field-binary-state"}],"style":{"css":["field-config","field-config--state"],"ref":["pad-left"]}}},{"concept":{"name":"table-layout"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"Table Layout","content":"Table-Layout"}}]}},{"concept":{"name":"row"},"type":"layout","tags":["list-item"],"projection":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"cells","tag":"cell-set"}]}},{"concept":{"name":"cell"},"type":"layout","tags":["list-item"],"projection":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"content"}]}},{"concept":{"name":"text-field"},"type":"layout","tags":["choice-selection","config","field-config"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"input","style":{"css":["field-config-main"]}}],"style":{"css":["field-config","field-config--text"]}}},{"concept":{"name":"text-field"},"type":"layout","tags":["state","field-state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"focusable","tag":"switch-field"},{"type":"attribute","name":"readonly","tag":"switch-field"},{"type":"attribute","name":"resizable","tag":"switch-field"},{"type":"attribute","name":"multiline","tag":"switch-field"},{"type":"attribute","name":"hidden","tag":"switch-field"}],"style":{"css":["field-config","field-config--text"]}}},{"concept":{"name":"text-field"},"type":"layout","tags":["style","field-style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","required":true}],"style":{"css":["field-config","field-config--text"]}}},{"concept":{"name":"text-field"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Text Field","disposition":[{"type":"static","static":{"type":"text","content":"Tx","style":{"css":["field-choice-icon"]}}},{"type":"static","static":{"type":"text","content":"Text-Field","style":{"css":["field-choice-value"]}}}],"style":{"css":["field-choice"]}}},{"concept":{"name":"binary-field"},"type":"layout","tags":["choice-selection","field-config","config"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"checkbox","required":true,"style":{"css":["field-config-main"]}}],"style":{"css":["field-config","field-config--binary"]}}},{"concept":{"name":"binary-field"},"type":"layout","tags":["state","field-state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"focusable","tag":"switch-field"},{"type":"attribute","name":"readonly","tag":"switch-field"},{"type":"attribute","name":"hidden","tag":"switch-field"}],"style":{"css":["field-config","field-config--binary"]}}},{"concept":{"name":"binary-field"},"type":"layout","tags":["style","field-style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","required":true}],"style":{"css":["field-config","field-config--binary"]}}},{"concept":{"name":"binary-field"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Binary Field","disposition":[{"type":"static","static":{"type":"text","content":"Bi","style":{"css":["field-choice-icon"]}}},{"type":"static","static":{"type":"text","content":"Binary-Field","style":{"css":["field-choice-value"]}}}]}},{"concept":{"name":"choice-field"},"type":"layout","tags":["choice-selection","field-config","config"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"choice template","tag":"choice-field-option"}],"style":{"css":["field-config","field-config--choice"]}}},{"concept":{"name":"choice-field"},"type":"layout","tags":["action","field-action"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"input","tag":"text","placeholder":{"content":{"type":"static","static":{"type":"text","content":"Add search input","help":"The input is used to filter the options","style":{"css":["field-config-option","font-ui"],"ref":["box-top"]}}}},"style":{"ref":["box-top"]}}],"style":{"css":["field-config","field-config--choice"]}}},{"concept":{"name":"choice-field"},"type":"layout","tags":["state","field-state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"expanded","tag":"switch-field"},{"type":"attribute","name":"focusable","tag":"switch-field"},{"type":"attribute","name":"readonly","tag":"switch-field"},{"type":"attribute","name":"hidden","tag":"switch-field"}],"style":{"css":["field-config","field-config--choice"]}}},{"concept":{"name":"choice-field"},"type":"layout","tags":["style","field-style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","required":true}],"style":{"css":["field-config","field-config--choice"]}}},{"concept":{"name":"choice-field"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"Choice Field","disposition":[{"type":"static","static":{"type":"text","content":"Ch","style":{"css":["field-choice-icon"]}}},{"type":"static","static":{"type":"text","content":"Choice-Field","style":{"css":["field-choice-value"]}}}]}},{"concept":{"name":"list-field"},"type":"layout","tags":["choice-selection","field-config","config"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"item template","tag":"list-field-item"}],"style":{"css":["field-config","field-config--list"]}}},{"concept":{"name":"list-field"},"type":"layout","tags":["action","field-action"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"action","style":{"ref":["box-top"]}}],"style":{"css":["field-config","field-config--list"]}}},{"concept":{"name":"list-field"},"type":"layout","tags":["state","field-state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"focusable","tag":"switch-field"},{"type":"attribute","name":"readonly","tag":"switch-field"},{"type":"attribute","name":"orientation","tag":"label-string"},{"type":"attribute","name":"hidden","tag":"switch-field"}],"style":{"css":["field-config","field-config--list"]}}},{"concept":{"name":"list-field"},"type":"layout","tags":["style","field-style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","required":true}],"style":{"css":["field-config","field-config--list"]}}},{"concept":{"name":"list-field"},"type":"layout","tags":["choice"],"projection":{"type":"flex","orientation":"row","focusable":false,"help":"List Field","disposition":[{"type":"static","static":{"type":"text","content":"Ls","style":{"css":["field-choice-icon"]}}},{"type":"static","static":{"type":"text","content":"List-Field","style":{"css":["field-choice-value"]}}}]}},{"concept":{"name":"list-field-action"},"type":"layout","tags":["choice-selection"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"add","style":{"css":["action-container"]}}]}}]}},{"concept":{"name":"action"},"type":"layout","tags":["choice-selection"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Add action (button)","style":{"css":["title"],"text":{"bold":true}}}},{"type":"static","static":{"type":"button","trigger":"open-style","content":[{"type":"static","static":{"type":"text","content":"Style"}}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}],"style":{"css":["container-config-header"]}}},{"type":"attribute","name":"position","tag":"label-string"},{"type":"static","static":{"type":"text","content":"Content","style":{"css":["title"]}}},{"type":"attribute","name":"content","tag":"text-string"}]}},{"concept":{"name":"action"},"type":"layout","tags":["style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","required":true}]}},{"concept":{"name":"input"},"type":"layout","tags":["config"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"baseline","disposition":[{"type":"static","static":{"type":"text","content":"Input","help":"Widget used to capture input","style":{"css":["title"]}}}]}},{"type":"attribute","name":"type","tag":"label-string"},{"type":"attribute","name":"placeholder","tag":"label-string"}],"style":{"css":["input-config"]}}},{"concept":{"name":"input"},"type":"layout","tags":["text"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"baseline","disposition":[{"type":"static","static":{"type":"text","content":"Search input","help":"Widget used to capture input","style":{"css":["title"]}}},{"type":"static","static":{"type":"button","trigger":"open-style","content":[{"type":"static","static":{"type":"text","content":"Style"}}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}]}},{"type":"attribute","name":"placeholder","tag":"label-string"}],"style":{"css":["input-config"]}}},{"concept":{"name":"input"},"type":"layout","tags":["state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"focusable","tag":"switch-field"},{"type":"attribute","name":"hidden","tag":"switch-field"}],"style":{"css":["input-config"]}}},{"concept":{"name":"input"},"type":"layout","tags":["style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","required":true}]}},{"concept":{"name":"checkbox"},"type":"layout","tags":["config"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"baseline","disposition":[{"type":"static","static":{"type":"text","content":"Checkbox","help":"Widget used to change state","style":{"css":["title"]}}},{"type":"static","static":{"type":"button","trigger":"open-state","content":[{"type":"static","static":{"type":"text","content":"State"}}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}},{"type":"static","static":{"type":"button","trigger":"open-style","content":[{"type":"static","static":{"type":"text","content":"Style"}}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}]}},{"type":"attribute","name":"label","style":{"ref":["box-top"]}}],"style":{"css":["input-config"]}}},{"concept":{"name":"checkbox"},"type":"layout","tags":["state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"focusable","tag":"switch-field"},{"type":"attribute","name":"hidden","tag":"switch-field"}],"style":{"css":["input-config"]}}},{"concept":{"name":"checkbox"},"type":"layout","tags":["style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","required":true}]}},{"concept":{"name":"label"},"type":"layout","tags":["config"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","alignItems":"baseline","disposition":[{"type":"static","static":{"type":"text","content":"Label","help":"Widget used to change state","style":{"css":["title"]}}},{"type":"static","static":{"type":"button","trigger":"open-style","content":[{"type":"static","static":{"type":"text","content":"Style"}}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}]}},{"type":"attribute","name":"content","tag":"text-string"}],"style":{"css":["input-config"]}}},{"concept":{"name":"label"},"type":"layout","tags":["style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","required":true}]}},{"concept":{"name":"static-content"},"type":"layout","tags":[],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"content","tag":"element-set"}]}},{"concept":{"name":"template"},"type":"field","tags":[],"projection":{"type":"choice","choice":{"style":{"css":["template-choice"]},"option":{"template":{"tag":"choice"},"style":{"css":["template-choice-option"]}}}}},{"concept":{"name":"template reference"},"type":"layout","tags":["config"],"projection":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Tag","style":{"css":["label"]}}},{"type":"attribute","name":"tag","tag":"tag-reference"}],"style":{"css":["tag-reference-wrapper"]}}},{"concept":{"name":"template reference"},"type":"layout","tags":["choice-field-option"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Option template","style":{"css":["title"]}}},{"type":"static","static":{"type":"button","trigger":"open-style","content":[{"type":"static","static":{"type":"text","content":"Style"}}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Tag","style":{"css":["label"]}}},{"type":"attribute","name":"tag","tag":"tag-reference"}]}}],"style":{"css":["tag-reference-wrapper"]}}},{"concept":{"name":"template reference"},"type":"layout","tags":["list-field-item"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Item template","style":{"css":["title"]}}},{"type":"static","static":{"type":"button","trigger":"open-style","content":[{"type":"static","static":{"type":"text","content":"Style"}}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Tag","style":{"css":["label"]}}},{"type":"attribute","name":"tag","tag":"tag-reference"}]}}],"style":{"css":["tag-reference-wrapper"]}}},{"concept":{"name":"template reference"},"type":"layout","tags":["style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"style","required":true}]}},{"concept":{"name":"element"},"tags":["list-item"],"type":"layout","projection":{"type":"flex","orientation":"column","disposition":[{"type":"projection","bind":"value","placeholder":false,"tag":"choice"},{"type":"field","field":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["select-choice__list-option"]}},"style":{"css":["select-choice__list"]}},"placeholder":"Select an element","expanded":false,"input":{"placeholder":"Select an element","style":{"css":["select-choice__input"]}},"style":{"css":["select-choice","select-choice--component"]}}},{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection"}]}},{"concept":{"name":"static element"},"type":"field","tags":["list-item"],"projection":{"type":"choice","choice":{"style":{"css":["static-choice"]},"option":{"template":{"tag":"choice"},"style":{"css":["static-choice-option"]}}},"style":{"css":["static-choice-field"]}}},{"concept":{"name":"text-static"},"type":"container","tags":["choice-selection","config"],"container":{"content":[{"type":"template","name":"tpl-element-header","param":[{"name":"type","value":"Txt"}]},{"type":"attribute","name":"content","tag":"text-string","options":{"resizable":true,"placeholder":"text..."},"style":{"css":["text-static"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config","static-config--text"]}}},{"concept":{"name":"text-static"},"type":"layout","tags":["state","config-state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--state"},{"type":"attribute","name":"content","tag":"text-string","style":{"ref":["box-bottom"]}},{"type":"attribute","name":"focusable","tag":"switch-field"},{"type":"attribute","name":"editable","tag":"switch-field"},{"type":"attribute","name":"asHTML","tag":"switch-field"}],"style":{"css":["mp-static","mp-static--text"]}}},{"concept":{"name":"text-static"},"type":"layout","tags":["style","config-style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--style"},{"type":"attribute","name":"style","required":true}],"style":{"css":["static-config","static-config--text"]}}},{"concept":{"name":"image-static"},"tags":["choice-selection","config"],"type":"container","container":{"content":[{"type":"template","name":"tpl-element-header","param":[{"name":"type","value":"Img"}]},{"type":"attribute","name":"url","tag":"text-string","options":{"resizable":false,"placeholder":"URL"},"style":{"css":["image-url"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["static-config","static-config--image"]}}},{"concept":{"name":"image-static"},"type":"layout","tags":["state","static-state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--state"},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Alt","style":{"css":["label"]}}},{"type":"attribute","name":"alt","tag":"text-string"}],"style":{"ref":["box-top"]}}},{"type":"attribute","name":"focusable","tag":"switch-field"},{"type":"attribute","name":"editable","tag":"switch-field"},{"type":"attribute","name":"hidden","tag":"switch-field"}],"style":{"css":["static-config","static-config--image"]}}},{"concept":{"name":"image-static"},"type":"layout","tags":["style","static-style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--style"},{"type":"attribute","name":"style","required":true}],"style":{"css":["static-config","static-config--image"]}}},{"concept":{"name":"link-static"},"tags":["choice-selection","field-config","config"],"type":"container","container":{"content":[{"type":"template","name":"tpl-element-header","param":[{"name":"type","value":"Lnk"}]},{"type":"attribute","name":"url","tag":"text-string","options":{"resizable":false,"placeholder":"URL"},"style":{"css":["link-url"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"template","name":"mp-button2","param":[{"name":"type","value":"text-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button2","param":[{"name":"type","value":"image-static"},{"name":"name","value":"Image"}]}],"style":{"css":["mp-button__header"]}}},{"type":"attribute","name":"content","tag":"element-set","style":{"css":["mp-link-content"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["static-config","static-config--link"]}}},{"concept":{"name":"link-static"},"type":"layout","tags":["state","static-state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--state"},{"type":"attribute","name":"type","tag":"label-string"},{"type":"attribute","name":"focusable","tag":"switch-field"},{"type":"attribute","name":"editable","tag":"switch-field"},{"type":"attribute","name":"hidden","tag":"switch-field"}],"style":{"css":["static-config","static-config--link"]}}},{"concept":{"name":"link-static"},"type":"layout","tags":["style","static-style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--style"},{"type":"attribute","name":"style","required":true}],"style":{"css":["static-config","static-config--link"]}}},{"concept":{"name":"plink-static"},"tags":["choice-selection","field-config","config"],"type":"container","container":{"content":[{"type":"template","name":"tpl-element-header","param":[{"name":"type","value":"Plk"}]},{"type":"attribute","name":"tag","tag":"text-string","options":{"placeholder":"tag"},"style":{"css":["mp-tag"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"template","name":"mp-button2","param":[{"name":"type","value":"text-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button2","param":[{"name":"type","value":"image-static"},{"name":"name","value":"Image"}]}],"style":{"css":["mp-button__header"]}}},{"type":"attribute","name":"content","tag":"element-set","style":{"css":["mp-link-content"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["static-config","static-config--plink"]}}},{"concept":{"name":"plink-static"},"type":"layout","tags":["state","static-state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--state"},{"type":"attribute","name":"focusable","tag":"switch-field"}],"style":{"css":["static-config","static-config--plink"]}}},{"concept":{"name":"plink-static"},"type":"layout","tags":["style","static-style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--style"},{"type":"attribute","name":"style","required":true}],"style":{"css":["static-config","static-config--plink"]}}},{"concept":{"name":"button-static"},"tags":["choice-selection","static-config","config"],"type":"container","container":{"content":[{"type":"template","name":"tpl-element-header","param":[{"name":"type","value":"Btn"}]},{"type":"attribute","name":"trigger","options":{"placeholder":"Trigger"},"tag":"text-string","style":{"css":["trigger"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"template","name":"mp-button2","param":[{"name":"type","value":"text-static"},{"name":"name","value":"Text"}]},{"type":"template","name":"mp-button2","param":[{"name":"type","value":"image-static"},{"name":"name","value":"Image"}]}],"style":{"css":["mp-button__header"]}}},{"type":"attribute","name":"content","tag":"element-set","style":{"css":["mp-button-content"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["static-config","static-config--link"]}}},{"concept":{"name":"button-static"},"type":"layout","tags":["content","static-content"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Content","style":{"css":["title"]}}},{"type":"attribute","name":"content","tag":"action"}]}},{"type":"attribute","name":"content","tag":"element-set","style":{"css":["mp-button-content"]}}],"style":{"css":["static-config","static-config--link"]}}},{"concept":{"name":"button-static"},"type":"layout","tags":["state","static-state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--state"},{"type":"attribute","name":"focusable","tag":"switch-field"},{"type":"attribute","name":"disabled","tag":"switch-field"},{"type":"attribute","name":"hidden","tag":"switch-field"}],"style":{"css":["static-config","static-config--link"]}}},{"concept":{"name":"button-static"},"type":"layout","tags":["style","static-style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--style"},{"type":"attribute","name":"style","required":true}],"style":{"css":["static-config","static-config--link"]}}},{"concept":{"name":"projection-dynamic"},"tags":["choice-selection","config"],"type":"container","container":{"content":[{"type":"template","name":"tpl-element-header","param":[{"name":"type","value":"Prj"}]},{"type":"attribute","name":"src","tag":"text-string","options":{"placeholder":"attribute"}},{"type":"attribute","name":"tag","tag":"text-string","options":{"placeholder":"tag"},"style":{"css":["mp-tag"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["dynamic-config","dynamic-config--attribute"]}}},{"concept":{"name":"projection-dynamic"},"type":"layout","tags":["state","dynamic-state"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--state"},{"type":"attribute","name":"focusable","tag":"switch-field"},{"type":"attribute","name":"listen","tag":"switch-field"}],"style":{"css":["dynamic-config","dynamic-config--attribute"]}}},{"concept":{"name":"projection-dynamic"},"type":"layout","tags":["style","dynamic-style"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"template","name":"tpl-options-nav--style"},{"type":"attribute","name":"style","required":true}],"style":{"css":["dynamic-config","dynamic-config--attribute"]}}},{"concept":{"name":"projection-dynamic"},"type":"layout","tags":["choice"],"content":{"type":"flex","orientation":"row","focusable":false,"help":"Projection (dynamic)","disposition":[{"type":"static","static":{"type":"text","content":"Prj","style":{"css":["dynamic-choice-icon"]}}},{"type":"static","static":{"type":"text","content":"Projection","style":{"css":["dynamic-choice-value"]}}}],"style":{"css":["dynamic-choice"]}}},{"concept":{"name":"template element"},"tags":["choice-selection"],"type":"container","container":{"content":[{"type":"template","name":"tpl-element-header","param":[{"name":"type","value":"Prj"}]},{"type":"attribute","name":"value","tag":"template-reference","style":{"css":["dynamic-config-main"]}}],"layout":{"type":"flex","orientation":"column"},"style":{"css":["dynamic-config","dynamic-config--template"]}}},{"concept":{"name":"template element"},"tags":["choice"],"type":"layout","content":{"type":"flex","orientation":"row","focusable":false,"help":"Template (dynamic)","disposition":[{"type":"static","static":{"type":"text","content":"Tpl","style":{"css":["dynamic-choice-icon"]}}},{"type":"static","static":{"type":"text","content":"Template","style":{"css":["dynamic-choice-value"]}}}],"style":{"css":["dynamic-choice"]}}},{"concept":{"name":"boolean"},"tags":["field-binary-state"],"type":"field","content":{"type":"binary","state":{"true":{"content":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["label","yesno-field__label"]}}},{"type":"static","static":{"type":"text","content":"yes","style":{"css":["yesno-field__value"]}}}]},"false":{"content":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["label","yesno-field__label"]}}},{"type":"static","static":{"type":"text","content":"no","style":{"css":["yesno-field__value"]}}}]}},"style":{"css":["yesno-field","yesno-field--check"]}}},{"concept":{"name":"boolean"},"tags":["switch-field"],"type":"field","content":{"type":"binary","checkbox":{"label":{"content":[{"type":"property","name":"refname"}],"style":{"css":["switch-field__label"]}},"style":{"css":["switch-field__checkbox"]}},"style":{"css":["switch-field"]}}},{"concept":{"name":"set"},"tags":["tag-set"],"type":"field","content":{"type":"list","list":{"item":{"template":{"tag":"text-string","options":{"placeholder":"tag"}},"style":{"css":["mp-tag"]}},"style":{"css":["mp-tags"]}},"action":{"add":false}}},{"concept":{"name":"set"},"tags":["projection-set"],"type":"layout","content":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Projections","style":{"css":["title","mp-projections-header__title"]}}},{"type":"field","field":{"type":"list","list":false,"action":{"add":{"content":[{"type":"static","static":{"type":"text","content":"+","focusable":false}}],"help":"Add a projection","style":{"css":["mp-projections-header__action-add"]}}},"style":{"css":["mp-projections-header__action"]}}}],"style":{"css":["mp-projections-header"]}}},{"type":"field","field":{"type":"list","list":{"item":{"template":{"tag":"collection-projection"},"style":{"css":["mp-projections-field__list-item"]}},"style":{"css":["mp-projections-field__list"]}},"action":{"add":false,"remove":false},"style":{"css":["mp-projections-field"]}}}],"style":{"css":["mp-projections"]}}},{"concept":{"name":"set"},"tags":["style-set"],"type":"layout","content":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Style rule","help":"Reuse the defined style rules","style":{"css":["config-title","font-ui"]}}},{"type":"field","field":{"type":"list","list":{"item":{"style":{"css":["textual-list__list-item--inline"]}},"style":{"css":["textual-list__list","textual-list__list--inline","textual-list__list--horizontal"]}},"action":{"add":{"content":[{"type":"static","static":{"type":"text","content":"Add rule","focusable":false}}],"help":"Add a rule","style":{"css":["textual-list__btn-add"]}},"remove":{"content":[{"type":"static","static":{"type":"text","content":"","focusable":false}}],"help":"Remove rule","style":{"css":["textual-list__btn-remove"]}}},"style":{"css":["textual-list","textual-list--style"],"ref":["pad-left"]}}}]}},{"concept":{"name":"set"},"tags":["element-set"],"type":"field","content":{"type":"list","list":{"item":{"template":{"tag":"list-item"},"style":{"css":["textual-list__list-item--box"]}},"style":{"css":["textual-list__list"]}},"action":{"add":false,"remove":{"content":[{"type":"static","static":{"type":"text","content":"","focusable":false}}],"help":"Remove element","style":{"css":["textual-list__btn-remove"]}}},"style":{"css":["textual-list","textual-list--element"]}}},{"concept":{"name":"set"},"tags":["action"],"type":"field","content":{"type":"list","list":false,"action":{"add":{"content":[{"type":"static","static":{"type":"text","content":"+","focusable":false}}],"help":"Add an element","style":{"css":["list-action__btn-add"]}}},"style":{"css":["list-action"]}}},{"concept":{"name":"set"},"tags":["row-set"],"type":"field","content":{"type":"list","list":{"item":{"template":{"tag":"list-item"},"style":{"css":["textual-list__list-item","textual-list__list-item--stripe"]}},"style":{"css":["textual-list__list"]}},"action":{"add":{"content":[{"type":"static","static":{"type":"text","content":"New row","focusable":false}}],"help":"Add a row","style":{"css":["textual-list__btn-add"]}},"remove":{"content":[{"type":"static","static":{"type":"text","content":"","focusable":false}}],"help":"Remove row","style":{"css":["textual-list__btn-remove"]}}},"style":{"css":["textual-list","textual-list--row"]}}},{"concept":{"name":"set"},"tags":["cell-set"],"type":"field","content":{"type":"list","list":{"item":{"template":{"tag":"list-item"},"style":{"css":["textual-list__list-item","textual-list__list-item--box"]}},"style":{"css":["textual-list__list","textual-list__list--horizontal"]}},"action":{"add":{"content":[{"type":"static","static":{"type":"text","content":"New cell","focusable":false}}],"help":"Add a cell","style":{"css":["textual-list__btn-add"]}},"remove":{"content":[{"type":"static","static":{"type":"text","content":"","focusable":false}}],"help":"Remove cell","style":{"css":["textual-list__btn-remove"]}}},"style":{"css":["textual-list","textual-list--cell"]}}},{"concept":{"name":"number"},"tags":["textual"],"type":"field","content":{"type":"text","resizable":true,"input":{"placeholder":"null","style":{"css":["textfield--labeled__input"]}},"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"number"},"tags":["simulation"],"type":"field","content":{"type":"svg","placeholder":"number...","style":{"anchor":"start","size":8,"baseline":"auto","font":"Segoe UI","weight":500}}},{"concept":{"name":"number"},"tags":["simulation-large"],"type":"field","content":{"type":"svg","placeholder":"0","style":{"anchor":"start","size":11,"baseline":"auto","font":"Segoe UI","weight":500}}},{"concept":{"name":"number"},"tags":["selection-info"],"type":"algorithm","content":{"type":"decoration","coordinates":{"x":100,"y":375},"content":[{"coordinates":{"x":10,"y":0},"dimension":{"type":"pure"},"render":{"kind":"static","type":"svg-text","content":"NbItems:","style":{"anchor":"end","size":18,"baseline":"hanging","font":"Segoe UI","weight":500}}},{"coordinates":{"x":10,"y":0},"dimension":{"type":"pure"},"render":{"kind":"field","type":"svg","placeholder":"number...","style":{"anchor":"start","size":18,"baseline":"hanging","font":"Segoe UI","weight":500}}}]}},{"concept":{"name":"tag"},"tags":["reference"],"type":"layout","content":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"value"}}}]}},{"concept":{"name":"number"},"tags":["textual--labelled"],"type":"layout","content":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["name-field--textual__label","label"]}}},{"type":"field","field":{"type":"text","resizable":true,"input":{"placeholder":"null","style":{"css":["name-field--textual__input"]}},"style":{"css":["name-field","name-field--textual"]}}}],"style":{"css":["name-field","name-field--textual"]}}},{"concept":{"name":"name"},"tags":["textual","list-item"],"type":"field","content":{"type":"text","resizable":true,"input":{"placeholder":"name","style":{"css":["textfield--labeled__input"]}},"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"attribute"},"tags":["textual","list-item"],"type":"field","content":{"type":"text","resizable":true,"input":{"placeholder":"attribute","style":{"css":["textfield--labeled__input"]}},"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"string"},"tags":["readonly"],"type":"static","static":{"type":"text","content":{"type":"property","name":"value"}}},{"concept":{"name":"string"},"tags":["label-string","textual--labelled"],"type":"container","container":{"content":[{"kind":"static","type":"text","content":{"type":"property","name":"refname"},"style":{"css":["label","mp-fieldwrap__label"]}},{"type":"field","field":{"type":"text","resizable":true,"input":{"style":{"css":["mp-fieldwrap__textfield-input"]}},"style":{"css":["mp-fieldwrap__textfield"]}}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["mp-fieldwrap"]}}},{"concept":{"name":"string"},"tags":["text-string","list-item"],"type":"field","content":{"type":"text","resizable":true,"input":{"placeholder":"text...","style":{"css":["mp-textfield-input"]}},"style":{"css":["mp-textfield"]}}},{"concept":{"name":"string"},"tags":["fixed"],"type":"field","content":{"type":"text","resizable":false,"input":{"placeholder":"...","style":{"css":["mp-textfield-input"]}},"style":{"css":["mp-textfield"]}}},{"concept":{"name":"reference"},"type":"field","tags":["template-reference"],"content":{"type":"choice","choice":{"option":{"template":{"tag":"choice"},"style":{"css":["select-choice__list-option"]}},"style":{"css":["select-choice__list"]}},"placeholder":"Select a template","expanded":false,"input":{"placeholder":"filter","style":{"css":["select-choice__input"]}},"style":{"css":["select-choice"]}}},{"concept":{"name":"reference"},"type":"field","tags":["tag-reference"],"content":{"type":"choice","choice":{"option":{"template":{"tag":"reference"},"style":{"css":["tag-reference__choice-option"]}},"style":{"css":["tag-reference__choice"]}},"placeholder":"select a tag","expanded":false,"input":{"placeholder":"Search...","style":{"css":["tag-reference__input"]}},"style":{"css":["tag-reference"]}}},{"concept":{"prototype":"render"},"type":"layout","tags":["choice-selection","collapse"],"projection":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"..."}},{"type":"static","static":{"type":"plink","tag":"config","content":[{"type":"static","static":{"type":"text","content":""}}],"style":{"css":["nav-projection","render__nav-projection","render__nav-projection--collapse"]}}}],"style":{"css":["render-config","render-config--collapse"]}}}],"style":[{"type":"style","name":"pad-all","style":{"box":{"inner":{"all":{"value":6,"unit":"px"}}}}},{"type":"style","name":"pad-top","style":{"box":{"inner":{"top":{"value":6,"unit":"px"}}}}},{"type":"style","name":"pad-right","style":{"box":{"inner":{"right":{"value":6,"unit":"px"}}}}},{"type":"style","name":"pad-bottom","style":{"box":{"inner":{"bottom":{"value":6,"unit":"px"}}}}},{"type":"style","name":"pad-left","style":{"box":{"inner":{"left":{"value":6,"unit":"px"}}}}},{"type":"style","name":"box-top","style":{"box":{"outer":{"top":{"value":6,"unit":"px"}}}}},{"type":"style","name":"box-right","style":{"box":{"outer":{"right":{"value":6,"unit":"px"}}}}},{"type":"style","name":"box-bottom","style":{"box":{"outer":{"bottom":{"value":6,"unit":"px"}}}}},{"type":"style","name":"box-left","style":{"box":{"outer":{"left":{"value":6,"unit":"px"}}}}},{"type":"style","name":"label","style":{"text":{"bold":500,"color":{"type":"hex","value":"#555"}}}}],"template":[{"type":"template","name":"nav-bar","param":[{"name":"tabs","type":"string"},{"name":"tab","type":"string","default":"content"}],"content":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"template","name":{"type":"param","name":"tabs"},"param":[{"name":"tab","value":{"type":"param","name":"tab"}}]}],"style":{"css":["nav","component-nav"]}}}]},{"type":"template","name":"mp-element-header","content":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"button","trigger":"open-state","content":[{"type":"static","static":{"type":"text","content":"State"}}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}},{"type":"static","static":{"type":"button","trigger":"open-style","content":[{"type":"static","static":{"type":"text","content":"Style"}}],"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--style"]}}}]}}]},{"type":"template","name":"mp-button","param":[{"name":"type","type":"string"},{"name":"name","type":"string"}],"content":[{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"elements"},"value":{"name":{"type":"param","name":"type"}}},"content":[{"kind":"static","type":"text","content":{"type":"param","name":"name"}}],"style":{"css":["container__btn-element"]}}]},{"type":"template","name":"mp-button2","param":[{"name":"type","type":"string"},{"name":"name","type":"string"}],"content":[{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"content"},"value":{"name":{"type":"param","name":"type"}}},"content":[{"kind":"static","type":"text","content":{"type":"param","name":"name"}}],"style":{"css":["container__btn-element"]}}]},{"type":"template","name":"mp-button3","param":[{"name":"type","type":"string"},{"name":"name","type":"string"}],"content":[{"kind":"static","type":"button","action":{"type":"SELECT","target":{"type":"bind"},"value":{"name":{"type":"param","name":"type"}}},"content":[{"kind":"static","type":"text","content":{"type":"param","name":"name"}}],"style":{"css":["container__btn-element","graph-elem__btn"]}}]},{"type":"template","name":"mp-button4","param":[{"name":"type","type":"string"},{"name":"name","type":"string"}],"content":[{"kind":"static","type":"button","action":{"type":"CREATES","target":{"type":"attribute","name":"content","attribute":"render"},"value":{"name":{"type":"param","name":"type"}}},"content":[{"kind":"static","type":"text","content":{"type":"param","name":"name"}}],"style":{"css":["container__btn-element"]}}]},{"type":"template","name":"mp-button4","param":[{"name":"type","type":"string"},{"name":"name","type":"string"}],"content":[{"kind":"static","type":"button","action":{"type":"SELECT","target":{"type":"attribute","name":"content"},"value":{"name":{"type":"param","name":"type"}}},"content":[{"kind":"static","type":"text","content":{"type":"param","name":"name"}}],"style":{"css":["container__btn-element"]}}]},{"type":"template","name":"fixed-button","param":[{"name":"type","type":"string"},{"name":"name","type":"string"}],"content":[{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"fixed-elements"},"value":{"name":{"type":"param","name":"type"}}},"content":[{"kind":"static","type":"text","content":{"type":"param","name":"name"}}],"style":{"css":["container__btn-element"]}}]},{"type":"template","name":"dynamic-button","param":[{"name":"type","type":"string"},{"name":"name","type":"string"}],"content":[{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"dynamic-elements"},"value":{"name":{"type":"param","name":"type"}}},"content":[{"kind":"static","type":"text","content":{"type":"param","name":"name"}}],"style":{"css":["container__btn-element"]}}]},{"type":"template","name":"hole-button","param":[{"name":"type","type":"string"},{"name":"name","type":"string"}],"content":[{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"holes"},"value":{"name":{"type":"param","name":"type"}}},"content":[{"kind":"static","type":"text","content":{"type":"param","name":"name"}}],"style":{"css":["container__btn-element"]}}]},{"type":"template","name":"tpl-element-header","param":[{"name":"type","type":"string"}],"content":[{"type":"container","content":[{"kind":"static","type":"text","content":{"type":"param","name":"type"},"style":{"css":["static-choice-icon"]}},{"kind":"static","type":"button","trigger":"open-state","content":[],"style":{"css":["static-config__btn-option"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config-header"]}}]},{"type":"template","name":"tpl-projection-header","content":[{"type":"container","content":[{"kind":"static","type":"text","content":"Tags","style":{"ref":["box-left"]}},{"kind":"static","type":"button","action":{"type":"CREATE","target":{"type":"attribute","name":"tags"}},"content":[{"kind":"static","type":"text","content":"+"}],"style":{"css":["model-projection-header__btn-add"]}},{"type":"attribute","name":"tags","tag":"tag-set"}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["model-projection-header"]}}]},{"type":"template","name":"tpl-options-nav--state","content":[{"type":"container","content":[{"kind":"static","type":"plink","tag":"state","content":[{"kind":"static","type":"text","content":"State","style":{"css":["mp-options-nav__link-text"]}}],"style":{"css":["mp-options-nav__link","current"]}},{"kind":"static","type":"plink","tag":"style","content":[{"kind":"static","type":"text","content":"Style","style":{"css":["mp-options-nav__link-text"]}}],"style":{"css":["mp-options-nav__link"]}}],"style":{"css":["mp-options-nav"]},"layout":{"type":"flex","orientation":"row"}}]},{"type":"template","name":"tpl-options-nav--create","content":[{"type":"container","content":[{"kind":"static","type":"plink","tag":"create","content":[{"kind":"static","type":"text","content":"Create","style":{"css":["mp-options-nav__link-text"]}}],"style":{"css":["mp-options-nav__link","current"]}},{"kind":"static","type":"plink","tag":"import","content":[{"kind":"static","type":"text","content":"Import","style":{"css":["mp-options-nav__link-text"]}}],"style":{"css":["mp-options-nav__link"]}}],"style":{"css":["mp-options-nav"]},"layout":{"type":"flex","orientation":"row"}}]},{"type":"template","name":"tpl-options-nav--import","content":[{"type":"container","content":[{"kind":"static","type":"plink","tag":"create","content":[{"kind":"static","type":"text","content":"Create","style":{"css":["mp-options-nav__link-text"]}}],"style":{"css":["mp-options-nav__link"]}},{"kind":"static","type":"plink","tag":"import","content":[{"kind":"static","type":"text","content":"Import","style":{"css":["mp-options-nav__link-text"]}}],"style":{"css":["mp-options-nav__link","current"]}}],"style":{"css":["mp-options-nav"]},"layout":{"type":"flex","orientation":"row"}}]},{"type":"template","name":"tpl-options-nav--style","content":[{"type":"container","content":[{"kind":"static","type":"plink","tag":"state","content":[{"kind":"static","type":"text","content":"State","style":{"css":["mp-options-nav__link-text"]}}],"style":{"css":["mp-options-nav__link"]}},{"kind":"static","type":"plink","tag":"style","content":[{"kind":"static","type":"text","content":"Style","style":{"css":["mp-options-nav__link-text"]}}],"style":{"css":["mp-options-nav__link","current"]}}],"style":{"css":["mp-options-nav"]},"layout":{"type":"flex","orientation":"row"}}]},{"type":"template","name":"tpl-element-header_graph","param":[{"name":"type","type":"string"}],"content":[{"type":"container","content":[{"kind":"static","type":"text","content":{"type":"param","name":"type"},"style":{"css":["static-choice-icon"]}},{"kind":"static","type":"svg-button","dimensions":{"width":40,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"30\\" height=\\"15\\" viewBox=\\"-5 0 40 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config-header"]}}]},{"type":"template","name":"tpl-element-header_graphd","param":[{"name":"type","type":"string"}],"content":[{"type":"container","content":[{"kind":"static","type":"text","content":{"type":"param","name":"type"},"style":{"css":["static-choice-icon"]}},{"kind":"static","type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 20 20\\" width=\\"15\\" height=\\"15\\"><circle stroke=\\"#1f75fe\\" stroke-width=\\"1\\" cx=\\"7.5\\" cy=\\"12.5\\" r=\\"6\\" fill=\\"white\\"></circle><rect stroke=\\"#1f75fe\\" stroke-width=\\"1\\" x=\\"7.5\\" y=\\"2.5\\" width=\\"10\\" height=\\"10\\" fill=\\"white\\"></rect></svg>","action":{"type":"SIDE","target":"layout-background"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}},{"kind":"static","type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"15\\" height=\\"15\\" viewBox=\\"0 0 20 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config-header"]}}]},{"type":"template","name":"tpl-element-header_deco","param":[{"name":"type","type":"string"}],"content":[{"type":"container","content":[{"kind":"static","type":"text","content":{"type":"param","name":"type"},"style":{"css":["static-choice-icon"]}},{"kind":"static","type":"svg-button","dimensions":{"width":40,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"30\\" height=\\"15\\" viewBox=\\"-5 0 40 20\\"><circle cx=\\"10\\" cy=\\"10\\" r=\\"8\\" fill=\\"#555\\"></circle><path d=\\"M 0 12 L 0 8 L 2.5 7.5 L 2.5 12.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 3.5 L 3.5 1 L 6.5 3 L 3 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 0 L 8 0 L 7.5 2.5 L 12.5 2.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 19 16.5 L 16.5 19 L 13.5 17 L 17 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 1 16.5 L 3.5 19 L 6.5 17 L 3 13.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 20 12 L 20 8 L 17.5 7.5 L 17.5 12.5 Z\\" fill=\\"#555\\" ></path><path d=\\"M 19 3.5 L 16.5 1 L 13.5 3 L 17 6.5 Z\\" fill=\\"#555\\"></path><path d=\\"M 12 20 L 8 20 L 7.5 17.5 L 12.5 17.5 Z\\" fill=\\"#555\\"></path><circle cx=\\"10\\" cy=\\"10\\" r=\\"3.5\\" fill=\\"white\\"></circle></svg>","action":{"type":"SIDE","target":"layout-setting"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}},{"type":"static","static":{"type":"svg-button","dimensions":{"width":20,"height":20},"content":"<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 20 20\\" width=\\"15\\" height=\\"15\\"><circle cx=\\"7.5\\" cy=\\"12.5\\" r=\\"6\\" fill=\\"purple\\"></circle><rect x=\\"7.5\\" y=\\"2.5\\" width=\\"10\\" height=\\"10\\" fill=\\"blue\\"></rect></svg>","action":{"type":"SIDE","target":"layout-background"},"style":{"css":["mp-element__btn-trigger","mp-element__btn-trigger--state"]}}}],"layout":{"type":"flex","orientation":"row"},"style":{"css":["static-config-header"]}}]}]}')},221:t=>{"use strict";t.exports=JSON.parse('{"concept":[{"name":"style","nature":"concrete","root":true,"attributes":[{"name":"css","target":{"name":"set","accept":{"name":"string"}}},{"name":"text","target":{"name":"text-style"}},{"name":"box","target":{"name":"box-style"}}]},{"name":"text-style","nature":"concrete","attributes":[{"name":"bold","target":{"name":"boolean","default":false}},{"name":"italic","target":{"name":"boolean","default":false}},{"name":"underline","target":{"name":"boolean","default":false}},{"name":"strikethrough","target":{"name":"boolean","default":false}},{"name":"nonbreakable","target":{"name":"boolean","default":false}},{"name":"color","target":{"name":"hex-color"}},{"name":"transform","target":{"name":"text-transform"}},{"name":"size","target":{"name":"size"}},{"name":"font","target":{"name":"font"}},{"name":"line-height","target":{"name":"number"}},{"name":"letter-spacing","target":{"name":"size"},"required":false},{"name":"word-spacing","target":{"name":"size"},"required":false}]},{"name":"box-style","nature":"concrete","attributes":[{"name":"inner","target":{"name":"spacing"}},{"name":"outer","target":{"name":"spacing"}},{"name":"background","target":{"name":"background"},"required":false},{"name":"width","target":{"name":"size"}},{"name":"height","target":{"name":"size"}},{"name":"border","target":{"name":"border"},"required":false},{"name":"corner","target":{"name":"border-radius"},"required":false},{"name":"opacity","target":{"name":"percentage","default":100}},{"name":"shadow","target":{"name":"box-shadow"}}]},{"name":"bold","nature":"concrete","attributes":[{"name":"value","target":{"name":"number","constraint":{"values":[100,200,300,400,500,600,700,800,900]}}}]},{"name":"font","nature":"concrete","attributes":[{"name":"name","target":{"name":"string","constraint":{"values":["Arial, sans-serif","Baskerville, \'Baskerville Old Face\', serif","\'Bradley Hand\', cursive","\'Brush Script MT\', \'Brush Script Std\', cursive","Calibri, sans-serif","Cambria, serif","\'Century Gothic\', CenturyGothic, AppleGothic, sans-serif","\'Comic Sans MS\', \'Comic Sans\', cursive","Consolas, monospace","\'Courier New\', Courier, monospace","Monaco, monospace","Didot, \'Didot LT STD\', serif","Garamond, serif","\'Hoefler Text\', serif","\'Gill Sans\', \'Gill Sans MT\', sans-serif","Georgia, serif","\'Helvetica Neue\', Helvetica, sans-serif","Impact, Haettenschweiler, fantasy","\'Lucida Grande\', sans-serif","\'Lucida Sans\', \'Lucida Sans Regular\', sans-serif","Luminari, fantasy","Rockwell, serif","\'Segoe UI\', \'Droid Sans\', Ubuntu, sans-serif","Tahoma, sans-serif","\'Times New Roman\', Times, serif","\'Trebuchet MS\', sans-serif","Geneva, sans-serif","Verdana, sans-serif","sans-serif","serif","monospace","cursive","fantasy"]}}}]},{"name":"size","nature":"concrete","attributes":[{"name":"value","target":{"name":"number"}},{"name":"unit","target":{"name":"size-unit","default":"px"}}]},{"name":"background","nature":"concrete","attributes":[{"name":"color","target":{"name":"background-color"},"required":true},{"name":"image","target":{"name":"background-image"},"required":false}]},{"name":"background-color","nature":"concrete","attributes":[{"name":"value","target":{"name":"hex-color"}}]},{"name":"background-image","nature":"concrete","attributes":[{"name":"url","target":{"name":"string"}},{"name":"position","target":{"name":"background-position"}},{"name":"size","target":{"name":"background-size"}},{"name":"repeat","target":{"name":"string","constraint":{"values":["horizontal","vertical","both"]}},"required":false},{"name":"attachment","target":{"name":"string","constraint":{"values":["scroll","fixed","local"]},"default":"scroll"},"required":false}]},{"name":"background-position","nature":"concrete","attributes":[{"name":"x","target":{"name":"string","constraint":{"values":["left","center","right"]}}},{"name":"y","target":{"name":"string","constraint":{"values":["top","center","bottom"]}}}]},{"name":"background-size","nature":"concrete","attributes":[{"name":"value","target":{"name":"string","constraint":{"values":["auto","cover","contain"]},"default":"auto"}}]},{"name":"box-shadow","nature":"concrete","attributes":[{"name":"offsetX","target":{"name":"size"}},{"name":"offsetY","target":{"name":"size"}},{"name":"blur","target":{"name":"size"}},{"name":"spread","target":{"name":"size"}},{"name":"inset","target":{"name":"boolean","default":false}},{"name":"color","target":{"name":"hex-color"}}]},{"name":"color","nature":"prototype","attributes":[{"name":"opacity","target":{"name":"percentage"}}]},{"name":"hex-color","nature":"concrete","prototype":"color","attributes":[{"name":"value","target":{"name":"string"}}],"properties":[{"name":"contentType","type":"string","value":"hex"}]},{"name":"hex-color__black","nature":"concrete","prototype":"color","attributes":[{"name":"value","target":{"name":"string","default":"#000000"}}],"properties":[{"name":"contentType","type":"string","value":"hex"}]},{"name":"rgb-color","nature":"concrete","prototype":"color","attributes":[{"name":"red","target":{"name":"rgb"}},{"name":"green","target":{"name":"rgb"}},{"name":"blue","target":{"name":"rgb"}}],"properties":[{"name":"contentType","type":"string","value":"rgb"}]},{"name":"spacing","nature":"concrete","attributes":[{"name":"all","target":{"name":"size"}},{"name":"top","target":{"name":"size"}},{"name":"right","target":{"name":"size"}},{"name":"bottom","target":{"name":"size"}},{"name":"left","target":{"name":"size"}}]},{"name":"border","nature":"concrete","attributes":[{"name":"all","target":{"name":"border-value"}},{"name":"top","target":{"name":"border-value"}},{"name":"right","target":{"name":"border-value"}},{"name":"bottom","target":{"name":"border-value"}},{"name":"left","target":{"name":"border-value"}}]},{"name":"border-value","nature":"concrete","attributes":[{"name":"width","target":{"name":"size"}},{"name":"color","target":{"name":"hex-color"}},{"name":"type","target":{"name":"border-type","default":"solid"}}]},{"name":"border-radius","nature":"concrete","attributes":[{"name":"all","target":{"name":"size"}},{"name":"top-left","target":{"name":"size"}},{"name":"top-right","target":{"name":"size"}},{"name":"bottom-right","target":{"name":"size"}},{"name":"bottom-left","target":{"name":"size"}}]},{"name":"rgb","nature":"derivative","base":"number","constraint":{"value":{"type":"range","range":{"min":{"value":0},"max":{"value":255}}}}},{"name":"percentage","nature":"derivative","base":"number","constraint":{"value":{"type":"range","range":{"min":{"value":0},"max":{"value":100}}}}},{"name":"size-unit","nature":"derivative","base":"string","constraint":{"values":["px","em","rem","%","vw","vh"]}},{"name":"border-type","nature":"derivative","base":"string","constraint":{"values":["solid","dotted","dashed","double","inset","outset"]}},{"name":"direction","nature":"derivative","base":"string","constraint":{"values":["top","right","bottom","left"]}},{"name":"alignment","nature":"derivative","base":"string","constraint":{"values":["left","right","center","justify"]}},{"name":"text-transform","nature":"derivative","base":"string","constraint":{"values":["capitalize","lowercase","uppercase"]}}]}')},843:t=>{"use strict";t.exports=JSON.parse('{"type":"projection","projection":[{"concept":{"name":"style"},"type":"layout","tags":[],"content":{"type":"stack","orientation":"vertical","disposition":[{"type":"static","static":{"type":"text","content":"Text style","style":{"css":["mp-style__title"]}}},{"type":"attribute","name":"text"},{"type":"static","static":{"type":"text","content":"Box style","style":{"css":["mp-style__title"]}}},{"type":"attribute","name":"box"},{"type":"attribute","name":"css","tag":"css-set","style":{"ref":["pad-all"]}}],"style":{"css":["mp-style"]}}},{"concept":{"name":"text-style"},"tags":[],"type":"layout","content":{"type":"flex","orientation":"column","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"bold","tag":"toggle-field--bold","style":{"css":["text-style-rule"]}},{"type":"attribute","name":"italic","tag":"toggle-field--italic","style":{"css":["text-style-rule"]}},{"type":"attribute","name":"underline","tag":"toggle-field--underline","style":{"css":["text-style-rule"]}},{"type":"attribute","name":"strikethrough","tag":"toggle-field--strikethrough","style":{"css":["text-style-rule"]}}]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"color","style":{"css":["text-style-rule"]}}],"style":{"css":["text-style-rule"]}}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Font","style":{"css":["label"]}}},{"type":"attribute","name":"font"},{"type":"attribute","name":"size"}],"style":{"css":["text-style-rule"]}}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Line spacing","style":{"css":["label"]}}},{"type":"attribute","name":"line-height"}],"style":{"css":["text-style-rule"]}}}],"style":{"css":["text-style"]}}},{"concept":{"name":"box-style"},"tags":[],"type":"layout","content":{"type":"flex","orientation":"column","disposition":[{"type":"attribute","name":"outer","tag":"margin","style":{"css":["box-style-rule"]}},{"type":"attribute","name":"inner","tag":"padding","style":{"css":["box-style-rule"]}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Width","style":{"css":["label"]}}},{"type":"attribute","name":"width"}],"style":{"css":["box-style-rule"]}}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"Height","style":{"css":["label"]}}},{"type":"attribute","name":"height"}],"style":{"css":["box-style-rule"]}}},{"type":"attribute","name":"background","required":true,"style":{"css":["box-style-rule"]}},{"type":"attribute","name":"border","required":true,"style":{"css":["box-style-rule"]}},{"type":"attribute","name":"corner","required":true,"style":{"css":["box-style-rule"]}}],"style":{"css":["box-style"]}}},{"concept":{"name":"spacing"},"tags":["margin"],"type":"layout","content":{"type":"stack","orientation":"vertical","disposition":[{"type":"static","static":{"type":"text","help":"Outer spacing","content":"Margin","style":{"css":["title"]}}},{"type":"template","name":"spacing-content"}]}},{"concept":{"name":"spacing"},"tags":["padding"],"type":"layout","content":{"type":"stack","orientation":"vertical","disposition":[{"type":"static","static":{"type":"text","help":"Inner spacing","content":"Padding","style":{"css":["title"]}}},{"type":"template","name":"spacing-content"}]}},{"concept":{"name":"border"},"tags":["choice-selection"],"type":"layout","content":{"type":"stack","orientation":"vertical","disposition":[{"type":"static","static":{"type":"text","content":"Border","style":{"css":["title"]}}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"All","style":{"css":["title"]}}},{"type":"attribute","name":"all"}]}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Top","style":{"css":["title"]}}},{"type":"attribute","name":"top"}]}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Right","style":{"css":["title"]}}},{"type":"attribute","name":"right"}]}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Bottom","style":{"css":["title"]}}},{"type":"attribute","name":"bottom"}]}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Left","style":{"css":["title"]}}},{"type":"attribute","name":"left"}]}}]}},{"concept":{"name":"border-value"},"tags":[],"type":"layout","content":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"type","tag":"label-string"},{"type":"attribute","name":"width"},{"type":"attribute","name":"color"}],"style":{"css":["border-value-config"]}}},{"concept":{"name":"background"},"tags":["choice-selection"],"type":"layout","content":{"type":"stack","orientation":"vertical","disposition":[{"type":"static","static":{"type":"text","content":"Background","style":{"css":["title--small"]}}},{"type":"attribute","name":"color","style":{"css":["background-config"]}}]}},{"concept":{"name":"background-color"},"tags":[],"type":"layout","content":{"type":"stack","orientation":"vertical","disposition":[{"type":"attribute","name":"value"}]}},{"concept":{"name":"background-image"},"tags":[],"type":"layout","content":{"type":"stack","orientation":"vertical","disposition":[{"type":"attribute","name":"url","tag":"simple-string--url"}]}},{"concept":{"name":"border-radius"},"tags":["margin"],"type":"layout","content":{"type":"stack","orientation":"vertical","disposition":[{"type":"static","static":{"type":"text","content":"Corner (border-radius)","style":{"css":["title"]}}},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Top-left","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"top-left"}],"style":{"ref":["box-right"]}}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Top-right","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"top-right"}],"style":{"ref":["box-right"]}}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Btm-right","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"bottom-right"}],"style":{"ref":["box-right"]}}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Btm-left","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"bottom-left"}]}}]}}]}},{"concept":{"name":"box-shadow"},"tags":["margin"],"type":"layout","content":{"type":"stack","orientation":"vertical","disposition":[{"type":"static","static":{"type":"text","content":"Box Shadow","style":{"css":["title"]}}},{"type":"attribute","name":"inset","tag":"switch-field"},{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","help":"Horizontal offset","content":"offset-X","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"offsetX"}],"style":{"ref":["box-right"]}}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","help":"Vertical offset","content":"offset-Y","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"offsetY"}],"style":{"ref":["box-right"]}}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","help":"Blur radius","content":"Blur","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"blur"}],"style":{"ref":["box-right"]}}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Spread","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"spread"}]}}]}},{"type":"attribute","name":"color"}]}},{"concept":{"name":"font"},"tags":[],"type":"layout","content":{"type":"flex","orientation":"row","disposition":[{"type":"attribute","name":"name","tag":"choice"}]}},{"concept":{"name":"color"},"tags":[],"type":"layout","projection":{"type":"stack","orientation":"vertical","disposition":[{"type":"static","static":{"type":"text","content":"Color","style":{"css":["title--small"]}}},{"type":"field","field":{"type":"choice","input":false,"choice":{"style":{"css":["constraint-choice--textual__choice-list"]},"option":{"template":{"tag":"choice"},"style":{"css":["constraint-choice--textual__choice-option"]}}},"style":{"css":["constraint-choice--textual__choice"]}}},{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection","style":{"css":["number-constraint"]}}]}},{"concept":{"name":"color"},"tags":["no-title"],"type":"layout","projection":{"type":"stack","orientation":"vertical","disposition":[{"type":"field","field":{"type":"choice","input":false,"choice":{"style":{"css":["constraint-choice--textual__choice-list"]},"option":{"template":{"tag":"choice"},"style":{"css":["constraint-choice--textual__choice-option"]}}},"style":{"css":["constraint-choice--textual__choice"]}}},{"type":"projection","bind":"value","placeholder":false,"tag":"choice-selection","style":{"css":["number-constraint"]}}]}},{"concept":{"name":"hex-color"},"tags":["choice-selection"],"type":"layout","content":{"type":"stack","orientation":"vertical","style":{"css":["text-element"]},"disposition":[{"type":"attribute","name":"value","tag":"color-string"}]}},{"concept":{"name":"hex-color"},"tags":["color-simple"],"type":"layout","content":{"type":"stack","orientation":"vertical","style":{"css":["text-element"]},"disposition":[{"type":"attribute","name":"value","tag":"color-simple"}]}},{"concept":{"name":"hex-color"},"tags":["choice"],"type":"layout","content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Picker"}}]}},{"concept":{"name":"rgb-color"},"tags":["choice-selection"],"type":"layout","content":{"type":"stack","orientation":"vertical","style":{"css":["text-element"]},"disposition":[{"type":"attribute","name":"red","tag":"textual--labelled"},{"type":"attribute","name":"green","tag":"textual--labelled"},{"type":"attribute","name":"blue","tag":"textual--labelled"}]}},{"concept":{"name":"rgb-color"},"tags":["choice"],"type":"layout","content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"RGB"}}]}},{"concept":{"name":"size"},"tags":[],"type":"layout","content":{"type":"stack","orientation":"horizontal","disposition":[{"type":"attribute","name":"value","tag":"textual"},{"type":"attribute","name":"unit","tag":"simple-string"}],"style":{"css":["size-config"]}}},{"concept":{"name":"set"},"tags":["css-set"],"type":"layout","content":{"type":"stack","orientation":"vertical","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"static","static":{"type":"text","content":"CSS class","style":{"css":["title","mp-tags-header__title"]}}},{"type":"field","field":{"type":"list","list":false,"action":{"add":{"content":[{"type":"static","static":{"type":"text","content":"+","focusable":false}}],"help":"Add a class","style":{"css":["mp-tags-header__action-add"]}}},"style":{"css":["mp-tags-header__action"]}}}],"style":{"css":["mp-tags-header"]}}},{"type":"field","field":{"type":"list","list":{"item":{"template":{"tag":"simple-string--css"},"style":{"css":["textual-list__list-item--inline"]}},"style":{"css":["textual-list__list","textual-list__list--inline","textual-list__list--horizontal"]}},"action":{"add":false},"style":{"css":["mp-tags__list"]}}}],"style":{"css":["mp-tags"]}}},{"concept":{"name":"set"},"tags":["style-set"],"type":"layout","content":{"type":"stack","orientation":"vertical","disposition":[{"type":"static","static":{"type":"text","content":"Style rule","help":"Reuse the defined style rules","style":{"css":["config-title","font-ui"]}}},{"type":"field","field":{"type":"list","list":{"item":{"style":{"css":["textual-list__list-item--inline"]}},"style":{"css":["textual-list__list","textual-list__list--inline","textual-list__list--horizontal"]}},"action":{"add":{"content":[{"type":"static","static":{"type":"text","content":"Add rule","focusable":false}}],"help":"Add a rule","style":{"css":["textual-list__btn-add"]}},"remove":{"content":[{"type":"static","static":{"type":"text","content":"","focusable":false}}],"help":"Remove rule","style":{"css":["textual-list__btn-remove"]}}},"style":{"css":["textual-list","textual-list--style"],"ref":["pad-left"]}}}]}},{"concept":{"name":"set"},"tags":["cell-set"],"type":"field","content":{"type":"list","list":{"item":{"template":{"tag":"list-item"},"style":{"css":["textual-list__list-item","textual-list__list-item--box"]}},"style":{"css":["textual-list__list","textual-list__list--horizontal"]}},"action":{"add":{"content":[{"type":"static","static":{"type":"text","content":"New cell","focusable":false}}],"help":"Add a cell","style":{"css":["textual-list__btn-add"]}},"remove":{"content":[{"type":"static","static":{"type":"text","content":"","focusable":false}}],"help":"Remove cell","style":{"css":["textual-list__btn-remove"]}}},"style":{"css":["textual-list","textual-list--cell"]}}},{"concept":{"name":"boolean"},"tags":["toggle-field--bold"],"type":"field","content":{"type":"binary","checkbox":{"label":{"content":[{"type":"raw","raw":"B","style":{"gss":{"text":{"bold":true}}}},{"type":"raw","raw":"Bold","style":{"css":["mp-toggle-field__label-help"]}}],"style":{"css":["mp-toggle-field__label"]}},"style":{"css":["mp-toggle-field__checkbox"]}},"style":{"css":["mp-toggle-field"]}}},{"concept":{"name":"boolean"},"tags":["toggle-field--italic"],"type":"field","content":{"type":"binary","checkbox":{"label":{"content":[{"type":"raw","raw":"I","style":{"gss":{"text":{"italic":true}}}},{"type":"raw","raw":"Italic","style":{"css":["mp-toggle-field__label-help"]}}],"style":{"css":["mp-toggle-field__label"]}},"style":{"css":["mp-toggle-field__checkbox"]}},"style":{"css":["mp-toggle-field"]}}},{"concept":{"name":"boolean"},"tags":["toggle-field--underline"],"type":"field","content":{"type":"binary","checkbox":{"label":{"content":[{"type":"raw","raw":"U","style":{"gss":{"text":{"underline":true}}}},{"type":"raw","raw":"Underline","style":{"css":["mp-toggle-field__label-help"]}}],"style":{"css":["mp-toggle-field__label"]}},"style":{"css":["mp-toggle-field__checkbox"]}},"style":{"css":["mp-toggle-field"]}}},{"concept":{"name":"boolean"},"tags":["toggle-field--strikethrough"],"type":"field","content":{"type":"binary","checkbox":{"label":{"content":[{"type":"raw","raw":"S","style":{"gss":{"text":{"strikethrough":true}}}},{"type":"raw","raw":"Strikethrough","style":{"css":["mp-toggle-field__label-help"]}}],"style":{"css":["mp-toggle-field__label"]}},"style":{"css":["mp-toggle-field__checkbox"]}},"style":{"css":["mp-toggle-field"]}}},{"concept":{"name":"number"},"tags":["textual"],"type":"field","content":{"type":"text","resizable":true,"input":{"placeholder":"null","style":{"css":["textfield--labeled__input"]}},"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"number"},"tags":["textual--labelled"],"type":"layout","content":{"type":"wrap","disposition":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["name-field--textual__label","label"]}}},{"type":"field","field":{"type":"text","resizable":true,"input":{"placeholder":"null","style":{"css":["name-field--textual__input"]}},"style":{"css":["name-field","name-field--textual"]}}}],"style":{"css":["name-field","name-field--textual"]}}},{"concept":{"name":"name"},"tags":["textual","list-item"],"type":"field","content":{"type":"text","resizable":true,"input":{"placeholder":"name","style":{"css":["textfield--labeled__input"]}},"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"string"},"tags":["simple-string"],"type":"field","content":{"type":"text","resizable":true,"input":{"placeholder":"null","style":{"css":["textfield--labeled__input"]}},"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"string"},"tags":["readonly"],"type":"layout","content":{"type":"wrap","disposition":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"value"}}}]}},{"concept":{"name":"string"},"tags":["simple-string--url"],"type":"field","content":{"type":"text","resizable":false,"input":{"placeholder":"url","type":"url","style":{"css":["textfield--labeled__input"]}},"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"string"},"tags":["label-string","textual--labelled"],"type":"layout","content":{"type":"wrap","disposition":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["label","name-field--textual__label"]}}},{"type":"field","field":{"type":"text","resizable":true,"input":{"placeholder":"null","style":{"css":["name-field--textual__input"]}},"style":{"css":["name-field","name-field--textual"]}}}],"style":{"css":["name-field","name-field--textual"]}}},{"concept":{"name":"string"},"tags":["color-string"],"type":"layout","content":{"type":"wrap","disposition":[{"type":"static","static":{"type":"text","content":"Color","style":{"css":["label","name-field--textual__label"]}}},{"type":"field","field":{"type":"text","input":{"type":"color","placeholder":"null","style":{"css":["name-field--textual__input"]}},"style":{"css":["name-field","name-field--textual"]}}}],"style":{"css":["name-field","name-field--textual"]}}},{"concept":{"name":"string"},"tags":["color-simple"],"type":"layout","content":{"type":"wrap","disposition":[{"type":"field","field":{"type":"text","input":{"type":"color","placeholder":"null","style":{"css":["name-field--textual__input"]}},"style":{"css":["name-field","name-field--textual"]}}}],"style":{"css":["name-field","name-field--textual"]}}},{"concept":{"name":"string"},"tags":["choice"],"type":"field","content":{"type":"choice","choice":{"option":{"template":{"tag":"reference"},"style":{"css":["tag-reference__choice-option"]}},"style":{"css":["tag-reference__choice"]}},"placeholder":"inherit","expanded":false,"input":{"placeholder":"Search...","style":{"css":["tag-reference__input"]}},"style":{"css":["tag-reference"]}}}],"template":[{"type":"template","name":"spacing-content","content":[{"type":"layout","layout":{"type":"flex","orientation":"row","disposition":[{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Top","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"top"}],"style":{"ref":["box-right"]}}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Right","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"right"}],"style":{"ref":["box-right"]}}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Bottom","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"bottom"}],"style":{"ref":["box-right"]}}},{"type":"layout","layout":{"type":"flex","orientation":"column","disposition":[{"type":"static","static":{"type":"text","content":"Left","style":{"css":["label","label--small"]}}},{"type":"attribute","name":"left"}]}}]}}]}]}')},78:(t,e,n)=>{var i,s;!function(){var a={version:"3.5.17"},r=[].slice,o=function(t){return r.call(t)},l=this.document;function c(t){return t&&(t.ownerDocument||t.document||t).documentElement}function h(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}if(l)try{o(l.documentElement.childNodes)[0].nodeType}catch(t){o=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),l)try{l.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var u=this.Element.prototype,d=u.setAttribute,p=u.setAttributeNS,m=this.CSSStyleDeclaration.prototype,f=m.setProperty;u.setAttribute=function(t,e){d.call(this,t,e+"")},u.setAttributeNS=function(t,e,n){p.call(this,t,e,n+"")},m.setProperty=function(t,e,n){f.call(this,t,e+"",n)}}function g(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function y(t){return null===t?NaN:+t}function b(t){return!isNaN(t)}function v(t){return{left:function(e,n,i,s){for(arguments.length<3&&(i=0),arguments.length<4&&(s=e.length);i<s;){var a=i+s>>>1;t(e[a],n)<0?i=a+1:s=a}return i},right:function(e,n,i,s){for(arguments.length<3&&(i=0),arguments.length<4&&(s=e.length);i<s;){var a=i+s>>>1;t(e[a],n)>0?s=a:i=a+1}return i}}}a.ascending=g,a.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},a.min=function(t,e){var n,i,s=-1,a=t.length;if(1===arguments.length){for(;++s<a;)if(null!=(i=t[s])&&i>=i){n=i;break}for(;++s<a;)null!=(i=t[s])&&n>i&&(n=i)}else{for(;++s<a;)if(null!=(i=e.call(t,t[s],s))&&i>=i){n=i;break}for(;++s<a;)null!=(i=e.call(t,t[s],s))&&n>i&&(n=i)}return n},a.max=function(t,e){var n,i,s=-1,a=t.length;if(1===arguments.length){for(;++s<a;)if(null!=(i=t[s])&&i>=i){n=i;break}for(;++s<a;)null!=(i=t[s])&&i>n&&(n=i)}else{for(;++s<a;)if(null!=(i=e.call(t,t[s],s))&&i>=i){n=i;break}for(;++s<a;)null!=(i=e.call(t,t[s],s))&&i>n&&(n=i)}return n},a.extent=function(t,e){var n,i,s,a=-1,r=t.length;if(1===arguments.length){for(;++a<r;)if(null!=(i=t[a])&&i>=i){n=s=i;break}for(;++a<r;)null!=(i=t[a])&&(n>i&&(n=i),s<i&&(s=i))}else{for(;++a<r;)if(null!=(i=e.call(t,t[a],a))&&i>=i){n=s=i;break}for(;++a<r;)null!=(i=e.call(t,t[a],a))&&(n>i&&(n=i),s<i&&(s=i))}return[n,s]},a.sum=function(t,e){var n,i=0,s=t.length,a=-1;if(1===arguments.length)for(;++a<s;)b(n=+t[a])&&(i+=n);else for(;++a<s;)b(n=+e.call(t,t[a],a))&&(i+=n);return i},a.mean=function(t,e){var n,i=0,s=t.length,a=-1,r=s;if(1===arguments.length)for(;++a<s;)b(n=y(t[a]))?i+=n:--r;else for(;++a<s;)b(n=y(e.call(t,t[a],a)))?i+=n:--r;if(r)return i/r},a.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),s=+t[i-1],a=n-i;return a?s+a*(t[i]-s):s},a.median=function(t,e){var n,i=[],s=t.length,r=-1;if(1===arguments.length)for(;++r<s;)b(n=y(t[r]))&&i.push(n);else for(;++r<s;)b(n=y(e.call(t,t[r],r)))&&i.push(n);if(i.length)return a.quantile(i.sort(g),.5)},a.variance=function(t,e){var n,i,s=t.length,a=0,r=0,o=-1,l=0;if(1===arguments.length)for(;++o<s;)b(n=y(t[o]))&&(r+=(i=n-a)*(n-(a+=i/++l)));else for(;++o<s;)b(n=y(e.call(t,t[o],o)))&&(r+=(i=n-a)*(n-(a+=i/++l)));if(l>1)return r/(l-1)},a.deviation=function(){var t=a.variance.apply(this,arguments);return t?Math.sqrt(t):t};var x=v(g);function w(t){return t.length}a.bisectLeft=x.left,a.bisect=a.bisectRight=x.right,a.bisector=function(t){return v(1===t.length?function(e,n){return g(t(e),n)}:t)},a.shuffle=function(t,e,n){(a=arguments.length)<3&&(n=t.length,a<2&&(e=0));for(var i,s,a=n-e;a;)s=Math.random()*a--|0,i=t[a+e],t[a+e]=t[s+e],t[s+e]=i;return t},a.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},a.pairs=function(t){for(var e=0,n=t.length-1,i=t[0],s=new Array(n<0?0:n);e<n;)s[e]=[i,i=t[++e]];return s},a.transpose=function(t){if(!(s=t.length))return[];for(var e=-1,n=a.min(t,w),i=new Array(n);++e<n;)for(var s,r=-1,o=i[e]=new Array(s);++r<s;)o[r]=t[r][e];return i},a.zip=function(){return a.transpose(arguments)},a.keys=function(t){var e=[];for(var n in t)e.push(n);return e},a.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},a.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},a.merge=function(t){for(var e,n,i,s=t.length,a=-1,r=0;++a<s;)r+=t[a].length;for(n=new Array(r);--s>=0;)for(e=(i=t[s]).length;--e>=0;)n[--r]=i[e];return n};var E=Math.abs;function A(t){for(var e=1;t*e%1;)e*=10;return e}function j(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function k(){this._=Object.create(null)}function N(t){return"__proto__"==(t+="")||"\0"===t[0]?"\0"+t:t}function _(t){return"\0"===(t+="")[0]?t.slice(1):t}function O(t){return N(t)in this._}function L(t){return(t=N(t))in this._&&delete this._[t]}function M(){var t=[];for(var e in this._)t.push(_(e));return t}function C(){var t=0;for(var e in this._)++t;return t}function S(){for(var t in this._)return!1;return!0}function T(){this._=Object.create(null)}function I(t){return t}function U(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function D(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,i=H.length;n<i;++n){var s=H[n]+e;if(s in t)return s}}a.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n==1/0)throw new Error("infinite range");var i,s=[],a=A(E(n)),r=-1;if(t*=a,e*=a,(n*=a)<0)for(;(i=t+n*++r)>e;)s.push(i/a);else for(;(i=t+n*++r)<e;)s.push(i/a);return s},a.map=function(t,e){var n=new k;if(t instanceof k)t.forEach((function(t,e){n.set(t,e)}));else if(Array.isArray(t)){var i,s=-1,a=t.length;if(1===arguments.length)for(;++s<a;)n.set(s,t[s]);else for(;++s<a;)n.set(e.call(t,i=t[s],s),i)}else for(var r in t)n.set(r,t[r]);return n},j(k,{has:O,get:function(t){return this._[N(t)]},set:function(t,e){return this._[N(t)]=e},remove:L,keys:M,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:_(e),value:this._[e]});return t},size:C,empty:S,forEach:function(t){for(var e in this._)t.call(this,_(e),this._[e])}}),a.nest=function(){var t,e,n={},i=[],s=[];function r(s,a,o){if(o>=i.length)return e?e.call(n,a):t?a.sort(t):a;for(var l,c,h,u,d=-1,p=a.length,m=i[o++],f=new k;++d<p;)(u=f.get(l=m(c=a[d])))?u.push(c):f.set(l,[c]);return s?(c=s(),h=function(t,e){c.set(t,r(s,e,o))}):(c={},h=function(t,e){c[t]=r(s,e,o)}),f.forEach(h),c}function o(t,e){if(e>=i.length)return t;var n=[],a=s[e++];return t.forEach((function(t,i){n.push({key:t,values:o(i,e)})})),a?n.sort((function(t,e){return a(t.key,e.key)})):n}return n.map=function(t,e){return r(e,t,0)},n.entries=function(t){return o(r(a.map,t,0),0)},n.key=function(t){return i.push(t),n},n.sortKeys=function(t){return s[i.length-1]=t,n},n.sortValues=function(e){return t=e,n},n.rollup=function(t){return e=t,n},n},a.set=function(t){var e=new T;if(t)for(var n=0,i=t.length;n<i;++n)e.add(t[n]);return e},j(T,{has:O,add:function(t){return this._[N(t+="")]=!0,t},remove:L,values:M,size:C,empty:S,forEach:function(t){for(var e in this._)t.call(this,_(e))}}),a.behavior={},a.rebind=function(t,e){for(var n,i=1,s=arguments.length;++i<s;)t[n=arguments[i]]=U(t,e,e[n]);return t};var H=["webkit","ms","moz","Moz","o","O"];function P(){}function R(){}function B(t){var e=[],n=new k;function i(){for(var n,i=e,s=-1,a=i.length;++s<a;)(n=i[s].on)&&n.apply(this,arguments);return t}return i.on=function(i,s){var a,r=n.get(i);return arguments.length<2?r&&r.on:(r&&(r.on=null,e=e.slice(0,a=e.indexOf(r)).concat(e.slice(a+1)),n.remove(i)),s&&e.push(n.set(i,{on:s})),t)},i}function V(){a.event.preventDefault()}function z(){for(var t,e=a.event;t=e.sourceEvent;)e=t;return e}function F(t){for(var e=new R,n=0,i=arguments.length;++n<i;)e[arguments[n]]=B(e);return e.of=function(n,i){return function(s){try{var r=s.sourceEvent=a.event;s.target=t,a.event=s,e[s.type].apply(n,i)}finally{a.event=r}}},e}a.dispatch=function(){for(var t=new R,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=B(t);return t},R.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},a.event=null,a.requote=function(t){return t.replace(q,"\\$&")};var q=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,$={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]};function W(t){return $(t,G),t}var Z=function(t,e){return e.querySelector(t)},X=function(t,e){return e.querySelectorAll(t)},Y=function(t,e){var n=t.matches||t[D(t,"matchesSelector")];return(Y=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&(Z=function(t,e){return Sizzle(t,e)[0]||null},X=Sizzle,Y=Sizzle.matchesSelector),a.selection=function(){return a.select(l.documentElement)};var G=a.selection.prototype=[];function J(t){return"function"==typeof t?t:function(){return Z(t,this)}}function K(t){return"function"==typeof t?t:function(){return X(t,this)}}G.select=function(t){var e,n,i,s,a=[];t=J(t);for(var r=-1,o=this.length;++r<o;){a.push(e=[]),e.parentNode=(i=this[r]).parentNode;for(var l=-1,c=i.length;++l<c;)(s=i[l])?(e.push(n=t.call(s,s.__data__,l,r)),n&&"__data__"in s&&(n.__data__=s.__data__)):e.push(null)}return W(a)},G.selectAll=function(t){var e,n,i=[];t=K(t);for(var s=-1,a=this.length;++s<a;)for(var r=this[s],l=-1,c=r.length;++l<c;)(n=r[l])&&(i.push(e=o(t.call(n,n.__data__,l,s))),e.parentNode=n);return W(i)};var Q="http://www.w3.org/1999/xhtml",tt={svg:"http://www.w3.org/2000/svg",xhtml:Q,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function et(t,e){return t=a.ns.qualify(t),null==e?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof e?t.local?function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}:function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}:t.local?function(){this.setAttributeNS(t.space,t.local,e)}:function(){this.setAttribute(t,e)}}function nt(t){return t.trim().replace(/\s+/g," ")}function it(t){return new RegExp("(?:^|\\s+)"+a.requote(t)+"(?:\\s+|$)","g")}function st(t){return(t+"").trim().split(/^|\s+/)}function at(t,e){var n=(t=st(t).map(rt)).length;return"function"==typeof e?function(){for(var i=-1,s=e.apply(this,arguments);++i<n;)t[i](this,s)}:function(){for(var i=-1;++i<n;)t[i](this,e)}}function rt(t){var e=it(t);return function(n,i){if(s=n.classList)return i?s.add(t):s.remove(t);var s=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(s)||n.setAttribute("class",nt(s+" "+t))):n.setAttribute("class",nt(s.replace(e," ")))}}function ot(t,e,n){return null==e?function(){this.style.removeProperty(t)}:"function"==typeof e?function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}:function(){this.style.setProperty(t,e,n)}}function lt(t,e){return null==e?function(){delete this[t]}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}:function(){this[t]=e}}function ct(t){return"function"==typeof t?t:(t=a.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Q&&e.documentElement.namespaceURI===Q?e.createElement(t):e.createElementNS(n,t)}}function ht(){var t=this.parentNode;t&&t.removeChild(this)}function ut(t){return{__data__:t}}function dt(t){return function(){return Y(this,t)}}function pt(t){return arguments.length||(t=g),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function mt(t,e){for(var n=0,i=t.length;n<i;n++)for(var s,a=t[n],r=0,o=a.length;r<o;r++)(s=a[r])&&e(s,r,n);return t}function ft(t){return $(t,gt),t}a.ns={prefix:tt,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),tt.hasOwnProperty(n)?{space:tt[n],local:t}:t}},G.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return(t=a.ns.qualify(t)).local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(et(e,t[e]));return this}return this.each(et(t,e))},G.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),i=(t=st(t)).length,s=-1;if(e=n.classList){for(;++s<i;)if(!e.contains(t[s]))return!1}else for(e=n.getAttribute("class");++s<i;)if(!it(t[s]).test(e))return!1;return!0}for(e in t)this.each(at(e,t[e]));return this}return this.each(at(t,e))},G.style=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=""),t)this.each(ot(n,t[n],e));return this}if(i<2){var s=this.node();return h(s).getComputedStyle(s,null).getPropertyValue(t)}n=""}return this.each(ot(t,e,n))},G.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(lt(e,t[e]));return this}return this.each(lt(t,e))},G.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},G.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},G.append=function(t){return t=ct(t),this.select((function(){return this.appendChild(t.apply(this,arguments))}))},G.insert=function(t,e){return t=ct(t),e=J(e),this.select((function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)}))},G.remove=function(){return this.each(ht)},G.data=function(t,e){var n,i,s=-1,a=this.length;if(!arguments.length){for(t=new Array(a=(n=this[0]).length);++s<a;)(i=n[s])&&(t[s]=i.__data__);return t}function r(t,n){var i,s,a,r=t.length,h=n.length,u=Math.min(r,h),d=new Array(h),p=new Array(h),m=new Array(r);if(e){var f,g=new k,y=new Array(r);for(i=-1;++i<r;)(s=t[i])&&(g.has(f=e.call(s,s.__data__,i))?m[i]=s:g.set(f,s),y[i]=f);for(i=-1;++i<h;)(s=g.get(f=e.call(n,a=n[i],i)))?!0!==s&&(d[i]=s,s.__data__=a):p[i]=ut(a),g.set(f,!0);for(i=-1;++i<r;)i in y&&!0!==g.get(y[i])&&(m[i]=t[i])}else{for(i=-1;++i<u;)s=t[i],a=n[i],s?(s.__data__=a,d[i]=s):p[i]=ut(a);for(;i<h;++i)p[i]=ut(n[i]);for(;i<r;++i)m[i]=t[i]}p.update=d,p.parentNode=d.parentNode=m.parentNode=t.parentNode,o.push(p),l.push(d),c.push(m)}var o=ft([]),l=W([]),c=W([]);if("function"==typeof t)for(;++s<a;)r(n=this[s],t.call(n,n.parentNode.__data__,s));else for(;++s<a;)r(n=this[s],t);return l.enter=function(){return o},l.exit=function(){return c},l},G.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},G.filter=function(t){var e,n,i,s=[];"function"!=typeof t&&(t=dt(t));for(var a=0,r=this.length;a<r;a++){s.push(e=[]),e.parentNode=(n=this[a]).parentNode;for(var o=0,l=n.length;o<l;o++)(i=n[o])&&t.call(i,i.__data__,o,a)&&e.push(i)}return W(s)},G.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,i=this[t],s=i.length-1,a=i[s];--s>=0;)(n=i[s])&&(a&&a!==n.nextSibling&&a.parentNode.insertBefore(n,a),a=n);return this},G.sort=function(t){t=pt.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},G.each=function(t){return mt(this,(function(e,n,i){t.call(e,e.__data__,n,i)}))},G.call=function(t){var e=o(arguments);return t.apply(e[0]=this,e),this},G.empty=function(){return!this.node()},G.node=function(){for(var t=0,e=this.length;t<e;t++)for(var n=this[t],i=0,s=n.length;i<s;i++){var a=n[i];if(a)return a}return null},G.size=function(){var t=0;return mt(this,(function(){++t})),t};var gt=[];function yt(t){var e,n;return function(i,s,a){var r,o=t[a].update,l=o.length;for(a!=n&&(n=a,e=0),s>=e&&(e=s+1);!(r=o[e])&&++e<l;);return r}}function bt(t,e,n){var i="__on"+t,s=t.indexOf("."),r=xt;s>0&&(t=t.slice(0,s));var l=vt.get(t);function c(){var e=this[i];e&&(this.removeEventListener(t,e,e.$),delete this[i])}return l&&(t=l,r=wt),s?e?function(){var s=r(e,o(arguments));c.call(this),this.addEventListener(t,this[i]=s,s.$=n),s._=e}:c:e?P:function(){var e,n=new RegExp("^__on([^.]+)"+a.requote(t)+"$");for(var i in this)if(e=i.match(n)){var s=this[i];this.removeEventListener(e[1],s,s.$),delete this[i]}}}a.selection.enter=ft,a.selection.enter.prototype=gt,gt.append=G.append,gt.empty=G.empty,gt.node=G.node,gt.call=G.call,gt.size=G.size,gt.select=function(t){for(var e,n,i,s,a,r=[],o=-1,l=this.length;++o<l;){i=(s=this[o]).update,r.push(e=[]),e.parentNode=s.parentNode;for(var c=-1,h=s.length;++c<h;)(a=s[c])?(e.push(i[c]=n=t.call(s.parentNode,a.__data__,c,o)),n.__data__=a.__data__):e.push(null)}return W(r)},gt.insert=function(t,e){return arguments.length<2&&(e=yt(this)),G.insert.call(this,t,e)},a.select=function(t){var e;return"string"==typeof t?(e=[Z(t,l)]).parentNode=l.documentElement:(e=[t]).parentNode=c(t),W([e])},a.selectAll=function(t){var e;return"string"==typeof t?(e=o(X(t,l))).parentNode=l.documentElement:(e=o(t)).parentNode=null,W([e])},G.on=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=!1),t)this.each(bt(n,t[n],e));return this}if(i<2)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(bt(t,e,n))};var vt=a.map({mouseenter:"mouseover",mouseleave:"mouseout"});function xt(t,e){return function(n){var i=a.event;a.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{a.event=i}}}function wt(t,e){var n=xt(t,e);return function(t){var e=this,i=t.relatedTarget;i&&(i===e||8&i.compareDocumentPosition(e))||n.call(e,t)}}l&&vt.forEach((function(t){"on"+t in l&&vt.remove(t)}));var Et,At=0;function jt(t){var e=".dragsuppress-"+ ++At,n="click"+e,i=a.select(h(t)).on("touchmove"+e,V).on("dragstart"+e,V).on("selectstart"+e,V);if(null==Et&&(Et=!("onselectstart"in t)&&D(t.style,"userSelect")),Et){var s=c(t).style,r=s[Et];s[Et]="none"}return function(t){if(i.on(e,null),Et&&(s[Et]=r),t){var a=function(){i.on(n,null)};i.on(n,(function(){V(),a()}),!0),setTimeout(a,0)}}}a.mouse=function(t){return Nt(t,z())};var kt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function Nt(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();if(kt<0){var s=h(t);if(s.scrollX||s.scrollY){var r=(n=a.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();kt=!(r.f||r.e),n.remove()}}return kt?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}function _t(){return a.event.changedTouches[0].identifier}a.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=z().changedTouches),e)for(var i,s=0,a=e.length;s<a;++s)if((i=e[s]).identifier===n)return Nt(t,i)},a.behavior.drag=function(){var t=F(s,"drag","dragstart","dragend"),e=null,n=r(P,a.mouse,h,"mousemove","mouseup"),i=r(_t,a.touch,I,"touchmove","touchend");function s(){this.on("mousedown.drag",n).on("touchstart.drag",i)}function r(n,i,s,r,o){return function(){var l,c=this,h=a.event.target.correspondingElement||a.event.target,u=c.parentNode,d=t.of(c,arguments),p=0,m=n(),f=".drag"+(null==m?"":"-"+m),g=a.select(s(h)).on(r+f,v).on(o+f,x),y=jt(h),b=i(u,m);function v(){var t,e,n=i(u,m);n&&(t=n[0]-b[0],e=n[1]-b[1],p|=t|e,b=n,d({type:"drag",x:n[0]+l[0],y:n[1]+l[1],dx:t,dy:e}))}function x(){i(u,m)&&(g.on(r+f,null).on(o+f,null),y(p),d({type:"dragend"}))}l=e?[(l=e.apply(c,arguments)).x-b[0],l.y-b[1]]:[0,0],d({type:"dragstart"})}}return s.origin=function(t){return arguments.length?(e=t,s):e},a.rebind(s,t,"on")},a.touches=function(t,e){return arguments.length<2&&(e=z().touches),e?o(e).map((function(e){var n=Nt(t,e);return n.identifier=e.identifier,n})):[]};var Ot=1e-6,Lt=Ot*Ot,Mt=Math.PI,Ct=2*Mt,St=Ct-Ot,Tt=Mt/2,It=Mt/180,Ut=180/Mt;function Dt(t){return t>0?1:t<0?-1:0}function Ht(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function Pt(t){return t>1?0:t<-1?Mt:Math.acos(t)}function Rt(t){return t>1?Tt:t<-1?-Tt:Math.asin(t)}function Bt(t){return((t=Math.exp(t))+1/t)/2}function Vt(t){return(t=Math.sin(t/2))*t}var zt=Math.SQRT2;a.interpolateZoom=function(t,e){var n,i,s=t[0],a=t[1],r=t[2],o=e[0],l=e[1],c=e[2],h=o-s,u=l-a,d=h*h+u*u;if(d<Lt)i=Math.log(c/r)/zt,n=function(t){return[s+t*h,a+t*u,r*Math.exp(zt*t*i)]};else{var p=Math.sqrt(d),m=(c*c-r*r+4*d)/(2*r*2*p),f=(c*c-r*r-4*d)/(2*c*2*p),g=Math.log(Math.sqrt(m*m+1)-m),y=Math.log(Math.sqrt(f*f+1)-f);i=(y-g)/zt,n=function(t){var e,n=t*i,o=Bt(g),l=r/(2*p)*(o*(e=zt*n+g,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[s+l*h,a+l*u,r*o/Bt(zt*n+g)]}}return n.duration=1e3*i,n},a.behavior.zoom=function(){var t,e,n,i,s,r,o,c,u,d={x:0,y:0,k:1},p=[960,500],m=$t,f=250,g=0,y="mousedown.zoom",b="mousemove.zoom",v="mouseup.zoom",x="touchstart.zoom",w=F(E,"zoomstart","zoom","zoomend");function E(t){t.on(y,C).on(qt+".zoom",T).on("dblclick.zoom",I).on(x,S)}function A(t){return[(t[0]-d.x)/d.k,(t[1]-d.y)/d.k]}function j(t){d.k=Math.max(m[0],Math.min(m[1],t))}function k(t,e){e=function(t){return[t[0]*d.k+d.x,t[1]*d.k+d.y]}(e),d.x+=t[0]-e[0],d.y+=t[1]-e[1]}function N(t,n,i,s){t.__chart__={x:d.x,y:d.y,k:d.k},j(Math.pow(2,s)),k(e=n,i),t=a.select(t),f>0&&(t=t.transition().duration(f)),t.call(E.event)}function _(){o&&o.domain(r.range().map((function(t){return(t-d.x)/d.k})).map(r.invert)),u&&u.domain(c.range().map((function(t){return(t-d.y)/d.k})).map(c.invert))}function O(t){g++||t({type:"zoomstart"})}function L(t){_(),t({type:"zoom",scale:d.k,translate:[d.x,d.y]})}function M(t){--g||(t({type:"zoomend"}),e=null)}function C(){var t=this,e=w.of(t,arguments),n=0,i=a.select(h(t)).on(b,o).on(v,l),s=A(a.mouse(t)),r=jt(t);function o(){n=1,k(a.mouse(t),s),L(e)}function l(){i.on(b,null).on(v,null),r(n),M(e)}Uo.call(t),O(e)}function S(){var t,e=this,n=w.of(e,arguments),i={},r=0,o=".zoom-"+a.event.changedTouches[0].identifier,l="touchmove"+o,c="touchend"+o,h=[],u=a.select(e),p=jt(e);function m(){var n=a.touches(e);return t=d.k,n.forEach((function(t){t.identifier in i&&(i[t.identifier]=A(t))})),n}function f(){var t=a.event.target;a.select(t).on(l,g).on(c,b),h.push(t);for(var n=a.event.changedTouches,o=0,u=n.length;o<u;++o)i[n[o].identifier]=null;var p=m(),f=Date.now();if(1===p.length){if(f-s<500){var y=p[0];N(e,y,i[y.identifier],Math.floor(Math.log(d.k)/Math.LN2)+1),V()}s=f}else if(p.length>1){y=p[0];var v=p[1],x=y[0]-v[0],w=y[1]-v[1];r=x*x+w*w}}function g(){var o,l,c,h,u=a.touches(e);Uo.call(e);for(var d=0,p=u.length;d<p;++d,h=null)if(c=u[d],h=i[c.identifier]){if(l)break;o=c,l=h}if(h){var m=(m=c[0]-o[0])*m+(m=c[1]-o[1])*m,f=r&&Math.sqrt(m/r);o=[(o[0]+c[0])/2,(o[1]+c[1])/2],l=[(l[0]+h[0])/2,(l[1]+h[1])/2],j(f*t)}s=null,k(o,l),L(n)}function b(){if(a.event.touches.length){for(var t=a.event.changedTouches,e=0,s=t.length;e<s;++e)delete i[t[e].identifier];for(var r in i)return void m()}a.selectAll(h).on(o,null),u.on(y,C).on(x,S),p(),M(n)}f(),O(n),u.on(y,null).on(x,f)}function T(){var s=w.of(this,arguments);i?clearTimeout(i):(Uo.call(this),t=A(e=n||a.mouse(this)),O(s)),i=setTimeout((function(){i=null,M(s)}),50),V(),j(Math.pow(2,.002*Ft())*d.k),k(e,t),L(s)}function I(){var t=a.mouse(this),e=Math.log(d.k)/Math.LN2;N(this,t,A(t),a.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}return qt||(qt="onwheel"in l?(Ft=function(){return-a.event.deltaY*(a.event.deltaMode?120:1)},"wheel"):"onmousewheel"in l?(Ft=function(){return a.event.wheelDelta},"mousewheel"):(Ft=function(){return-a.event.detail},"MozMousePixelScroll")),E.event=function(t){t.each((function(){var t=w.of(this,arguments),n=d;Po?a.select(this).transition().each("start.zoom",(function(){d=this.__chart__||{x:0,y:0,k:1},O(t)})).tween("zoom:zoom",(function(){var i=p[0],s=p[1],r=e?e[0]:i/2,o=e?e[1]:s/2,l=a.interpolateZoom([(r-d.x)/d.k,(o-d.y)/d.k,i/d.k],[(r-n.x)/n.k,(o-n.y)/n.k,i/n.k]);return function(e){var n=l(e),s=i/n[2];this.__chart__=d={x:r-n[0]*s,y:o-n[1]*s,k:s},L(t)}})).each("interrupt.zoom",(function(){M(t)})).each("end.zoom",(function(){M(t)})):(this.__chart__=d,O(t),L(t),M(t))}))},E.translate=function(t){return arguments.length?(d={x:+t[0],y:+t[1],k:d.k},_(),E):[d.x,d.y]},E.scale=function(t){return arguments.length?(d={x:d.x,y:d.y,k:null},j(+t),_(),E):d.k},E.scaleExtent=function(t){return arguments.length?(m=null==t?$t:[+t[0],+t[1]],E):m},E.center=function(t){return arguments.length?(n=t&&[+t[0],+t[1]],E):n},E.size=function(t){return arguments.length?(p=t&&[+t[0],+t[1]],E):p},E.duration=function(t){return arguments.length?(f=+t,E):f},E.x=function(t){return arguments.length?(o=t,r=t.copy(),d={x:0,y:0,k:1},E):o},E.y=function(t){return arguments.length?(u=t,c=t.copy(),d={x:0,y:0,k:1},E):u},a.rebind(E,w,"on")};var Ft,qt,$t=[0,1/0];function Wt(){}function Zt(t,e,n){return this instanceof Zt?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof Zt?new Zt(t.h,t.s,t.l):me(""+t,fe,Zt):new Zt(t,e,n)}a.color=Wt,Wt.prototype.toString=function(){return this.rgb()+""},a.hsl=Zt;var Xt=Zt.prototype=new Wt;function Yt(t,e,n){var i,s;function a(t){return Math.round(255*function(t){return t>360?t-=360:t<0&&(t+=360),t<60?i+(s-i)*t/60:t<180?s:t<240?i+(s-i)*(240-t)/60:i}(t))}return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)||e<0?0:e>1?1:e,i=2*(n=n<0?0:n>1?1:n)-(s=n<=.5?n*(1+e):n+e-n*e),new ce(a(t+120),a(t),a(t-120))}function Gt(t,e,n){return this instanceof Gt?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof Gt?new Gt(t.h,t.c,t.l):ae(t instanceof Qt?t.l:(t=ge((t=a.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new Gt(t,e,n)}Xt.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new Zt(this.h,this.s,this.l/t)},Xt.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new Zt(this.h,this.s,t*this.l)},Xt.rgb=function(){return Yt(this.h,this.s,this.l)},a.hcl=Gt;var Jt=Gt.prototype=new Wt;function Kt(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new Qt(n,Math.cos(t*=It)*e,Math.sin(t)*e)}function Qt(t,e,n){return this instanceof Qt?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof Qt?new Qt(t.l,t.a,t.b):t instanceof Gt?Kt(t.h,t.c,t.l):ge((t=ce(t)).r,t.g,t.b):new Qt(t,e,n)}Jt.brighter=function(t){return new Gt(this.h,this.c,Math.min(100,this.l+te*(arguments.length?t:1)))},Jt.darker=function(t){return new Gt(this.h,this.c,Math.max(0,this.l-te*(arguments.length?t:1)))},Jt.rgb=function(){return Kt(this.h,this.c,this.l).rgb()},a.lab=Qt;var te=18,ee=.95047,ne=1.08883,ie=Qt.prototype=new Wt;function se(t,e,n){var i=(t+16)/116,s=i+e/500,a=i-n/200;return new ce(le(3.2404542*(s=re(s)*ee)-1.5371385*(i=1*re(i))-.4985314*(a=re(a)*ne)),le(-.969266*s+1.8760108*i+.041556*a),le(.0556434*s-.2040259*i+1.0572252*a))}function ae(t,e,n){return t>0?new Gt(Math.atan2(n,e)*Ut,Math.sqrt(e*e+n*n),t):new Gt(NaN,NaN,t)}function re(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function oe(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function le(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function ce(t,e,n){return this instanceof ce?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof ce?new ce(t.r,t.g,t.b):me(""+t,ce,Yt):new ce(t,e,n)}function he(t){return new ce(t>>16,t>>8&255,255&t)}function ue(t){return he(t)+""}ie.brighter=function(t){return new Qt(Math.min(100,this.l+te*(arguments.length?t:1)),this.a,this.b)},ie.darker=function(t){return new Qt(Math.max(0,this.l-te*(arguments.length?t:1)),this.a,this.b)},ie.rgb=function(){return se(this.l,this.a,this.b)},a.rgb=ce;var de=ce.prototype=new Wt;function pe(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function me(t,e,n){var i,s,a,r=0,o=0,l=0;if(i=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(s=i[2].split(","),i[1]){case"hsl":return n(parseFloat(s[0]),parseFloat(s[1])/100,parseFloat(s[2])/100);case"rgb":return e(be(s[0]),be(s[1]),be(s[2]))}return(a=ve.get(t))?e(a.r,a.g,a.b):(null==t||"#"!==t.charAt(0)||isNaN(a=parseInt(t.slice(1),16))||(4===t.length?(r=(3840&a)>>4,r|=r>>4,o=240&a,o|=o>>4,l=15&a,l|=l<<4):7===t.length&&(r=(16711680&a)>>16,o=(65280&a)>>8,l=255&a)),e(r,o,l))}function fe(t,e,n){var i,s,a=Math.min(t/=255,e/=255,n/=255),r=Math.max(t,e,n),o=r-a,l=(r+a)/2;return o?(s=l<.5?o/(r+a):o/(2-r-a),i=t==r?(e-n)/o+(e<n?6:0):e==r?(n-t)/o+2:(t-e)/o+4,i*=60):(i=NaN,s=l>0&&l<1?0:i),new Zt(i,s,l)}function ge(t,e,n){var i=oe((.4124564*(t=ye(t))+.3575761*(e=ye(e))+.1804375*(n=ye(n)))/ee),s=oe((.2126729*t+.7151522*e+.072175*n)/1);return Qt(116*s-16,500*(i-s),200*(s-oe((.0193339*t+.119192*e+.9503041*n)/ne)))}function ye(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function be(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}de.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,s=30;return e||n||i?(e&&e<s&&(e=s),n&&n<s&&(n=s),i&&i<s&&(i=s),new ce(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,i/t))):new ce(s,s,s)},de.darker=function(t){return new ce((t=Math.pow(.7,arguments.length?t:1))*this.r,t*this.g,t*this.b)},de.hsl=function(){return fe(this.r,this.g,this.b)},de.toString=function(){return"#"+pe(this.r)+pe(this.g)+pe(this.b)};var ve=a.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function xe(t){return"function"==typeof t?t:function(){return t}}function we(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),Ee(e,n,t,i)}}function Ee(t,e,n,i){var s={},r=a.dispatch("beforesend","progress","load","error"),l={},c=new XMLHttpRequest,h=null;function u(){var t,e=c.status;if(!e&&function(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}(c)||e>=200&&e<300||304===e){try{t=n.call(s,c)}catch(t){return void r.error.call(s,t)}r.load.call(s,t)}else r.error.call(s,c)}return this.XDomainRequest&&!("withCredentials"in c)&&/^(http(s)?:)?\/\//.test(t)&&(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=u:c.onreadystatechange=function(){c.readyState>3&&u()},c.onprogress=function(t){var e=a.event;a.event=t;try{r.progress.call(s,c)}finally{a.event=e}},s.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l[t]:(null==e?delete l[t]:l[t]=e+"",s)},s.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",s):e},s.responseType=function(t){return arguments.length?(h=t,s):h},s.response=function(t){return n=t,s},["get","post"].forEach((function(t){s[t]=function(){return s.send.apply(s,[t].concat(o(arguments)))}})),s.send=function(n,i,a){if(2===arguments.length&&"function"==typeof i&&(a=i,i=null),c.open(n,t,!0),null==e||"accept"in l||(l.accept=e+",*/*"),c.setRequestHeader)for(var o in l)c.setRequestHeader(o,l[o]);return null!=e&&c.overrideMimeType&&c.overrideMimeType(e),null!=h&&(c.responseType=h),null!=a&&s.on("error",a).on("load",(function(t){a(null,t)})),r.beforesend.call(s,c),c.send(null==i?null:i),s},s.abort=function(){return c.abort(),s},a.rebind(s,r,"on"),null==i?s:s.get(function(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}(i))}ve.forEach((function(t,e){ve.set(t,he(e))})),a.functor=xe,a.xhr=we(I),a.dsv=function(t,e){var n=new RegExp('["'+t+"\n]"),i=t.charCodeAt(0);function s(t,n,i){arguments.length<3&&(i=n,n=null);var s=Ee(t,e,null==n?a:r(n),i);return s.row=function(t){return arguments.length?s.response(null==(n=t)?a:r(t)):n},s}function a(t){return s.parse(t.responseText)}function r(t){return function(e){return s.parse(e.responseText,t)}}function o(e){return e.map(l).join(t)}function l(t){return n.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}return s.parse=function(t,e){var n;return s.parseRows(t,(function(t,i){if(n)return n(t,i-1);var s=new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+"]"})).join(",")+"}");n=e?function(t,n){return e(s(t),n)}:s}))},s.parseRows=function(t,e){var n,s,a={},r={},o=[],l=t.length,c=0,h=0;function u(){if(c>=l)return r;if(s)return s=!1,a;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<l;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}return c=n+2,13===(o=t.charCodeAt(n+1))?(s=!0,10===t.charCodeAt(n+2)&&++c):10===o&&(s=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;c<l;){var o,h=1;if(10===(o=t.charCodeAt(c++)))s=!0;else if(13===o)s=!0,10===t.charCodeAt(c)&&(++c,++h);else if(o!==i)continue;return t.slice(e,c-h)}return t.slice(e)}for(;(n=u())!==r;){for(var d=[];n!==a&&n!==r;)d.push(n),n=u();e&&null==(d=e(d,h++))||o.push(d)}return o},s.format=function(e){if(Array.isArray(e[0]))return s.formatRows(e);var n=new T,i=[];return e.forEach((function(t){for(var e in t)n.has(e)||i.push(n.add(e))})),[i.map(l).join(t)].concat(e.map((function(e){return i.map((function(t){return l(e[t])})).join(t)}))).join("\n")},s.formatRows=function(t){return t.map(o).join("\n")},s},a.csv=a.dsv(",","text/csv"),a.tsv=a.dsv("\t","text/tab-separated-values");var Ae,je,ke,Ne,_e=this[D(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};function Oe(t,e,n){var i=arguments.length;i<2&&(e=0),i<3&&(n=Date.now());var s=n+e,a={c:t,t:s,n:null};return je?je.n=a:Ae=a,je=a,ke||(Ne=clearTimeout(Ne),ke=1,_e(Le)),a}function Le(){var t=Me(),e=Ce()-t;e>24?(isFinite(e)&&(clearTimeout(Ne),Ne=setTimeout(Le,e)),ke=0):(ke=1,_e(Le))}function Me(){for(var t=Date.now(),e=Ae;e;)t>=e.t&&e.c(t-e.t)&&(e.c=null),e=e.n;return t}function Ce(){for(var t,e=Ae,n=1/0;e;)e.c?(e.t<n&&(n=e.t),e=(t=e).n):e=t?t.n=e.n:Ae=e.n;return je=t,n}function Se(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}a.timer=function(){Oe.apply(this,arguments)},a.timer.flush=function(){Me(),Ce()},a.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var Te=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map((function(t,e){var n=Math.pow(10,3*E(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}));function Ie(t){var e=t.decimal,n=t.thousands,i=t.grouping,s=t.currency,r=i&&n?function(t,e){for(var s=t.length,a=[],r=0,o=i[0],l=0;s>0&&o>0&&(l+o+1>e&&(o=Math.max(1,e-l)),a.push(t.substring(s-=o,s+o)),!((l+=o+1)>e));)o=i[r=(r+1)%i.length];return a.reverse().join(n)}:I;return function(t){var n=Ue.exec(t),i=n[1]||" ",o=n[2]||">",l=n[3]||"-",c=n[4]||"",h=n[5],u=+n[6],d=n[7],p=n[8],m=n[9],f=1,g="",y="",b=!1,v=!0;switch(p&&(p=+p.substring(1)),(h||"0"===i&&"="===o)&&(h=i="0",o="="),m){case"n":d=!0,m="g";break;case"%":f=100,y="%",m="f";break;case"p":f=100,y="%",m="r";break;case"b":case"o":case"x":case"X":"#"===c&&(g="0"+m.toLowerCase());case"c":v=!1;case"d":b=!0,p=0;break;case"s":f=-1,m="r"}"$"===c&&(g=s[0],y=s[1]),"r"!=m||p||(m="g"),null!=p&&("g"==m?p=Math.max(1,Math.min(21,p)):"e"!=m&&"f"!=m||(p=Math.max(0,Math.min(20,p)))),m=De.get(m)||He;var x=h&&d;return function(t){var n=y;if(b&&t%1)return"";var s=t<0||0===t&&1/t<0?(t=-t,"-"):"-"===l?"":l;if(f<0){var c=a.formatPrefix(t,p);t=c.scale(t),n=c.symbol+y}else t*=f;var w,E,A=(t=m(t,p)).lastIndexOf(".");if(A<0){var j=v?t.lastIndexOf("e"):-1;j<0?(w=t,E=""):(w=t.substring(0,j),E=t.substring(j))}else w=t.substring(0,A),E=e+t.substring(A+1);!h&&d&&(w=r(w,1/0));var k=g.length+w.length+E.length+(x?0:s.length),N=k<u?new Array(k=u-k+1).join(i):"";return x&&(w=r(N+w,N.length?u-E.length:1/0)),s+=g,t=w+E,("<"===o?s+t+N:">"===o?N+s+t:"^"===o?N.substring(0,k>>=1)+s+t+N.substring(k):s+(x?t:N+t))+n}}}a.formatPrefix=function(t,e){var n=0;return(t=+t)&&(t<0&&(t*=-1),e&&(t=a.round(t,Se(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),Te[8+n/3]};var Ue=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,De=a.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=a.round(t,Se(t,e))).toFixed(Math.max(0,Math.min(20,Se(t*(1+1e-15),e))))}});function He(t){return t+""}var Pe=a.time={},Re=Date;function Be(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}Be.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Ve.setUTCDate.apply(this._,arguments)},setDay:function(){Ve.setUTCDay.apply(this._,arguments)},setFullYear:function(){Ve.setUTCFullYear.apply(this._,arguments)},setHours:function(){Ve.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Ve.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Ve.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Ve.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Ve.setUTCSeconds.apply(this._,arguments)},setTime:function(){Ve.setTime.apply(this._,arguments)}};var Ve=Date.prototype;function ze(t,e,n){function i(e){var n=t(e),i=a(n,1);return e-n<i-e?n:i}function s(n){return e(n=t(new Re(n-1)),1),n}function a(t,n){return e(t=new Re(+t),n),t}function r(t,i,a){var r=s(t),o=[];if(a>1)for(;r<i;)n(r)%a||o.push(new Date(+r)),e(r,1);else for(;r<i;)o.push(new Date(+r)),e(r,1);return o}t.floor=t,t.round=i,t.ceil=s,t.offset=a,t.range=r;var o=t.utc=Fe(t);return o.floor=o,o.round=Fe(i),o.ceil=Fe(s),o.offset=Fe(a),o.range=function(t,e,n){try{Re=Be;var i=new Be;return i._=t,r(i,e,n)}finally{Re=Date}},t}function Fe(t){return function(e,n){try{Re=Be;var i=new Be;return i._=e,t(i,n)._}finally{Re=Date}}}function qe(t){var e=t.dateTime,n=t.date,i=t.time,s=t.periods,r=t.days,o=t.shortDays,l=t.months,c=t.shortMonths;function h(t){var e=t.length;function n(n){for(var i,s,a,r=[],o=-1,l=0;++o<e;)37===t.charCodeAt(o)&&(r.push(t.slice(l,o)),null!=(s=$e[i=t.charAt(++o)])&&(i=t.charAt(++o)),(a=w[i])&&(i=a(n,null==s?"e"===i?" ":"0":s)),r.push(i),l=o+1);return r.push(t.slice(l,o)),r.join("")}return n.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(u(n,t,e,0)!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var i=null!=n.Z&&Re!==Be,s=new(i?Be:Re);return"j"in n?s.setFullYear(n.y,0,n.j):"W"in n||"U"in n?("w"in n||(n.w="W"in n?1:0),s.setFullYear(n.y,0,1),s.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(s.getDay()+5)%7:n.w+7*n.U-(s.getDay()+6)%7)):s.setFullYear(n.y,n.m,n.d),s.setHours(n.H+(n.Z/100|0),n.M+n.Z%100,n.S,n.L),i?s._:s},n.toString=function(){return t},n}function u(t,e,n,i){for(var s,a,r,o=0,l=e.length,c=n.length;o<l;){if(i>=c)return-1;if(37===(s=e.charCodeAt(o++))){if(r=e.charAt(o++),!(a=E[r in $e?e.charAt(o++):r])||(i=a(t,n,i))<0)return-1}else if(s!=n.charCodeAt(i++))return-1}return i}h.utc=function(t){var e=h(t);function n(t){try{var n=new(Re=Be);return n._=t,e(n)}finally{Re=Date}}return n.parse=function(t){try{Re=Be;var n=e.parse(t);return n&&n._}finally{Re=Date}},n.toString=e.toString,n},h.multi=h.utc.multi=pn;var d=a.map(),p=Ye(r),m=Ge(r),f=Ye(o),g=Ge(o),y=Ye(l),b=Ge(l),v=Ye(c),x=Ge(c);s.forEach((function(t,e){d.set(t.toLowerCase(),e)}));var w={a:function(t){return o[t.getDay()]},A:function(t){return r[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return l[t.getMonth()]},c:h(e),d:function(t,e){return Xe(t.getDate(),e,2)},e:function(t,e){return Xe(t.getDate(),e,2)},H:function(t,e){return Xe(t.getHours(),e,2)},I:function(t,e){return Xe(t.getHours()%12||12,e,2)},j:function(t,e){return Xe(1+Pe.dayOfYear(t),e,3)},L:function(t,e){return Xe(t.getMilliseconds(),e,3)},m:function(t,e){return Xe(t.getMonth()+1,e,2)},M:function(t,e){return Xe(t.getMinutes(),e,2)},p:function(t){return s[+(t.getHours()>=12)]},S:function(t,e){return Xe(t.getSeconds(),e,2)},U:function(t,e){return Xe(Pe.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Xe(Pe.mondayOfYear(t),e,2)},x:h(n),X:h(i),y:function(t,e){return Xe(t.getFullYear()%100,e,2)},Y:function(t,e){return Xe(t.getFullYear()%1e4,e,4)},Z:un,"%":function(){return"%"}},E={a:function(t,e,n){f.lastIndex=0;var i=f.exec(e.slice(n));return i?(t.w=g.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(t,e,n){p.lastIndex=0;var i=p.exec(e.slice(n));return i?(t.w=m.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(t,e,n){v.lastIndex=0;var i=v.exec(e.slice(n));return i?(t.m=x.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(t,e,n){y.lastIndex=0;var i=y.exec(e.slice(n));return i?(t.m=b.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(t,e,n){return u(t,w.c.toString(),e,n)},d:an,e:an,H:on,I:on,j:rn,L:hn,m:sn,M:ln,p:function(t,e,n){var i=d.get(e.slice(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)},S:cn,U:Ke,w:Je,W:Qe,x:function(t,e,n){return u(t,w.x.toString(),e,n)},X:function(t,e,n){return u(t,w.X.toString(),e,n)},y:en,Y:tn,Z:nn,"%":dn};return h}Pe.year=ze((function(t){return(t=Pe.day(t)).setMonth(0,1),t}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t){return t.getFullYear()})),Pe.years=Pe.year.range,Pe.years.utc=Pe.year.utc.range,Pe.day=ze((function(t){var e=new Re(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t){return t.getDate()-1})),Pe.days=Pe.day.range,Pe.days.utc=Pe.day.utc.range,Pe.dayOfYear=function(t){var e=Pe.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach((function(t,e){e=7-e;var n=Pe[t]=ze((function(t){return(t=Pe.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t}),(function(t,e){t.setDate(t.getDate()+7*Math.floor(e))}),(function(t){var n=Pe.year(t).getDay();return Math.floor((Pe.dayOfYear(t)+(n+e)%7)/7)-(n!==e)}));Pe[t+"s"]=n.range,Pe[t+"s"].utc=n.utc.range,Pe[t+"OfYear"]=function(t){var n=Pe.year(t).getDay();return Math.floor((Pe.dayOfYear(t)+(n+e)%7)/7)}})),Pe.week=Pe.sunday,Pe.weeks=Pe.sunday.range,Pe.weeks.utc=Pe.sunday.utc.range,Pe.weekOfYear=Pe.sundayOfYear;var $e={"-":"",_:" ",0:"0"},We=/^\s*\d+/,Ze=/^%/;function Xe(t,e,n){var i=t<0?"-":"",s=(i?-t:t)+"",a=s.length;return i+(a<n?new Array(n-a+1).join(e)+s:s)}function Ye(t){return new RegExp("^(?:"+t.map(a.requote).join("|")+")","i")}function Ge(t){for(var e=new k,n=-1,i=t.length;++n<i;)e.set(t[n].toLowerCase(),n);return e}function Je(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Ke(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function Qe(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function tn(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function en(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.y=function(t){return t+(t>68?1900:2e3)}(+i[0]),n+i[0].length):-1}function nn(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function sn(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function an(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function rn(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1}function on(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function ln(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function cn(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function hn(t,e,n){We.lastIndex=0;var i=We.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function un(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=E(e)/60|0,s=E(e)%60;return n+Xe(i,"0",2)+Xe(s,"0",2)}function dn(t,e,n){Ze.lastIndex=0;var i=Ze.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function pn(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,i=t[n];!i[1](e);)i=t[++n];return i[0](e)}}a.locale=function(t){return{numberFormat:Ie(t),timeFormat:qe(t)}};var mn=a.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function fn(){}a.format=mn.numberFormat,a.geo={},fn.prototype={s:0,t:0,add:function(t){yn(t,this.t,gn),yn(gn.s,this.s,this),this.s?this.t+=gn.t:this.s=gn.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var gn=new fn;function yn(t,e,n){var i=n.s=t+e,s=i-t,a=i-s;n.t=t-a+(e-s)}function bn(t,e){t&&xn.hasOwnProperty(t.type)&&xn[t.type](t,e)}a.geo.stream=function(t,e){t&&vn.hasOwnProperty(t.type)?vn[t.type](t,e):bn(t,e)};var vn={Feature:function(t,e){bn(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,s=n.length;++i<s;)bn(n[i].geometry,e)}},xn={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){wn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)wn(n[i],e,0)},Polygon:function(t,e){En(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)En(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,s=n.length;++i<s;)bn(n[i],e)}};function wn(t,e,n){var i,s=-1,a=t.length-n;for(e.lineStart();++s<a;)i=t[s],e.point(i[0],i[1],i[2]);e.lineEnd()}function En(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)wn(t[n],e,1);e.polygonEnd()}a.geo.area=function(t){return An=0,a.geo.stream(t,Dn),An};var An,jn,kn,Nn,_n,On,Ln,Mn,Cn,Sn,Tn,In,Un=new fn,Dn={sphere:function(){An+=4*Mt},point:P,lineStart:P,lineEnd:P,polygonStart:function(){Un.reset(),Dn.lineStart=Hn},polygonEnd:function(){var t=2*Un;An+=t<0?4*Mt+t:t,Dn.lineStart=Dn.lineEnd=Dn.point=P}};function Hn(){var t,e,n,i,s;function a(t,e){e=e*It/2+Mt/4;var a=(t*=It)-n,r=a>=0?1:-1,o=r*a,l=Math.cos(e),c=Math.sin(e),h=s*c,u=i*l+h*Math.cos(o),d=h*r*Math.sin(o);Un.add(Math.atan2(d,u)),n=t,i=l,s=c}Dn.point=function(r,o){Dn.point=a,n=(t=r)*It,i=Math.cos(o=(e=o)*It/2+Mt/4),s=Math.sin(o)},Dn.lineEnd=function(){a(t,e)}}function Pn(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function Rn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Bn(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Vn(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function zn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Fn(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function qn(t){return[Math.atan2(t[1],t[0]),Rt(t[2])]}function $n(t,e){return E(t[0]-e[0])<Ot&&E(t[1]-e[1])<Ot}a.geo.bounds=function(){var t,e,n,i,s,r,o,l,c,h,u,d={point:p,lineStart:f,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=b,d.lineEnd=v,c=0,Dn.polygonStart()},polygonEnd:function(){Dn.polygonEnd(),d.point=p,d.lineStart=f,d.lineEnd=g,Un<0?(t=-(n=180),e=-(i=90)):c>Ot?i=90:c<-Ot&&(e=-90),u[0]=t,u[1]=n}};function p(s,a){h.push(u=[t=s,n=s]),a<e&&(e=a),a>i&&(i=a)}function m(a,r){var o=Pn([a*It,r*It]);if(l){var c=Bn(l,o),h=Bn([c[1],-c[0],0],c);Fn(h),h=qn(h);var u=a-s,d=u>0?1:-1,m=h[0]*Ut*d,f=E(u)>180;if(f^(d*s<m&&m<d*a))(g=h[1]*Ut)>i&&(i=g);else if(f^(d*s<(m=(m+360)%360-180)&&m<d*a)){var g;(g=-h[1]*Ut)<e&&(e=g)}else r<e&&(e=r),r>i&&(i=r);f?a<s?x(t,a)>x(t,n)&&(n=a):x(a,n)>x(t,n)&&(t=a):n>=t?(a<t&&(t=a),a>n&&(n=a)):a>s?x(t,a)>x(t,n)&&(n=a):x(a,n)>x(t,n)&&(t=a)}else p(a,r);l=o,s=a}function f(){d.point=m}function g(){u[0]=t,u[1]=n,d.point=p,l=null}function y(t,e){if(l){var n=t-s;c+=E(n)>180?n+(n>0?360:-360):n}else r=t,o=e;Dn.point(t,e),m(t,e)}function b(){Dn.lineStart()}function v(){y(r,o),Dn.lineEnd(),E(c)>Ot&&(t=-(n=180)),u[0]=t,u[1]=n,l=null}function x(t,e){return(e-=t)<0?e+360:e}function w(t,e){return t[0]-e[0]}function A(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}return function(s){if(i=n=-(t=e=1/0),h=[],a.geo.stream(s,d),c=h.length){h.sort(w);for(var r=1,o=[f=h[0]];r<c;++r)A((p=h[r])[0],f)||A(p[1],f)?(x(f[0],p[1])>x(f[0],f[1])&&(f[1]=p[1]),x(p[0],f[1])>x(f[0],f[1])&&(f[0]=p[0])):o.push(f=p);for(var l,c,p,m=-1/0,f=(r=0,o[c=o.length-1]);r<=c;f=p,++r)p=o[r],(l=x(f[1],p[0]))>m&&(m=l,t=p[0],n=f[1])}return h=u=null,t===1/0||e===1/0?[[NaN,NaN],[NaN,NaN]]:[[t,e],[n,i]]}}(),a.geo.centroid=function(t){jn=kn=Nn=_n=On=Ln=Mn=Cn=Sn=Tn=In=0,a.geo.stream(t,Wn);var e=Sn,n=Tn,i=In,s=e*e+n*n+i*i;return s<Lt&&(e=Ln,n=Mn,i=Cn,kn<Ot&&(e=Nn,n=_n,i=On),(s=e*e+n*n+i*i)<Lt)?[NaN,NaN]:[Math.atan2(n,e)*Ut,Rt(i/Math.sqrt(s))*Ut]};var Wn={sphere:P,point:Zn,lineStart:Yn,lineEnd:Gn,polygonStart:function(){Wn.lineStart=Jn},polygonEnd:function(){Wn.lineStart=Yn}};function Zn(t,e){t*=It;var n=Math.cos(e*=It);Xn(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function Xn(t,e,n){++jn,Nn+=(t-Nn)/jn,_n+=(e-_n)/jn,On+=(n-On)/jn}function Yn(){var t,e,n;function i(i,s){i*=It;var a=Math.cos(s*=It),r=a*Math.cos(i),o=a*Math.sin(i),l=Math.sin(s),c=Math.atan2(Math.sqrt((c=e*l-n*o)*c+(c=n*r-t*l)*c+(c=t*o-e*r)*c),t*r+e*o+n*l);kn+=c,Ln+=c*(t+(t=r)),Mn+=c*(e+(e=o)),Cn+=c*(n+(n=l)),Xn(t,e,n)}Wn.point=function(s,a){s*=It;var r=Math.cos(a*=It);t=r*Math.cos(s),e=r*Math.sin(s),n=Math.sin(a),Wn.point=i,Xn(t,e,n)}}function Gn(){Wn.point=Zn}function Jn(){var t,e,n,i,s;function a(t,e){t*=It;var a=Math.cos(e*=It),r=a*Math.cos(t),o=a*Math.sin(t),l=Math.sin(e),c=i*l-s*o,h=s*r-n*l,u=n*o-i*r,d=Math.sqrt(c*c+h*h+u*u),p=n*r+i*o+s*l,m=d&&-Pt(p)/d,f=Math.atan2(d,p);Sn+=m*c,Tn+=m*h,In+=m*u,kn+=f,Ln+=f*(n+(n=r)),Mn+=f*(i+(i=o)),Cn+=f*(s+(s=l)),Xn(n,i,s)}Wn.point=function(r,o){t=r,e=o,Wn.point=a,r*=It;var l=Math.cos(o*=It);n=l*Math.cos(r),i=l*Math.sin(r),s=Math.sin(o),Xn(n,i,s)},Wn.lineEnd=function(){a(t,e),Wn.lineEnd=Gn,Wn.point=Zn}}function Kn(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function Qn(){return!0}function ti(t,e,n,i,s){var a=[],r=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],i=t[e];if($n(n,i)){s.lineStart();for(var o=0;o<e;++o)s.point((n=t[o])[0],n[1]);s.lineEnd()}else{var l=new ni(n,t,null,!0),c=new ni(n,null,l,!1);l.o=c,a.push(l),r.push(c),l=new ni(i,t,null,!1),c=new ni(i,null,l,!0),l.o=c,a.push(l),r.push(c)}}})),r.sort(e),ei(a),ei(r),a.length){for(var o=0,l=n,c=r.length;o<c;++o)r[o].e=l=!l;for(var h,u,d=a[0];;){for(var p=d,m=!0;p.v;)if((p=p.n)===d)return;h=p.z,s.lineStart();do{if(p.v=p.o.v=!0,p.e){if(m)for(o=0,c=h.length;o<c;++o)s.point((u=h[o])[0],u[1]);else i(p.x,p.n.x,1,s);p=p.n}else{if(m)for(o=(h=p.p.z).length-1;o>=0;--o)s.point((u=h[o])[0],u[1]);else i(p.x,p.p.x,-1,s);p=p.p}h=(p=p.o).z,m=!m}while(!p.v);s.lineEnd()}}}function ei(t){if(e=t.length){for(var e,n,i=0,s=t[0];++i<e;)s.n=n=t[i],n.p=s,s=n;s.n=n=t[0],n.p=s}}function ni(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function ii(t,e,n,i){return function(s,r){var o,l=e(r),c=s.invert(i[0],i[1]),h={point:u,lineStart:p,lineEnd:m,polygonStart:function(){h.point=x,h.lineStart=w,h.lineEnd=E,o=[],f=[]},polygonEnd:function(){h.point=u,h.lineStart=p,h.lineEnd=m,o=a.merge(o);var t=function(t,e){var n=t[0],i=t[1],s=[Math.sin(n),-Math.cos(n),0],a=0,r=0;Un.reset();for(var o=0,l=e.length;o<l;++o){var c=e[o],h=c.length;if(h)for(var u=c[0],d=u[0],p=u[1]/2+Mt/4,m=Math.sin(p),f=Math.cos(p),g=1;;){g===h&&(g=0);var y=(t=c[g])[0],b=t[1]/2+Mt/4,v=Math.sin(b),x=Math.cos(b),w=y-d,E=w>=0?1:-1,A=E*w,j=A>Mt,k=m*v;if(Un.add(Math.atan2(k*E*Math.sin(A),f*x+k*Math.cos(A))),a+=j?w+E*Ct:w,j^d>=n^y>=n){var N=Bn(Pn(u),Pn(t));Fn(N);var _=Bn(s,N);Fn(_);var O=(j^w>=0?-1:1)*Rt(_[2]);(i>O||i===O&&(N[0]||N[1]))&&(r+=j^w>=0?1:-1)}if(!g++)break;d=y,m=v,f=x,u=t}}return(a<-Ot||a<Ot&&Un<-Ot)^1&r}(c,f);o.length?(v||(r.polygonStart(),v=!0),ti(o,ri,t,n,r)):t&&(v||(r.polygonStart(),v=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),v&&(r.polygonEnd(),v=!1),o=f=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function u(e,n){var i=s(e,n);t(e=i[0],n=i[1])&&r.point(e,n)}function d(t,e){var n=s(t,e);l.point(n[0],n[1])}function p(){h.point=d,l.lineStart()}function m(){h.point=u,l.lineEnd()}var f,g,y=ai(),b=e(y),v=!1;function x(t,e){g.push([t,e]);var n=s(t,e);b.point(n[0],n[1])}function w(){b.lineStart(),g=[]}function E(){x(g[0][0],g[0][1]),b.lineEnd();var t,e=b.clean(),n=y.buffer(),i=n.length;if(g.pop(),f.push(g),g=null,i)if(1&e){var s,a=-1;if((i=(t=n[0]).length-1)>0){for(v||(r.polygonStart(),v=!0),r.lineStart();++a<i;)r.point((s=t[a])[0],s[1]);r.lineEnd()}}else i>1&&2&e&&n.push(n.pop().concat(n.shift())),o.push(n.filter(si))}return h}}function si(t){return t.length>1}function ai(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:P,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function ri(t,e){return((t=t.x)[0]<0?t[1]-Tt-Ot:Tt-t[1])-((e=e.x)[0]<0?e[1]-Tt-Ot:Tt-e[1])}var oi=ii(Qn,(function(t){var e,n=NaN,i=NaN,s=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,r){var o=a>0?Mt:-Mt,l=E(a-n);E(l-Mt)<Ot?(t.point(n,i=(i+r)/2>0?Tt:-Tt),t.point(s,i),t.lineEnd(),t.lineStart(),t.point(o,i),t.point(a,i),e=0):s!==o&&l>=Mt&&(E(n-s)<Ot&&(n-=s*Ot),E(a-o)<Ot&&(a-=o*Ot),i=function(t,e,n,i){var s,a,r=Math.sin(t-n);return E(r)>Ot?Math.atan((Math.sin(e)*(a=Math.cos(i))*Math.sin(n)-Math.sin(i)*(s=Math.cos(e))*Math.sin(t))/(s*a*r)):(e+i)/2}(n,i,a,r),t.point(s,i),t.lineEnd(),t.lineStart(),t.point(o,i),e=0),t.point(n=a,i=r),s=o},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var s;if(null==t)s=n*Tt,i.point(-Mt,s),i.point(0,s),i.point(Mt,s),i.point(Mt,0),i.point(Mt,-s),i.point(0,-s),i.point(-Mt,-s),i.point(-Mt,0),i.point(-Mt,s);else if(E(t[0]-e[0])>Ot){var a=t[0]<e[0]?Mt:-Mt;s=n*a/2,i.point(-a,s),i.point(0,s),i.point(a,s)}else i.point(e[0],e[1])}),[-Mt,-Mt/2]);function li(t){var e=Math.cos(t),n=e>0,i=E(e)>Ot;return ii(s,(function(t){var e,o,l,c,h;return{lineStart:function(){c=l=!1,h=1},point:function(u,d){var p,m=[u,d],f=s(u,d),g=n?f?0:r(u,d):f?r(u+(u<0?Mt:-Mt),d):0;if(!e&&(c=l=f)&&t.lineStart(),f!==l&&(p=a(e,m),($n(e,p)||$n(m,p))&&(m[0]+=Ot,m[1]+=Ot,f=s(m[0],m[1]))),f!==l)h=0,f?(t.lineStart(),p=a(m,e),t.point(p[0],p[1])):(p=a(e,m),t.point(p[0],p[1]),t.lineEnd()),e=p;else if(i&&e&&n^f){var y;g&o||!(y=a(m,e,!0))||(h=0,n?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!f||e&&$n(e,m)||t.point(m[0],m[1]),e=m,l=f,o=g},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return h|(c&&l)<<1}}}),$i(t,6*It),n?[0,-t]:[-Mt,t-Mt]);function s(t,n){return Math.cos(t)*Math.cos(n)>e}function a(t,n,i){var s=[1,0,0],a=Bn(Pn(t),Pn(n)),r=Rn(a,a),o=a[0],l=r-o*o;if(!l)return!i&&t;var c=e*r/l,h=-e*o/l,u=Bn(s,a),d=zn(s,c);Vn(d,zn(a,h));var p=u,m=Rn(d,p),f=Rn(p,p),g=m*m-f*(Rn(d,d)-1);if(!(g<0)){var y=Math.sqrt(g),b=zn(p,(-m-y)/f);if(Vn(b,d),b=qn(b),!i)return b;var v,x=t[0],w=n[0],A=t[1],j=n[1];w<x&&(v=x,x=w,w=v);var k=w-x,N=E(k-Mt)<Ot;if(!N&&j<A&&(v=A,A=j,j=v),N||k<Ot?N?A+j>0^b[1]<(E(b[0]-x)<Ot?A:j):A<=b[1]&&b[1]<=j:k>Mt^(x<=b[0]&&b[0]<=w)){var _=zn(p,(-m+y)/f);return Vn(_,d),[b,qn(_)]}}}function r(e,i){var s=n?t:Mt-t,a=0;return e<-s?a|=1:e>s&&(a|=2),i<-s?a|=4:i>s&&(a|=8),a}}function ci(t,e,n,i){return function(s){var a,r=s.a,o=s.b,l=r.x,c=r.y,h=0,u=1,d=o.x-l,p=o.y-c;if(a=t-l,d||!(a>0)){if(a/=d,d<0){if(a<h)return;a<u&&(u=a)}else if(d>0){if(a>u)return;a>h&&(h=a)}if(a=n-l,d||!(a<0)){if(a/=d,d<0){if(a>u)return;a>h&&(h=a)}else if(d>0){if(a<h)return;a<u&&(u=a)}if(a=e-c,p||!(a>0)){if(a/=p,p<0){if(a<h)return;a<u&&(u=a)}else if(p>0){if(a>u)return;a>h&&(h=a)}if(a=i-c,p||!(a<0)){if(a/=p,p<0){if(a>u)return;a>h&&(h=a)}else if(p>0){if(a<h)return;a<u&&(u=a)}return h>0&&(s.a={x:l+h*d,y:c+h*p}),u<1&&(s.b={x:l+u*d,y:c+u*p}),s}}}}}}var hi=1e9;function ui(t,e,n,i){return function(l){var c,h,u,d,p,m,f,g,y,b,v,x=l,w=ai(),E=ci(t,e,n,i),A={point:N,lineStart:function(){A.point=_,h&&h.push(u=[]),b=!0,y=!1,f=g=NaN},lineEnd:function(){c&&(_(d,p),m&&y&&w.rejoin(),c.push(w.buffer())),A.point=N,y&&l.lineEnd()},polygonStart:function(){l=w,c=[],h=[],v=!0},polygonEnd:function(){l=x,c=a.merge(c);var e=function(t){for(var e=0,n=h.length,i=t[1],s=0;s<n;++s)for(var a,r=1,o=h[s],l=o.length,c=o[0];r<l;++r)a=o[r],c[1]<=i?a[1]>i&&Ht(c,a,t)>0&&++e:a[1]<=i&&Ht(c,a,t)<0&&--e,c=a;return 0!==e}([t,i]),n=v&&e,s=c.length;(n||s)&&(l.polygonStart(),n&&(l.lineStart(),j(null,null,1,l),l.lineEnd()),s&&ti(c,r,e,j,l),l.polygonEnd()),c=h=u=null}};function j(a,r,l,c){var h=0,u=0;if(null==a||(h=s(a,l))!==(u=s(r,l))||o(a,r)<0^l>0)do{c.point(0===h||3===h?t:n,h>1?i:e)}while((h=(h+l+4)%4)!==u);else c.point(r[0],r[1])}function k(s,a){return t<=s&&s<=n&&e<=a&&a<=i}function N(t,e){k(t,e)&&l.point(t,e)}function _(t,e){var n=k(t=Math.max(-1e9,Math.min(hi,t)),e=Math.max(-1e9,Math.min(hi,e)));if(h&&u.push([t,e]),b)d=t,p=e,m=n,b=!1,n&&(l.lineStart(),l.point(t,e));else if(n&&y)l.point(t,e);else{var i={a:{x:f,y:g},b:{x:t,y:e}};E(i)?(y||(l.lineStart(),l.point(i.a.x,i.a.y)),l.point(i.b.x,i.b.y),n||l.lineEnd(),v=!1):n&&(l.lineStart(),l.point(t,e),v=!1)}f=t,g=e,y=n}return A};function s(i,s){return E(i[0]-t)<Ot?s>0?0:3:E(i[0]-n)<Ot?s>0?2:1:E(i[1]-e)<Ot?s>0?1:0:s>0?3:2}function r(t,e){return o(t.x,e.x)}function o(t,e){var n=s(t,1),i=s(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}}function di(t){var e=0,n=Mt/3,i=Hi(t),s=i(e,n);return s.parallels=function(t){return arguments.length?i(e=t[0]*Mt/180,n=t[1]*Mt/180):[e/Mt*180,n/Mt*180]},s}function pi(t,e){var n=Math.sin(t),i=(n+Math.sin(e))/2,s=1+n*(2*i-n),a=Math.sqrt(s)/i;function r(t,e){var n=Math.sqrt(s-2*i*Math.sin(e))/i;return[n*Math.sin(t*=i),a-n*Math.cos(t)]}return r.invert=function(t,e){var n=a-e;return[Math.atan2(t,n)/i,Rt((s-(t*t+n*n)*i*i)/(2*i))]},r}a.geo.clipExtent=function(){var t,e,n,i,s,a,r={stream:function(t){return s&&(s.valid=!1),(s=a(t)).valid=!0,s},extent:function(o){return arguments.length?(a=ui(t=+o[0][0],e=+o[0][1],n=+o[1][0],i=+o[1][1]),s&&(s.valid=!1,s=null),r):[[t,e],[n,i]]}};return r.extent([[0,0],[960,500]])},(a.geo.conicEqualArea=function(){return di(pi)}).raw=pi,a.geo.albers=function(){return a.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},a.geo.albersUsa=function(){var t,e,n,i,s=a.geo.albers(),r=a.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=a.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,n){t=[e,n]}};function c(s){var a=s[0],r=s[1];return t=null,e(a,r),t||(n(a,r),t)||i(a,r),t}return c.invert=function(t){var e=s.scale(),n=s.translate(),i=(t[0]-n[0])/e,a=(t[1]-n[1])/e;return(a>=.12&&a<.234&&i>=-.425&&i<-.214?r:a>=.166&&a<.234&&i>=-.214&&i<-.115?o:s).invert(t)},c.stream=function(t){var e=s.stream(t),n=r.stream(t),i=o.stream(t);return{point:function(t,s){e.point(t,s),n.point(t,s),i.point(t,s)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},c.precision=function(t){return arguments.length?(s.precision(t),r.precision(t),o.precision(t),c):s.precision()},c.scale=function(t){return arguments.length?(s.scale(t),r.scale(.35*t),o.scale(t),c.translate(s.translate())):s.scale()},c.translate=function(t){if(!arguments.length)return s.translate();var a=s.scale(),h=+t[0],u=+t[1];return e=s.translate(t).clipExtent([[h-.455*a,u-.238*a],[h+.455*a,u+.238*a]]).stream(l).point,n=r.translate([h-.307*a,u+.201*a]).clipExtent([[h-.425*a+Ot,u+.12*a+Ot],[h-.214*a-Ot,u+.234*a-Ot]]).stream(l).point,i=o.translate([h-.205*a,u+.212*a]).clipExtent([[h-.214*a+Ot,u+.166*a+Ot],[h-.115*a-Ot,u+.234*a-Ot]]).stream(l).point,c},c.scale(1070)};var mi,fi,gi,yi,bi,vi,xi={point:P,lineStart:P,lineEnd:P,polygonStart:function(){fi=0,xi.lineStart=wi},polygonEnd:function(){xi.lineStart=xi.lineEnd=xi.point=P,mi+=E(fi/2)}};function wi(){var t,e,n,i;function s(t,e){fi+=i*t-n*e,n=t,i=e}xi.point=function(a,r){xi.point=s,t=n=a,e=i=r},xi.lineEnd=function(){s(t,e)}}var Ei={point:function(t,e){t<gi&&(gi=t),t>bi&&(bi=t),e<yi&&(yi=e),e>vi&&(vi=e)},lineStart:P,lineEnd:P,polygonStart:P,polygonEnd:P};function Ai(){var t=ji(4.5),e=[],n={point:i,lineStart:function(){n.point=s},lineEnd:r,polygonStart:function(){n.lineEnd=o},polygonEnd:function(){n.lineEnd=r,n.point=i},pointRadius:function(e){return t=ji(e),n},result:function(){if(e.length){var t=e.join("");return e=[],t}}};function i(n,i){e.push("M",n,",",i,t)}function s(t,i){e.push("M",t,",",i),n.point=a}function a(t,n){e.push("L",t,",",n)}function r(){n.point=i}function o(){e.push("Z")}return n}function ji(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}var ki,Ni={point:_i,lineStart:Oi,lineEnd:Li,polygonStart:function(){Ni.lineStart=Mi},polygonEnd:function(){Ni.point=_i,Ni.lineStart=Oi,Ni.lineEnd=Li}};function _i(t,e){Nn+=t,_n+=e,++On}function Oi(){var t,e;function n(n,i){var s=n-t,a=i-e,r=Math.sqrt(s*s+a*a);Ln+=r*(t+n)/2,Mn+=r*(e+i)/2,Cn+=r,_i(t=n,e=i)}Ni.point=function(i,s){Ni.point=n,_i(t=i,e=s)}}function Li(){Ni.point=_i}function Mi(){var t,e,n,i;function s(t,e){var s=t-n,a=e-i,r=Math.sqrt(s*s+a*a);Ln+=r*(n+t)/2,Mn+=r*(i+e)/2,Cn+=r,Sn+=(r=i*t-n*e)*(n+t),Tn+=r*(i+e),In+=3*r,_i(n=t,i=e)}Ni.point=function(a,r){Ni.point=s,_i(t=n=a,e=i=r)},Ni.lineEnd=function(){s(t,e)}}function Ci(t){var e=4.5,n={point:i,lineStart:function(){n.point=s},lineEnd:r,polygonStart:function(){n.lineEnd=o},polygonEnd:function(){n.lineEnd=r,n.point=i},pointRadius:function(t){return e=t,n},result:P};function i(n,i){t.moveTo(n+e,i),t.arc(n,i,e,0,Ct)}function s(e,i){t.moveTo(e,i),n.point=a}function a(e,n){t.lineTo(e,n)}function r(){n.point=i}function o(){t.closePath()}return n}function Si(t){var e=.5,n=Math.cos(30*It),i=16;function s(t){return(i?r:a)(t)}function a(e){return Ui(e,(function(n,i){n=t(n,i),e.point(n[0],n[1])}))}function r(e){var n,s,a,r,l,c,h,u,d,p,m,f,g={point:y,lineStart:b,lineEnd:x,polygonStart:function(){e.polygonStart(),g.lineStart=w},polygonEnd:function(){e.polygonEnd(),g.lineStart=b}};function y(n,i){n=t(n,i),e.point(n[0],n[1])}function b(){u=NaN,g.point=v,e.lineStart()}function v(n,s){var a=Pn([n,s]),r=t(n,s);o(u,d,h,p,m,f,u=r[0],d=r[1],h=n,p=a[0],m=a[1],f=a[2],i,e),e.point(u,d)}function x(){g.point=y,e.lineEnd()}function w(){b(),g.point=E,g.lineEnd=A}function E(t,e){v(n=t,e),s=u,a=d,r=p,l=m,c=f,g.point=v}function A(){o(u,d,h,p,m,f,s,a,n,r,l,c,i,e),g.lineEnd=x,x()}return g}function o(i,s,a,r,l,c,h,u,d,p,m,f,g,y){var b=h-i,v=u-s,x=b*b+v*v;if(x>4*e&&g--){var w=r+p,A=l+m,j=c+f,k=Math.sqrt(w*w+A*A+j*j),N=Math.asin(j/=k),_=E(E(j)-1)<Ot||E(a-d)<Ot?(a+d)/2:Math.atan2(A,w),O=t(_,N),L=O[0],M=O[1],C=L-i,S=M-s,T=v*C-b*S;(T*T/x>e||E((b*C+v*S)/x-.5)>.3||r*p+l*m+c*f<n)&&(o(i,s,a,r,l,c,L,M,_,w/=k,A/=k,j,g,y),y.point(L,M),o(L,M,_,w,A,j,h,u,d,p,m,f,g,y))}}return s.precision=function(t){return arguments.length?(i=(e=t*t)>0&&16,s):Math.sqrt(e)},s}function Ti(t){var e=Si((function(e,n){return t([e*Ut,n*Ut])}));return function(t){return Pi(e(t))}}function Ii(t){this.stream=t}function Ui(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function Di(t){return Hi((function(){return t}))()}function Hi(t){var e,n,i,s,r,o,l=Si((function(t,n){return[(t=e(t,n))[0]*c+s,r-t[1]*c]})),c=150,h=480,u=250,d=0,p=0,m=0,f=0,g=0,y=oi,b=I,v=null,x=null;function w(t){return[(t=i(t[0]*It,t[1]*It))[0]*c+s,r-t[1]*c]}function E(t){return(t=i.invert((t[0]-s)/c,(r-t[1])/c))&&[t[0]*Ut,t[1]*Ut]}function A(){i=Kn(n=Vi(m,f,g),e);var t=e(d,p);return s=h-t[0]*c,r=u+t[1]*c,j()}function j(){return o&&(o.valid=!1,o=null),w}return w.stream=function(t){return o&&(o.valid=!1),(o=Pi(y(n,l(b(t))))).valid=!0,o},w.clipAngle=function(t){return arguments.length?(y=null==t?(v=t,oi):li((v=+t)*It),j()):v},w.clipExtent=function(t){return arguments.length?(x=t,b=t?ui(t[0][0],t[0][1],t[1][0],t[1][1]):I,j()):x},w.scale=function(t){return arguments.length?(c=+t,A()):c},w.translate=function(t){return arguments.length?(h=+t[0],u=+t[1],A()):[h,u]},w.center=function(t){return arguments.length?(d=t[0]%360*It,p=t[1]%360*It,A()):[d*Ut,p*Ut]},w.rotate=function(t){return arguments.length?(m=t[0]%360*It,f=t[1]%360*It,g=t.length>2?t[2]%360*It:0,A()):[m*Ut,f*Ut,g*Ut]},a.rebind(w,l,"precision"),function(){return e=t.apply(this,arguments),w.invert=e.invert&&E,A()}}function Pi(t){return Ui(t,(function(e,n){t.point(e*It,n*It)}))}function Ri(t,e){return[t,e]}function Bi(t,e){return[t>Mt?t-Ct:t<-Mt?t+Ct:t,e]}function Vi(t,e,n){return t?e||n?Kn(Fi(t),qi(e,n)):Fi(t):e||n?qi(e,n):Bi}function zi(t){return function(e,n){return[(e+=t)>Mt?e-Ct:e<-Mt?e+Ct:e,n]}}function Fi(t){var e=zi(t);return e.invert=zi(-t),e}function qi(t,e){var n=Math.cos(t),i=Math.sin(t),s=Math.cos(e),a=Math.sin(e);function r(t,e){var r=Math.cos(e),o=Math.cos(t)*r,l=Math.sin(t)*r,c=Math.sin(e),h=c*n+o*i;return[Math.atan2(l*s-h*a,o*n-c*i),Rt(h*s+l*a)]}return r.invert=function(t,e){var r=Math.cos(e),o=Math.cos(t)*r,l=Math.sin(t)*r,c=Math.sin(e),h=c*s-l*a;return[Math.atan2(l*s+c*a,o*n+h*i),Rt(h*n-o*i)]},r}function $i(t,e){var n=Math.cos(t),i=Math.sin(t);return function(s,a,r,o){var l=r*e;null!=s?(s=Wi(n,s),a=Wi(n,a),(r>0?s<a:s>a)&&(s+=r*Ct)):(s=t+r*Ct,a=t-.5*l);for(var c,h=s;r>0?h>a:h<a;h-=l)o.point((c=qn([n,-i*Math.cos(h),-i*Math.sin(h)]))[0],c[1])}}function Wi(t,e){var n=Pn(e);n[0]-=t,Fn(n);var i=Pt(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-Ot)%(2*Math.PI)}function Zi(t,e,n){var i=a.range(t,e-Ot,n).concat(e);return function(t){return i.map((function(e){return[t,e]}))}}function Xi(t,e,n){var i=a.range(t,e-Ot,n).concat(e);return function(t){return i.map((function(e){return[e,t]}))}}function Yi(t){return t.source}function Gi(t){return t.target}a.geo.path=function(){var t,e,n,i,s,r=4.5;function o(t){return t&&("function"==typeof r&&i.pointRadius(+r.apply(this,arguments)),s&&s.valid||(s=n(i)),a.geo.stream(t,s)),i.result()}function l(){return s=null,o}return o.area=function(t){return mi=0,a.geo.stream(t,n(xi)),mi},o.centroid=function(t){return Nn=_n=On=Ln=Mn=Cn=Sn=Tn=In=0,a.geo.stream(t,n(Ni)),In?[Sn/In,Tn/In]:Cn?[Ln/Cn,Mn/Cn]:On?[Nn/On,_n/On]:[NaN,NaN]},o.bounds=function(t){return bi=vi=-(gi=yi=1/0),a.geo.stream(t,n(Ei)),[[gi,yi],[bi,vi]]},o.projection=function(e){return arguments.length?(n=(t=e)?e.stream||Ti(e):I,l()):t},o.context=function(t){return arguments.length?(i=null==(e=t)?new Ai:new Ci(t),"function"!=typeof r&&i.pointRadius(r),l()):e},o.pointRadius=function(t){return arguments.length?(r="function"==typeof t?t:(i.pointRadius(+t),+t),o):r},o.projection(a.geo.albersUsa()).context(null)},a.geo.transform=function(t){return{stream:function(e){var n=new Ii(e);for(var i in t)n[i]=t[i];return n}}},Ii.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},a.geo.projection=Di,a.geo.projectionMutator=Hi,(a.geo.equirectangular=function(){return Di(Ri)}).raw=Ri.invert=Ri,a.geo.rotation=function(t){function e(e){return(e=t(e[0]*It,e[1]*It))[0]*=Ut,e[1]*=Ut,e}return t=Vi(t[0]%360*It,t[1]*It,t.length>2?t[2]*It:0),e.invert=function(e){return(e=t.invert(e[0]*It,e[1]*It))[0]*=Ut,e[1]*=Ut,e},e},Bi.invert=Ri,a.geo.circle=function(){var t,e,n=[0,0],i=6;function s(){var t="function"==typeof n?n.apply(this,arguments):n,i=Vi(-t[0]*It,-t[1]*It,0).invert,s=[];return e(null,null,1,{point:function(t,e){s.push(t=i(t,e)),t[0]*=Ut,t[1]*=Ut}}),{type:"Polygon",coordinates:[s]}}return s.origin=function(t){return arguments.length?(n=t,s):n},s.angle=function(n){return arguments.length?(e=$i((t=+n)*It,i*It),s):t},s.precision=function(n){return arguments.length?(e=$i(t*It,(i=+n)*It),s):i},s.angle(90)},a.geo.distance=function(t,e){var n,i=(e[0]-t[0])*It,s=t[1]*It,a=e[1]*It,r=Math.sin(i),o=Math.cos(i),l=Math.sin(s),c=Math.cos(s),h=Math.sin(a),u=Math.cos(a);return Math.atan2(Math.sqrt((n=u*r)*n+(n=c*h-l*u*o)*n),l*h+c*u*o)},a.geo.graticule=function(){var t,e,n,i,s,r,o,l,c,h,u,d,p=10,m=p,f=90,g=360,y=2.5;function b(){return{type:"MultiLineString",coordinates:v()}}function v(){return a.range(Math.ceil(i/f)*f,n,f).map(u).concat(a.range(Math.ceil(l/g)*g,o,g).map(d)).concat(a.range(Math.ceil(e/p)*p,t,p).filter((function(t){return E(t%f)>Ot})).map(c)).concat(a.range(Math.ceil(r/m)*m,s,m).filter((function(t){return E(t%g)>Ot})).map(h))}return b.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))},b.outline=function(){return{type:"Polygon",coordinates:[u(i).concat(d(o).slice(1),u(n).reverse().slice(1),d(l).reverse().slice(1))]}},b.extent=function(t){return arguments.length?b.majorExtent(t).minorExtent(t):b.minorExtent()},b.majorExtent=function(t){return arguments.length?(i=+t[0][0],n=+t[1][0],l=+t[0][1],o=+t[1][1],i>n&&(t=i,i=n,n=t),l>o&&(t=l,l=o,o=t),b.precision(y)):[[i,l],[n,o]]},b.minorExtent=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],r=+n[0][1],s=+n[1][1],e>t&&(n=e,e=t,t=n),r>s&&(n=r,r=s,s=n),b.precision(y)):[[e,r],[t,s]]},b.step=function(t){return arguments.length?b.majorStep(t).minorStep(t):b.minorStep()},b.majorStep=function(t){return arguments.length?(f=+t[0],g=+t[1],b):[f,g]},b.minorStep=function(t){return arguments.length?(p=+t[0],m=+t[1],b):[p,m]},b.precision=function(a){return arguments.length?(y=+a,c=Zi(r,s,90),h=Xi(e,t,y),u=Zi(l,o,90),d=Xi(i,n,y),b):y},b.majorExtent([[-180,-90+Ot],[180,90-Ot]]).minorExtent([[-180,-80-Ot],[180,80+Ot]])},a.geo.greatArc=function(){var t,e,n=Yi,i=Gi;function s(){return{type:"LineString",coordinates:[t||n.apply(this,arguments),e||i.apply(this,arguments)]}}return s.distance=function(){return a.geo.distance(t||n.apply(this,arguments),e||i.apply(this,arguments))},s.source=function(e){return arguments.length?(n=e,t="function"==typeof e?null:e,s):n},s.target=function(t){return arguments.length?(i=t,e="function"==typeof t?null:t,s):i},s.precision=function(){return arguments.length?s:0},s},a.geo.interpolate=function(t,e){return function(t,e,n,i){var s=Math.cos(e),a=Math.sin(e),r=Math.cos(i),o=Math.sin(i),l=s*Math.cos(t),c=s*Math.sin(t),h=r*Math.cos(n),u=r*Math.sin(n),d=2*Math.asin(Math.sqrt(Vt(i-e)+s*r*Vt(n-t))),p=1/Math.sin(d),m=d?function(t){var e=Math.sin(t*=d)*p,n=Math.sin(d-t)*p,i=n*l+e*h,s=n*c+e*u,r=n*a+e*o;return[Math.atan2(s,i)*Ut,Math.atan2(r,Math.sqrt(i*i+s*s))*Ut]}:function(){return[t*Ut,e*Ut]};return m.distance=d,m}(t[0]*It,t[1]*It,e[0]*It,e[1]*It)},a.geo.length=function(t){return ki=0,a.geo.stream(t,Ji),ki};var Ji={sphere:P,point:P,lineStart:function(){var t,e,n;function i(i,s){var a=Math.sin(s*=It),r=Math.cos(s),o=E((i*=It)-t),l=Math.cos(o);ki+=Math.atan2(Math.sqrt((o=r*Math.sin(o))*o+(o=n*a-e*r*l)*o),e*a+n*r*l),t=i,e=a,n=r}Ji.point=function(s,a){t=s*It,e=Math.sin(a*=It),n=Math.cos(a),Ji.point=i},Ji.lineEnd=function(){Ji.point=Ji.lineEnd=P}},lineEnd:P,polygonStart:P,polygonEnd:P};function Ki(t,e){function n(e,n){var i=Math.cos(e),s=Math.cos(n),a=t(i*s);return[a*s*Math.sin(e),a*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),s=e(i),a=Math.sin(s),r=Math.cos(s);return[Math.atan2(t*a,i*r),Math.asin(i&&n*a/i)]},n}var Qi=Ki((function(t){return Math.sqrt(2/(1+t))}),(function(t){return 2*Math.asin(t/2)}));(a.geo.azimuthalEqualArea=function(){return Di(Qi)}).raw=Qi;var ts=Ki((function(t){var e=Math.acos(t);return e&&e/Math.sin(e)}),I);function es(t,e){var n=Math.cos(t),i=function(t){return Math.tan(Mt/4+t/2)},s=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(i(e)/i(t)),a=n*Math.pow(i(t),s)/s;if(!s)return ss;function r(t,e){a>0?e<-Tt+Ot&&(e=-Tt+Ot):e>Tt-Ot&&(e=Tt-Ot);var n=a/Math.pow(i(e),s);return[n*Math.sin(s*t),a-n*Math.cos(s*t)]}return r.invert=function(t,e){var n=a-e,i=Dt(s)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/s,2*Math.atan(Math.pow(a/i,1/s))-Tt]},r}function ns(t,e){var n=Math.cos(t),i=t===e?Math.sin(t):(n-Math.cos(e))/(e-t),s=n/i+t;if(E(i)<Ot)return Ri;function a(t,e){var n=s-e;return[n*Math.sin(i*t),s-n*Math.cos(i*t)]}return a.invert=function(t,e){var n=s-e;return[Math.atan2(t,n)/i,s-Dt(i)*Math.sqrt(t*t+n*n)]},a}(a.geo.azimuthalEquidistant=function(){return Di(ts)}).raw=ts,(a.geo.conicConformal=function(){return di(es)}).raw=es,(a.geo.conicEquidistant=function(){return di(ns)}).raw=ns;var is=Ki((function(t){return 1/t}),Math.atan);function ss(t,e){return[t,Math.log(Math.tan(Mt/4+e/2))]}function as(t){var e,n=Di(t),i=n.scale,s=n.translate,a=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=s.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var r=a.apply(n,arguments);if(r===n){if(e=null==t){var o=Mt*i(),l=s();a([[l[0]-o,l[1]-o],[l[0]+o,l[1]+o]])}}else e&&(r=null);return r},n.clipExtent(null)}(a.geo.gnomonic=function(){return Di(is)}).raw=is,ss.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Tt]},(a.geo.mercator=function(){return as(ss)}).raw=ss;var rs=Ki((function(){return 1}),Math.asin);(a.geo.orthographic=function(){return Di(rs)}).raw=rs;var os=Ki((function(t){return 1/(1+t)}),(function(t){return 2*Math.atan(t)}));function ls(t,e){return[Math.log(Math.tan(Mt/4+e/2)),-t]}function cs(t){return t[0]}function hs(t){return t[1]}function us(t){for(var e=t.length,n=[0,1],i=2,s=2;s<e;s++){for(;i>1&&Ht(t[n[i-2]],t[n[i-1]],t[s])<=0;)--i;n[i++]=s}return n.slice(0,i)}function ds(t,e){return t[0]-e[0]||t[1]-e[1]}(a.geo.stereographic=function(){return Di(os)}).raw=os,ls.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Tt]},(a.geo.transverseMercator=function(){var t=as(ls),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90])}).raw=ls,a.geom={},a.geom.hull=function(t){var e=cs,n=hs;if(arguments.length)return i(t);function i(t){if(t.length<3)return[];var i,s=xe(e),a=xe(n),r=t.length,o=[],l=[];for(i=0;i<r;i++)o.push([+s.call(this,t[i],i),+a.call(this,t[i],i),i]);for(o.sort(ds),i=0;i<r;i++)l.push([o[i][0],-o[i][1]]);var c=us(o),h=us(l),u=h[0]===c[0],d=h[h.length-1]===c[c.length-1],p=[];for(i=c.length-1;i>=0;--i)p.push(t[o[c[i]][2]]);for(i=+u;i<h.length-d;++i)p.push(t[o[h[i]][2]]);return p}return i.x=function(t){return arguments.length?(e=t,i):e},i.y=function(t){return arguments.length?(n=t,i):n},i},a.geom.polygon=function(t){return $(t,ps),t};var ps=a.geom.polygon.prototype=[];function ms(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function fs(t,e,n,i){var s=t[0],a=n[0],r=e[0]-s,o=i[0]-a,l=t[1],c=n[1],h=e[1]-l,u=i[1]-c,d=(o*(l-c)-u*(s-a))/(u*r-o*h);return[s+d*r,l+d*h]}function gs(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}ps.area=function(){for(var t,e=-1,n=this.length,i=this[n-1],s=0;++e<n;)t=i,i=this[e],s+=t[1]*i[0]-t[0]*i[1];return.5*s},ps.centroid=function(t){var e,n,i=-1,s=this.length,a=0,r=0,o=this[s-1];for(arguments.length||(t=-1/(6*this.area()));++i<s;)e=o,o=this[i],n=e[0]*o[1]-o[0]*e[1],a+=(e[0]+o[0])*n,r+=(e[1]+o[1])*n;return[a*t,r*t]},ps.clip=function(t){for(var e,n,i,s,a,r,o=gs(t),l=-1,c=this.length-gs(this),h=this[c-1];++l<c;){for(e=t.slice(),t.length=0,s=this[l],a=e[(i=e.length-o)-1],n=-1;++n<i;)ms(r=e[n],h,s)?(ms(a,h,s)||t.push(fs(a,r,h,s)),t.push(r)):ms(a,h,s)&&t.push(fs(a,r,h,s)),a=r;o&&t.push(t[0]),h=s}return t};var ys,bs,vs,xs,ws,Es=[],As=[];function js(){zs(this),this.edge=this.site=this.circle=null}function ks(t){var e=Es.pop()||new js;return e.site=t,e}function Ns(t){Us(t),vs.remove(t),Es.push(t),zs(t)}function _s(t){var e=t.circle,n=e.x,i=e.cy,s={x:n,y:i},a=t.P,r=t.N,o=[t];Ns(t);for(var l=a;l.circle&&E(n-l.circle.x)<Ot&&E(i-l.circle.cy)<Ot;)a=l.P,o.unshift(l),Ns(l),l=a;o.unshift(l),Us(l);for(var c=r;c.circle&&E(n-c.circle.x)<Ot&&E(i-c.circle.cy)<Ot;)r=c.N,o.push(c),Ns(c),c=r;o.push(c),Us(c);var h,u=o.length;for(h=1;h<u;++h)c=o[h],l=o[h-1],Rs(c.edge,l.site,c.site,s);l=o[0],(c=o[u-1]).edge=Ps(l.site,c.site,null,s),Is(l),Is(c)}function Os(t){for(var e,n,i,s,a=t.x,r=t.y,o=vs._;o;)if((i=Ls(o,r)-a)>Ot)o=o.L;else{if(!((s=a-Ms(o,r))>Ot)){i>-Ot?(e=o.P,n=o):s>-Ot?(e=o,n=o.N):e=n=o;break}if(!o.R){e=o;break}o=o.R}var l=ks(t);if(vs.insert(e,l),e||n){if(e===n)return Us(e),n=ks(e.site),vs.insert(l,n),l.edge=n.edge=Ps(e.site,l.site),Is(e),void Is(n);if(n){Us(e),Us(n);var c=e.site,h=c.x,u=c.y,d=t.x-h,p=t.y-u,m=n.site,f=m.x-h,g=m.y-u,y=2*(d*g-p*f),b=d*d+p*p,v=f*f+g*g,x={x:(g*b-p*v)/y+h,y:(d*v-f*b)/y+u};Rs(n.edge,c,m,x),l.edge=Ps(c,t,null,x),n.edge=Ps(t,m,null,x),Is(e),Is(n)}else l.edge=Ps(e.site,l.site)}}function Ls(t,e){var n=t.site,i=n.x,s=n.y,a=s-e;if(!a)return i;var r=t.P;if(!r)return-1/0;var o=(n=r.site).x,l=n.y,c=l-e;if(!c)return o;var h=o-i,u=1/a-1/c,d=h/c;return u?(-d+Math.sqrt(d*d-2*u*(h*h/(-2*c)-l+c/2+s-a/2)))/u+i:(i+o)/2}function Ms(t,e){var n=t.N;if(n)return Ls(n,e);var i=t.site;return i.y===e?i.x:1/0}function Cs(t){this.site=t,this.edges=[]}function Ss(t,e){return e.angle-t.angle}function Ts(){zs(this),this.x=this.y=this.arc=this.site=this.cy=null}function Is(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,s=t.site,a=n.site;if(i!==a){var r=s.x,o=s.y,l=i.x-r,c=i.y-o,h=a.x-r,u=2*(l*(g=a.y-o)-c*h);if(!(u>=-Lt)){var d=l*l+c*c,p=h*h+g*g,m=(g*d-c*p)/u,f=(l*p-h*d)/u,g=f+o,y=As.pop()||new Ts;y.arc=t,y.site=s,y.x=m+r,y.y=g+Math.sqrt(m*m+f*f),y.cy=g,t.circle=y;for(var b=null,v=ws._;v;)if(y.y<v.y||y.y===v.y&&y.x<=v.x){if(!v.L){b=v.P;break}v=v.L}else{if(!v.R){b=v;break}v=v.R}ws.insert(b,y),b||(xs=y)}}}}function Us(t){var e=t.circle;e&&(e.P||(xs=e.N),ws.remove(e),As.push(e),zs(e),t.circle=null)}function Ds(t,e){var n=t.b;if(n)return!0;var i,s,a=t.a,r=e[0][0],o=e[1][0],l=e[0][1],c=e[1][1],h=t.l,u=t.r,d=h.x,p=h.y,m=u.x,f=u.y,g=(d+m)/2,y=(p+f)/2;if(f===p){if(g<r||g>=o)return;if(d>m){if(a){if(a.y>=c)return}else a={x:g,y:l};n={x:g,y:c}}else{if(a){if(a.y<l)return}else a={x:g,y:c};n={x:g,y:l}}}else if(s=y-(i=(d-m)/(f-p))*g,i<-1||i>1)if(d>m){if(a){if(a.y>=c)return}else a={x:(l-s)/i,y:l};n={x:(c-s)/i,y:c}}else{if(a){if(a.y<l)return}else a={x:(c-s)/i,y:c};n={x:(l-s)/i,y:l}}else if(p<f){if(a){if(a.x>=o)return}else a={x:r,y:i*r+s};n={x:o,y:i*o+s}}else{if(a){if(a.x<r)return}else a={x:o,y:i*o+s};n={x:r,y:i*r+s}}return t.a=a,t.b=n,!0}function Hs(t,e){this.l=t,this.r=e,this.a=this.b=null}function Ps(t,e,n,i){var s=new Hs(t,e);return ys.push(s),n&&Rs(s,t,e,n),i&&Rs(s,e,t,i),bs[t.i].edges.push(new Bs(s,t,e)),bs[e.i].edges.push(new Bs(s,e,t)),s}function Rs(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function Bs(t,e,n){var i=t.a,s=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(s.x-i.x,i.y-s.y):Math.atan2(i.x-s.x,s.y-i.y)}function Vs(){this._=null}function zs(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Fs(t,e){var n=e,i=e.R,s=n.U;s?s.L===n?s.L=i:s.R=i:t._=i,i.U=s,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function qs(t,e){var n=e,i=e.L,s=n.U;s?s.L===n?s.L=i:s.R=i:t._=i,i.U=s,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function $s(t){for(;t.L;)t=t.L;return t}function Ws(t,e){var n,i,s,a=t.sort(Zs).pop();for(ys=[],bs=new Array(t.length),vs=new Vs,ws=new Vs;;)if(s=xs,a&&(!s||a.y<s.y||a.y===s.y&&a.x<s.x))a.x===n&&a.y===i||(bs[a.i]=new Cs(a),Os(a),n=a.x,i=a.y),a=t.pop();else{if(!s)break;_s(s.arc)}e&&(function(t){for(var e,n=ys,i=ci(t[0][0],t[0][1],t[1][0],t[1][1]),s=n.length;s--;)(!Ds(e=n[s],t)||!i(e)||E(e.a.x-e.b.x)<Ot&&E(e.a.y-e.b.y)<Ot)&&(e.a=e.b=null,n.splice(s,1))}(e),function(t){for(var e,n,i,s,a,r,o,l,c,h,u=t[0][0],d=t[1][0],p=t[0][1],m=t[1][1],f=bs,g=f.length;g--;)if((a=f[g])&&a.prepare())for(l=(o=a.edges).length,r=0;r<l;)i=(h=o[r].end()).x,s=h.y,e=(c=o[++r%l].start()).x,n=c.y,(E(i-e)>Ot||E(s-n)>Ot)&&(o.splice(r,0,new Bs((y=a.site,b=h,v=E(i-u)<Ot&&m-s>Ot?{x:u,y:E(e-u)<Ot?n:m}:E(s-m)<Ot&&d-i>Ot?{x:E(n-m)<Ot?e:d,y:m}:E(i-d)<Ot&&s-p>Ot?{x:d,y:E(e-d)<Ot?n:p}:E(s-p)<Ot&&i-u>Ot?{x:E(n-p)<Ot?e:u,y:p}:null,x=void 0,(x=new Hs(y,null)).a=b,x.b=v,ys.push(x),x),a.site,null)),++l);var y,b,v,x}(e));var r={cells:bs,edges:ys};return vs=ws=ys=bs=null,r}function Zs(t,e){return e.y-t.y||e.x-t.x}Cs.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)(t=e[n].edge).b&&t.a||e.splice(n,1);return e.sort(Ss),e.length},Bs.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Vs.prototype={insert:function(t,e){var n,i,s;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=$s(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(s=i.R)&&s.C?(n.C=s.C=!1,i.C=!0,t=i):(t===n.R&&(Fs(this,n),n=(t=n).U),n.C=!1,i.C=!0,qs(this,i)):(s=i.L)&&s.C?(n.C=s.C=!1,i.C=!0,t=i):(t===n.L&&(qs(this,n),n=(t=n).U),n.C=!1,i.C=!0,Fs(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,s=t.U,a=t.L,r=t.R;if(n=a?r?$s(r):a:r,s?s.L===t?s.L=n:s.R=n:this._=n,a&&r?(i=n.C,n.C=t.C,n.L=a,a.U=n,n!==r?(s=n.U,n.U=t.U,t=n.R,s.L=t,n.R=r,r.U=n):(n.U=s,s=n,t=n.R)):(i=t.C,t=n),t&&(t.U=s),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===s.L){if((e=s.R).C&&(e.C=!1,s.C=!0,Fs(this,s),e=s.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,qs(this,e),e=s.R),e.C=s.C,s.C=e.R.C=!1,Fs(this,s),t=this._;break}}else if((e=s.L).C&&(e.C=!1,s.C=!0,qs(this,s),e=s.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Fs(this,e),e=s.L),e.C=s.C,s.C=e.L.C=!1,qs(this,s),t=this._;break}e.C=!0,t=s,s=s.U}while(!t.C);t&&(t.C=!1)}}},a.geom.voronoi=function(t){var e=cs,n=hs,i=e,s=n,a=Xs;if(t)return r(t);function r(t){var e=new Array(t.length),n=a[0][0],i=a[0][1],s=a[1][0],r=a[1][1];return Ws(o(t),a).cells.forEach((function(a,o){var l=a.edges,c=a.site;(e[o]=l.length?l.map((function(t){var e=t.start();return[e.x,e.y]})):c.x>=n&&c.x<=s&&c.y>=i&&c.y<=r?[[n,r],[s,r],[s,i],[n,i]]:[]).point=t[o]})),e}function o(t){return t.map((function(t,e){return{x:Math.round(i(t,e)/Ot)*Ot,y:Math.round(s(t,e)/Ot)*Ot,i:e}}))}return r.links=function(t){return Ws(o(t)).edges.filter((function(t){return t.l&&t.r})).map((function(e){return{source:t[e.l.i],target:t[e.r.i]}}))},r.triangles=function(t){var e=[];return Ws(o(t)).cells.forEach((function(n,i){for(var s,a,r,o,l=n.site,c=n.edges.sort(Ss),h=-1,u=c.length,d=c[u-1].edge,p=d.l===l?d.r:d.l;++h<u;)s=p,p=(d=c[h].edge).l===l?d.r:d.l,i<s.i&&i<p.i&&(r=s,o=p,((a=l).x-o.x)*(r.y-a.y)-(a.x-r.x)*(o.y-a.y)<0)&&e.push([t[i],t[s.i],t[p.i]])})),e},r.x=function(t){return arguments.length?(i=xe(e=t),r):e},r.y=function(t){return arguments.length?(s=xe(n=t),r):n},r.clipExtent=function(t){return arguments.length?(a=null==t?Xs:t,r):a===Xs?null:a},r.size=function(t){return arguments.length?r.clipExtent(t&&[[0,0],t]):a===Xs?null:a&&a[1]},r};var Xs=[[-1e6,-1e6],[1e6,1e6]];function Ys(t){return t.x}function Gs(t){return t.y}function Js(t,e,n,i,s,a){if(!t(e,n,i,s,a)){var r=.5*(n+s),o=.5*(i+a),l=e.nodes;l[0]&&Js(t,l[0],n,i,r,o),l[1]&&Js(t,l[1],r,i,s,o),l[2]&&Js(t,l[2],n,o,r,a),l[3]&&Js(t,l[3],r,o,s,a)}}function Ks(t,e,n,i,s,a,r){var o,l=1/0;return function t(c,h,u,d,p){if(!(h>a||u>r||d<i||p<s)){if(m=c.point){var m,f=e-c.x,g=n-c.y,y=f*f+g*g;if(y<l){var b=Math.sqrt(l=y);i=e-b,s=n-b,a=e+b,r=n+b,o=m}}for(var v=c.nodes,x=.5*(h+d),w=.5*(u+p),E=(n>=w)<<1|e>=x,A=E+4;E<A;++E)if(c=v[3&E])switch(3&E){case 0:t(c,h,u,x,w);break;case 1:t(c,x,u,d,w);break;case 2:t(c,h,w,x,p);break;case 3:t(c,x,w,d,p)}}}(t,i,s,a,r),o}function Qs(t,e){t=a.rgb(t),e=a.rgb(e);var n=t.r,i=t.g,s=t.b,r=e.r-n,o=e.g-i,l=e.b-s;return function(t){return"#"+pe(Math.round(n+r*t))+pe(Math.round(i+o*t))+pe(Math.round(s+l*t))}}function ta(t,e){var n,i={},s={};for(n in t)n in e?i[n]=aa(t[n],e[n]):s[n]=t[n];for(n in e)n in t||(s[n]=e[n]);return function(t){for(n in i)s[n]=i[n](t);return s}}function ea(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function na(t,e){var n,i,s,a=ia.lastIndex=sa.lastIndex=0,r=-1,o=[],l=[];for(t+="",e+="";(n=ia.exec(t))&&(i=sa.exec(e));)(s=i.index)>a&&(s=e.slice(a,s),o[r]?o[r]+=s:o[++r]=s),(n=n[0])===(i=i[0])?o[r]?o[r]+=i:o[++r]=i:(o[++r]=null,l.push({i:r,x:ea(n,i)})),a=sa.lastIndex;return a<e.length&&(s=e.slice(a),o[r]?o[r]+=s:o[++r]=s),o.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var n,i=0;i<e;++i)o[(n=l[i]).i]=n.x(t);return o.join("")})}a.geom.delaunay=function(t){return a.geom.voronoi().triangles(t)},a.geom.quadtree=function(t,e,n,i,s){var a,r=cs,o=hs;if(a=arguments.length)return r=Ys,o=Gs,3===a&&(s=n,i=e,n=e=0),l(t);function l(t){var l,c,h,u,d,p,m,f,g,y=xe(r),b=xe(o);if(null!=e)p=e,m=n,f=i,g=s;else if(f=g=-(p=m=1/0),c=[],h=[],d=t.length,a)for(u=0;u<d;++u)(l=t[u]).x<p&&(p=l.x),l.y<m&&(m=l.y),l.x>f&&(f=l.x),l.y>g&&(g=l.y),c.push(l.x),h.push(l.y);else for(u=0;u<d;++u){var v=+y(l=t[u],u),x=+b(l,u);v<p&&(p=v),x<m&&(m=x),v>f&&(f=v),x>g&&(g=x),c.push(v),h.push(x)}var w=f-p,A=g-m;function j(t,e,n,i,s,a,r,o){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var l=t.x,c=t.y;if(null!=l)if(E(l-n)+E(c-i)<.01)k(t,e,n,i,s,a,r,o);else{var h=t.point;t.x=t.y=t.point=null,k(t,h,l,c,s,a,r,o),k(t,e,n,i,s,a,r,o)}else t.x=n,t.y=i,t.point=e}else k(t,e,n,i,s,a,r,o)}function k(t,e,n,i,s,a,r,o){var l=.5*(s+r),c=.5*(a+o),h=n>=l,u=i>=c,d=u<<1|h;t.leaf=!1,h?s=l:r=l,u?a=c:o=c,j(t=t.nodes[d]||(t.nodes[d]={leaf:!0,nodes:[],point:null,x:null,y:null}),e,n,i,s,a,r,o)}w>A?g=m+w:f=p+A;var N={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){j(N,t,+y(t,++u),+b(t,u),p,m,f,g)},visit:function(t){Js(t,N,p,m,f,g)},find:function(t){return Ks(N,t[0],t[1],p,m,f,g)}};if(u=-1,null==e){for(;++u<d;)j(N,t[u],c[u],h[u],p,m,f,g);--u}else t.forEach(N.add);return c=h=t=l=null,N}return l.x=function(t){return arguments.length?(r=t,l):r},l.y=function(t){return arguments.length?(o=t,l):o},l.extent=function(t){return arguments.length?(null==t?e=n=i=s=null:(e=+t[0][0],n=+t[0][1],i=+t[1][0],s=+t[1][1]),l):null==e?null:[[e,n],[i,s]]},l.size=function(t){return arguments.length?(null==t?e=n=i=s=null:(e=n=0,i=+t[0],s=+t[1]),l):null==e?null:[i-e,s-n]},l},a.interpolateRgb=Qs,a.interpolateObject=ta,a.interpolateNumber=ea,a.interpolateString=na;var ia=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sa=new RegExp(ia.source,"g");function aa(t,e){for(var n,i=a.interpolators.length;--i>=0&&!(n=a.interpolators[i](t,e)););return n}function ra(t,e){var n,i=[],s=[],a=t.length,r=e.length,o=Math.min(t.length,e.length);for(n=0;n<o;++n)i.push(aa(t[n],e[n]));for(;n<a;++n)s[n]=t[n];for(;n<r;++n)s[n]=e[n];return function(t){for(n=0;n<o;++n)s[n]=i[n](t);return s}}a.interpolate=aa,a.interpolators=[function(t,e){var n=typeof e;return("string"===n?ve.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?Qs:na:e instanceof Wt?Qs:Array.isArray(e)?ra:"object"===n&&isNaN(e)?ta:ea)(t,e)}],a.interpolateArray=ra;var oa=function(){return I},la=a.map({linear:oa,poly:function(t){return function(e){return Math.pow(e,t)}},quad:function(){return pa},cubic:function(){return ma},sin:function(){return ga},exp:function(){return ya},circle:function(){return ba},elastic:function(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/Ct*Math.asin(1/t):(t=1,n=e/4),function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*Ct/e)}},back:function(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}},bounce:function(){return va}}),ca=a.map({in:I,out:ua,"in-out":da,"out-in":function(t){return da(ua(t))}});function ha(t){return function(e){return e<=0?0:e>=1?1:t(e)}}function ua(t){return function(e){return 1-t(1-e)}}function da(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function pa(t){return t*t}function ma(t){return t*t*t}function fa(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function ga(t){return 1-Math.cos(t*Tt)}function ya(t){return Math.pow(2,10*(t-1))}function ba(t){return 1-Math.sqrt(1-t*t)}function va(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function xa(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function wa(t){var e,n,i,s=[t.a,t.b],a=[t.c,t.d],r=Aa(s),o=Ea(s,a),l=Aa(((e=a)[0]+=(i=-o)*(n=s)[0],e[1]+=i*n[1],e))||0;s[0]*a[1]<a[0]*s[1]&&(s[0]*=-1,s[1]*=-1,r*=-1,o*=-1),this.rotate=(r?Math.atan2(s[1],s[0]):Math.atan2(-a[0],a[1]))*Ut,this.translate=[t.e,t.f],this.scale=[r,l],this.skew=l?Math.atan2(o,l)*Ut:0}function Ea(t,e){return t[0]*e[0]+t[1]*e[1]}function Aa(t){var e=Math.sqrt(Ea(t,t));return e&&(t[0]/=e,t[1]/=e),e}a.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.slice(0,e):t,i=e>=0?t.slice(e+1):"in";return n=la.get(n)||oa,ha((i=ca.get(i)||I)(n.apply(null,r.call(arguments,1))))},a.interpolateHcl=function(t,e){t=a.hcl(t),e=a.hcl(e);var n=t.h,i=t.c,s=t.l,r=e.h-n,o=e.c-i,l=e.l-s;return isNaN(o)&&(o=0,i=isNaN(i)?e.c:i),isNaN(r)?(r=0,n=isNaN(n)?e.h:n):r>180?r-=360:r<-180&&(r+=360),function(t){return Kt(n+r*t,i+o*t,s+l*t)+""}},a.interpolateHsl=function(t,e){t=a.hsl(t),e=a.hsl(e);var n=t.h,i=t.s,s=t.l,r=e.h-n,o=e.s-i,l=e.l-s;return isNaN(o)&&(o=0,i=isNaN(i)?e.s:i),isNaN(r)?(r=0,n=isNaN(n)?e.h:n):r>180?r-=360:r<-180&&(r+=360),function(t){return Yt(n+r*t,i+o*t,s+l*t)+""}},a.interpolateLab=function(t,e){t=a.lab(t),e=a.lab(e);var n=t.l,i=t.a,s=t.b,r=e.l-n,o=e.a-i,l=e.b-s;return function(t){return se(n+r*t,i+o*t,s+l*t)+""}},a.interpolateRound=xa,a.transform=function(t){var e=l.createElementNS(a.ns.prefix.svg,"g");return(a.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new wa(n?n.matrix:ja)})(t)},wa.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ja={a:1,b:0,c:0,d:1,e:0,f:0};function ka(t){return t.length?t.pop()+",":""}function Na(t,e){var n=[],i=[];return t=a.transform(t),e=a.transform(e),function(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var s=n.push("translate(",null,",",null,")");i.push({i:s-4,x:ea(t[0],e[0])},{i:s-2,x:ea(t[1],e[1])})}else(e[0]||e[1])&&n.push("translate("+e+")")}(t.translate,e.translate,n,i),function(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(ka(n)+"rotate(",null,")")-2,x:ea(t,e)})):e&&n.push(ka(n)+"rotate("+e+")")}(t.rotate,e.rotate,n,i),function(t,e,n,i){t!==e?i.push({i:n.push(ka(n)+"skewX(",null,")")-2,x:ea(t,e)}):e&&n.push(ka(n)+"skewX("+e+")")}(t.skew,e.skew,n,i),function(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var s=n.push(ka(n)+"scale(",null,",",null,")");i.push({i:s-4,x:ea(t[0],e[0])},{i:s-2,x:ea(t[1],e[1])})}else 1===e[0]&&1===e[1]||n.push(ka(n)+"scale("+e+")")}(t.scale,e.scale,n,i),t=e=null,function(t){for(var e,s=-1,a=i.length;++s<a;)n[(e=i[s]).i]=e.x(t);return n.join("")}}function _a(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function Oa(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function La(t){for(var e=t.source,n=t.target,i=function(t,e){if(t===e)return t;for(var n=Ma(t),i=Ma(e),s=n.pop(),a=i.pop(),r=null;s===a;)r=s,s=n.pop(),a=i.pop();return r}(e,n),s=[e];e!==i;)e=e.parent,s.push(e);for(var a=s.length;n!==i;)s.splice(a,0,n),n=n.parent;return s}function Ma(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Ca(t){t.fixed|=2}function Sa(t){t.fixed&=-7}function Ta(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Ia(t){t.fixed&=-5}function Ua(t,e,n){var i=0,s=0;if(t.charge=0,!t.leaf)for(var a,r=t.nodes,o=r.length,l=-1;++l<o;)null!=(a=r[l])&&(Ua(a,e,n),t.charge+=a.charge,i+=a.charge*a.cx,s+=a.charge*a.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var c=e*n[t.point.index];t.charge+=t.pointCharge=c,i+=c*t.point.x,s+=c*t.point.y}t.cx=i/t.charge,t.cy=s/t.charge}a.interpolateTransform=Na,a.layout={},a.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;++n<i;)e.push(La(t[n]));return e}},a.layout.chord=function(){var t,e,n,i,s,r,o,l={},c=0;function h(){var l,h,d,p,m,f={},g=[],y=a.range(i),b=[];for(t=[],e=[],l=0,p=-1;++p<i;){for(h=0,m=-1;++m<i;)h+=n[p][m];g.push(h),b.push(a.range(i)),l+=h}for(s&&y.sort((function(t,e){return s(g[t],g[e])})),r&&b.forEach((function(t,e){t.sort((function(t,i){return r(n[e][t],n[e][i])}))})),l=(Ct-c*i)/l,h=0,p=-1;++p<i;){for(d=h,m=-1;++m<i;){var v=y[p],x=b[v][m],w=n[v][x],E=h,A=h+=w*l;f[v+"-"+x]={index:v,subindex:x,startAngle:E,endAngle:A,value:w}}e[v]={index:v,startAngle:d,endAngle:h,value:g[v]},h+=c}for(p=-1;++p<i;)for(m=p-1;++m<i;){var j=f[p+"-"+m],k=f[m+"-"+p];(j.value||k.value)&&t.push(j.value<k.value?{source:k,target:j}:{source:j,target:k})}o&&u()}function u(){t.sort((function(t,e){return o((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)}))}return l.matrix=function(s){return arguments.length?(i=(n=s)&&n.length,t=e=null,l):n},l.padding=function(n){return arguments.length?(c=n,t=e=null,l):c},l.sortGroups=function(n){return arguments.length?(s=n,t=e=null,l):s},l.sortSubgroups=function(e){return arguments.length?(r=e,t=null,l):r},l.sortChords=function(e){return arguments.length?(o=e,t&&u(),l):o},l.chords=function(){return t||h(),t},l.groups=function(){return e||h(),e},l},a.layout.force=function(){var t,e,n,i,s,r,o={},l=a.dispatch("start","tick","end"),c=[1,1],h=.9,u=Da,d=Ha,p=-30,m=Pa,f=.1,g=.64,y=[],b=[];function v(t){return function(e,n,i,s){if(e.point!==t){var a=e.cx-t.x,r=e.cy-t.y,o=s-n,l=a*a+r*r;if(o*o/g<l){if(l<m){var c=e.charge/l;t.px-=a*c,t.py-=r*c}return!0}e.point&&l&&l<m&&(c=e.pointCharge/l,t.px-=a*c,t.py-=r*c)}return!e.charge}}function x(t){t.px=a.event.x,t.py=a.event.y,o.resume()}return o.tick=function(){if((n*=.99)<.005)return t=null,l.end({type:"end",alpha:n=0}),!0;var e,o,u,d,m,g,x,w,E,A=y.length,j=b.length;for(o=0;o<j;++o)d=(u=b[o]).source,(g=(w=(m=u.target).x-d.x)*w+(E=m.y-d.y)*E)&&(w*=g=n*s[o]*((g=Math.sqrt(g))-i[o])/g,E*=g,m.x-=w*(x=d.weight+m.weight?d.weight/(d.weight+m.weight):.5),m.y-=E*x,d.x+=w*(x=1-x),d.y+=E*x);if((x=n*f)&&(w=c[0]/2,E=c[1]/2,o=-1,x))for(;++o<A;)(u=y[o]).x+=(w-u.x)*x,u.y+=(E-u.y)*x;if(p)for(Ua(e=a.geom.quadtree(y),n,r),o=-1;++o<A;)(u=y[o]).fixed||e.visit(v(u));for(o=-1;++o<A;)(u=y[o]).fixed?(u.x=u.px,u.y=u.py):(u.x-=(u.px-(u.px=u.x))*h,u.y-=(u.py-(u.py=u.y))*h);l.tick({type:"tick",alpha:n})},o.nodes=function(t){return arguments.length?(y=t,o):y},o.links=function(t){return arguments.length?(b=t,o):b},o.size=function(t){return arguments.length?(c=t,o):c},o.linkDistance=function(t){return arguments.length?(u="function"==typeof t?t:+t,o):u},o.distance=o.linkDistance,o.linkStrength=function(t){return arguments.length?(d="function"==typeof t?t:+t,o):d},o.friction=function(t){return arguments.length?(h=+t,o):h},o.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,o):p},o.chargeDistance=function(t){return arguments.length?(m=t*t,o):Math.sqrt(m)},o.gravity=function(t){return arguments.length?(f=+t,o):f},o.theta=function(t){return arguments.length?(g=t*t,o):Math.sqrt(g)},o.alpha=function(e){return arguments.length?(e=+e,n?e>0?n=e:(t.c=null,t.t=NaN,t=null,l.end({type:"end",alpha:n=0})):e>0&&(l.start({type:"start",alpha:n=e}),t=Oe(o.tick)),o):n},o.start=function(){var t,e,n,a=y.length,l=b.length,h=c[0],m=c[1];for(t=0;t<a;++t)(n=y[t]).index=t,n.weight=0;for(t=0;t<l;++t)"number"==typeof(n=b[t]).source&&(n.source=y[n.source]),"number"==typeof n.target&&(n.target=y[n.target]),++n.source.weight,++n.target.weight;for(t=0;t<a;++t)n=y[t],isNaN(n.x)&&(n.x=f("x",h)),isNaN(n.y)&&(n.y=f("y",m)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(i=[],"function"==typeof u)for(t=0;t<l;++t)i[t]=+u.call(this,b[t],t);else for(t=0;t<l;++t)i[t]=u;if(s=[],"function"==typeof d)for(t=0;t<l;++t)s[t]=+d.call(this,b[t],t);else for(t=0;t<l;++t)s[t]=d;if(r=[],"function"==typeof p)for(t=0;t<a;++t)r[t]=+p.call(this,y[t],t);else for(t=0;t<a;++t)r[t]=p;function f(n,i){if(!e){for(e=new Array(a),c=0;c<a;++c)e[c]=[];for(c=0;c<l;++c){var s=b[c];e[s.source.index].push(s.target),e[s.target.index].push(s.source)}}for(var r,o=e[t],c=-1,h=o.length;++c<h;)if(!isNaN(r=o[c][n]))return r;return Math.random()*i}return o.resume()},o.resume=function(){return o.alpha(.1)},o.stop=function(){return o.alpha(0)},o.drag=function(){if(e||(e=a.behavior.drag().origin(I).on("dragstart.force",Ca).on("drag.force",x).on("dragend.force",Sa)),!arguments.length)return e;this.on("mouseover.force",Ta).on("mouseout.force",Ia).call(e)},a.rebind(o,l,"on")};var Da=20,Ha=1,Pa=1/0;function Ra(t,e){return a.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=$a,t}function Ba(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(s=t.children)&&(i=s.length))for(var i,s;--i>=0;)n.push(s[i])}function Va(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(a=t.children)&&(s=a.length))for(var s,a,r=-1;++r<s;)n.push(a[r]);for(;null!=(t=i.pop());)e(t)}function za(t){return t.children}function Fa(t){return t.value}function qa(t,e){return e.value-t.value}function $a(t){return a.merge(t.map((function(t){return(t.children||[]).map((function(e){return{source:t,target:e}}))})))}a.layout.hierarchy=function(){var t=qa,e=za,n=Fa;function i(s){var a,r=[s],o=[];for(s.depth=0;null!=(a=r.pop());)if(o.push(a),(c=e.call(i,a,a.depth))&&(l=c.length)){for(var l,c,h;--l>=0;)r.push(h=c[l]),h.parent=a,h.depth=a.depth+1;n&&(a.value=0),a.children=c}else n&&(a.value=+n.call(i,a,a.depth)||0),delete a.children;return Va(s,(function(e){var i,s;t&&(i=e.children)&&i.sort(t),n&&(s=e.parent)&&(s.value+=e.value)})),o}return i.sort=function(e){return arguments.length?(t=e,i):t},i.children=function(t){return arguments.length?(e=t,i):e},i.value=function(t){return arguments.length?(n=t,i):n},i.revalue=function(t){return n&&(Ba(t,(function(t){t.children&&(t.value=0)})),Va(t,(function(t){var e;t.children||(t.value=+n.call(i,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)}))),t},i},a.layout.partition=function(){var t=a.layout.hierarchy(),e=[1,1];function n(t,e,i,s){var a=t.children;if(t.x=e,t.y=t.depth*s,t.dx=i,t.dy=s,a&&(r=a.length)){var r,o,l,c=-1;for(i=t.value?i/t.value:0;++c<r;)n(o=a[c],e,l=o.value*i,s),e+=l}}function i(t){var e=t.children,n=0;if(e&&(s=e.length))for(var s,a=-1;++a<s;)n=Math.max(n,i(e[a]));return 1+n}function s(s,a){var r=t.call(this,s,a);return n(r[0],0,e[0],e[1]/i(r[0])),r}return s.size=function(t){return arguments.length?(e=t,s):e},Ra(s,t)},a.layout.pie=function(){var t=Number,e=Wa,n=0,i=Ct,s=0;function r(o){var l,c=o.length,h=o.map((function(e,n){return+t.call(r,e,n)})),u=+("function"==typeof n?n.apply(this,arguments):n),d=("function"==typeof i?i.apply(this,arguments):i)-u,p=Math.min(Math.abs(d)/c,+("function"==typeof s?s.apply(this,arguments):s)),m=p*(d<0?-1:1),f=a.sum(h),g=f?(d-c*m)/f:0,y=a.range(c),b=[];return null!=e&&y.sort(e===Wa?function(t,e){return h[e]-h[t]}:function(t,n){return e(o[t],o[n])}),y.forEach((function(t){b[t]={data:o[t],value:l=h[t],startAngle:u,endAngle:u+=l*g+m,padAngle:p}})),b}return r.value=function(e){return arguments.length?(t=e,r):t},r.sort=function(t){return arguments.length?(e=t,r):e},r.startAngle=function(t){return arguments.length?(n=t,r):n},r.endAngle=function(t){return arguments.length?(i=t,r):i},r.padAngle=function(t){return arguments.length?(s=t,r):s},r};var Wa={};function Za(t){return t.x}function Xa(t){return t.y}function Ya(t,e,n){t.y0=e,t.y=n}a.layout.stack=function(){var t=I,e=Ka,n=Qa,i=Ya,s=Za,r=Xa;function o(l,c){if(!(p=l.length))return l;var h=l.map((function(e,n){return t.call(o,e,n)})),u=h.map((function(t){return t.map((function(t,e){return[s.call(o,t,e),r.call(o,t,e)]}))})),d=e.call(o,u,c);h=a.permute(h,d),u=a.permute(u,d);var p,m,f,g,y=n.call(o,u,c),b=h[0].length;for(f=0;f<b;++f)for(i.call(o,h[0][f],g=y[f],u[0][f][1]),m=1;m<p;++m)i.call(o,h[m][f],g+=u[m-1][f][1],u[m][f][1]);return l}return o.values=function(e){return arguments.length?(t=e,o):t},o.order=function(t){return arguments.length?(e="function"==typeof t?t:Ga.get(t)||Ka,o):e},o.offset=function(t){return arguments.length?(n="function"==typeof t?t:Ja.get(t)||Qa,o):n},o.x=function(t){return arguments.length?(s=t,o):s},o.y=function(t){return arguments.length?(r=t,o):r},o.out=function(t){return arguments.length?(i=t,o):i},o};var Ga=a.map({"inside-out":function(t){var e,n,i=t.length,s=t.map(tr),r=t.map(er),o=a.range(i).sort((function(t,e){return s[t]-s[e]})),l=0,c=0,h=[],u=[];for(e=0;e<i;++e)n=o[e],l<c?(l+=r[n],h.push(n)):(c+=r[n],u.push(n));return u.reverse().concat(h)},reverse:function(t){return a.range(t.length).reverse()},default:Ka}),Ja=a.map({silhouette:function(t){var e,n,i,s=t.length,a=t[0].length,r=[],o=0,l=[];for(n=0;n<a;++n){for(e=0,i=0;e<s;e++)i+=t[e][n][1];i>o&&(o=i),r.push(i)}for(n=0;n<a;++n)l[n]=(o-r[n])/2;return l},wiggle:function(t){var e,n,i,s,a,r,o,l,c,h=t.length,u=t[0],d=u.length,p=[];for(p[0]=l=c=0,n=1;n<d;++n){for(e=0,s=0;e<h;++e)s+=t[e][n][1];for(e=0,a=0,o=u[n][0]-u[n-1][0];e<h;++e){for(i=0,r=(t[e][n][1]-t[e][n-1][1])/(2*o);i<e;++i)r+=(t[i][n][1]-t[i][n-1][1])/o;a+=r*t[e][n][1]}p[n]=l-=s?a/s*o:0,l<c&&(c=l)}for(n=0;n<d;++n)p[n]-=c;return p},expand:function(t){var e,n,i,s=t.length,a=t[0].length,r=1/s,o=[];for(n=0;n<a;++n){for(e=0,i=0;e<s;e++)i+=t[e][n][1];if(i)for(e=0;e<s;e++)t[e][n][1]/=i;else for(e=0;e<s;e++)t[e][n][1]=r}for(n=0;n<a;++n)o[n]=0;return o},zero:Qa});function Ka(t){return a.range(t.length)}function Qa(t){for(var e=-1,n=t[0].length,i=[];++e<n;)i[e]=0;return i}function tr(t){for(var e,n=1,i=0,s=t[0][1],a=t.length;n<a;++n)(e=t[n][1])>s&&(i=n,s=e);return i}function er(t){return t.reduce(nr,0)}function nr(t,e){return t+e[1]}function ir(t,e){return sr(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function sr(t,e){for(var n=-1,i=+t[0],s=(t[1]-i)/e,a=[];++n<=e;)a[n]=s*n+i;return a}function ar(t){return[a.min(t),a.max(t)]}function rr(t,e){return t.value-e.value}function or(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function lr(t,e){t._pack_next=e,e._pack_prev=t}function cr(t,e){var n=e.x-t.x,i=e.y-t.y,s=t.r+e.r;return.999*s*s>n*n+i*i}function hr(t){if((e=t.children)&&(l=e.length)){var e,n,i,s,a,r,o,l,c=1/0,h=-1/0,u=1/0,d=-1/0;if(e.forEach(ur),(n=e[0]).x=-n.r,n.y=0,v(n),l>1&&((i=e[1]).x=i.r,i.y=0,v(i),l>2))for(mr(n,i,s=e[2]),v(s),or(n,s),n._pack_prev=s,or(s,i),i=n._pack_next,a=3;a<l;a++){mr(n,i,s=e[a]);var p=0,m=1,f=1;for(r=i._pack_next;r!==i;r=r._pack_next,m++)if(cr(r,s)){p=1;break}if(1==p)for(o=n._pack_prev;o!==r._pack_prev&&!cr(o,s);o=o._pack_prev,f++);p?(m<f||m==f&&i.r<n.r?lr(n,i=r):lr(n=o,i),a--):(or(n,s),i=s,v(s))}var g=(c+h)/2,y=(u+d)/2,b=0;for(a=0;a<l;a++)(s=e[a]).x-=g,s.y-=y,b=Math.max(b,s.r+Math.sqrt(s.x*s.x+s.y*s.y));t.r=b,e.forEach(dr)}function v(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),u=Math.min(t.y-t.r,u),d=Math.max(t.y+t.r,d)}}function ur(t){t._pack_next=t._pack_prev=t}function dr(t){delete t._pack_next,delete t._pack_prev}function pr(t,e,n,i){var s=t.children;if(t.x=e+=i*t.x,t.y=n+=i*t.y,t.r*=i,s)for(var a=-1,r=s.length;++a<r;)pr(s[a],e,n,i)}function mr(t,e,n){var i=t.r+n.r,s=e.x-t.x,a=e.y-t.y;if(i&&(s||a)){var r=e.r+n.r,o=s*s+a*a,l=.5+((i*=i)-(r*=r))/(2*o),c=Math.sqrt(Math.max(0,2*r*(i+o)-(i-=o)*i-r*r))/(2*o);n.x=t.x+l*s+c*a,n.y=t.y+l*a-c*s}else n.x=t.x+i,n.y=t.y}function fr(t,e){return t.parent==e.parent?1:2}function gr(t){var e=t.children;return e.length?e[0]:t.t}function yr(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function br(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function vr(t,e,n){return t.a.parent===e.parent?t.a:n}function xr(t){var e=t.children;return e&&e.length?xr(e[0]):t}function wr(t){var e,n=t.children;return n&&(e=n.length)?wr(n[e-1]):t}function Er(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Ar(t,e){var n=t.x+e[3],i=t.y+e[0],s=t.dx-e[1]-e[3],a=t.dy-e[0]-e[2];return s<0&&(n+=s/2,s=0),a<0&&(i+=a/2,a=0),{x:n,y:i,dx:s,dy:a}}function jr(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]}function kr(t){return t.rangeExtent?t.rangeExtent():jr(t.range())}function Nr(t,e,n,i){var s=n(t[0],t[1]),a=i(e[0],e[1]);return function(t){return a(s(t))}}function _r(t,e){var n,i=0,s=t.length-1,a=t[i],r=t[s];return r<a&&(n=i,i=s,s=n,n=a,a=r,r=n),t[i]=e.floor(a),t[s]=e.ceil(r),t}function Or(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:Lr}a.layout.histogram=function(){var t=!0,e=Number,n=ar,i=ir;function s(s,r){for(var o,l,c=[],h=s.map(e,this),u=n.call(this,h,r),d=i.call(this,u,h,r),p=(r=-1,h.length),m=d.length-1,f=t?1:1/p;++r<m;)(o=c[r]=[]).dx=d[r+1]-(o.x=d[r]),o.y=0;if(m>0)for(r=-1;++r<p;)(l=h[r])>=u[0]&&l<=u[1]&&((o=c[a.bisect(d,l,1,m)-1]).y+=f,o.push(s[r]));return c}return s.value=function(t){return arguments.length?(e=t,s):e},s.range=function(t){return arguments.length?(n=xe(t),s):n},s.bins=function(t){return arguments.length?(i="number"==typeof t?function(e){return sr(e,t)}:xe(t),s):i},s.frequency=function(e){return arguments.length?(t=!!e,s):t},s},a.layout.pack=function(){var t,e=a.layout.hierarchy().sort(rr),n=0,i=[1,1];function s(s,a){var r=e.call(this,s,a),o=r[0],l=i[0],c=i[1],h=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(o.x=o.y=0,Va(o,(function(t){t.r=+h(t.value)})),Va(o,hr),n){var u=n*(t?1:Math.max(2*o.r/l,2*o.r/c))/2;Va(o,(function(t){t.r+=u})),Va(o,hr),Va(o,(function(t){t.r-=u}))}return pr(o,l/2,c/2,t?1:1/Math.max(2*o.r/l,2*o.r/c)),r}return s.size=function(t){return arguments.length?(i=t,s):i},s.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,s):t},s.padding=function(t){return arguments.length?(n=+t,s):n},Ra(s,e)},a.layout.tree=function(){var t=a.layout.hierarchy().sort(null).value(null),e=fr,n=[1,1],i=null;function s(s,a){var c=t.call(this,s,a),h=c[0],u=function(t){for(var e,n={A:null,children:[t]},i=[n];null!=(e=i.pop());)for(var s,a=e.children,r=0,o=a.length;r<o;++r)i.push((a[r]=s={_:a[r],parent:e,children:(s=a[r].children)&&s.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:r}).a=s);return n.children[0]}(h);if(Va(u,r),u.parent.m=-u.z,Ba(u,o),i)Ba(h,l);else{var d=h,p=h,m=h;Ba(h,(function(t){t.x<d.x&&(d=t),t.x>p.x&&(p=t),t.depth>m.depth&&(m=t)}));var f=e(d,p)/2-d.x,g=n[0]/(p.x+e(p,d)/2+f),y=n[1]/(m.depth||1);Ba(h,(function(t){t.x=(t.x+f)*g,t.y=t.depth*y}))}return c}function r(t){var n=t.children,i=t.parent.children,s=t.i?i[t.i-1]:null;if(n.length){!function(t){for(var e,n=0,i=0,s=t.children,a=s.length;--a>=0;)(e=s[a]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(t);var a=(n[0].z+n[n.length-1].z)/2;s?(t.z=s.z+e(t._,s._),t.m=t.z-a):t.z=a}else s&&(t.z=s.z+e(t._,s._));t.parent.A=function(t,n,i){if(n){for(var s,a=t,r=t,o=n,l=a.parent.children[0],c=a.m,h=r.m,u=o.m,d=l.m;o=yr(o),a=gr(a),o&&a;)l=gr(l),(r=yr(r)).a=t,(s=o.z+u-a.z-c+e(o._,a._))>0&&(br(vr(o,t,i),t,s),c+=s,h+=s),u+=o.m,c+=a.m,d+=l.m,h+=r.m;o&&!yr(r)&&(r.t=o,r.m+=u-h),a&&!gr(l)&&(l.t=a,l.m+=c-d,i=t)}return i}(t,s,t.parent.A||i[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function l(t){t.x*=n[0],t.y=t.depth*n[1]}return s.separation=function(t){return arguments.length?(e=t,s):e},s.size=function(t){return arguments.length?(i=null==(n=t)?l:null,s):i?null:n},s.nodeSize=function(t){return arguments.length?(i=null==(n=t)?null:l,s):i?n:null},Ra(s,t)},a.layout.cluster=function(){var t=a.layout.hierarchy().sort(null).value(null),e=fr,n=[1,1],i=!1;function s(s,r){var o,l=t.call(this,s,r),c=l[0],h=0;Va(c,(function(t){var n=t.children;n&&n.length?(t.x=function(t){return t.reduce((function(t,e){return t+e.x}),0)/t.length}(n),t.y=function(t){return 1+a.max(t,(function(t){return t.y}))}(n)):(t.x=o?h+=e(t,o):0,t.y=0,o=t)}));var u=xr(c),d=wr(c),p=u.x-e(u,d)/2,m=d.x+e(d,u)/2;return Va(c,i?function(t){t.x=(t.x-c.x)*n[0],t.y=(c.y-t.y)*n[1]}:function(t){t.x=(t.x-p)/(m-p)*n[0],t.y=(1-(c.y?t.y/c.y:1))*n[1]}),l}return s.separation=function(t){return arguments.length?(e=t,s):e},s.size=function(t){return arguments.length?(i=null==(n=t),s):i?null:n},s.nodeSize=function(t){return arguments.length?(i=null!=(n=t),s):i?n:null},Ra(s,t)},a.layout.treemap=function(){var t,e=a.layout.hierarchy(),n=Math.round,i=[1,1],s=null,r=Er,o=!1,l="squarify",c=.5*(1+Math.sqrt(5));function h(t,e){for(var n,i,s=-1,a=t.length;++s<a;)i=(n=t[s]).value*(e<0?0:e),n.area=isNaN(i)||i<=0?0:i}function u(t){var e=t.children;if(e&&e.length){var n,i,s,a=r(t),o=[],c=e.slice(),d=1/0,f="slice"===l?a.dx:"dice"===l?a.dy:"slice-dice"===l?1&t.depth?a.dy:a.dx:Math.min(a.dx,a.dy);for(h(c,a.dx*a.dy/t.value),o.area=0;(s=c.length)>0;)o.push(n=c[s-1]),o.area+=n.area,"squarify"!==l||(i=p(o,f))<=d?(c.pop(),d=i):(o.area-=o.pop().area,m(o,f,a,!1),f=Math.min(a.dx,a.dy),o.length=o.area=0,d=1/0);o.length&&(m(o,f,a,!0),o.length=o.area=0),e.forEach(u)}}function d(t){var e=t.children;if(e&&e.length){var n,i=r(t),s=e.slice(),a=[];for(h(s,i.dx*i.dy/t.value),a.area=0;n=s.pop();)a.push(n),a.area+=n.area,null!=n.z&&(m(a,n.z?i.dx:i.dy,i,!s.length),a.length=a.area=0);e.forEach(d)}}function p(t,e){for(var n,i=t.area,s=0,a=1/0,r=-1,o=t.length;++r<o;)(n=t[r].area)&&(n<a&&(a=n),n>s&&(s=n));return e*=e,(i*=i)?Math.max(e*s*c/i,i/(e*a*c)):1/0}function m(t,e,i,s){var a,r=-1,o=t.length,l=i.x,c=i.y,h=e?n(t.area/e):0;if(e==i.dx){for((s||h>i.dy)&&(h=i.dy);++r<o;)(a=t[r]).x=l,a.y=c,a.dy=h,l+=a.dx=Math.min(i.x+i.dx-l,h?n(a.area/h):0);a.z=!0,a.dx+=i.x+i.dx-l,i.y+=h,i.dy-=h}else{for((s||h>i.dx)&&(h=i.dx);++r<o;)(a=t[r]).x=l,a.y=c,a.dx=h,c+=a.dy=Math.min(i.y+i.dy-c,h?n(a.area/h):0);a.z=!1,a.dy+=i.y+i.dy-c,i.x+=h,i.dx-=h}}function f(n){var s=t||e(n),a=s[0];return a.x=a.y=0,a.value?(a.dx=i[0],a.dy=i[1]):a.dx=a.dy=0,t&&e.revalue(a),h([a],a.dx*a.dy/a.value),(t?d:u)(a),o&&(t=s),s}return f.size=function(t){return arguments.length?(i=t,f):i},f.padding=function(t){if(!arguments.length)return s;function e(e){var n=t.call(f,e,e.depth);return null==n?Er(e):Ar(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return Ar(e,t)}var i;return r=null==(s=t)?Er:"function"==(i=typeof t)?e:"number"===i?(t=[t,t,t,t],n):n,f},f.round=function(t){return arguments.length?(n=t?Math.round:Number,f):n!=Number},f.sticky=function(e){return arguments.length?(o=e,t=null,f):o},f.ratio=function(t){return arguments.length?(c=t,f):c},f.mode=function(t){return arguments.length?(l=t+"",f):l},Ra(f,e)},a.random={normal:function(t,e){var n=arguments.length;return n<2&&(e=1),n<1&&(t=0),function(){var n,i,s;do{s=(n=2*Math.random()-1)*n+(i=2*Math.random()-1)*i}while(!s||s>1);return t+e*n*Math.sqrt(-2*Math.log(s)/s)}},logNormal:function(){var t=a.random.normal.apply(a,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=a.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;n<t;n++)e+=Math.random();return e}}},a.scale={};var Lr={floor:I,ceil:I};function Mr(t,e,n,i){var s=[],r=[],o=0,l=Math.min(t.length,e.length)-1;for(t[l]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<=l;)s.push(n(t[o-1],t[o])),r.push(i(e[o-1],e[o]));return function(e){var n=a.bisect(t,e,1,l)-1;return r[n](s[n](e))}}function Cr(t,e,n,i){var s,a;function r(){var r=Math.min(t.length,e.length)>2?Mr:Nr,l=i?Oa:_a;return s=r(t,e,l,n),a=r(e,t,l,aa),o}function o(t){return s(t)}return o.invert=function(t){return a(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},o.range=function(t){return arguments.length?(e=t,r()):e},o.rangeRound=function(t){return o.range(t).interpolate(xa)},o.clamp=function(t){return arguments.length?(i=t,r()):i},o.interpolate=function(t){return arguments.length?(n=t,r()):n},o.ticks=function(e){return Ur(t,e)},o.tickFormat=function(e,n){return Dr(t,e,n)},o.nice=function(e){return Tr(t,e),r()},o.copy=function(){return Cr(t,e,n,i)},r()}function Sr(t,e){return a.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Tr(t,e){return _r(t,Or(Ir(t,e)[2])),_r(t,Or(Ir(t,e)[2])),t}function Ir(t,e){null==e&&(e=10);var n=jr(t),i=n[1]-n[0],s=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),a=e/i*s;return a<=.15?s*=10:a<=.35?s*=5:a<=.75&&(s*=2),n[0]=Math.ceil(n[0]/s)*s,n[1]=Math.floor(n[1]/s)*s+.5*s,n[2]=s,n}function Ur(t,e){return a.range.apply(a,Ir(t,e))}function Dr(t,e,n){var i=Ir(t,e);if(n){var s=Ue.exec(n);if(s.shift(),"s"===s[8]){var r=a.formatPrefix(Math.max(E(i[0]),E(i[1])));return s[7]||(s[7]="."+Pr(r.scale(i[2]))),s[8]="f",n=a.format(s.join("")),function(t){return n(r.scale(t))+r.symbol}}s[7]||(s[7]="."+function(t,e){var n=Pr(e[2]);return t in Hr?Math.abs(n-Pr(Math.max(E(e[0]),E(e[1]))))+ +("e"!==t):n-2*("%"===t)}(s[8],i)),n=s.join("")}else n=",."+Pr(i[2])+"f";return a.format(n)}a.scale.linear=function(){return Cr([0,1],[0,1],aa,!1)};var Hr={s:1,g:1,p:1,r:1,e:1};function Pr(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Rr(t,e,n,i){function s(t){return(n?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function r(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function o(e){return t(s(e))}return o.invert=function(e){return r(t.invert(e))},o.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((i=e.map(Number)).map(s)),o):i},o.base=function(n){return arguments.length?(e=+n,t.domain(i.map(s)),o):e},o.nice=function(){var e=_r(i.map(s),n?Math:Vr);return t.domain(e),i=e.map(r),o},o.ticks=function(){var t=jr(i),a=[],o=t[0],l=t[1],c=Math.floor(s(o)),h=Math.ceil(s(l)),u=e%1?2:e;if(isFinite(h-c)){if(n){for(;c<h;c++)for(var d=1;d<u;d++)a.push(r(c)*d);a.push(r(c))}else for(a.push(r(c));c++<h;)for(d=u-1;d>0;d--)a.push(r(c)*d);for(c=0;a[c]<o;c++);for(h=a.length;a[h-1]>l;h--);a=a.slice(c,h)}return a},o.tickFormat=function(t,n){if(!arguments.length)return Br;arguments.length<2?n=Br:"function"!=typeof n&&(n=a.format(n));var i=Math.max(1,e*t/o.ticks().length);return function(t){var a=t/r(Math.round(s(t)));return a*e<e-.5&&(a*=e),a<=i?n(t):""}},o.copy=function(){return Rr(t.copy(),e,n,i)},Sr(o,t)}a.scale.log=function(){return Rr(a.scale.linear().domain([0,1]),10,!0,[1,10])};var Br=a.format(".0e"),Vr={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};function zr(t,e,n){var i=Fr(e),s=Fr(1/e);function a(e){return t(i(e))}return a.invert=function(e){return s(t.invert(e))},a.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(i)),a):n},a.ticks=function(t){return Ur(n,t)},a.tickFormat=function(t,e){return Dr(n,t,e)},a.nice=function(t){return a.domain(Tr(n,t))},a.exponent=function(r){return arguments.length?(i=Fr(e=r),s=Fr(1/e),t.domain(n.map(i)),a):e},a.copy=function(){return zr(t.copy(),e,n)},Sr(a,t)}function Fr(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function qr(t,e){var n,i,s;function r(s){return i[((n.get(s)||("range"===e.t?n.set(s,t.push(s)):NaN))-1)%i.length]}function o(e,n){return a.range(t.length).map((function(t){return e+n*t}))}return r.domain=function(i){if(!arguments.length)return t;t=[],n=new k;for(var s,a=-1,o=i.length;++a<o;)n.has(s=i[a])||n.set(s,t.push(s));return r[e.t].apply(r,e.a)},r.range=function(t){return arguments.length?(i=t,s=0,e={t:"range",a:arguments},r):i},r.rangePoints=function(n,a){arguments.length<2&&(a=0);var l=n[0],c=n[1],h=t.length<2?(l=(l+c)/2,0):(c-l)/(t.length-1+a);return i=o(l+h*a/2,h),s=0,e={t:"rangePoints",a:arguments},r},r.rangeRoundPoints=function(n,a){arguments.length<2&&(a=0);var l=n[0],c=n[1],h=t.length<2?(l=c=Math.round((l+c)/2),0):(c-l)/(t.length-1+a)|0;return i=o(l+Math.round(h*a/2+(c-l-(t.length-1+a)*h)/2),h),s=0,e={t:"rangeRoundPoints",a:arguments},r},r.rangeBands=function(n,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=n[1]<n[0],h=n[c-0],u=n[1-c],d=(u-h)/(t.length-a+2*l);return i=o(h+d*l,d),c&&i.reverse(),s=d*(1-a),e={t:"rangeBands",a:arguments},r},r.rangeRoundBands=function(n,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=n[1]<n[0],h=n[c-0],u=n[1-c],d=Math.floor((u-h)/(t.length-a+2*l));return i=o(h+Math.round((u-h-(t.length-a)*d)/2),d),c&&i.reverse(),s=Math.round(d*(1-a)),e={t:"rangeRoundBands",a:arguments},r},r.rangeBand=function(){return s},r.rangeExtent=function(){return jr(e.a[0])},r.copy=function(){return qr(t,e)},r.domain(t)}a.scale.pow=function(){return zr(a.scale.linear(),1,[0,1])},a.scale.sqrt=function(){return a.scale.pow().exponent(.5)},a.scale.ordinal=function(){return qr([],{t:"range",a:[[]]})},a.scale.category10=function(){return a.scale.ordinal().range($r)},a.scale.category20=function(){return a.scale.ordinal().range(Wr)},a.scale.category20b=function(){return a.scale.ordinal().range(Zr)},a.scale.category20c=function(){return a.scale.ordinal().range(Xr)};var $r=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ue),Wr=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ue),Zr=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ue),Xr=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ue);function Yr(t,e){var n;function i(){var i=0,r=e.length;for(n=[];++i<r;)n[i-1]=a.quantile(t,i/r);return s}function s(t){if(!isNaN(t=+t))return e[a.bisect(n,t)]}return s.domain=function(e){return arguments.length?(t=e.map(y).filter(b).sort(g),i()):t},s.range=function(t){return arguments.length?(e=t,i()):e},s.quantiles=function(){return n},s.invertExtent=function(i){return(i=e.indexOf(i))<0?[NaN,NaN]:[i>0?n[i-1]:t[0],i<n.length?n[i]:t[t.length-1]]},s.copy=function(){return Yr(t,e)},i()}function Gr(t,e,n){var i,s;function a(e){return n[Math.max(0,Math.min(s,Math.floor(i*(e-t))))]}function r(){return i=n.length/(e-t),s=n.length-1,a}return a.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],r()):[t,e]},a.range=function(t){return arguments.length?(n=t,r()):n},a.invertExtent=function(e){return[e=(e=n.indexOf(e))<0?NaN:e/i+t,e+1/i]},a.copy=function(){return Gr(t,e,n)},r()}function Jr(t,e){function n(n){if(n<=n)return e[a.bisect(t,n)]}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return Jr(t,e)},n}function Kr(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return Ur(t,e)},e.tickFormat=function(e,n){return Dr(t,e,n)},e.copy=function(){return Kr(t)},e}function Qr(){return 0}a.scale.quantile=function(){return Yr([],[])},a.scale.quantize=function(){return Gr(0,1,[0,1])},a.scale.threshold=function(){return Jr([.5],[0,1])},a.scale.identity=function(){return Kr([0,1])},a.svg={},a.svg.arc=function(){var t=eo,e=no,n=Qr,i=to,s=io,a=so,r=ao;function o(){var o=Math.max(0,+t.apply(this,arguments)),c=Math.max(0,+e.apply(this,arguments)),h=s.apply(this,arguments)-Tt,u=a.apply(this,arguments)-Tt,d=Math.abs(u-h),p=h>u?0:1;if(c<o&&(m=c,c=o,o=m),d>=St)return l(c,p)+(o?l(o,1-p):"")+"Z";var m,f,g,y,b,v,x,w,E,A,j,k,N=0,_=0,O=[];if((y=(+r.apply(this,arguments)||0)/2)&&(g=i===to?Math.sqrt(o*o+c*c):+i.apply(this,arguments),p||(_*=-1),c&&(_=Rt(g/c*Math.sin(y))),o&&(N=Rt(g/o*Math.sin(y)))),c){b=c*Math.cos(h+_),v=c*Math.sin(h+_),x=c*Math.cos(u-_),w=c*Math.sin(u-_);var L=Math.abs(u-h-2*_)<=Mt?0:1;if(_&&ro(b,v,x,w)===p^L){var M=(h+u)/2;b=c*Math.cos(M),v=c*Math.sin(M),x=w=null}}else b=v=0;if(o){E=o*Math.cos(u-N),A=o*Math.sin(u-N),j=o*Math.cos(h+N),k=o*Math.sin(h+N);var C=Math.abs(h-u+2*N)<=Mt?0:1;if(N&&ro(E,A,j,k)===1-p^C){var S=(h+u)/2;E=o*Math.cos(S),A=o*Math.sin(S),j=k=null}}else E=A=0;if(d>Ot&&(m=Math.min(Math.abs(c-o)/2,+n.apply(this,arguments)))>.001){f=o<c^p?0:1;var T=m,I=m;if(d<Mt){var U=null==j?[E,A]:null==x?[b,v]:fs([b,v],[j,k],[x,w],[E,A]),D=b-U[0],H=v-U[1],P=x-U[0],R=w-U[1],B=1/Math.sin(Math.acos((D*P+H*R)/(Math.sqrt(D*D+H*H)*Math.sqrt(P*P+R*R)))/2),V=Math.sqrt(U[0]*U[0]+U[1]*U[1]);I=Math.min(m,(o-V)/(B-1)),T=Math.min(m,(c-V)/(B+1))}if(null!=x){var z=oo(null==j?[E,A]:[j,k],[b,v],c,T,p),F=oo([x,w],[E,A],c,T,p);m===T?O.push("M",z[0],"A",T,",",T," 0 0,",f," ",z[1],"A",c,",",c," 0 ",1-p^ro(z[1][0],z[1][1],F[1][0],F[1][1]),",",p," ",F[1],"A",T,",",T," 0 0,",f," ",F[0]):O.push("M",z[0],"A",T,",",T," 0 1,",f," ",F[0])}else O.push("M",b,",",v);if(null!=j){var q=oo([b,v],[j,k],o,-I,p),$=oo([E,A],null==x?[b,v]:[x,w],o,-I,p);m===I?O.push("L",$[0],"A",I,",",I," 0 0,",f," ",$[1],"A",o,",",o," 0 ",p^ro($[1][0],$[1][1],q[1][0],q[1][1]),",",1-p," ",q[1],"A",I,",",I," 0 0,",f," ",q[0]):O.push("L",$[0],"A",I,",",I," 0 0,",f," ",q[0])}else O.push("L",E,",",A)}else O.push("M",b,",",v),null!=x&&O.push("A",c,",",c," 0 ",L,",",p," ",x,",",w),O.push("L",E,",",A),null!=j&&O.push("A",o,",",o," 0 ",C,",",1-p," ",j,",",k);return O.push("Z"),O.join("")}function l(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}return o.innerRadius=function(e){return arguments.length?(t=xe(e),o):t},o.outerRadius=function(t){return arguments.length?(e=xe(t),o):e},o.cornerRadius=function(t){return arguments.length?(n=xe(t),o):n},o.padRadius=function(t){return arguments.length?(i=t==to?to:xe(t),o):i},o.startAngle=function(t){return arguments.length?(s=xe(t),o):s},o.endAngle=function(t){return arguments.length?(a=xe(t),o):a},o.padAngle=function(t){return arguments.length?(r=xe(t),o):r},o.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+s.apply(this,arguments)+ +a.apply(this,arguments))/2-Tt;return[Math.cos(i)*n,Math.sin(i)*n]},o};var to="auto";function eo(t){return t.innerRadius}function no(t){return t.outerRadius}function io(t){return t.startAngle}function so(t){return t.endAngle}function ao(t){return t&&t.padAngle}function ro(t,e,n,i){return(t-n)*e-(e-i)*t>0?0:1}function oo(t,e,n,i,s){var a=t[0]-e[0],r=t[1]-e[1],o=(s?i:-i)/Math.sqrt(a*a+r*r),l=o*r,c=-o*a,h=t[0]+l,u=t[1]+c,d=e[0]+l,p=e[1]+c,m=(h+d)/2,f=(u+p)/2,g=d-h,y=p-u,b=g*g+y*y,v=n-i,x=h*p-d*u,w=(y<0?-1:1)*Math.sqrt(Math.max(0,v*v*b-x*x)),E=(x*y-g*w)/b,A=(-x*g-y*w)/b,j=(x*y+g*w)/b,k=(-x*g+y*w)/b,N=E-m,_=A-f,O=j-m,L=k-f;return N*N+_*_>O*O+L*L&&(E=j,A=k),[[E-l,A-c],[E*n/v,A*n/v]]}function lo(t){var e=cs,n=hs,i=Qn,s=ho,a=s.key,r=.7;function o(a){var o,l=[],c=[],h=-1,u=a.length,d=xe(e),p=xe(n);function m(){l.push("M",s(t(c),r))}for(;++h<u;)i.call(this,o=a[h],h)?c.push([+d.call(this,o,h),+p.call(this,o,h)]):c.length&&(m(),c=[]);return c.length&&m(),l.length?l.join(""):null}return o.x=function(t){return arguments.length?(e=t,o):e},o.y=function(t){return arguments.length?(n=t,o):n},o.defined=function(t){return arguments.length?(i=t,o):i},o.interpolate=function(t){return arguments.length?(a="function"==typeof t?s=t:(s=co.get(t)||ho).key,o):a},o.tension=function(t){return arguments.length?(r=t,o):r},o}a.svg.line=function(){return lo(I)};var co=a.map({linear:ho,"linear-closed":uo,step:function(t){for(var e=0,n=t.length,i=t[0],s=[i[0],",",i[1]];++e<n;)s.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);return n>1&&s.push("H",i[0]),s.join("")},"step-before":po,"step-after":mo,basis:yo,"basis-open":function(t){if(t.length<4)return ho(t);for(var e,n=[],i=-1,s=t.length,a=[0],r=[0];++i<3;)e=t[i],a.push(e[0]),r.push(e[1]);for(n.push(bo(wo,a)+","+bo(wo,r)),--i;++i<s;)e=t[i],a.shift(),a.push(e[0]),r.shift(),r.push(e[1]),Eo(n,a,r);return n.join("")},"basis-closed":function(t){for(var e,n,i=-1,s=t.length,a=s+4,r=[],o=[];++i<4;)n=t[i%s],r.push(n[0]),o.push(n[1]);for(e=[bo(wo,r),",",bo(wo,o)],--i;++i<a;)n=t[i%s],r.shift(),r.push(n[0]),o.shift(),o.push(n[1]),Eo(e,r,o);return e.join("")},bundle:function(t,e){var n=t.length-1;if(n)for(var i,s,a=t[0][0],r=t[0][1],o=t[n][0]-a,l=t[n][1]-r,c=-1;++c<=n;)s=c/n,(i=t[c])[0]=e*i[0]+(1-e)*(a+s*o),i[1]=e*i[1]+(1-e)*(r+s*l);return yo(t)},cardinal:function(t,e){return t.length<3?ho(t):t[0]+fo(t,go(t,e))},"cardinal-open":function(t,e){return t.length<4?ho(t):t[1]+fo(t.slice(1,-1),go(t,e))},"cardinal-closed":function(t,e){return t.length<3?uo(t):t[0]+fo((t.push(t[0]),t),go([t[t.length-2]].concat(t,[t[1]]),e))},monotone:function(t){return t.length<3?ho(t):t[0]+fo(t,function(t){for(var e,n,i,s,a=[],r=function(t){for(var e=0,n=t.length-1,i=[],s=t[0],a=t[1],r=i[0]=Ao(s,a);++e<n;)i[e]=(r+(r=Ao(s=a,a=t[e+1])))/2;return i[e]=r,i}(t),o=-1,l=t.length-1;++o<l;)e=Ao(t[o],t[o+1]),E(e)<Ot?r[o]=r[o+1]=0:(s=(n=r[o]/e)*n+(i=r[o+1]/e)*i)>9&&(s=3*e/Math.sqrt(s),r[o]=s*n,r[o+1]=s*i);for(o=-1;++o<=l;)s=(t[Math.min(l,o+1)][0]-t[Math.max(0,o-1)][0])/(6*(1+r[o]*r[o])),a.push([s||0,r[o]*s||0]);return a}(t))}});function ho(t){return t.length>1?t.join("L"):t+"Z"}function uo(t){return t.join("L")+"Z"}function po(t){for(var e=0,n=t.length,i=t[0],s=[i[0],",",i[1]];++e<n;)s.push("V",(i=t[e])[1],"H",i[0]);return s.join("")}function mo(t){for(var e=0,n=t.length,i=t[0],s=[i[0],",",i[1]];++e<n;)s.push("H",(i=t[e])[0],"V",i[1]);return s.join("")}function fo(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return ho(t);var n=t.length!=e.length,i="",s=t[0],a=t[1],r=e[0],o=r,l=1;if(n&&(i+="Q"+(a[0]-2*r[0]/3)+","+(a[1]-2*r[1]/3)+","+a[0]+","+a[1],s=t[1],l=2),e.length>1){o=e[1],a=t[l],l++,i+="C"+(s[0]+r[0])+","+(s[1]+r[1])+","+(a[0]-o[0])+","+(a[1]-o[1])+","+a[0]+","+a[1];for(var c=2;c<e.length;c++,l++)a=t[l],o=e[c],i+="S"+(a[0]-o[0])+","+(a[1]-o[1])+","+a[0]+","+a[1]}if(n){var h=t[l];i+="Q"+(a[0]+2*o[0]/3)+","+(a[1]+2*o[1]/3)+","+h[0]+","+h[1]}return i}function go(t,e){for(var n,i=[],s=(1-e)/2,a=t[0],r=t[1],o=1,l=t.length;++o<l;)n=a,a=r,r=t[o],i.push([s*(r[0]-n[0]),s*(r[1]-n[1])]);return i}function yo(t){if(t.length<3)return ho(t);var e=1,n=t.length,i=t[0],s=i[0],a=i[1],r=[s,s,s,(i=t[1])[0]],o=[a,a,a,i[1]],l=[s,",",a,"L",bo(wo,r),",",bo(wo,o)];for(t.push(t[n-1]);++e<=n;)i=t[e],r.shift(),r.push(i[0]),o.shift(),o.push(i[1]),Eo(l,r,o);return t.pop(),l.push("L",i),l.join("")}function bo(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}co.forEach((function(t,e){e.key=t,e.closed=/-closed$/.test(t)}));var vo=[0,2/3,1/3,0],xo=[0,1/3,2/3,0],wo=[0,1/6,2/3,1/6];function Eo(t,e,n){t.push("C",bo(vo,e),",",bo(vo,n),",",bo(xo,e),",",bo(xo,n),",",bo(wo,e),",",bo(wo,n))}function Ao(t,e){return(e[1]-t[1])/(e[0]-t[0])}function jo(t){for(var e,n,i,s=-1,a=t.length;++s<a;)n=(e=t[s])[0],i=e[1]-Tt,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function ko(t){var e=cs,n=cs,i=0,s=hs,a=Qn,r=ho,o=r.key,l=r,c="L",h=.7;function u(o){var u,d,p,m=[],f=[],g=[],y=-1,b=o.length,v=xe(e),x=xe(i),w=e===n?function(){return d}:xe(n),E=i===s?function(){return p}:xe(s);function A(){m.push("M",r(t(g),h),c,l(t(f.reverse()),h),"Z")}for(;++y<b;)a.call(this,u=o[y],y)?(f.push([d=+v.call(this,u,y),p=+x.call(this,u,y)]),g.push([+w.call(this,u,y),+E.call(this,u,y)])):f.length&&(A(),f=[],g=[]);return f.length&&A(),m.length?m.join(""):null}return u.x=function(t){return arguments.length?(e=n=t,u):n},u.x0=function(t){return arguments.length?(e=t,u):e},u.x1=function(t){return arguments.length?(n=t,u):n},u.y=function(t){return arguments.length?(i=s=t,u):s},u.y0=function(t){return arguments.length?(i=t,u):i},u.y1=function(t){return arguments.length?(s=t,u):s},u.defined=function(t){return arguments.length?(a=t,u):a},u.interpolate=function(t){return arguments.length?(o="function"==typeof t?r=t:(r=co.get(t)||ho).key,l=r.reverse||r,c=r.closed?"M":"L",u):o},u.tension=function(t){return arguments.length?(h=t,u):h},u}function No(t){return t.radius}function _o(t){return[t.x,t.y]}function Oo(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]-Tt;return[n*Math.cos(i),n*Math.sin(i)]}}function Lo(){return 64}function Mo(){return"circle"}function Co(t){var e=Math.sqrt(t/Mt);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}a.svg.line.radial=function(){var t=lo(jo);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},po.reverse=mo,mo.reverse=po,a.svg.area=function(){return ko(I)},a.svg.area.radial=function(){var t=ko(jo);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},a.svg.chord=function(){var t=Yi,e=Gi,n=No,i=io,s=so;function a(n,i){var s,a,c=r(this,t,n,i),h=r(this,e,n,i);return"M"+c.p0+o(c.r,c.p1,c.a1-c.a0)+(a=h,((s=c).a0==a.a0&&s.a1==a.a1?l(c.r,c.p1,c.r,c.p0):l(c.r,c.p1,h.r,h.p0)+o(h.r,h.p1,h.a1-h.a0)+l(h.r,h.p1,c.r,c.p0))+"Z")}function r(t,e,a,r){var o=e.call(t,a,r),l=n.call(t,o,r),c=i.call(t,o,r)-Tt,h=s.call(t,o,r)-Tt;return{r:l,a0:c,a1:h,p0:[l*Math.cos(c),l*Math.sin(c)],p1:[l*Math.cos(h),l*Math.sin(h)]}}function o(t,e,n){return"A"+t+","+t+" 0 "+ +(n>Mt)+",1 "+e}function l(t,e,n,i){return"Q 0,0 "+i}return a.radius=function(t){return arguments.length?(n=xe(t),a):n},a.source=function(e){return arguments.length?(t=xe(e),a):t},a.target=function(t){return arguments.length?(e=xe(t),a):e},a.startAngle=function(t){return arguments.length?(i=xe(t),a):i},a.endAngle=function(t){return arguments.length?(s=xe(t),a):s},a},a.svg.diagonal=function(){var t=Yi,e=Gi,n=_o;function i(i,s){var a=t.call(this,i,s),r=e.call(this,i,s),o=(a.y+r.y)/2,l=[a,{x:a.x,y:o},{x:r.x,y:o},r];return"M"+(l=l.map(n))[0]+"C"+l[1]+" "+l[2]+" "+l[3]}return i.source=function(e){return arguments.length?(t=xe(e),i):t},i.target=function(t){return arguments.length?(e=xe(t),i):e},i.projection=function(t){return arguments.length?(n=t,i):n},i},a.svg.diagonal.radial=function(){var t=a.svg.diagonal(),e=_o,n=t.projection;return t.projection=function(t){return arguments.length?n(Oo(e=t)):e},t},a.svg.symbol=function(){var t=Mo,e=Lo;function n(n,i){return(So.get(t.call(this,n,i))||Co)(e.call(this,n,i))}return n.type=function(e){return arguments.length?(t=xe(e),n):t},n.size=function(t){return arguments.length?(e=xe(t),n):e},n};var So=a.map({circle:Co,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Io)),n=e*Io;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/To),n=e*To/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/To),n=e*To/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});a.svg.symbolTypes=So.keys();var To=Math.sqrt(3),Io=Math.tan(30*It);G.transition=function(t){for(var e,n,i=Po||++Vo,s=qo(t),a=[],r=Ro||{time:Date.now(),ease:fa,delay:0,duration:250},o=-1,l=this.length;++o<l;){a.push(e=[]);for(var c=this[o],h=-1,u=c.length;++h<u;)(n=c[h])&&$o(n,h,s,i,r),e.push(n)}return Ho(a,s,i)},G.interrupt=function(t){return this.each(null==t?Uo:Do(qo(t)))};var Uo=Do(qo());function Do(t){return function(){var e,n,i;(e=this[t])&&(i=e[n=e.active])&&(i.timer.c=null,i.timer.t=NaN,--e.count?delete e[n]:delete this[t],e.active+=.5,i.event&&i.event.interrupt.call(this,this.__data__,i.index))}}function Ho(t,e,n){return $(t,Bo),t.namespace=e,t.id=n,t}var Po,Ro,Bo=[],Vo=0;function zo(t,e,n,i){var s=t.id,a=t.namespace;return mt(t,"function"==typeof n?function(t,r,o){t[a][s].tween.set(e,i(n.call(t,t.__data__,r,o)))}:(n=i(n),function(t){t[a][s].tween.set(e,n)}))}function Fo(t){return null==t&&(t=""),function(){this.textContent=t}}function qo(t){return null==t?"__transition__":"__transition_"+t+"__"}function $o(t,e,n,i,s){var a,r,o,l,c,h=t[n]||(t[n]={active:0,count:0}),u=h[i];function d(n){var s=h.active,d=h[s];for(var m in d&&(d.timer.c=null,d.timer.t=NaN,--h.count,delete h[s],d.event&&d.event.interrupt.call(t,t.__data__,d.index)),h)if(+m<i){var f=h[m];f.timer.c=null,f.timer.t=NaN,--h.count,delete h[m]}r.c=p,Oe((function(){return r.c&&p(n||1)&&(r.c=null,r.t=NaN),1}),0,a),h.active=i,u.event&&u.event.start.call(t,t.__data__,e),c=[],u.tween.forEach((function(n,i){(i=i.call(t,t.__data__,e))&&c.push(i)})),l=u.ease,o=u.duration}function p(s){for(var a=s/o,r=l(a),d=c.length;d>0;)c[--d].call(t,r);if(a>=1)return u.event&&u.event.end.call(t,t.__data__,e),--h.count?delete h[i]:delete t[n],1}u||(a=s.time,r=Oe((function(t){var e=u.delay;if(r.t=e+a,e<=t)return d(t-e);r.c=d}),0,a),u=h[i]={tween:new k,time:a,timer:r,delay:s.delay,duration:s.duration,ease:s.ease,index:e},s=null,++h.count)}Bo.call=G.call,Bo.empty=G.empty,Bo.node=G.node,Bo.size=G.size,a.transition=function(t,e){return t&&t.transition?Po?t.transition(e):t:a.selection().transition(t)},a.transition.prototype=Bo,Bo.select=function(t){var e,n,i,s=this.id,a=this.namespace,r=[];t=J(t);for(var o=-1,l=this.length;++o<l;){r.push(e=[]);for(var c=this[o],h=-1,u=c.length;++h<u;)(i=c[h])&&(n=t.call(i,i.__data__,h,o))?("__data__"in i&&(n.__data__=i.__data__),$o(n,h,a,s,i[a][s]),e.push(n)):e.push(null)}return Ho(r,a,s)},Bo.selectAll=function(t){var e,n,i,s,a,r=this.id,o=this.namespace,l=[];t=K(t);for(var c=-1,h=this.length;++c<h;)for(var u=this[c],d=-1,p=u.length;++d<p;)if(i=u[d]){a=i[o][r],n=t.call(i,i.__data__,d,c),l.push(e=[]);for(var m=-1,f=n.length;++m<f;)(s=n[m])&&$o(s,m,o,r,a),e.push(s)}return Ho(l,o,r)},Bo.filter=function(t){var e,n,i=[];"function"!=typeof t&&(t=dt(t));for(var s=0,a=this.length;s<a;s++){i.push(e=[]);for(var r,o=0,l=(r=this[s]).length;o<l;o++)(n=r[o])&&t.call(n,n.__data__,o,s)&&e.push(n)}return Ho(i,this.namespace,this.id)},Bo.tween=function(t,e){var n=this.id,i=this.namespace;return arguments.length<2?this.node()[i][n].tween.get(t):mt(this,null==e?function(e){e[i][n].tween.remove(t)}:function(s){s[i][n].tween.set(t,e)})},Bo.attr=function(t,e){if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var n="transform"==t?Na:aa,i=a.ns.qualify(t);function s(){this.removeAttribute(i)}function r(){this.removeAttributeNS(i.space,i.local)}function o(t){return null==t?s:(t+="",function(){var e,s=this.getAttribute(i);return s!==t&&(e=n(s,t),function(t){this.setAttribute(i,e(t))})})}function l(t){return null==t?r:(t+="",function(){var e,s=this.getAttributeNS(i.space,i.local);return s!==t&&(e=n(s,t),function(t){this.setAttributeNS(i.space,i.local,e(t))})})}return zo(this,"attr."+t,e,i.local?l:o)},Bo.attrTween=function(t,e){var n=a.ns.qualify(t);return this.tween("attr."+t,n.local?function(t,i){var s=e.call(this,t,i,this.getAttributeNS(n.space,n.local));return s&&function(t){this.setAttributeNS(n.space,n.local,s(t))}}:function(t,i){var s=e.call(this,t,i,this.getAttribute(n));return s&&function(t){this.setAttribute(n,s(t))}})},Bo.style=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){for(n in i<2&&(e=""),t)this.style(n,t[n],e);return this}n=""}function s(){this.style.removeProperty(t)}function a(e){return null==e?s:(e+="",function(){var i,s=h(this).getComputedStyle(this,null).getPropertyValue(t);return s!==e&&(i=aa(s,e),function(e){this.style.setProperty(t,i(e),n)})})}return zo(this,"style."+t,e,a)},Bo.styleTween=function(t,e,n){function i(i,s){var a=e.call(this,i,s,h(this).getComputedStyle(this,null).getPropertyValue(t));return a&&function(e){this.style.setProperty(t,a(e),n)}}return arguments.length<3&&(n=""),this.tween("style."+t,i)},Bo.text=function(t){return zo(this,"text",t,Fo)},Bo.remove=function(){var t=this.namespace;return this.each("end.transition",(function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)}))},Bo.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=a.ease.apply(a,arguments)),mt(this,(function(i){i[n][e].ease=t})))},Bo.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:mt(this,"function"==typeof t?function(i,s,a){i[n][e].delay=+t.call(i,i.__data__,s,a)}:(t=+t,function(i){i[n][e].delay=t}))},Bo.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:mt(this,"function"==typeof t?function(i,s,a){i[n][e].duration=Math.max(1,t.call(i,i.__data__,s,a))}:(t=Math.max(1,t),function(i){i[n][e].duration=t}))},Bo.each=function(t,e){var n=this.id,i=this.namespace;if(arguments.length<2){var s=Ro,r=Po;try{Po=n,mt(this,(function(e,s,a){Ro=e[i][n],t.call(e,e.__data__,s,a)}))}finally{Ro=s,Po=r}}else mt(this,(function(s){var r=s[i][n];(r.event||(r.event=a.dispatch("start","end","interrupt"))).on(t,e)}));return this},Bo.transition=function(){for(var t,e,n,i=this.id,s=++Vo,a=this.namespace,r=[],o=0,l=this.length;o<l;o++){r.push(t=[]);for(var c,h=0,u=(c=this[o]).length;h<u;h++)(e=c[h])&&$o(e,h,a,s,{time:(n=e[a][i]).time,ease:n.ease,delay:n.delay+n.duration,duration:n.duration}),t.push(e)}return Ho(r,a,s)},a.svg.axis=function(){var t,e=a.scale.linear(),n=Wo,i=6,s=6,r=3,l=[10],c=null;function h(o){o.each((function(){var o,h=a.select(this),u=this.__chart__||e,d=this.__chart__=e.copy(),p=null==c?d.ticks?d.ticks.apply(d,l):d.domain():c,m=null==t?d.tickFormat?d.tickFormat.apply(d,l):I:t,f=h.selectAll(".tick").data(p,d),g=f.enter().insert("g",".domain").attr("class","tick").style("opacity",Ot),y=a.transition(f.exit()).style("opacity",Ot).remove(),b=a.transition(f.order()).style("opacity",1),v=Math.max(i,0)+r,x=kr(d),w=h.selectAll(".domain").data([0]),E=(w.enter().append("path").attr("class","domain"),a.transition(w));g.append("line"),g.append("text");var A,j,k,N,_=g.select("line"),O=b.select("line"),L=f.select("text").text(m),M=g.select("text"),C=b.select("text"),S="top"===n||"left"===n?-1:1;if("bottom"===n||"top"===n?(o=Xo,A="x",k="y",j="x2",N="y2",L.attr("dy",S<0?"0em":".71em").style("text-anchor","middle"),E.attr("d","M"+x[0]+","+S*s+"V0H"+x[1]+"V"+S*s)):(o=Yo,A="y",k="x",j="y2",N="x2",L.attr("dy",".32em").style("text-anchor",S<0?"end":"start"),E.attr("d","M"+S*s+","+x[0]+"H0V"+x[1]+"H"+S*s)),_.attr(N,S*i),M.attr(k,S*v),O.attr(j,0).attr(N,S*i),C.attr(A,0).attr(k,S*v),d.rangeBand){var T=d,U=T.rangeBand()/2;u=d=function(t){return T(t)+U}}else u.rangeBand?u=d:y.call(o,d,u);g.call(o,u,d),b.call(o,d,d)}))}return h.scale=function(t){return arguments.length?(e=t,h):e},h.orient=function(t){return arguments.length?(n=t in Zo?t+"":Wo,h):n},h.ticks=function(){return arguments.length?(l=o(arguments),h):l},h.tickValues=function(t){return arguments.length?(c=t,h):c},h.tickFormat=function(e){return arguments.length?(t=e,h):t},h.tickSize=function(t){var e=arguments.length;return e?(i=+t,s=+arguments[e-1],h):i},h.innerTickSize=function(t){return arguments.length?(i=+t,h):i},h.outerTickSize=function(t){return arguments.length?(s=+t,h):s},h.tickPadding=function(t){return arguments.length?(r=+t,h):r},h.tickSubdivide=function(){return arguments.length&&h},h};var Wo="bottom",Zo={top:1,right:1,bottom:1,left:1};function Xo(t,e,n){t.attr("transform",(function(t){var i=e(t);return"translate("+(isFinite(i)?i:n(t))+",0)"}))}function Yo(t,e,n){t.attr("transform",(function(t){var i=e(t);return"translate(0,"+(isFinite(i)?i:n(t))+")"}))}a.svg.brush=function(){var t,e,n=F(d,"brushstart","brush","brushend"),i=null,s=null,r=[0,0],o=[0,0],l=!0,c=!0,u=Jo[0];function d(t){t.each((function(){var t=a.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",g).on("touchstart.brush",g),e=t.selectAll(".background").data([0]);e.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var n=t.selectAll(".resize").data(u,I);n.exit().remove(),n.enter().append("g").attr("class",(function(t){return"resize "+t})).style("cursor",(function(t){return Go[t]})).append("rect").attr("x",(function(t){return/[ew]$/.test(t)?-3:null})).attr("y",(function(t){return/^[ns]/.test(t)?-3:null})).attr("width",6).attr("height",6).style("visibility","hidden"),n.style("display",d.empty()?"none":null);var r,o=a.transition(t),l=a.transition(e);i&&(r=kr(i),l.attr("x",r[0]).attr("width",r[1]-r[0]),m(o)),s&&(r=kr(s),l.attr("y",r[0]).attr("height",r[1]-r[0]),f(o)),p(o)}))}function p(t){t.selectAll(".resize").attr("transform",(function(t){return"translate("+r[+/e$/.test(t)]+","+o[+/^s/.test(t)]+")"}))}function m(t){t.select(".extent").attr("x",r[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",r[1]-r[0])}function f(t){t.select(".extent").attr("y",o[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",o[1]-o[0])}function g(){var u,g,y=this,b=a.select(a.event.target),v=n.of(y,arguments),x=a.select(y),w=b.datum(),E=!/^(n|s)$/.test(w)&&i,A=!/^(e|w)$/.test(w)&&s,j=b.classed("extent"),k=jt(y),N=a.mouse(y),_=a.select(h(y)).on("keydown.brush",M).on("keyup.brush",C);if(a.event.changedTouches?_.on("touchmove.brush",S).on("touchend.brush",I):_.on("mousemove.brush",S).on("mouseup.brush",I),x.interrupt().selectAll("*").interrupt(),j)N[0]=r[0]-N[0],N[1]=o[0]-N[1];else if(w){var O=+/w$/.test(w),L=+/^n/.test(w);g=[r[1-O]-N[0],o[1-L]-N[1]],N[0]=r[O],N[1]=o[L]}else a.event.altKey&&(u=N.slice());function M(){32==a.event.keyCode&&(j||(u=null,N[0]-=r[1],N[1]-=o[1],j=2),V())}function C(){32==a.event.keyCode&&2==j&&(N[0]+=r[1],N[1]+=o[1],j=0,V())}function S(){var t=a.mouse(y),e=!1;g&&(t[0]+=g[0],t[1]+=g[1]),j||(a.event.altKey?(u||(u=[(r[0]+r[1])/2,(o[0]+o[1])/2]),N[0]=r[+(t[0]<u[0])],N[1]=o[+(t[1]<u[1])]):u=null),E&&T(t,i,0)&&(m(x),e=!0),A&&T(t,s,1)&&(f(x),e=!0),e&&(p(x),v({type:"brush",mode:j?"move":"resize"}))}function T(n,i,s){var a,h,d=kr(i),p=d[0],m=d[1],f=N[s],g=s?o:r,y=g[1]-g[0];if(j&&(p-=f,m-=y+f),a=(s?c:l)?Math.max(p,Math.min(m,n[s])):n[s],j?h=(a+=f)+y:(u&&(f=Math.max(p,Math.min(m,2*u[s]-a))),f<a?(h=a,a=f):h=f),g[0]!=a||g[1]!=h)return s?e=null:t=null,g[0]=a,g[1]=h,!0}function I(){S(),x.style("pointer-events","all").selectAll(".resize").style("display",d.empty()?"none":null),a.select("body").style("cursor",null),_.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),k(),v({type:"brushend"})}x.style("pointer-events","none").selectAll(".resize").style("display",null),a.select("body").style("cursor",b.style("cursor")),v({type:"brushstart"}),S()}return d.event=function(i){i.each((function(){var i=n.of(this,arguments),s={x:r,y:o,i:t,j:e},l=this.__chart__||s;this.__chart__=s,Po?a.select(this).transition().each("start.brush",(function(){t=l.i,e=l.j,r=l.x,o=l.y,i({type:"brushstart"})})).tween("brush:brush",(function(){var n=ra(r,s.x),a=ra(o,s.y);return t=e=null,function(t){r=s.x=n(t),o=s.y=a(t),i({type:"brush",mode:"resize"})}})).each("end.brush",(function(){t=s.i,e=s.j,i({type:"brush",mode:"resize"}),i({type:"brushend"})})):(i({type:"brushstart"}),i({type:"brush",mode:"resize"}),i({type:"brushend"}))}))},d.x=function(t){return arguments.length?(u=Jo[!(i=t)<<1|!s],d):i},d.y=function(t){return arguments.length?(u=Jo[!i<<1|!(s=t)],d):s},d.clamp=function(t){return arguments.length?(i&&s?(l=!!t[0],c=!!t[1]):i?l=!!t:s&&(c=!!t),d):i&&s?[l,c]:i?l:s?c:null},d.extent=function(n){var a,l,c,h,u;return arguments.length?(i&&(a=n[0],l=n[1],s&&(a=a[0],l=l[0]),t=[a,l],i.invert&&(a=i(a),l=i(l)),l<a&&(u=a,a=l,l=u),a==r[0]&&l==r[1]||(r=[a,l])),s&&(c=n[0],h=n[1],i&&(c=c[1],h=h[1]),e=[c,h],s.invert&&(c=s(c),h=s(h)),h<c&&(u=c,c=h,h=u),c==o[0]&&h==o[1]||(o=[c,h])),d):(i&&(t?(a=t[0],l=t[1]):(a=r[0],l=r[1],i.invert&&(a=i.invert(a),l=i.invert(l)),l<a&&(u=a,a=l,l=u))),s&&(e?(c=e[0],h=e[1]):(c=o[0],h=o[1],s.invert&&(c=s.invert(c),h=s.invert(h)),h<c&&(u=c,c=h,h=u))),i&&s?[[a,c],[l,h]]:i?[a,l]:s&&[c,h])},d.clear=function(){return d.empty()||(r=[0,0],o=[0,0],t=e=null),d},d.empty=function(){return!!i&&r[0]==r[1]||!!s&&o[0]==o[1]},a.rebind(d,n,"on")};var Go={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Jo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ko=Pe.format=mn.timeFormat,Qo=Ko.utc,tl=Qo("%Y-%m-%dT%H:%M:%S.%LZ");function el(t){return t.toISOString()}function nl(t,e,n){function i(e){return t(e)}function s(t,n){var i=(t[1]-t[0])/n,s=a.bisect(sl,i);return s==sl.length?[e.year,Ir(t.map((function(t){return t/31536e6})),n)[2]]:s?e[i/sl[s-1]<sl[s]/i?s-1:s]:[ol,Ir(t,n)[2]]}return i.invert=function(e){return il(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(il)},i.nice=function(t,e){var n=i.domain(),a=jr(n),r=null==t?s(a,10):"number"==typeof t&&s(a,t);function o(n){return!isNaN(n)&&!t.range(n,il(+n+1),e).length}return r&&(t=r[0],e=r[1]),i.domain(_r(n,e>1?{floor:function(e){for(;o(e=t.floor(e));)e=il(e-1);return e},ceil:function(e){for(;o(e=t.ceil(e));)e=il(+e+1);return e}}:t))},i.ticks=function(t,e){var n=jr(i.domain()),a=null==t?s(n,10):"number"==typeof t?s(n,t):!t.range&&[{range:t},e];return a&&(t=a[0],e=a[1]),t.range(n[0],il(+n[1]+1),e<1?1:e)},i.tickFormat=function(){return n},i.copy=function(){return nl(t.copy(),e,n)},Sr(i,t)}function il(t){return new Date(t)}Ko.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?el:tl,el.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},el.toString=tl.toString,Pe.second=ze((function(t){return new Re(1e3*Math.floor(t/1e3))}),(function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))}),(function(t){return t.getSeconds()})),Pe.seconds=Pe.second.range,Pe.seconds.utc=Pe.second.utc.range,Pe.minute=ze((function(t){return new Re(6e4*Math.floor(t/6e4))}),(function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))}),(function(t){return t.getMinutes()})),Pe.minutes=Pe.minute.range,Pe.minutes.utc=Pe.minute.utc.range,Pe.hour=ze((function(t){var e=t.getTimezoneOffset()/60;return new Re(36e5*(Math.floor(t/36e5-e)+e))}),(function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))}),(function(t){return t.getHours()})),Pe.hours=Pe.hour.range,Pe.hours.utc=Pe.hour.utc.range,Pe.month=ze((function(t){return(t=Pe.day(t)).setDate(1),t}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t){return t.getMonth()})),Pe.months=Pe.month.range,Pe.months.utc=Pe.month.utc.range;var sl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],al=[[Pe.second,1],[Pe.second,5],[Pe.second,15],[Pe.second,30],[Pe.minute,1],[Pe.minute,5],[Pe.minute,15],[Pe.minute,30],[Pe.hour,1],[Pe.hour,3],[Pe.hour,6],[Pe.hour,12],[Pe.day,1],[Pe.day,2],[Pe.week,1],[Pe.month,1],[Pe.month,3],[Pe.year,1]],rl=Ko.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Qn]]),ol={range:function(t,e,n){return a.range(Math.ceil(t/n)*n,+e,n).map(il)},floor:I,ceil:I};al.year=Pe.year,Pe.scale=function(){return nl(a.scale.linear(),al,rl)};var ll=al.map((function(t){return[t[0].utc,t[1]]})),cl=Qo.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Qn]]);function hl(t){return JSON.parse(t.responseText)}function ul(t){var e=l.createRange();return e.selectNode(l.body),e.createContextualFragment(t.responseText)}ll.year=Pe.year.utc,Pe.scale.utc=function(){return nl(a.scale.linear(),ll,cl)},a.text=we((function(t){return t.responseText})),a.json=function(t,e){return Ee(t,"application/json",hl,e)},a.html=function(t,e){return Ee(t,"text/html",ul,e)},a.xml=we((function(t){return t.responseXML})),this.d3=a,void 0===(s="function"==typeof(i=a)?i.call(e,n,e,t):i)||(t.exports=s)}()},835:(t,e,n)=>{"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||l(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function h(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?x(t)?e:t:w(t)?e:t}function u(t){return g(t)&&0===t.length}function d(t){return t instanceof Date||"object"===i(t)&&"[object Date]"===Object.prototype.toString.call(t)}function p(t){return"string"==typeof t||t instanceof String}function m(t){return"function"==typeof t}function f(t){return!w(t)&&"object"===i(t)}function g(t){return!w(t)&&"function"==typeof t[Symbol.iterator]}function y(t){return g(t)&&!p(t)}function b(t){return null===t}function v(t){return!t||p(t)&&(0===t.length||/^\s*$/.test(t))}function x(t){return void 0===t}function w(t){return b(t)||x(t)}function E(t,e,n){if(!Array.isArray(t)||!Number.isInteger(e))throw new TypeError("Bad argument");return t.splice(e,0,n),t.length}function A(t){if(!Array.isArray(t))throw new TypeError("Bad argument");if(!u(t))return t[t.length-1]}function j(t){if(!Array.isArray(t))throw new TypeError("Bad argument");return t[0]}n.r(e),n.d(e,{Accordion:()=>ji,Collapsible:()=>Ai,DELETE:()=>M,GET:()=>_,POST:()=>O,PUT:()=>L,Selector:()=>ni,SelectorFactory:()=>ii,Switch:()=>di,addAttributes:()=>It,addPath:()=>rt,all:()=>Q,appendChildren:()=>Lt,assert:()=>J,boolToInt:()=>Y,camelCase:()=>W,capitalize:()=>z,capitalizeFirstLetter:()=>F,changeSelectValue:()=>Ut,cloneObject:()=>V,cloneTemplate:()=>An,compareTime:()=>S,copytoClipboard:()=>Cn,createAbbreviation:()=>He,createAnchor:()=>ge,createArea:()=>ye,createArticle:()=>Wt,createAside:()=>Yt,createAudio:()=>xe,createB:()=>Pe,createBase:()=>be,createBlockQuotation:()=>le,createButton:()=>rn,createCaption:()=>ln,createCite:()=>ze,createCode:()=>qe,createDataList:()=>en,createDeletedPart:()=>Ie,createDescriptionDetails:()=>fe,createDescriptionList:()=>pe,createDescriptionTerm:()=>me,createDiv:()=>ne,createDocFragment:()=>Rt,createEmbed:()=>se,createEmphasis:()=>Le,createFieldset:()=>Qe,createFigure:()=>ke,createFigureCaption:()=>Ne,createFooter:()=>qt,createForm:()=>$e,createH1:()=>Gt,createH2:()=>Jt,createH3:()=>Kt,createH4:()=>Qt,createH5:()=>te,createH6:()=>ee,createHeader:()=>Ft,createI:()=>Re,createImage:()=>ve,createInput:()=>We,createInsertedPart:()=>Ue,createLabel:()=>Xe,createLegend:()=>tn,createLineBreak:()=>ae,createLink:()=>Vt,createListItem:()=>de,createMain:()=>$t,createMark:()=>Me,createMeter:()=>nn,createNav:()=>Xt,createObject:()=>ie,createOption:()=>Ge,createOptionGroup:()=>Ke,createOrderedList:()=>ue,createOutput:()=>an,createParagraph:()=>oe,createPicture:()=>je,createProgress:()=>sn,createQuote:()=>De,createS:()=>Be,createSample:()=>Ce,createSection:()=>Zt,createSelect:()=>Ye,createSource:()=>Ee,createSpan:()=>_e,createStrong:()=>Oe,createSubscript:()=>Se,createSuperscript:()=>Te,createTable:()=>on,createTableBody:()=>un,createTableCell:()=>yn,createTableColumn:()=>pn,createTableColumnGroup:()=>mn,createTableFooter:()=>dn,createTableHeader:()=>hn,createTableHeaderCell:()=>gn,createTableRow:()=>fn,createTemplate:()=>zt,createTextArea:()=>Ze,createTextNode:()=>Bt,createThematicBreak:()=>re,createTime:()=>Fe,createTrack:()=>Ae,createU:()=>Ve,createUnorderedList:()=>he,createVideo:()=>we,fetchWithTimeout:()=>C,findAncestor:()=>_n,findByPath:()=>ht,first:()=>j,floatingLabel:()=>In,formatCase:()=>$,formatDate:()=>I,getDir:()=>ot,getDirTarget:()=>lt,getElement:()=>xn,getElements:()=>wn,getNextElementSibling:()=>Nn,getPreviousElementSibling:()=>kn,getRootUrl:()=>Ni,getTemplate:()=>En,getUrlParams:()=>_i,hasOwn:()=>R,htmlToElement:()=>Et,htmlToElements:()=>At,inputCounter:()=>Un,insert:()=>E,insertAfterElement:()=>_t,insertBeforeElement:()=>Nt,isCollection:()=>y,isDate:()=>d,isDerivedOf:()=>B,isDocumentFragment:()=>xt,isElement:()=>gt,isEmpty:()=>u,isFunction:()=>m,isHTMLCollection:()=>vt,isHTMLElement:()=>yt,isInElement:()=>kt,isInViewport:()=>jt,isIterable:()=>g,isNode:()=>mt,isNodeList:()=>ft,isNull:()=>b,isNullOrUndefined:()=>w,isNullOrWhitespace:()=>v,isObject:()=>f,isString:()=>p,isUndefined:()=>x,last:()=>A,lone:()=>nt,no:()=>et,one:()=>tt,pascalCase:()=>Z,preprendChild:()=>Ot,queryBuilder:()=>Oi,random:()=>st,removeAccents:()=>X,removeChildren:()=>Mn,resolveDate:()=>T,shortDate:()=>U,shortDateTime:()=>D,some:()=>K,toBoolean:()=>G,valOrDefault:()=>h,windowHeight:()=>dt,windowWidth:()=>ut});var k={OK:200,Created:201,Accepted:202,NoContent:204,BadRequest:400,Unauthorized:401,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,UnsupportedMediaType:415,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavaible:503,GatewayTimeout:504},N=function(t,e,n,i,s,a){var r=new XMLHttpRequest;return r.onreadystatechange=function(){var t;if(4===r.readyState){var e=function(t,e){return{status:t,message:e}}(r.status,r.responseText);n(r.status)?t=i:(t=s,r.status>=200&&r.status<300&&m(a)&&(t=a)),m(t)&&t(e)}},r.open(t,e,!0),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r};function _(t,e,n,i){var s=(i=h(i,{})).successPred,a=m(s)?s:function(t){return t===k.OK};N("GET",t,a,e,n,i.pass).send()}function O(t,e,n,i,s){var a=(s=h(s,{})).successPred,r=m(a)?a:function(t){return[k.OK,k.Created].includes(t)};N("POST",t,r,n,i,s.pass).send(e)}function L(t,e,n,i,s){var a=(s=h(s,{})).successPred,r=m(a)?a:function(t){return[k.OK,k.NoContent].includes(t)};N("PUT",t,r,n,i,s.pass).send(e)}function M(t,e,n,i,s){var a=(s=h(s,{})).successPred,r=m(a)?a:function(t){return[k.OK,k.Accepted,k.NoContent].includes(t)};N("DELETE",t,r,n,i,s.pass).send(e)}function C(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,i=new AbortController,s=r(r({},e),{},{signal:i.signal});return setTimeout((function(){i.abort()}),n),fetch(t,s).then((function(t){if(!t.ok)throw new Error("".concat(t.status,": ").concat(t.statusText));return t})).catch((function(t){if("AbortError"===t.name)throw new Error("Response timed out");throw new Error(t.message)}))}function S(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:":";if(w(t)||w(e)||!t.includes(n)||!e.includes(n))return null;var i=t.split(n),s=e.split(n);if(+i[0]>+s[0])return 1;if(+i[0]<+s[0])return-1;if(+i[1]>+s[1])return 1;if(+i[1]<+s[1])return-1;if(i.length==s.length&&3==i.length){if(+i[2]>+s[2])return 1;if(+i[2]<+s[2])return-1}return 0}function T(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(w(t))return new Date;if(d(t))return t;var n=new Date(t),i=n.getTime();return Number.isNaN(i)?new Date:e?new Date(i+6e4*n.getTimezoneOffset()):n}function I(t,e){var n=t.getDate(),i=t.getMonth()+1,s=t.getFullYear().toString(),a=t.getHours(),r=t.getMinutes(),o=t.getSeconds(),l=function(t){return t<10?"0".concat(t):t};return e.replace("yyyy",s).replace("yy",s.slice(-2)).replace("mm",l(i)).replace("m",i).replace("dd",l(n)).replace("d",n).replace("hh",l(a)).replace("h",a).replace("MM",l(r)).replace("M",r).replace("ss",l(o)).replace("s",o)}function U(t){return I(T(t),"yyyy-mm-dd")}function D(t){return I(T(t,!1),"yyyy-mm-dd hh:MM")}var H=Object.prototype.hasOwnProperty,P=Object.prototype.isPrototypeOf,R=function(t,e){return H.call(t,e)},B=function(t,e){return Object.getPrototypeOf(t)!==e&&P.call(e,t)};function V(t){if(w(t)||!f(t))return t;var e=t.constructor();for(var n in t)R(t,n)&&(t.isActiveClone=null,e[n]=V(t[n]),delete t.isActiveClone);return e}function z(t){return v(t)?t:t.toLowerCase().replace(/\b\w/g,(function(t){return t.toUpperCase()}))}function F(t){return v(t)?t:t.charAt(0).toUpperCase()+t.slice(1)}var q={camel:function(t){return W(t)},pascal:function(t){return Z(t)},upper:function(t){return t.toUpperCase()},lower:function(t){return t.toLowerCase()}};function $(t,e){return v(t)?t:R(q,e)?q[e](t):t}function W(t){if(v(t))return t;var e=Z(t);return e.charAt(0).toLowerCase()+e.slice(1)}function Z(t){return v(t)?t:z(t.replace(/[_-]+/g," ").replace(/\s+/g," ").trim()).replace(/\s+/g,"")}function X(t){return String.prototype.normalize?t.normalize("NFD").replace(/[\u0300-\u036f]/g,""):t.replace(/[àâäæ]/gi,"a").replace(/[ç]/gi,"c").replace(/[éèê]/gi,"e").replace(/[îï]/gi,"i").replace(/[ôœ]/gi,"o").replace(/[ùûü]/gi,"u")}function Y(t){return t?1:0}function G(t){var e=h(t,!1);return p(e)&&"true"===e.toLowerCase()||Number.isInteger(e)&&1===e||!0===e}var J=function(t,e,n,i){if(!Array.isArray(t)||!m(e))throw new TypeError("Bad argument");var s=it(t,e);if(Q([n,i],Number.isInteger)){if(i<n)throw new Error("Bad argument: max must be greater than min");return s>=n&&s<=i}return Number.isInteger(n)?s>=n:Number.isInteger(i)?s<=i:s>0},K=function(t,e){if(!Array.isArray(t)||!m(e))throw new TypeError("Bad argument");for(var n=0;n<t.length;n++){var i=t[n];if(e.apply(void 0,o(Array.isArray(i)?i:[i])))return!0}return!1},Q=function(t,e){if(!Array.isArray(t)||!m(e))throw new TypeError("Bad argument");for(var n=0;n<t.length;n++){var i=t[n];if(!e.apply(void 0,o(Array.isArray(i)?i:[i])))return!1}return!0},tt=function(t,e){if(!Array.isArray(t)||!m(e))throw new TypeError("Bad argument");return 1===it(t,e)},et=function(t,e){if(!Array.isArray(t)||!m(e))throw new TypeError("Bad argument");return 0===it(t,e)},nt=function(t,e){if(!Array.isArray(t)||!m(e))throw new TypeError("Bad argument");return it(t,e)<=1};function it(t,e){for(var n=0,i=0;i<t.length;i++){var s=t[i];e.apply(void 0,o(Array.isArray(s)?s:[s]))&&n++}return n}function st(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!Number.isInteger(t))throw new TypeError("Bad argument");if(Number.isInteger(e)||(e=t,t=0),e<t)throw new Error("Bad argument: max must be greater than min");return t+Math.floor((n?at():Math.random())*(e-t+1))}function at(){return window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967295}function rt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";return v(t)?e:"".concat(t).concat(n).concat(e)}function ot(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";return t.substring(0,t.lastIndexOf(e))}function lt(t,e){return t.substring(0,t.lastIndexOf(e)-1)}function ct(t,e,n){var i=+e[0].match(/\d+/g);return t[n][i]}function ht(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".",i=/\[\d+\]/g,s=V(t),a=function(t,e,n){var i=t.match(e),a=t.substring(0,t.indexOf("["));return n(s,i,a)},r=e.split(n),o=0,l=r.length;o<l;o++){var c=r[o];if(w(s=i.test(c)?a(c,i,ct):s[c]))return}return s}var ut=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},dt=function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},pt=function(t){return!w(t)&&t.nodeType===Node.ELEMENT_NODE},mt=function(t){return t instanceof Node},ft=function(t){return t instanceof NodeList},gt=function(t){return pt(t)&&t instanceof Element},yt=function(t,e){return!!(pt(t)&&t instanceof HTMLElement)&&(!g(e)||(n=t,i=Array.isArray(e)?e:[e],s=function(t){return n instanceof t},a=function(t){return n.tagName===t.toUpperCase()},r=function(t){return Array.isArray(t)?t.includes(n.type):n.type===t},i.some((function(t){if(!g(t))return!1;var e=t,n=null;if(Array.isArray(t)){var i=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,s=!1,a=void 0;try{for(var r,o=t[Symbol.iterator]();!(i=(r=o.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){s=!0,a=t}finally{try{i||null==o.return||o.return()}finally{if(s)throw a}}return n}}(t,e)||l(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2);e=i[0],n=i[1]}e=e.toLowerCase();var o="HTML".concat(R(bt,e)?bt[e]:Z(e),"Element");return!(!s(window[o])&&!a(e))&&(!(y(n)&&!u(n))||r(n))}))));var n,i,s,a,r},bt={a:"Anchor",br:"BR",dl:"DList",datalist:"DataList",fieldset:"FieldSet",frameset:"FrameSet",hr:"HR",h1:"Heading",h2:"Heading",h3:"Heading",h4:"Heading",h5:"Heading",h6:"Heading",li:"LI",ol:"OList",optgroup:"OptGroup",p:"Paragraph",q:"Quote",blockquote:"Quote",caption:"TableCaption",td:"TableCell",th:"TableCell",col:"TableCol",tr:"TableRow",tbody:"TableSection",thead:"TableSection",tfoot:"TableSection",textarea:"TextArea",ul:"UList"},vt=function(t){return t instanceof HTMLCollection},xt=function(t){return function(t){return!w(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE}(t)&&t instanceof DocumentFragment};function wt(t,e){if(!p(e))return null;var n=document.createElement("template");return n.innerHTML=e.trim(),n.content[t]}var Et=wt.bind(null,"firstChild"),At=wt.bind(null,"childNodes");function jt(t){if(!yt(t))throw new Error("The given element is not a valid HTML Element");var e=t.getBoundingClientRect(),n=e.top,i=e.right,s=e.bottom,a=e.left;return n>=0&&a>=0&&s<=dt()&&i<=ut()}function kt(t,e){if(!Q([t,e],yt))throw new Error("The given element is not a valid HTML Element");var n=t.getBoundingClientRect(),i=n.top,s=n.right,a=n.bottom,r=n.left,o=e.getBoundingClientRect(),l=o.top,c=o.right,h=o.bottom,u=o.left;return Q([[l,i],[u,r],[s,c],[a,h]],(function(t,e){return t<=e}))}function Nt(t,e){if(!Q([t,e],gt))throw new TypeError("Bad argument: The given `element` or `target` is not a valid Element");return t.insertAdjacentElement("beforebegin",e),t}function _t(t,e){if(!Q([t,e],gt))throw new TypeError("Bad argument: The given `element` or `target` is not a valid Element");return t.insertAdjacentElement("afterend",e),t}function Ot(t,e){if(!Q([t,e],gt))throw new TypeError("Bad argument: The given `element` or `target` is not a valid Element");return t.insertAdjacentElement("afterbegin",e),t}function Lt(t,e){if(!mt(t))throw new TypeError("Bad argument: The given `parent` is not a valid Node");if(!vt(e)&&!y(e))throw new TypeError("Bad argument: The given `children` is not a valid HTMLCollection/HTMLElement array");var n=xt(t)?t:document.createDocumentFragment();return Array.from(e).forEach((function(t){var e;w(t)||n.appendChild(mt(t)?t:(e=t.toString(),document.createTextNode(e.toString())))})),t!==n&&t.appendChild(n),t}function Mt(t,e,n){t[e]=n}function Ct(t,e,n){t.setAttribute(e,n)}var St="accesskey,autocapitalize,class,dataset,editable,draggable,hidden,id,inputmode,lang,html,style,tabindex,text,title",Tt={accesskey:[Mt,"accessKey"],autocapitalize:[Mt,"autocapitalize"],class:[function(t,e){var n;if(!yt(t))throw new Error("Bad argument: The passed `element` argument is not a valid HTML Element");return(n=t.classList).add.apply(n,o(Array.isArray(e)?e:[e])),t}],dataset:[function(t,e,n){Object.assign(t[e],n)},"dataset"],draggable:[Mt,"draggable"],editable:[Mt,"contentEditable"],hidden:[Mt,"hidden"],id:[Mt,"id"],inputmode:[Mt,"inputMode"],lang:[Mt,"lang"],html:[Mt,"innerHTML"],style:[Mt,"style"],tabindex:[Mt,"tabIndex"],text:[Mt,"textContent"],title:[Mt,"title"],data:[Mt,"data"],cite:[Mt,"cite"],download:[Mt,"download"],ping:[Mt,"ping"],target:[Mt,"target"],coords:[Mt,"coords"],shape:[Mt,"shape"],autoplay:[Mt,"autoplay"],buffered:[Mt,"buffered"],controls:[Mt,"controls"],loop:[Mt,"loop"],muted:[Mt,"muted"],playsinline:[Ct,"playsinline"],poster:[Mt,"poster"],preload:[Mt,"preload"],crossorigin:[Mt,"crossOrigin"],decoding:[Mt,"decoding"],height:[Mt,"height"],ismap:[Mt,"isMap"],loading:[Mt,"loading"],srcset:[Mt,"srcset"],width:[Mt,"width"],alt:[Mt,"alt"],as:[Mt,"as"],media:[Mt,"media"],rel:[Mt,"rel"],src:[Mt,"src"],sizes:[Mt,"sizes"],reversed:[Mt,"reversed"],start:[Mt,"start"],accept:[Mt,"accept"],"accept-charset":[Mt,"acceptCharset"],action:[Mt,"action"],autocomplete:[Mt,"autocomplete"],autofocus:[Mt,"autofocus"],capture:[Mt,"capture"],checked:[Mt,"checked"],cols:[Mt,"cols"],disabled:[Mt,"disabled"],dirname:[Mt,"dirName"],enctype:[Mt,"enctype"],for:[Mt,"for"],form:[Mt,"form"],formaction:[Mt,"formAction"],formenctype:[Mt,"formEnctype"],formmethod:[Mt,"formMethod"],formnovalidate:[Mt,"formNoValidate"],formtarget:[Mt,"formTarget"],high:[Mt,"high"],label:[Mt,"label"],list:[Mt,"list"],low:[Mt,"low"],max:[Mt,"max"],maxlength:[Mt,"maxLength"],method:[Mt,"method"],min:[Mt,"min"],minlength:[Mt,"minLength"],multiple:[Mt,"multiple"],name:[Mt,"name"],novalidate:[Mt,"noValidate"],optimum:[Mt,"optimum"],pattern:[Mt,"pattern"],placeholder:[Mt,"placeholder"],readonly:[Mt,"readOnly"],required:[Mt,"required"],rows:[Mt,"rows"],selected:[Mt,"selected"],size:[Mt,"size"],spellcheck:[Ct,"spellcheck"],step:[Mt,"step"],wrap:[Mt,"wrap"],default:[Mt,"default"],kind:[Mt,"kind"],srclang:[Mt,"srclang"],abbr:[Mt,"abbr"],colspan:[Mt,"colSpan"],span:[Mt,"span"],rowspan:[Mt,"rowSpan"],scope:[Mt,"scope"],href:[Mt,"href"],hreflang:[Mt,"hreflang"],datetime:[Mt,"dateTime"],type:[Mt,"type"],value:[Mt,"value"],usemap:[Mt,"useMap"]};function It(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!yt(t))throw new Error("Bad argument: The given element argument is not a valid HTML Element");if(!f(e))return t;for(var i=function(t){return St.includes(t)||n.includes(t)},s=0,a=Object.keys(e);s<a.length;s++){var r=a[s];if(i(r)){var l=e[r],c=Tt[r].slice(0),h=c.shift();h.apply(void 0,[t].concat(o(c),[l]))}}return t}function Ut(t,e){if(!yt(t,"select"))throw new Error("Bad argument: The given select argument is not a valid HTML Select element");if(w(e))throw new Error("The given value parameter is a null or undefined");for(var n=t.options,i=0;i<n.length;i++){var s=n[i];if(s.value===e.toString())return s.selected=!0,!0}return!1}function Dt(t,e,n){var i=document.createElement(t);return yt(i)?(f(n)&&It(i,n,h(e,"")),i):null}function Ht(t,e,n,i){var s=Dt(t,e,n);return yt(s)?(w(i)||bn(s,i),s):null}function Pt(t,e,n,i,s){var a=Dt(t,e,i);return yt(a)?(w(s)||bn(a,s,n),a):null}function Rt(t){var e=document.createDocumentFragment();return w(t)||bn(e,t),e}var Bt=function(t){return document.createTextNode(t)},Vt=Dt.bind(null,"link","as,crossorigin,disabled,href,hreflang,media,rel,sizes,type"),zt=Ht.bind(null,"template",""),Ft=Ht.bind(null,"header",""),qt=Ht.bind(null,"footer",""),$t=Ht.bind(null,"main",""),Wt=Ht.bind(null,"article",""),Zt=Ht.bind(null,"section",""),Xt=Ht.bind(null,"nav",""),Yt=Ht.bind(null,"aside",""),Gt=Ht.bind(null,"h1",""),Jt=Ht.bind(null,"h2",""),Kt=Ht.bind(null,"h3",""),Qt=Ht.bind(null,"h4",""),te=Ht.bind(null,"h5",""),ee=Ht.bind(null,"h6",""),ne=Ht.bind(null,"div",""),ie=Ht.bind(null,"object","data,height,name,type,usemap,width"),se=Dt.bind(null,"embed","height,src,type,width"),ae=Dt.bind(null,"br",""),re=Dt.bind(null,"hr",""),oe=Ht.bind(null,"p",""),le=Ht.bind(null,"blockquote","cite"),ce=function(t){return yt(t,"li")?t:de(null,t)},he=Pt.bind(null,"ul","",ce),ue=Pt.bind(null,"ol","reversed,start,type",ce),de=Ht.bind(null,"li","value"),pe=Ht.bind(null,"dl",""),me=Ht.bind(null,"dt",""),fe=Ht.bind(null,"dd",""),ge=Ht.bind(null,"a","download,href,hreflang,ping,rel,target,type"),ye=Dt.bind(null,"area","alt,coords,download,href,hreflang,media,ping,rel,shape,target"),be=Dt.bind(null,"base","href,target"),ve=Dt.bind(null,"img","alt,crossorigin,decoding,height,ismap,loading,sizes,src,srcset,usemap,width"),xe=Ht.bind(null,"audio","autoplay,controls,crossorigin,loop,muted,preload,src"),we=Ht.bind(null,"video","autoplay,controls,crossorigin,height,loop,muted,playsinline,poster,preload,src,width"),Ee=Dt.bind(null,"source","media,sizes,src,srcset,type"),Ae=Dt.bind(null,"track","default,kind,label,src,srclang"),je=Ht.bind(null,"picture",""),ke=Ht.bind(null,"figure",""),Ne=Ht.bind(null,"figcaption",""),_e=Ht.bind(null,"span",""),Oe=Ht.bind(null,"strong",""),Le=Ht.bind(null,"em",""),Me=Ht.bind(null,"mark",""),Ce=Ht.bind(null,"samp",""),Se=Ht.bind(null,"sub",""),Te=Ht.bind(null,"sup",""),Ie=Ht.bind(null,"del","cite,datetime"),Ue=Ht.bind(null,"ins","cite,datetime"),De=Ht.bind(null,"q","cite"),He=Ht.bind(null,"abbr",""),Pe=Ht.bind(null,"b",""),Re=Ht.bind(null,"i",""),Be=Ht.bind(null,"s",""),Ve=Ht.bind(null,"u",""),ze=Ht.bind(null,"cite",""),Fe=Ht.bind(null,"time","datetime"),qe=Ht.bind(null,"code",""),$e=Ht.bind(null,"form","accept-charset,action,autocomplete,enctype,method,name,novalidate,rel,target"),We=Dt.bind(null,"input","accept,alt,autocomplete,autofocus,capture,checked,dirname,disabled,height,max,maxlength,minlength,min,multiple,name,pattern,placeholder,readonly,required,size,src,step,type,value,width"),Ze=Ht.bind(null,"textarea","autocomplete,autofocus,cols,disabled,maxlength,minlength,name,placeholder,readonly,required,rows,spellcheck,value,wrap"),Xe=Ht.bind(null,"label","for"),Ye=Pt.bind(null,"select","autocomplete,autofocus,disabled,multiple,name,required,size",(function(t){return yt(t,["option","optgroup"])?t:Array.isArray(t)?Ke(null,t):Ge(null,t)})),Ge=Ht.bind(null,"option","disabled,label,selected,value"),Je=function(t){return yt(t,"option")?t:Ge(null,t)},Ke=Pt.bind(null,"optgroup","disabled,label",Je),Qe=Ht.bind(null,"fieldset","disabled,name"),tn=Ht.bind(null,"legend",""),en=Pt.bind(null,"datalist","",Je),nn=Ht.bind(null,"meter","high,low,max,min,optimum,value"),sn=Ht.bind(null,"progress","max,value"),an=Ht.bind(null,"output","name,value"),rn=Ht.bind(null,"button","autofocus,disabled,formaction,formenctype,formmethod,formnovalidate,formtarget,name,type,value"),on=Ht.bind(null,"table",""),ln=Ht.bind(null,"caption",""),cn=function(t){return yt(t,"tr")?t:fn(null,t)},hn=Pt.bind(null,"thead","",cn),un=Pt.bind(null,"tbody","",cn),dn=Pt.bind(null,"tfoot","",cn),pn=Dt.bind(null,"col","span"),mn=Pt.bind(null,"colgroup","span",(function(t){return yt(t,"col")?t:null})),fn=Pt.bind(null,"tr","",(function(t){return yt(t,["th","td"])?t:yn(null,t)})),gn=Ht.bind(null,"th","abbr,colspan,rowspan,scope"),yn=Ht.bind(null,"td","colspan,rowspan");function bn(t,e,n){var i=Array.isArray(e)?e:[e];return m(n)&&(i=i.map((function(t){return n(t)}))),Lt(t,i),t}var vn=function(t){return/^\.[a-zA-Z0-9_-]+$/.test(t)};function xn(t,e){var n=h(e,document);return v(t)?null:xt(n)?n.querySelector(t):function(t){return/^#[a-zA-Z0-9_-]+$/.test(t)}(t)?document.getElementById(t.substring(1)):vn(t)?n.getElementsByClassName(t.substring(1))[0]:n.querySelector(t)}function wn(t,e){var n=h(e,document);return v(t)?null:xt(n)?n.querySelectorAll(t):vn(t)?n.getElementsByClassName(t.substring(1)):n.querySelectorAll(t)}function En(t,e){return"content"in document.createElement("template")?xn(t,e):null}function An(t,e){return t?document.importNode(t.content,h(e,!0)):t}function jn(t,e,n){if(!yt(e))return null;var i=e[t];if(m(n))for(;gt(i)&&!n(i);)i=i[t];return i}var kn=jn.bind(null,"previousElementSibling"),Nn=jn.bind(null,"nextElementSibling");function _n(t,e,n){if(!gt(t))throw new TypeError("Bad argument: The given target parameter is not a valid HTML Element");if(!m(e))throw new TypeError("Bad argument: The given pred parameter is not a valid Function");var i=t.parentElement;return n>0?Ln(i,e,n-1):On(i,e)}function On(t,e){return w(t)?null:e(t)?t:On(t.parentElement,e)}function Ln(t,e,n){return w(t)||0===n?null:e(t)?t:Ln(t.parentElement,e,n-1)}function Mn(t,e){if(!mt(t))throw new TypeError("Bad argument: The given `node` is not a valid Node");return m(e)?(Array.from(t.childNodes).forEach((function(n){e(n)&&t.removeChild(n)})),t):function(t){for(;t.hasChildNodes();)t.removeChild(t.lastChild);return t}(t)}function Cn(t){if(w(t))return!1;var e=Ze({value:yt(t)?t.textContent:t.toString(),readonly:!0});return!!yt(e)&&(document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove(),!0)}var Sn=function(t){return t.classList.add("down")},Tn=function(t){return t.classList.remove("down")};function In(t){for(var e=wn(".form-label",t),n=0;n<e.length;n++){var i=e[n];if("placeholder"==i.dataset.type&&!v(i.htmlFor)){var s=xn("#".concat(i.htmlFor));yt(s)?v(s.placeholder)?(a(s,i),u(s.value)&&Sn(i)):console.warn('%c@zenkai%c #FloatingLabel>%cfloatingLabel:%c Input "'.concat(i.htmlFor,'" contains a placeholder'),"text-decoration: underline","","font-weight: bold;","font-weight: normal;"):console.error('%c@zenkai%c #FloatingLabel>%cfloatingLabel:%c Missing input for label "'.concat(i.htmlFor,'"'),"text-decoration: underline","","font-weight: bold;","font-weight: normal;")}}function a(t,e){v(t.placeholder)&&(t.addEventListener("focus",(function(n){t.placeholder="",Tn(e),e.parentElement.classList.add("focused")})),t.addEventListener("blur",(function(t){u(this.value)&&Sn(e),e.parentElement.classList.remove("focused")})),t.addEventListener("input",(function(n){document.activeElement!=t&&(u(this.value)?Sn(e):Tn(e))})))}return e}function Un(t){for(var e=wn("[data-counter]",t),n=0;n<e.length;n++){var i=e[n],s=i.dataset.counter,a=xn("#".concat(s));yt(a)?(i.dataset.counterMax=a.maxLength,i.dataset.counterVal=a.value.length,r(a,i)):console.error("%c@zenkai%c #InputCounter>%cinputCounter:%c Failed to add counter ".concat(s,". Input (referenced) was not found."),"text-decoration: underline","","font-weight: bold;","font-weight: normal;")}function r(t,e){t.addEventListener("input",(function(n){e.dataset.counterVal=t.value.length}))}return e}var Dn=function(t){return t.dataset.type},Hn=function(t){return t.dataset.state},Pn=function(t,e){return t.dataset.state=e},Rn=function(t,e){return Pn(t,h(e,"checked"))},Bn=function(t,e){return Pn(t,h(e,"unchecked"))};function Vn(t,e,n){if(yt(t))return e(t)?[t]:wn(n,t);if(p(t)&&!u(t)){var i=xn(t);return w(i)?null:Vn(i)}return w(t)?wn(n):null}function zn(t,e){return v(e.htmlFor)?xn("input[type='".concat(h(t,"text"),"']"),e):xn("#".concat(e.htmlFor))}var Fn="on",qn={init:function(t){return Object.assign(this,t),this.isChecked()&&Rn(this.container,Fn),this},container:null,index:null,get value(){return this.container.dataset.value},isChecked:function(){return Hn(this.container)===Fn},setChecked:function(t){return!w(t)&&(t?Rn(this.container,Fn):Bn(this.container,"off"),!0)}},$n={name:"selector",container:null,items:null,selectedIndex:null,selectedItem:null,beforeChange:null,afterChange:null,get value(){return this.selectedItem.value},setSelectedItem:function(t){return this.items.includes(t)?(this.selectedItem&&this.selectedItem.setChecked(!1),this.selectedItem=t,this.selectedItem.setChecked(!0),!0):null},init:function(){for(var t=this.container.dataset.value,e=null,n=0;n<this.items.length;n++){var i=this.items[n];i.isChecked()&&this.setSelectedItem(i),i.value===t&&(e=i)}return b(this.selectedItem)&&!b(e)&&this.setSelectedItem(e),this.bindEvents(),this},bindEvents:function(){var t=this;this.container.addEventListener("click",(function(e){var n=e.target;if(R(n.dataset,"selector")){var i=!1;if(m(t.beforeChange)&&(i=!1===t.beforeChange(t,e)),!i){var s=t.items.find((function(t){return t.index===+h(n.dataset.selectorIndex,-1)}));w(s)||(t.setSelectedItem(s),m(t.afterChange)&&t.afterChange(t,e))}}}))}},Wn={init:function(t){return Object.assign(this,t),this.isChecked()&&Rn(this.container,"on"),this},container:null,input:null,index:null,get value(){return this.input.value},isChecked:function(){return this.input.checked},setChecked:function(t){return!w(t)&&(t?(this.input.checked=!0,Rn(this.container,"on")):(this.input.checked=!1,Bn(this.container,"off")),!0)}},Zn={name:"form-selector",container:null,items:null,selectedIndex:null,selectedItem:null,beforeChange:null,afterChange:null,get value(){return this.selectedItem.value},setSelectedItem:function(t){return this.items.includes(t)?(this.selectedItem&&this.selectedItem.setChecked(!1),this.selectedItem=t,this.selectedItem.setChecked(!0),!0):null},init:function(){for(var t=this.container.dataset.value,e=null,n=0;n<this.items.length;n++){var i=this.items[n];i.isChecked()&&this.setSelectedItem(i),i.value===t&&(e=i)}return b(this.selectedItem)&&!b(e)&&this.setSelectedItem(e),this.bindEvents(),this},bindEvents:function(){var t=this;this.container.addEventListener("change",(function(e){var n=e.target,i=!1;if(m(t.beforeChange)&&(i=!1===t.beforeChange(t,e)),i)return n.checked=!1,void t.items[t.selectedIndex].setChecked(!0);var s=t.items.find((function(t){return t.index===+h(n.dataset.selectorIndex,-1)}));w(s)||(t.setSelectedItem(s),m(t.afterChange)&&t.afterChange(t,e))}))}},Xn="BAD_CONTAINER",Yn=function(t){return'[data-type="'.concat(t.name,'"]')},Gn={BaseSelector:Yn($n),FormSelector:Yn(Zn)},Jn={create:function(t,e){if(!yt(t))return Xn;var n=wn("[data-selector]",t);if(!ft(n))return Xn;var i=null,s=null,a=Dn(t);switch(a){case"selector":s=Kn(n,a,!1),i=Object.create($n);break;case"form-selector":s=Kn(n,a,!0),i=Object.create(Zn)}return Object.assign(i,e,{container:t,items:s,querySelector:Yn(i)}),i}};function Kn(t,e,n){for(var i=[],s={selector:function(){return Object.create(qn)},"form-selector":function(){return Object.create(Wn)}},a=0;a<t.length;a++){var r=t[a];r.dataset.selectorIndex=a;var o={container:r,index:a};if(n){var l=zn("radio",r);if(!yt(l))return"BAD_INPUT";l.dataset.selectorIndex=a,Object.assign(o,{input:l})}var c=s[e]().init(o);i.push(c)}return i}var Qn={BAD_CONTAINER:new Error("Missing container: A selector requires a container"),BAD_INPUT:new Error("Missing input: FormSelector requires an input in the container")},ti=function(t){return RegExp("selector|form-selector").test(t.dataset.type)},ei=[Gn.BaseSelector,Gn.FormSelector].join(",");function ni(t,e){var n=Vn(t,ti,ei),i=h(e,{});if(w(n))return null;for(var s=[],a=0;a<n.length;a++){var r=Jn.create(n[a],i);if(R(Qn,r))throw Qn[r];r.init(),s.push(r)}return s}var ii=Jn,si={BAD_CONTAINER:new Error("Missing container: A switch requires a container"),BAD_INPUT:new Error("Missing input: FormSwitch requires an input in the container")},ai="on",ri=function(t){return'[data-type="'.concat(t.name,'"]')},oi=function(t){return RegExp("switch|form-switch").test(t.dataset.type)},li=function(t,e){if(!yt(t))return"BAD_CONTAINER";var n=null,i=null;switch(Dn(t)){case"switch":n=Object.create(ci);break;case"form-switch":if(i=zn("checkbox",t),!yt(i))return"BAD_INPUT";e.input=i,n=Object.create(hi)}return Object.assign(n,e,{container:t,querySelector:ri(n)}),n},ci={name:"switch",container:null,beforeChange:null,afterChange:null,get value(){return this.container.dataset.value},isChecked:function(){return Hn(this.container)===ai},setChecked:function(t){return!w(t)&&(t?Rn(this.container,ai):Bn(this.container,"off"),!0)},toggle:function(){this.isChecked()?this.setChecked(!1):this.setChecked(!0)},init:function(t){return Object.assign(this,t),this.isChecked()&&Rn(this.container,ai),this.bindEvents(),this},bindEvents:function(){var t=this;this.container.addEventListener("click",(function(e){var n=!1;m(t.beforeChange)&&(n=!1===t.beforeChange(t,e)),n||(t.toggle(),m(t.afterChange)&&t.afterChange(t,e))}))}},hi={name:"form-switch",container:null,input:null,beforeChange:null,afterChange:null,get value(){return this.input.value},isChecked:function(){return Hn(this.container)===ai},setChecked:function(t){return!w(t)&&(this.input.checked=t,t?Rn(this.container,ai):Bn(this.container,"off"),!0)},toggle:function(){this.isChecked()?this.setChecked(!1):this.setChecked(!0)},init:function(t){return Object.assign(this,t),this.input.checked&&this.setChecked(!0),this.bindEvents(),this},bindEvents:function(){var t=this;this.input.addEventListener("change",(function(e){var n=!1;m(t.beforeChange)&&(n=!1===t.beforeChange(t,e)),n?t.input.checked=!t.input.checked:(t.toggle(),m(t.afterChange)&&t.afterChange(t,e))}))}},ui=[ri(ci),ri(hi)].join(",");function di(t,e){var n=Vn(t,oi,ui),i=h(e,{});if(w(n))return null;for(var s=[],a=0;a<n.length;a++){var r=li(n[a],i);if(R(si,r))throw si[r];r.init(),s.push(r)}return s}function pi(t){t.style.display="block"}function mi(t){t.style.display="none"}var fi={BAD_CONTAINER_COLLAPSIBLE:"BAD_CONTAINER_COLLAPSIBLE",BAD_CONTAINER_ACCORDION:"BAD_CONTAINER_ACCORDION"},gi={BAD_CONTAINER_COLLAPSIBLE:new Error("Missing container: A collapsible requires a container"),BAD_CONTAINER_ACCORDION:new Error("Missing container: An accordion requires a container")},yi="expanded",bi="collapsed",vi=function(t){return"collapsible"in t.dataset},xi=function(t){return"accordion"===t.dataset.boost},wi={create:function(t,e){if(!yt(t))return fi.BAD_CONTAINER_COLLAPSIBLE;var n=Object.create(this);return Object.assign(n,e,{container:t}),n},name:"collapsible",container:null,header:null,content:null,beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null,getState:function(){return this.container.dataset[this.name]},setState:function(t){this.container.dataset[this.name]=t},isCollapsed:function(){return this.getState()===bi},isExpanded:function(){return this.getState()===yi},isClosed:!1,isInitialized:!1,open:function(){if(this.isInitialized&&!this.isClosed)return this;var t=!1;return m(this.beforeOpen)&&(t=!1===this.beforeOpen(this)),t||(this.toggle(pi,yi,"add"),m(this.afterOpen)&&this.afterOpen(this),this.isClosed=!1),this},close:function(){if(this.isInitialized&&this.isClosed)return this;var t=!1;return m(this.beforeClose)&&(t=!1===this.beforeClose(this)),t||(this.toggle(mi,bi,"remove"),m(this.afterClose)&&this.afterClose(this),this.isClosed=!0),this},toggle:function(t,e,n){t(this.content),this.setState(e),this.container.classList[n]("expanded")},init:function(t){return Object.assign(this,t),this.header=xn("[data-".concat(this.name,"-header]"),this.container),this.content=xn("[data-".concat(this.name,"-content]"),this.container),this.isCollapsed()?this.close():this.isExpanded()&&(this.isClosed=!0,this.open()),this.bindEvents(),this.isInitialized=!0,this},bindEvents:function(){var t=this,e=this.container,n=this.header;n.addEventListener("click",(function(i){var s=_n(i.target,(function(e){return t.name in e.dataset}));e===s&&(t.isCollapsed()?t.open():n.parentNode===e&&t.close())}))}},Ei={create:function(t,e){if(!yt(t))return fi.BAD_CONTAINER_ACCORDION;var n=Object.create(this);return Object.assign(n,e,{container:t}),n},container:null,sections:null,selectedSection:null,beforeChange:null,afterChange:null,init:function(){var t=this;this.sections=[];for(var e=wn("[data-accordion]",this.container),n=0;n<e.length;n++){var i=e[n],s=wi.create(i,{name:"accordion",index:n,afterOpen:function(e){m(t.beforeChange)&&t.beforeChange(e),t.sections.filter((function(t){return t.index!==e.index})).forEach((function(t){return t.close()})),m(t.afterChange)&&t.afterChange(e),t.selectedSection=e}});if(R(fi,s))return s;this.sections.push(s),s.init()}return this}};function Ai(t,e){var n=Vn(t,vi,"[data-collapsible]"),i=h(e,{});if(w(n))return null;for(var s=[],a=0;a<n.length;a++){var r=wi.create(n[a],i);if(R(gi,r))throw gi[r];r.init(),s.push(r)}return s}function ji(t,e){var n=Vn(t,xi,"[data-boost=accordion]"),i=h(e,{});if(w(n))return null;for(var s=[],a=0;a<n.length;a++){var r=Ei.create(n[a],i);if(R(gi,r))throw gi[r];r.init(),s.push(r)}return s}var ki=encodeURIComponent;function Ni(t){return t.toString().replace(/^(.*\/\/[^/?#]*).*$/,"$1")}function _i(t,e){var n=decodeURIComponent(window.location.search);if(v(n))return null;var i={};if("URLSearchParams"in window){var s,a=new URLSearchParams(n.substring(1)),r=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=l(t))){n&&(t=n);var i=0,s=function(){};return{s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){o=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(o)throw a}}}}(a.entries());try{for(r.s();!(s=r.n()).done;){var o=s.value;i[o[0]]=o[1]}}catch(t){r.e(t)}finally{r.f()}return t?a.get(t):i}return n.substring(1).split("&").forEach((function(t){var e=t.split("=",2);i[e[0]]=e[1]})),t?h(i[t],e):i}function Oi(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return Object.keys(t).forEach((function(i){e&&v(t[i])||n.push("".concat(ki(i),"=").concat(ki(t[i])))})),n.join("&")}},491:(t,e,n)=>{"use strict";n.d(e,{createEditor:()=>Wr});var s=n(835),a=n(241);const r={file:null,title:null,status:null,container:null,mainView:null,infoView:null,conceptList:null,selection:null,placeholder:null,cache:null,init(){return this.cache=new Map,this},get hasFile(){return this.cache.size>0},get hasSelection(){return!(0,s.isNullOrUndefined)(this.selection)},refresh(){return this.hasFile?(this.container.classList.remove("empty"),(0,a.Cp)(this.placeholder),(0,a.$Z)(this.conceptList)):(this.container.classList.add("empty"),(0,a.$Z)(this.placeholder),(0,a.Cp)(this.conceptList)),this.hasSelection||(0,a.Cp)(this.infoView),this},render(){return this.container=(0,s.createDiv)({class:["editor-config"]}),this.mainView=(0,s.createDiv)({class:["editor-config-main"]}),this.infoView=(0,s.createDiv)({class:["editor-config-info"]}),this.conceptList=(0,s.createUnorderedList)({class:["bare-list","editor-config__list"]}),this.placeholder=(0,s.createParagraph)({class:["editor-config-placeholder"],html:`${(0,a._b)("No concept found")}. Please upload your files.`}),this.mainView.append(this.conceptList,this.placeholder),this.container.append(this.mainView,this.infoView),this.bindEvents(),this.refresh(),this.container},clear(){(0,s.removeChildren)(this.conceptList),(0,s.removeChildren)(this.infoView),this.cache.clear(),this.refresh()},selectItem(t){if(!this.cache.has(t))return null;let e=this.cache.get(t);return(0,s.isHTMLElement)(this.selection)&&this.selection.classList.remove("selected"),this.selection=e,this.selection.classList.add("selected"),this.refresh(),t},show(){return(0,a.$Z)(this.container),this.visible=!0,this},hide(){return(0,a.Cp)(this.container),this.visible=!1,this},showInfo(t){let e=o(this.editor.conceptModel.getCompleteModelConcept(t),(0,s.getTemplate)("#concept-schema"));(0,s.removeChildren)(this.infoView).append(e),(0,a.$Z)(this.infoView)},addItem(t){let e=(0,s.createSpan)({class:["loaded-element-name","fit-content"]},t.name),n=(0,s.createListItem)({class:["loaded-element",`loaded-element--${this.type}`],dataset:{context:"menu",action:"open-concept",concept:t.name,status:"active"}}),i=(0,s.createButton)({class:["btn","file-section__actionbar-button","file-section__actionbar-button--edit"],title:`Reload the ${this.type}`,dataset:{context:"menu",action:"open-concept",concept:t.name}});n.append(e,i),this.conceptList.append(n),this.cache.set(t.name,n),this.refresh()},bindEvents(){}};function o(t,e){if((0,s.isNullOrUndefined)(t))throw new TypeError("Bad argument: The 'schema' is missing");if(!(0,s.isHTMLElement)(e))throw new TypeError("Bad argument: The given 'template' is not a valid HTML Element");const n=(0,s.cloneTemplate)(e);return(0,s.getElements)("[data-if]",n).forEach(((e,n)=>{let i=e.dataset.if;(0,s.hasOwn)(t,i)||e.remove()})),(0,s.getElements)("[data-name]",n).forEach(((e,n)=>{let i=e.dataset.name;e.textContent=t[i]})),(0,s.getElements)("[data-attr]",n).forEach(((e,n)=>{let i=e.dataset.attr,[s,a]=i.split(":"),r=(e=>e.startsWith("$")?t[e.substring(1)]:e)(a);delete e.dataset.attr,e.dataset[s]=r})),(0,s.getElements)("[data-bind]",n).forEach(((e,n)=>{let i=e.dataset.bind;if(!(0,s.hasOwn)(t,i))return;let a=(0,s.getElement)("[data-item]",e),r=a.dataset.item,l=(0,s.getTemplate)(`#${r}`);t[i].forEach((t=>{a.append(o(t,l))}))})),n}const l={PRIMITIVE:"E",CONCRETE:"C",PROTOTYPE:"P",DERIVATIVE:"D"},c={file:null,title:null,status:null,container:null,mainView:null,infoView:null,files:null,btnLoad:null,btnLoadConcept:null,btnLoadProjection:null,btnUnload:null,btnDownload:null,btnEdit:null,selection:null,concepts:null,selectedConcept:null,attributes:null,filter:null,init(){return this.concepts=new Map,this.attributes=new Map,this.filter=Object.create(p,{editor:{value:this.editor},settings:{value:this}}).init([{label:"Concrete",nature:"concrete"},{label:"Prototype",nature:"prototype"},{label:"Derivative",nature:"derivative"}]),this},get hasFile(){return this.concepts.size>0},get hasSelection(){return!(0,s.isNullOrUndefined)(this.selection)},getFile(){return this.file},setFile(t){this.file=t,this.refresh()},refresh(){return this.hasFile?(this.container.classList.remove("empty"),(0,a.$Z)(this.files)):(this.container.classList.add("empty"),(0,a.Cp)(this.files)),this.btnUnload.disabled=!this.hasFile,this.editor.isReady?((0,a.Cp)(this.placeholder),this.placeholder.classList.remove("error")):this.hasFile?(this.editor.hasConceptModel||(this.placeholder.innerHTML=`${(0,a._b)("Missing projections")}`),this.editor.hasProjectionModel||(this.placeholder.innerHTML=`${(0,a._b)("Missing projections")}`),this.placeholder.classList.add("error"),(0,a.$Z)(this.placeholder)):(this.placeholder.innerHTML=`Add your ${(0,a._b)("concepts")} and ${(0,a._b)("projections")} or load a previously saved ${(0,a._b)("model")}`,this.placeholder.classList.remove("error")),this.hasSelection?(0,a.$Z)(this.infoView):(0,a.Cp)(this.infoView),this},reload(){this.editor.hasConceptModel?(this.editor.conceptModel.schema.forEach((t=>{let e=(0,s.createListItem)({class:["editor-file-concept"],dataset:{name:t.name,nature:t.nature,root:(0,s.valOrDefault)(t.root,"false")}},t.name);if(t.root){let t=(0,s.createI)({class:["editor-file-concept-root"],title:"root concept"});e.append(t)}this.concepts.set(t.name,e),this.files.append(e)})),this.refresh()):this.clear()},render(){this.container=(0,s.createDiv)({class:["editor-file"]});let t=(0,s.createDiv)({class:["editor-file-actionbar"]});this.btnOpen=(0,s.createButton)({class:["btn","editor-file__browse-button"],title:"Open a model",dataset:{action:"load"}},"Open"),this.btnLoad=h("load","Browse","Load file in editor");let e=(0,s.createDiv)({class:["editor-file-modactions"]});return this.btnLoadConcept=h("load-concept","Concept","Load some concepts into the editor"),this.btnLoadProjection=h("load-projection","Projection","Load some projections into the editor"),this.btnUnload=(0,s.createButton)({class:["btn","editor-file-actionbar__button","editor-file-actionbar__btn-remove"],title:"Remove all files",dataset:{action:"unload"}}),e.append(this.btnLoadConcept,this.btnLoadProjection,this.btnUnload),t.append(e),this.mainView=(0,s.createDiv)({class:["editor-file-mainview"]}),this.files=(0,s.createUnorderedList)({class:["bare-list","editor-file__list"]}),this.infoView=(0,s.createDiv)({class:["detail-area","editor-file-detail"]}),this.placeholder=(0,s.createParagraph)({class:["editor-file-placeholder"],html:`Add your ${(0,a._b)("concepts")}, ${(0,a._b)("projections")} and all other ${(0,a._b)("resources")}`}),this.mainView.append(this.filter.render(),this.files,this.infoView),this.container.append(t,this.mainView),this.bindEvents(),this.refresh(),this.container},clear(){(0,s.removeChildren)(this.files)},show(){return(0,a.$Z)(this.container),this.visible=!0,this},hide(){return(0,a.Cp)(this.container),this.visible=!1,this},selectItem(t){let e=this.concepts.get(t);(0,s.isHTMLElement)(this.selection)&&this.selection.classList.remove("selected"),this.selection=e,this.selection.classList.add("selected"),this.displayInfo(t),this.refresh()},displayConcept(t){if((0,s.isNullOrUndefined)(t))return;let e=this.editor.conceptModel.getConceptSchema(t);if((0,s.isNullOrUndefined)(e))return;this.selection=t;const{name:n,nature:i,attributes:a}=e;let r=(0,s.createDiv)({class:["app-model-concept"]}),o=(0,s.createDiv)({class:["app-model-concept-header"]}),c=(0,s.createUnorderedList)({class:["bare-list","app-model-concept-menu"]}),h=(0,s.createListItem)({class:["app-model-concept-menu-item","selected"],dataset:{action:"nav-structure"}},"Structure"),d=(0,s.createListItem)({class:["app-model-concept-menu-item"],dataset:{action:"nav-projections"}},"Projections");c.append(h,d);let p=(0,s.createI)({class:["app-model-concept-nature"],dataset:{name:i}},l[i.toUpperCase()]),m=(0,s.createSpan)({class:["app-model-concept-name"]},n);o.append(p,m);let f=(0,s.createDiv)({class:["app-model-concept-body"]}),g=(0,s.createUnorderedList)({class:["bare-list","app-model-concept-attributes"]}),y=(0,s.createUnorderedList)({class:["bare-list","app-model-concept-projections","hidden"]});Array.isArray(a)&&a.forEach((t=>{let e=(0,s.createListItem)({class:["app-model-concept-attribute"],dataset:{name:t.name,type:"attribute"}}),n=(0,s.createDiv)({class:["app-model__attribute-header"]}),i=(0,s.createSpan)({class:["app-model__attribute-name"]},t.name);if(t.required){let t=(0,s.createI)({class:["app-model__attribute-required"]},(0,s.createSpan)({class:["help"]},"required"));n.append(t)}n.append(i);let a=(0,s.createDiv)({class:["app-model__attribute-target"]},u(t.target)),r=(0,s.createDiv)({class:["app-model__attribute-info"]},[n,a]);e.append(r),this.attributes.set(t.name,e),g.append(e)})),f.append(g,y),r.append(o,f),(0,s.removeChildren)(this.infoView),this.infoView.append(r),this.selectedConcept=e,this.selectedConceptAttrs=g,this.selectedConceptProjs=y,this.refresh()},showStructure(){(0,a.$Z)(this.selectedConceptAttrs),(0,a.Cp)(this.selectedConceptProjs)},showProjections(){(0,a.Cp)(this.selectedConceptAttrs),(0,a.$Z)(this.selectedConceptProjs)},selectAttribute(t){return!(0,s.isNullOrUndefined)(t)&&(this.selectedAttribute!==t&&(this.selectedAttribute&&this.attributes.get(this.selectedAttribute).classList.remove("selected"),!!this.attributes.has(t)&&(this.selectedAttribute=t,this.attributes.get(t).classList.add("selected"),this.displayAttribute(t),this.refresh(),!0)))},displayAttribute(t){this.refresh()},bindEvents(){this.editor.registerHandler("editor.load-concept@post",(t=>{this.reload()})),this.editor.registerHandler("editor.unload-concept@post",(t=>{this.reload()})),this.editor.registerHandler("editor.unload-projection@post",(t=>{this.reload()})),this.container.addEventListener("dragenter",(t=>{this.container.classList.add("highlight"),t.preventDefault(),t.stopPropagation()}),!1),this.container.addEventListener("dragleave",(t=>{this.container.classList.remove("highlight"),t.preventDefault(),t.stopPropagation()}),!1),this.container.addEventListener("dragover",(t=>{this.container.classList.add("highlight"),t.preventDefault(),t.stopPropagation()}),!1),this.container.addEventListener("drop",(t=>{this.container.classList.remove("highlight");let e=t.dataTransfer.files[0];if(!e.name.endsWith(".json"))return void this.notify("This file is not supported. Please use a .json file");let n=new FileReader;n.onload=t=>{this.editor.load(n.result,this.type)},n.readAsText(e),t.preventDefault(),t.stopPropagation()}),!1),this.container.addEventListener("click",(t=>{const{target:e}=t,{type:n,action:i,name:s}=e.dataset;"nav-structure"===i?this.showStructure():"nav-projections"===i&&this.showProjections(),this.displayConcept(s),"attribute"===n?this.selectAttribute(s):"concept"===n&&this.parent.selectConcept(s)}))}};function h(t,e,n){return(0,s.createButton)({class:["btn","editor-file__browse-button"],title:n,dataset:{action:t},html:`\n            <span class="editor-home__btn-browse-icon" data-ignore="all">+</span> \n            <span class="editor-home__btn-browse-text" data-ignore="all">${e}</span>\n        `})}function u(t){const e=(0,s.createDocFragment)();if((0,s.isNullOrUndefined)(t))return e;const{name:n,accept:i}=t;let a=(0,s.createSpan)({class:["target-name"],dataset:{type:"concept",name:n}},n);if(e.append(a),i){let t=(0,s.createDiv)({class:["target-accept"]});Array.isArray(i)?(t.append(...i.map((t=>u(t)))),t.classList.add("array")):t.append(u(i)),e.append(t)}return e}const p={container:null,values:null,filters:null,concepts:null,init(t){this.values=(0,s.valOrDefault)(t,[]);let e=1;return this.values.forEach((t=>{t.id=e++})),this.filters=new Map,this},refresh(){this.filters.forEach(((t,e)=>{t.checked?t.parentElement.classList.add("checked"):t.parentElement.classList.remove("checked")}))},render(){return(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:"concept-filter"})),this.search=(0,s.createInput)({class:["concept-filter-search"]}),this.values.forEach((t=>{let e=(0,s.createInput)({class:["cf-option-checkbox"],type:"checkbox",checked:!0,value:t.id}),n=(0,s.createSpan)({class:["cf-option-text"]},t.label),i=(0,s.createLabel)({class:"concept-filter-option"},[e,n]);this.filters.set(t,e),this.container.append(i)})),this.bindEvents(),this.refresh(),this.container},filterConcepts(){this.settings.concepts.forEach(((t,e)=>{const{nature:n,root:i}=t.dataset;this.filters.forEach(((e,r)=>{r.nature===n&&(e.checked?(0,a.$Z)(t):(0,a.Cp)(t)),r.root===(0,s.toBoolean)(i)&&(e.checked?(0,a.$Z)(t):(0,a.Cp)(t))}))})),this.refresh()},bindEvents(){this.container.addEventListener("change",(t=>{const{target:e}=t;this.filterConcepts()}))}},m={file:null,title:null,status:null,container:null,mainView:null,infoView:null,conceptList:null,selection:null,placeholder:null,cache:null,init(){return this.cache=new Map,this},get hasFile(){return this.cache.size>0},get hasSelection(){return!(0,s.isNullOrUndefined)(this.selection)},refresh(){return this.hasFile?(this.container.classList.remove("empty"),(0,a.Cp)(this.placeholder),(0,a.$Z)(this.conceptList)):(this.container.classList.add("empty"),(0,a.$Z)(this.placeholder),(0,a.Cp)(this.conceptList)),this.hasSelection||(0,a.Cp)(this.infoView),this},render(){return this.container=(0,s.createDiv)({class:["editor-config"]}),this.mainView=(0,s.createDiv)({class:["editor-config-main"]}),this.infoView=(0,s.createDiv)({class:["editor-config-info"]}),this.conceptList=(0,s.createUnorderedList)({class:["bare-list","editor-config__list"]}),this.placeholder=(0,s.createParagraph)({class:["editor-config-placeholder"],html:`${(0,a._b)("No concept found")}. Please upload your files.`}),this.mainView.append(this.conceptList,this.placeholder),this.container.append(this.mainView,this.infoView),this.bindEvents(),this.refresh(),this.container},clear(){(0,s.removeChildren)(this.conceptList),(0,s.removeChildren)(this.infoView),this.cache.clear(),this.refresh()},selectItem(t){if(!this.cache.has(t))return null;let e=this.cache.get(t);return(0,s.isHTMLElement)(this.selection)&&this.selection.classList.remove("selected"),this.selection=e,this.selection.classList.add("selected"),this.refresh(),t},show(){return(0,a.$Z)(this.container),this.visible=!0,this},hide(){return(0,a.Cp)(this.container),this.visible=!1,this},addItem(t){let e=(0,s.createSpan)({class:["loaded-element-name","fit-content"]},t.name),n=(0,s.createListItem)({class:["loaded-element",`loaded-element--${this.type}`],dataset:{context:"menu",action:"open-concept",concept:t.name,status:"active"}}),i=(0,s.createButton)({class:["btn","file-section__actionbar-button","file-section__actionbar-button--edit"],title:`Reload the ${this.type}`,dataset:{context:"menu",action:"open-concept",concept:t.name}});n.append(e,i),this.conceptList.append(n),this.cache.set(t.name,n),this.refresh()},bindEvents(){}},f={menu:null,schema:null,isOpen:!1,visible:!0,btnStart:null,settings:null,init(t){return t&&(this.schema=t),this},get isRendered(){return(0,s.isHTMLElement)(this.container)},clear(){return(0,s.removeChildren)(this.container),this},update(){},render(){const t=(0,s.createDocFragment)();if(!(0,s.isHTMLElement)(this.container)){this.container=(0,s.createDiv)({class:["editor-home"]});let t=(0,s.createImage)({class:["editor-logo"],src:"https://gentlemancp.org/assets/images/logo_gentleman_200.png"}),e=(0,s.createH2)({class:["editor-title"]},"Settings"),n=(0,s.createDiv)({class:["editor-home-header"]},[t,e]);this.container.append(n)}return(0,s.isHTMLElement)(this.menu)||(this.menu=Object.create(g,{editor:{value:this.editor}}).init(),t.append(this.menu.render())),(0,s.isHTMLElement)(this.btnStart)||(this.btnStart=(0,s.createButton)({class:["btn","editor-home-section--model__button","editor-home-section__button--start"],dataset:{action:"close",context:"home"}},"Done!"),t.append(this.btnStart)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){const{hasConceptModel:t,hasProjectionModel:e}=this.editor;return this.btnStart.disabled=!(t&&e),this},actionHandler(t,e){const{concept:n}=e.dataset;"open-concept"===t&&(this.menu.config.selectItem(n),this.menu.config.showInfo(n))},bindEvents(){this.editor.registerHandler("concept-model.updated",(()=>{this.menu.config.clear(),this.editor.hasConceptModel&&this.editor.conceptModel.schema.filter((t=>t.root)).forEach((t=>{this.menu.config.addItem(t)}))}))}},g={container:null,tabsElement:null,tabs:null,currentTab:null,activeTab:null,fileIO:null,config:null,dataSettings:null,buildSettings:null,init(){return this.tabs=new Map,this.tabs.set("file","File"),this.tabs.set("config","Config"),this.currentTab="file",this},refresh(){},render(){return this.container=(0,s.createSection)({class:["editor-home-menu"]}),this.tabsElement=(0,s.createUnorderedList)({class:["bare-list","editor-home-menu-tabs"]}),this.tabs.forEach(((t,e)=>{let n=(0,s.createListItem)({class:["editor-home-menu-tab"],dataset:{name:e}},t);this.tabs.set(e,n),this.tabsElement.append(n)})),this.window=(0,s.createDiv)({class:["editor-home-menu-section"]}),this.fileIO=y.call(this),this.config=b.call(this),this.dataSettings=v.call(this),this.window.append(this.fileIO.render()),this.window.append(this.config.render()),this.window.append(this.dataSettings.render()),this.selectTab(this.currentTab),this.container.append(this.tabsElement,this.window),this.bindEvents(),this.container},selectTab(t){(0,s.isNullOrUndefined)(t)||this.activeTab&&this.currentTab===t||("file"===t?(this.fileIO.show(),this.config.hide(),this.dataSettings.hide()):"config"===t&&(this.config.show(),this.fileIO.hide(),this.dataSettings.hide()),this.activeTab&&(0,a.hF)(this.activeTab),this.currentTab=t,this.activeTab=this.tabs.get(this.currentTab),(0,a.Ys)(this.activeTab))},bindEvents(){this.tabsElement.addEventListener("click",(t=>{const{target:e}=t,{name:n}=e.dataset;this.selectTab(n)}))}};function y(t){const e=Object.create(c,{editor:{value:this.editor}});return e.init(),e}function b(){const t=Object.create(r,{editor:{value:this.editor}});return t.init(),t}function v(){const t=Object.create(m,{editor:{value:this.editor}});return t.init(),t}function x(t,e){const{name:n,object:i,id:a}=e,r=(0,s.createListItem)({class:["selector-concept",`selector-concept--${t}`],title:e.getName(),dataset:{concept:a,object:i}});var o=(0,s.createSpan)({class:["selector-concept-content"]},e.getName());r.append(o),"ancestor"===t&&o.classList.add("fit-content");const l=(0,s.createI)({class:["selector-concept-status"]});if(e.hasError){l.classList.add("error");let t=(0,s.createUnorderedList)({class:["bare-list","selector-concept-status__errors"]});e.errors.forEach((e=>{let n=(0,s.createListItem)({class:["selector-concept-status__error"]},e);n.style.minWidth=`${Math.min(.5*e.length,30)}em`,t.append(n)})),l.append(t),r.classList.add("error")}else l.classList.add("valid"),r.classList.add("valid");return r.append(l),r.addEventListener("mouseenter",(t=>{let e=(0,s.getElement)(`.projection[data-concept="${a}"]`,this.editor.body);e&&this.editor.highlight(e)})),r.addEventListener("mouseleave",(t=>{this.editor.unhighlight()})),r.addEventListener("click",(t=>{let e=(0,s.getElement)(`.projection[data-concept="${a}"]`,this.editor.body);e&&e.focus()})),r}const w={container:null,title:null,conceptList:null,header:null,body:null,get isRendered(){return(0,s.isHTMLElement)(this.container)},init(t={}){return this.schema=t,this},update(){},refresh(){const{activeInstance:t,activeConcept:e,hasActiveInstance:n,hasActiveConcept:i}=this.editor;if(!n||!i)return(0,s.removeChildren)(this.conceptList),this;const a=t.concept,r=(0,s.createDocFragment)();let o=x.call(this,"root",a);if(r.append(o),a===e&&o.classList.add("selector-concept--active"),a===e)return(0,s.removeChildren)(this.conceptList).append(r),this;if(!e.hasParent())return(0,s.removeChildren)(this.conceptList).append(r),this;let l=e.getParent(),c=[];for(;l&&l!==a;)c.unshift(l),l=l.getParent();return c.forEach((t=>{r.append(x.call(this,"ancestor",t))})),o=x.call(this,"active",e),r.append(o),(0,s.removeChildren)(this.conceptList).append(r),this},render(){const t=(0,s.createDocFragment)();(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["editor-breadcrumb"]})),(0,s.isHTMLElement)(this.notification)||(this.notification=(0,s.createDiv)({class:["notification","breadcrumb-notification"]}),t.append(this.notification));const e=(0,s.createSpan)({class:["breadcrumb-title","hidden"],dataset:{ignore:"all"}},"Breadcrumb");return t.append(e),(0,s.isHTMLElement)(this.conceptList)||(this.conceptList=(0,s.createUnorderedList)({class:["bare-list","selector-concepts"]}),t.append(this.conceptList)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.update(),this.refresh(),this.container},bindEvents(){}},E={schema:null,isOpen:!1,visible:!0,btnStart:null,logList:null,init(t){return t&&(this.schema=t),this},get isRendered(){return(0,s.isHTMLElement)(this.container)},add(t,e,n=a.hi.NORMAL){if(!Array.isArray(t))return;let i=(0,s.createUnorderedList)({class:["bare-list","log-item-messages"]});t.forEach((t=>i.append((0,s.createListItem)({class:["log-item-message"]},t))));let r=(0,s.createListItem)({class:["log-item",`log-item--${n}`]}),o=(0,s.createButton)({class:["btn","btn-delete"],dataset:{action:"delete",target:"parent"}},"✖"),l=(0,s.createSpan)({class:["log-item__name"],dataset:{action:"delete",target:"parent"}},`${(0,s.valOrDefault)(e,"Log")} (${(0,s.shortDateTime)(Date.now())})`);return r.append(o,l,i),this.logList.append(r),this.refresh(),this},clear(){return(0,s.removeChildren)(this.logList),this},update(){},render(){const t=(0,s.createDocFragment)();return(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["editor-log"]})),(0,s.isHTMLElement)(this.logList)||(this.logList=(0,s.createUnorderedList)({class:["bare-list","log-list"]}),t.append(this.logList)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){return this.logList.hasChildNodes()?this.show():this.hide(),this},bindEvents(){}},A={modelstatus:null,editorstatus:null,notification:null,views:null,view:"grid",viewContainer:null,viewList:null,viewItem:null,activeViewItem:null,groupList:null,groupItem:null,activeGroupItem:null,visible:!0,container:null,get isRendered(){return(0,s.isHTMLElement)(this.container)},init(){return this.views=new Map,this},show(){return(0,a.$Z)(this.container),this.visible=!0,this},hide(){return(0,a.Cp)(this.container),this.visible=!1,this},toggle(){return(0,a.ZN)(this.container),this.visible=!this.visible,this},updateActiveView(){"tab"===this.view&&(this.editor.instances.forEach((t=>{t!==this.editor.activeInstance&&(t.view.classList.remove("active"),t.hide())})),this.editor.activeInstance.view.classList.add("active"),this.editor.activeInstance.show()),this.editor.refresh()},addView(t){if((0,s.isNullOrUndefined)(t))return!1;let e=t.title.textContent,n=(0,s.createI)({class:["ico","ico-delete"]},"✖"),i=(0,s.createButton)({class:["btn","btn-close"]},n),a=(0,s.createDiv)({class:[`editor-view-${this.view}list-item__content`,"fit-content"]},e),r=(0,s.createListItem)({class:[`editor-view-${this.view}list-item`],title:t.title.textContent},[a,i]);t.view=r,r.addEventListener("click",(e=>{if(function(t){const e=t=>t===r||t===i;return e(t)?t:(0,s.findAncestor)(t,(t=>e(t)),5)}(e.target)===i){let e=r.previousSibling||r.nextSibling;t.delete(),null===this.editor.activeInstance&&e&&e.click()}else this.editor.updateActiveInstance(t)})),this.tabView.append(r)},changeView(t){if(t===this.view)return this;this.view=t,(0,a.hF)(this.viewItem),this.viewItem=this.views.get(this.view),(0,a.Ys)(this.viewItem),(0,s.removeChildren)(this.editor.viewSection),"tab"===t?(this.tabView=(0,s.createUnorderedList)({class:["bare-list","editor-view-tablist"]}),(0,s.removeChildren)(this.tabView),this.editor.instances.forEach((t=>{t.expand(),this.addView(t)})),this.editor.viewSection.append(this.tabView)):"grid"===t&&this.editor.instances.forEach((t=>{t.show()})),this.updateActiveView()},addGroup(){(0,s.createListItem)({class:["editor-footer-group"]})},notify(t,e=4500){let n=t;const i="open";if(this.notification.classList.contains(i))return!1;this.notification.appendChild(n),setTimeout((()=>{this.notification.classList.add(i),this.container.classList.add("menu--notifying")}),50),setTimeout((()=>{this.notification.classList.remove(i),this.container.classList.remove("menu--notifying"),setTimeout((()=>{(0,s.removeChildren)(this.notification)}),500)}),e)},refresh(){const{conceptModel:t}=this.editor;if(this.editor.isReady){if(t.hasError){this.modelstatusBadge.classList.add("error"),this.modelstatusBadge.classList.remove("valid"),this.container.classList.add("error");let e=t.concepts.filter((t=>t.hasError)).length;this.modelstatusInfo.textContent=`${e} ${function(t,e,n){if(1===n)return t;let i="s".split("|");return 1===i.length?t+i[0]:t.substring(0,t.lastIndexOf(i[0]))+i[1]}("error",0,e)}`}else this.modelstatusBadge.classList.add("valid"),this.modelstatusBadge.classList.remove("error"),this.container.classList.remove("error"),(0,s.removeChildren)(this.modelstatusInfo),this.editor.logs.clear();if(this.editor.hasError){this.editorstatusBadge.classList.add("error"),this.editorstatusBadge.classList.remove("valid"),this.container.classList.add("error");let t=this.editor.errors.length;this.editorstatusInfo.textContent=`${t}`}else this.editorstatusBadge.classList.add("valid"),this.editorstatusBadge.classList.remove("error"),this.container.classList.remove("error"),(0,s.removeChildren)(this.editorstatusInfo),this.editor.logs.clear()}},render(){const t=(0,s.createDocFragment)();if((0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["editor-statusbar"]})),(0,s.isHTMLElement)(this.badgeContainer)||(this.badgeContainer=(0,s.createDiv)({class:["editor-statusbar-badge-container"]}),t.appendChild(this.badgeContainer)),(0,s.isHTMLElement)(this.modelstatus)||(this.modelstatus=(0,s.createDiv)({class:["editor-statusbar-model"]}),this.modelstatusBadge=(0,s.createI)({class:["editor-statusbar-model-badge"]}),this.modelstatusInfo=(0,s.createDiv)({class:["editor-statusbar-model-info"]}),this.modelstatus.append(this.modelstatusBadge,this.modelstatusInfo),this.badgeContainer.appendChild(this.modelstatus)),(0,s.isHTMLElement)(this.editorstatus)||(this.editorstatus=(0,s.createDiv)({class:["editor-statusbar-global"]}),this.editorstatusBadge=(0,s.createI)({class:["editor-statusbar-global-badge"]}),this.editorstatusInfo=(0,s.createDiv)({class:["editor-statusbar-global-info"]}),this.editorstatus.append(this.editorstatusBadge,this.editorstatusInfo),this.badgeContainer.appendChild(this.editorstatus)),(0,s.isHTMLElement)(this.viewContainer)||(this.viewContainer=(0,s.createDiv)({class:["editor-statusbar-viewer-container"]}),t.appendChild(this.viewContainer)),!(0,s.isHTMLElement)(this.btnGroup)){let t=(0,s.createI)({class:["ico","ico-plus","btn-content"],title:"Add a group",dataset:{ignore:"all"}},"+");this.btnGroup=(0,s.createButton)({class:["editor-statusbar-viewer__button-add"],dataset:{action:"add-group"}},t)}return(0,s.isHTMLElement)(this.groupContainer)||(this.groupContainer=(0,s.createDiv)({class:["editor-footer-group"]})),(0,s.isHTMLElement)(this.viewList)||(this.viewList=(0,s.createUnorderedList)({class:["bare-list","editor-statusbar-viewers"]}),this.viewContainer.appendChild(this.viewList)),["grid","tab"].forEach((t=>{let e=(0,s.createListItem)({class:["editor-statusbar-viewer"],dataset:{type:"viewer",action:"change-view",value:t}},t);this.views.set(t,e),this.viewList.append(e)})),this.viewItem=this.views.get(this.view),this.viewItem.classList.add("selected"),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},bindEvents(){function t(t,e){let n=(0,s.createEmphasis)({class:["link","error-message__link"]},t);const i=`.projection[data-concept="${e}"]`;return n.addEventListener("mouseenter",(t=>{let e=(0,s.getElement)(i,this.editor.body);e&&this.editor.highlight(e)})),n.addEventListener("mouseleave",(t=>{this.editor.unhighlight()})),n.addEventListener("click",(t=>{let e=this.editor.resolveElement((0,s.getElement)(i,this.editor.body));e&&e.focus()})),n}this.modelstatus.addEventListener("click",(e=>{if(!this.editor.conceptModel.hasError)return;let n=[];this.editor.conceptModel.concepts.forEach((e=>{e.hasError&&n.push(...e.errors.map((n=>{let i=t.call(this,e.getName(),e.id);return(0,s.createSpan)({class:["error-message"]},[i,`: ${n}`])})))})),this.editor.logs.clear(),this.editor.logs.add(n,"Validation error",a.hi.ERROR)})),this.editorstatus.addEventListener("click",(t=>{if(!this.editor.hasError)return;let e=[];e.push(...this.editor.errors.map((t=>(0,s.createSpan)({class:["error-message"]},[`${t.message}`])))),this.editor.logs.clear(),this.editor.logs.add(e,"Validation error",a.hi.ERROR)})),this.editor.registerHandler("editor.instance@active:updated",(()=>{this.updateActiveView()}))}},j={container:null,list:null,editor:null,dataList:null,fetch:null,init(t){return this.fetch=t,this},render(){const t=(0,s.createDocFragment)();return(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["container","container--editor-selectors"]})),(0,s.isHTMLElement)(this.list)||(this.list=(0,s.createUnorderedList)({class:["bare-list","editor-selectors","font-ui"]}),t.append(this.list)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){return this},update(){this.dataList=this.fetch(),(0,s.removeChildren)(this.list);let t=(0,s.valOrDefault)(this.editor.getConfig("concept"),{});return this.dataList.forEach((e=>{const{concept:n,accept:i}=e;let a=(0,s.createH4)({class:["title","editor-selector__title"]},`${r=e.name,(0,s.hasOwn)(t,r)?t[r].name:r}`);var r;n&&a.append((0,s.createSpan)({class:["editor-selector__title-concept"]},(n.name||n.prototype).replace(" ","-").toLowerCase())),i&&a.append((0,s.createSpan)({class:["editor-selector__title-accept"]},i.name)),(0,s.createButton)({class:["btn","editor-selector__header-button","editor-selector__header-button--info"],title:`View ${e.name||e.type} info`,dataset:{action:"collapse",rel:"parent",target:"selector"}},"i");let o=(0,s.createHeader)({class:["title","editor-selector__header"],title:`Expand/Collapse ${this.type}`},[a]),l=k[this.type],c=(0,s.createDiv)({class:["editor-selector__action-bar"]},l.call(this,e)),h=(0,s.createListItem)({class:["editor-selector","collapsed","font-ui"],tabindex:0,dataset:{type:this.type,alias:`${e.name||e.type}`,name:"selector",projection:e.id}},[o,c]);this.list.append(h)})),this.refresh(),this},show(){return(0,a.$Z)(this.container),this},hide(){return(0,a.Cp)(this.container),this},bindEvents(){}},k={projection:function(t){const e=(0,s.createDocFragment)();let n=(0,s.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"edit:projection",id:t.id}},"Edit");return e.append(n),e},value:function(t){const e=(0,s.createDocFragment)();let n=(0,s.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"create-instance:value",id:t.id}},(0,s.createI)({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+")),i=(0,s.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"copy:value",id:t.id}},(0,s.createI)({class:["ico","ico-copy","btn-content"],dataset:{ignore:"all"}})),a=(0,s.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--delete"],dataset:{action:"delete:value",id:t.id}},(0,s.createI)({class:["ico","ico-delete","btn-content"],dataset:{ignore:"all"}},"✖"));return e.append(a,i,n),e},concept:function(t){const e=(0,s.createDocFragment)();let n=this.editor.projectionModel.hasProjectionSchema(t),i=(0,s.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],disabled:!n,title:`Create an instance of "${t.name}"`,dataset:{action:"create-instance",concept:t.name}},(0,s.createI)({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+"));return n||(i.title=`The concept ${t.name} has no projection`),e.append(i),e},resource:function(t){const{name:e,type:n,required:i}=t,a=(0,s.createDocFragment)();let r=(0,s.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--add"],dataset:{action:"load-resource",id:e}},(0,s.createI)({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+")),o=(0,s.createButton)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--delete"],dataset:{action:"delete:resource",id:e}},(0,s.createI)({class:["ico","ico-delete","btn-content"],dataset:{ignore:"all"}},"✖"));return this.editor.getResource(e)?a.append(o):a.append(r),a}},N={editor:null,valueCount:0,fileCount:0,container:null,title:null,visible:!0,tabs:null,tabConcept:null,tabValue:null,tabProjection:null,tabResource:null,tabConceptNotification:null,tabValueNotification:null,tabProjectionNotification:null,tabResourceNotification:null,activeTab:null,activeTabValue:null,menu:null,header:null,body:null,btnHome:null,btnSave:null,btnClose:null,get isRendered(){return(0,s.isHTMLElement)(this.container)},init(t){return t&&(this.editor=t),this._conceptSelector=function(t,e,n){return Object.create(j,{object:{value:"selector"},model:{value:void 0},type:{value:"concept"},editor:{value:e}})}(0,this.editor).init((()=>this.editor.isReady?this.editor.conceptModel.getSchema("concrete").filter((t=>t.root)):[])),this},render(){const t=(0,s.createDocFragment)();(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["editor-header"],dataset:{name:"editor-header",alias:"header"}})),(0,s.isHTMLElement)(this.title)||(this.title=(0,s.createSpan)({class:["editor-header-title"]},"Gentleman")),(0,s.isHTMLElement)(this.menu)||(this.menu=(0,s.createDiv)({class:["editor-header-left"]},[this.title]));let e=(0,s.valOrDefault)(this.editor.getConfig("toolbar"),[]),n=(0,s.createDiv)({class:["editor-toolbar"]},e.map((t=>(0,s.createButton)({class:(0,s.valOrDefault)(t.class,[]),dataset:{name:t.name,action:t.action}},t.content))));return(0,s.isHTMLElement)(this.btnHome)||(this.btnHome=(0,s.createButton)({class:["btn","editor-toolbar__button","editor-toolbar__button--home"],title:"Toggle menu",dataset:{action:"home"}}),n.append(this.btnHome)),(0,s.isHTMLElement)(this.header)||(this.header=(0,s.createDiv)({class:["editor-header-menu"]},[this.menu,n]),t.append(this.header)),(0,s.isHTMLElement)(this.body)||(this.body=(0,s.createDiv)({class:["editor-header-main"]}),t.append(this.body)),(0,s.isHTMLElement)(this._conceptSelector.container)||this.body.append(this._conceptSelector.render()),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){let t=(0,s.valOrDefault)(this.editor.getConfig("settings"),!0),e=(0,s.valOrDefault)(this.editor.getConfig("header"),!0);return this.editor.hasConceptModel?(this._conceptSelector.update(),(0,a.$Z)(this.body)):(0,a.Cp)(this.body),!1===t&&(0,a.Cp)(this.btnHome),!1===e&&(0,a.Cp)(this.body),this},show(t){if(!(0,s.isHTMLElement)(this[t]))return(0,a.$Z)(this.container),this.visible=!0,this;(0,a.$Z)(this[t])},hide(t){if(!(0,s.isHTMLElement)(this[t]))return(0,a.Cp)(this.container),this.visible=!1,this;(0,a.Cp)(this[t])},toggle(){return(0,a.ZN)(this.container),this.visible=!this.visible,this},bindEvents(){}};var _=0;const O={createInstance(t,e,n){if((0,s.isNullOrUndefined)(t))return this.notify("The concept is not valid",a.k$.ERROR),!1;let i="concept"===t.type?t:this.createConcept(t),r=e;(0,s.isNullOrUndefined)(r)&&this.hasProjectionModel&&(r=this.createProjection(i).init());let o=Object.create(L,{id:{value:"instance"+_++},object:{value:"environment"},name:{value:"editor-instance"},type:{value:"instance"},concept:{value:i,writable:!0},projection:{value:r,writable:!0},editor:{value:this}});const l=Object.assign({type:"concept",resize:!0,maximize:!0,close:"DELETE-CONCEPT"},n);return o.init(l),this.addInstance(o),o},getInstance(t){return this.instances.get(t)},addInstance(t){return t.isRendered||this.instanceSection.append(t.render()),this.instances.set(t.id,t),"tab"===this.status.view&&this.status.addView(t),t.concept.notify("displayed",t.projection.element.id),this.updateActiveInstance(t),this.refresh(),this},removeInstance(t){let e=this.getInstance(t);return!(0,s.isNullOrUndefined)(e)&&(e===this.activeInstance&&(this.activeInstance=null),e.view&&(0,s.removeChildren)(e.view).remove(),this.instances.delete(t),this.refresh(),!0)},moveInstance(t,e){return this.instanceSection.children[e].before(t),this},swapInstance(t,e){let n=Array.from(this.instanceSection.children);const i=n.indexOf(t),s=n.indexOf(e);return this.moveInstance(e,i),this.moveInstance(t,s),this}},L={window:null,container:null,title:null,visible:!0,menu:null,header:null,body:null,btnMaximize:null,btnClose:null,size:1,fullscreen:!1,collapsed:!1,schema:null,ctype:null,get isRendered(){return(0,s.isHTMLElement)(this.container)},init(t={}){return this.ctype=(0,s.valOrDefault)(t.type,"concept"),this.schema=t,this},setTitle(t){return!(0,s.isNullOrWhitespace)(t)&&(this.title.textContent=t,!0)},collapse(){return(0,a.wo)(this.container),this.collapsed=!0,this.fullscreen=!1,this.size="normal",this.refresh(),this},expand(){return(0,a.jn)(this.container),this.collapsed=!1,this.refresh(),this},changeSize(t){this.size=t,"fullscreen"===t?(this.fullscreen=!0,this.container.style.removeProperty("width"),this.container.style.removeProperty("height")):this.fullscreen=!1,this.refresh()},full(){this.size="fullscreen",this.fullscreen=!0,this.container.style.removeProperty("width"),this.container.style.removeProperty("height"),this.refresh()},show(){return(0,a.$Z)(this.container),this.visible=!0,this},hide(){return(0,a.Cp)(this.container),this.visible=!1,this},toggle(){return(0,a.ZN)(this.container),this.visible=!this.visible,this},refresh(){return this.container.dataset.size=`${this.size}`,(0,s.isNullOrUndefined)(this.projection)&&(this.body.textContent="No projection found"),Array.from(this.editor.instances).some((t=>t.fullscreen))?this.editor.instanceSection.classList.add("fullscreen"):this.editor.instanceSection.classList.remove("fullscreen"),this},render(){const t=(0,s.createDocFragment)(),{name:e}=this.concept,n=e.toLowerCase();(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["editor-concept",`editor-concept--${this.ctype}`],tabindex:0,dataset:{nature:"concept-container",type:this.ctype,size:1}})),(0,s.isHTMLElement)(this.header)||(this.header=(0,s.createHeader)({title:"concept"===this.schema.type?`Instance of "${n}"`:`Linked instance of "${n}"`,class:["editor-concept-header"]}),t.append(this.header)),(0,s.isHTMLElement)(this.btnClose)||(this.btnClose=(0,s.createButton)({class:["btn","editor-concept-toolbar__btn-delete"],title:`Delete the instance "${n}"`,dataset:{action:"close",context:this.type,id:this.id}}),"projection"===this.schema.type&&(this.btnClose.title=`Close the linked instance "${n}"`)),(0,s.isHTMLElement)(this.btnMaximize)||(this.btnMaximize=(0,s.createButton)({class:["btn","editor-concept-toolbar__btn-maximize"],title:`Maximize ${e.toLowerCase()}`,dataset:{action:"maximize",context:this.type,id:this.id}})),this.title=(0,s.createH3)({class:["title","editor-concept-title","fit-content"],dataset:{nature:"editable",id:this.id}},(0,s.valOrDefault)(this.schema.title,e));let i=(0,s.createDiv)({class:["editor-concept-toolbar"]},[this.btnMaximize,this.btnClose]);return(0,s.removeChildren)(this.header).append(this.title,i),this.body&&this.body.remove(),this.projection?this.body=this.projection.render():this.body=(0,s.createParagraph)(),t.append(this.body),t.hasChildNodes()&&(this.container.appendChild(t),this.bindEvents()),(0,a.n2)(this.container),this.refresh(),this.container},clear(){},actionHandler(t){switch(t){case"collapse":this.collapsed?this.expand():this.collapse();break;case"maximize":this.fullscreen?this.changeSize("normal"):this.changeSize("fullscreen");break;case"close":this.delete()}},delete(){switch(this.schema.close){case"DELETE-CONCEPT":if(!this.concept.delete(!0))return this.editor.notify("The concept could not be deleted",a.k$.ERROR),this;break;case"DELETE-PROJECTION":if(this.projection&&!this.projection.delete())return this.notify("The projection could not be deleted",a.k$.ERROR),this}(0,s.removeChildren)(this.container).remove(),this.editor.removeInstance(this.id),this.window&&this.window.removeInstance(this)},bindEvents(){this.container.addEventListener("focusin",(t=>{this.editor.updateActiveInstance(this)}))}};var M=0;const C={createWindow(t){let e=Object.create(S,{id:{value:"window"+M++},object:{value:"environment"},name:{value:"editor-window"},type:{value:"window"},editor:{value:this}});return e.refname=t,e.init(),this.addWindow(e),e},getWindow(t){return this.windows.get(t)},findWindow(t){return Array.from(this.windows.values()).find((e=>e.refname===t))},addWindow(t){return t.isRendered||this.body.append(t.render()),this.windows.set(t.id,t),"tab"===this.status.view&&this.status.addView(t),this.refresh(),this},removeWindow(t){let e=this.getWindow(t);return!(0,s.isNullOrUndefined)(e)&&(e===this.activeWindow&&(this.activeWindow=null),e.view&&(0,s.removeChildren)(e.view).remove(),this.windows.delete(t),this.refresh(),!0)},moveWindow(t,e){return this.body.children[e].before(t),this},swapWindow(t,e){let n=Array.from(this.body.children);const i=n.indexOf(t),s=n.indexOf(e);return this.moveWindow(e,i),this.moveWindow(t,s),this}},S={container:null,title:null,visible:!0,instances:null,menu:null,header:null,body:null,btnClose:null,maxInstance:1,get isRendered(){return(0,s.isHTMLElement)(this.container)},init(t={}){return this.ctype=(0,s.valOrDefault)(t.type,"concept"),this.schema=t,this.instances=new Set,this},isEmpty(){return 0===this.instances.size},show(){return(0,a.$Z)(this.container),this.visible=!0,this},hide(){return(0,a.Cp)(this.container),this.visible=!1,this},toggle(){return(0,a.ZN)(this.container),this.visible=!this.visible,this},close(){(0,s.removeChildren)(this.container).remove(),this.editor.removeWindow(this.id)},refresh(){return this.isEmpty()?this.hide():this.show(),this},render(){const t=(0,s.createDocFragment)();(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["editor-window"],tabindex:-1})),(0,s.isHTMLElement)(this.header)||(this.header=(0,s.createHeader)({class:["editor-window-header"]}),t.append(this.header)),(0,s.isHTMLElement)(this.title)||(this.title=(0,s.createH3)({class:["title","editor-window-title","fit-content"]})),(0,s.isHTMLElement)(this.btnClose)||(this.btnClose=(0,s.createButton)({class:["btn","editor-window-header__btn-delete"],title:"Close the window",dataset:{action:"close",context:this.type,id:this.id}}));let e=(0,s.createDiv)({class:["editor-window-toolbar"]},[this.btnClose]);return(0,s.removeChildren)(this.header).append(this.title,e),t.hasChildNodes()&&(this.container.appendChild(t),this.bindEvents()),this.refresh(),this.container},getInstance(t){return(0,s.isNullOrUndefined)(t)?null:Array.from(this.instances).find((e=>e.id===t))},addInstance(t){if(!(0,s.isNullOrUndefined)(t)&&!this.instances.has(t))return this.instances.add(t),t.window=this,this.container.append(t.container),this.refresh(),!0},removeInstance(t){if(!(0,s.isNullOrUndefined)(t)&&this.instances.has(t))return this.instances.delete(t),this.refresh(),!0},actionHandler(t){switch(t){case"close":this.close()}},bindEvents(){}},T={schema:null,isOpen:!1,visible:!0,btnClose:null,btnExport:null,outputName:null,selector:null,init(t){return t&&(this.schema=t),this},get isRendered(){return(0,s.isHTMLElement)(this.container)},clear(){return(0,s.removeChildren)(this.logList),this},update(){},render(){const t=(0,s.createDocFragment)();(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["editor-exporter","hidden"]})),(0,s.isHTMLElement)(this.btnClose)||(this.btnClose=(0,s.createButton)({title:"Close window",class:["btn","btn-collapse"]}),t.append(this.btnClose));let e=(0,s.createH4)({class:["editor-exporter-title"]},"Export model");if(t.append(e),(0,s.isNullOrUndefined)(this.selector)){let e=(0,s.createParagraph)({class:["editor-exporter__instruction"]},"Select the export format");this.selector=(n=["JSON","XML"],Object.create(I).init(n)),t.append(e,this.selector.render()),this.selector.select("JSON")}var n;if(!(0,s.isHTMLElement)(this.outputName)){let e=(0,s.createLabel)({class:["editor-exporter-file__label"]}),n=(0,s.createLabel)({class:["editor-exporter-file__label-value"]},"File");this.outputName=(0,s.createInput)({placeholder:"File name",class:["editor-exporter-file__input"]}),e.append(n,this.outputName),t.append(e)}return(0,s.isHTMLElement)(this.btnExport)||(this.btnExport=(0,s.createButton)({class:["btn","btn-export"]},"Export"),t.append(this.btnExport)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){return this},execute(){switch(this.selector.getValue()){case"JSON":this.toJSON(this.outputName.value);break;case"XML":this.toXML(this.outputName.value)}},toXML(){const{conceptModel:t}=this.editor,e=t.toXML();this.editor.download(e,`${this.outputName.value}.xml`,"XML")},toJSON(){const{conceptModel:t,projectionModel:e}=this.editor,n=JSON.stringify({type:"model",concept:t.schema,projection:e.schema,values:t.export()});this.editor.download(n,`${this.outputName.value}.json`,"JSON")},isValid(){return!(0,s.isNullOrWhitespace)(this.outputName.value)},bindEvents(){this.btnClose.addEventListener("click",(t=>{this.close()})),this.btnExport.addEventListener("click",(t=>{if(!this.isValid())return(0,a.lL)(this.btnExport),void this.editor.notify("Enter the file name",a.k$.ERROR,3e3);this.execute()}))}},I={container:null,values:null,selectors:null,selected:null,value:null,init(t){return this.values=(0,s.valOrDefault)(t,[]),this.selectors=new Map,this},getValue(){return this.value},refresh(){(0,s.isNullOrUndefined)(this.value)?this.container.classList.add("empty"):this.container.classList.remove("empty")},render(){let t=!1;return(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createUnorderedList)({class:["bare-list","export-selector"]}),t=!0),this.values.forEach((t=>{let e=this.createItem(t);this.container.append(e)})),t&&this.bindEvents(),this.container},select(t){if((0,s.isNullOrUndefined)(t))return;if(!this.selectors.has(t))return;let e=this.selectors.get(t);this.setSelectedItem(e),this.value=t,this.refresh()},createItem(t){let e=(0,s.createListItem)({class:["export-selector-item"],dataset:{value:t}}),n=(0,s.createLabel)({class:["export-selector-item__label"]}),i=(0,s.createInput)({type:"radio",name:"export-choice",value:t,class:["export-selector-item__input"]});return n.append(i,t),e.append(n),this.addItem(t,e),e},addItem(t,e){return this.selectors.set(t,e),this.refresh(),this},getItem(t){return this.selectors.get(t)},setSelectedItem(t){return!(!(0,s.isHTMLElement)(t)||t.parentElement!==this.container)&&(this.selected!==t?(this.selected&&(0,a.hF)(this.selected),this.selected=t,(0,a.Ys)(this.selected),!0):void 0)},bindEvents(){this.container.addEventListener("change",(t=>{const{target:e}=t;(0,s.isNullOrUndefined)(e.value)||this.select(e.value)}))}},U={container:null,isOpen:!1,visible:!0,show(){return(0,a.$Z)(this.container),this.visible=!0,this},hide(){return(0,a.Cp)(this.container),this.visible=!1,this},toggle(){return(0,a.ZN)(this.container),this.visible=!this.visible,this},open(){return this.container.classList.add("open"),this.show(),this.isOpen=!0,this.editor.refresh(),this},close(){return this.container.classList.remove("open"),this.hide(),this.isOpen=!1,this.editor.refresh(),this}};function D(){return Object.create(N,{object:{value:"environment"},name:{value:"editor-header"},editor:{value:this}})}function H(){return Object.create(w,{object:{value:"environment"},name:{value:"editor-breadcrumb"},type:{value:"breadcrumb"},editor:{value:this}})}function P(){return Object.assign(Object.create(U,{object:{value:"environment"},name:{value:"editor-home"},type:{value:"home"},editor:{value:this}}),f)}function R(){return Object.create(A,{object:{value:"environment"},name:{value:"editor-status"},type:{value:"status"},editor:{value:this}})}function B(){return Object.assign(Object.create(U,{object:{value:"environment"},name:{value:"editor-log"},type:{value:"log"},editor:{value:this}}),E)}function V(){return Object.assign(Object.create(U,{object:{value:"environment"},name:{value:"editor-exporter"},type:{value:"exporter"},editor:{value:this}}),T)}const z={getHandlers(t){return(0,s.valOrDefault)(this.handlers.get(t),[])},triggerEvent(t,e,n=!0){const{name:i,options:a,args:r}=t,o=this.getHandlers(i),l=(0,s.isFunction)(e);let c=!1;return o.forEach((t=>{let i=t.call(this,r,a);!1!==i?n&&l&&e.call(this,i):c=!0})),!c&&(!n&&l&&e.call(this),!0)},registerHandler(t,e){return this.hasHanlder(t)||this.handlers.set(t,[]),this.handlers.get(t).push(e),!0},unregisterHandler(t,e){if(!this.hasHanlder(t))return!1;let n=this.getHandlers(t);for(let t=0;t<n.length;t++)if(n[t]===e)return n.splice(t,1),!0;return!1},hasHanlder(t){return this.handlers.has(t)},registerReceiver(t,e){(0,s.isNullOrUndefined)(this.activeReceiver[e])&&(this.activeReceiver[e]=t),(0,s.isNullOrUndefined)(this.receivers[e])&&(this.receivers[e]={root:t,projections:[]},t.isRoot=!0),this.receivers[e].projections.push(t)},saturationRevolved(t,e){let n,i=this.receivers[e].projections;for(let e=0;e<i.length;e++)t.id===i[e].id&&(n=e);if(n>=i.length)return void this.setActiveReceiver(t,e);let s=i[n+1].transmitFirst();t.acceptAnchor(s)},getActiveReceiver(t){return this.activeReceiver[t]},setActiveReceiver(t,e){this.activeReceiver[e]=t},getRootReceiver(t){return this.receivers[t].root},findReceiverInstance(t,e){let n=this.receivers[e].projections;for(let e=0;e<n.length;e++){let i=n[e].instances.get(t);if((0,s.isHTMLElement)(i))return{container:n[e],instance:i}}alert("Not Found")}};var F=n(914);const q={create(t,e){const n=Object.create(this);return n.concept=t,n.schema=e,n},model:null,schema:null,source:null,id:null,value:null,object:"structure",init(t){throw new Error("This function has not been implemented")}};Object.defineProperty(q,"model",{get(){return this.concept.model}}),Object.defineProperty(q,"name",{get(){return this.schema.name}}),Object.defineProperty(q,"required",{get(){return(0,s.valOrDefault)(this.schema.required,!0)}});const $={object:"attribute",target:null,init(t){return this.target=this.model.createConcept(this.schema.target,{value:(0,s.valOrDefault)(t,this.schema.value),parent:this.concept,ref:this}),this},getValue(){return this.target.getValue()},hasValue(){return this.target.hasValue()},setValue(t){this.target.setValue(t)},getTarget(){return this.target},copy(){return this.target.hasValue()?this.target.copy(!1):null},clone(){return this.target.hasValue()?this.target.clone():null},export(){return this.target.hasValue()?{id:this.target.id,name:this.target.name}:null},toString(){return{[`attribute.${this.name}`]:this.target.toString()}},toXML(){return this.target.hasValue()?this.target.toXML():""}},W=Object.assign(Object.create(q),$),Z={attributes:null,attributes_created:null,initAttribute(){return this.attributes=[],this.attributes_created=new Set,this.attributes_updated=new Set,this.attributes_deleted=new Set,Array.isArray(this.attributeSchema)&&this.attributeSchema.filter((t=>(0,s.valOrDefault)(t.required,!0))).forEach((t=>this.createAttribute(t.name))),this},getAttributes(){return this.attributes},getAttribute(t){if((0,s.isNullOrUndefined)(t))throw new TypeError("Bad argument");return this.getAttributeByName(t)},getAttributeSchema(t){if((0,s.isNullOrWhitespace)(t))throw new TypeError("Bad argument");if(!this.hasAttribute(t))throw new Error(`Attribute '${t}' does not exist`);return(0,s.cloneObject)(this.attributeSchema.find((e=>e.name===t)))},getAttributeByName(t){if((0,s.isNullOrWhitespace)(t))throw new TypeError("Bad argument");var e=this.attributes.find((e=>e.name===t));return(0,s.isNullOrUndefined)(e)&&(e=this.createAttribute(t)),e},createAttribute(t,e){if(!this.hasAttribute(t))throw new Error(`Attribute not found: The concept '${this.name}' does not contain an attribute named '${t}'`);if(this.isAttributeCreated(t)){let n=this.getAttributeByName(t);if(e){let t=this.model.getValue(e);n.target.initValue(t)}return n}const n=this.getAttributeSchema(t);let i=this.model.getValue(e);var s=W.create(this,n).init(i);return this.addAttribute(s),s},addAttribute(t){if((0,s.isNullOrUndefined)(t)||"attribute"!==t.object)throw new Error("Bad argument: 'attribute' must be an attribute object");return this.attributes.push(t),this.attributes_created.add(t.name),this.notify("attribute.added",t),this},hasAttributes(){return!(0,s.isEmpty)(this.attributeSchema)||!(0,s.isEmpty)(this.attributes)},hasAttribute(t){return-1!==this.attributeSchema.findIndex((e=>e.name===t))},isAttributeRequired(t){const e=this.getAttributeSchema(t);return(0,s.valOrDefault)(e.required,!0)},isAttributeCreated(t){return this.attributes_created.has(t)},listAttributes(){const t=[];return this.attributeSchema.forEach((e=>{t.push({type:"attribute",name:e.name,target:e.target,accept:e.accept,required:this.isAttributeRequired(name),created:this.isAttributeCreated(name)})})),t},removeAttribute(t){if(this.isAttributeRequired(t))return{message:`The attribute '${t}' is required.`,success:!1};var e=this.attributes.findIndex((e=>e.name===t));if(-1===e)return{message:`The attribute '${t}' was not found.`,success:!1};var n=this.attributes.splice(e,1)[0];return this.attributes_created.delete(t),this.notify("attribute.removed",n),{message:`The attribute '${t}' was successfully removed.`,success:!0}}},X={listeners:null,initObserver(){return this.listeners=[],this},register(t){return this.listeners.includes(t)||this.listeners.push(t),!0},unregister(t){var e=this.listeners.indexOf(t);return-1!==e&&(this.listeners.splice(e,1),!0)},unregisterAll(){this.listeners=[]},notify(t,e){this.listeners.forEach((n=>{n.update(t,e,this)}))}},Y={model:null,schema:null,source:null,id:null,name:null,ref:null,actions:null,operations:null,accept:null,parent:null,references:null,errors:null,value:null,values:null,action:null,shadows:null,watchers:null,kind:"concept",init(t={}){return this.accept=t.accept,this.parent=t.parent,this.ref=t.ref,this.properties=(0,s.valOrDefault)(this.schema.properties,[]),Array.isArray(t.properties)&&this.properties.push(...t.properties),this.default=(0,s.valOrDefault)(this.schema.default,null),this.values=(0,s.valOrDefault)(t.values,(0,s.valOrDefault)(this.schema.values,[])),this.src=(0,s.valOrDefault)(this.schema.src,[]),this.constraint=this.schema.constraint,this.watchers=new Map,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(t.value),this},isRoot(){return(0,s.isNullOrUndefined)(this.parent)},initValue(){throw new Error("This function has not been implemented")},getName(){return this.ref&&"attribute"===this.ref.object?this.ref.name:this.name},getCandidates(){return this.values.forEach((t=>{(0,s.isObject)(t)&&(t.type="value")})),this.values},getStructure(){return[...this.listAttributes()]},getProperty(t,e){if("refname"===t){if((0,s.isNullOrUndefined)(this.ref))return;return this.ref.name}if("name"===t)return this.name;if("value"===t)return this.value;if(!this.hasProperty(t))return;let n=this.properties.find((e=>e.name===t));const{type:i,value:a}=n;return"string"===i?G.call(this,a):"number"===i?+a:"boolean"===i?(0,s.toBoolean)(a):a},hasProperty(t){return!!["refname","name","value"].includes(t)||-1!==(0,s.valOrDefault)(this.schema.properties,[]).findIndex((e=>e.name===t))},getConstraint(t){if(this.hasConstraint(t))return this.constraint[t]},hasConstraint(t){return!(0,s.isNullOrUndefined)(this.constraint)&&(!!(0,s.isNullOrUndefined)(t)||(0,s.hasOwn)(this.constraint,t))},hasParent(){return!this.isRoot()},getParent(t){if(this.isRoot())return null;if((0,s.isNullOrWhitespace)(t))return this.parent;const e=this.parent;return e.name===t?e:e.getParent(t)},getParentWith(t){if(this.isRoot())return null;if((0,s.isNullOrWhitespace)(t))return this.parent;const e=this.parent;return e.hasPrototype(t)?e:e.getParentWith(t)},getPrototype(){return(0,s.isNullOrUndefined)(this.prototype)?null:this.prototype},hasPrototype(t){if((0,s.isNullOrUndefined)(this.schema.prototype))return!1;if((0,s.isNullOrUndefined)(t))return!0;let e=this.model.getConceptSchema(this.schema.prototype);for(;!(0,s.isNullOrUndefined)(e);){if(e.name===t)return!0;e=this.model.getConceptSchema(e.prototype)}return!1},getAncestor(t){const e=[];for(var n=this.getParent(t);n;)e.push(n),n=n.getParent(t);return e},getChildren(t){const e=[];return(0,s.isNullOrUndefined)(t)?this.getAttributes().forEach((t=>{e.push(t.target)})):this.getAttributes().forEach((n=>{n.target.name===t?e.push(n.target):e.push(...n.target.getChildren(t))})),e},getDescendant(t){const e=[];return this.getChildren(t).forEach((n=>{e.push(n),e.push(...n.getDescendant(t))})),e},propagate(t,e,n){this.watchers.has(t)&&this.signal(t,e,n),this.hasParent()&&this.getParent().propagate(t,e,n)},watch(t,e){this.watchers.has(t)||this.watchers.set(t,[]),this.watchers.get(t).push(e)},signal(t,e,n){this.watchers.has(t)&&this.watchers.get(t).forEach((t=>t(e,n)))},unwatch(t,e){if((0,s.isNullOrUndefined)(t)||!this.watchers.has(t))return!1;if(!(0,s.isFunction)(e))return this.watchers.delete(t),!0;let n=this.watchers.get(t).findIndex((t=>t===e));return-1!==n&&(this.watchers.splice(n,1),!0)},done(){this.unregisterAll(),this.watchers.clear()},delete(t=!1){if(!t){const{object:t}=this.ref;let e={success:!0};if("concept"===t?e=this.getParent().removeValue(this):"attribute"===t&&(e=this.getParent().removeAttribute(this.ref.name)),!e.success)return e}this.getChildren().forEach((t=>{t&&t.delete(!0)}));try{this.notify("delete"),this.model.removeConcept(this.id),this.notify("delete")}catch(t){return console.error(this),{message:"Concept not found",success:!1}}return{message:`The concept '${this.name}' was successfully deleted.`,success:!0}},copy(t=!0){const e={name:this.name,nature:this.nature};var n=[];return this.getAttributes().forEach((t=>{n.push({name:t.name,value:t.copy(!1)})})),e.attributes=n,t&&this.model.addValue(e),e},clone(){const t={id:this.id,name:this.name};var e=[];return this.getAttributes().forEach((t=>{e.push({name:t.name,value:t.clone()})})),t.attributes=e,t},export(){const t={id:this.id,root:this.isRoot(),name:this.name};var e=[];return this.getAttributes().forEach((t=>{e.push({name:t.name,value:t.export()})})),t.force=this.force,t.attributes=e,t},toString(){var t={};return this.attributes.forEach((e=>{Object.assign(t,e.toString())})),t},toXML(){let t=this.getName().replace(" ","-");return`<${t} id="${this.id}">`+this.attributes.map((t=>t.toXML())).join("")+`</${t}>`},toXMI(){let t=this.getName().replace(" ","-");return`<${t} id="${this.id}">`+this.attributes.map((t=>t.toXML())).join("")+`</${t}>`}};function G(t){if((0,s.isString)(t))return t;const{type:e}=t;switch(e){case"concat":return K.call(this,t.concat)}}function J(t,e){const{type:n}=t;return"string"===n?G.call(this,t.value):"property"===n?this.getProperty(t.name):e||t}function K(t,e=""){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");return t.length<2?J.call(this,t[0]):t.map((t=>J.call(this,t))).join(e)}const Q=Object.assign(Y,X,Z);Object.defineProperty(Q,"attributeSchema",{get(){return this.schema.attributes}}),Object.defineProperty(Q,"_prototype",{get(){return this.schema.prototype}}),Object.defineProperty(Q,"hasError",{get(){return this.errors&&!(0,s.isEmpty)(this.errors)}});const tt={nature:"primitive",init(t={}){return this.parent=t.parent,this.ref=t.ref,this.default=(0,s.valOrDefault)(this.schema.default,!0),this.constraint=this.schema.constraint,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(t.value),this},initValue(t){if((0,s.isNullOrUndefined)(t))return this.value=this.default,this;if((0,s.isObject)(t)){const{id:e="",value:n}=t;e.length>10&&(this.id=e),this.setValue(n)}else this.setValue(t);return this},hasValue(){return!(0,s.isNullOrUndefined)(this.value)},getValue(){return this.value},setValue(t){let e=(0,s.isObject)(t)?t.value:t;return 200!==this.validate(e)?{success:!1,message:"Validation failed: The value could not be updated."}:(this.value=(0,s.toBoolean)(e),this.notify("value.changed",e),{success:!0,message:"The value has been successfully updated."})},restore(t){const{value:e}=t;this.setValue(e)},update:(t,e)=>!0,getCandidates:()=>[!0,!1],getChildren:t=>[],validate(t){return this.errors=[],(0,s.isString)(t)&&["true","false"].includes(t.toLowerCase())||Number.isInteger(t)&&[1,0].includes(t)||[!0,!1].includes(t)?200:400},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.getValue()};return t&&this.model.addValue(e),e},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let t=this.getName();return`<${t} id="${this.id}">`+this.getValue()+`</${t}>`}},et=Object.assign(Object.create(Q),tt);function nt(t,e){switch(t){case 400:return{success:!1,message:"The value is not a number."};case 401:return{success:!1,message:`Valid values: ${e}`};case 403:return{success:!1,message:`Maximum allowed: ${e.value}.`};case 402:return{success:!1,message:`Minimum allowed: ${e.value}.`};case 404:return{success:!1,message:`Value allowed: ${e.value}.`}}}const it={nature:"primitive",initValue(t){if((0,s.isNullOrUndefined)(t))return this.value=this.default,this;if((0,s.isObject)(t)){const{id:e="",value:n}=t;e.length>10&&(this.id=e),this.setValue(n)}else this.setValue(t);return this},hasValue(){return"number"==typeof this.value&&!isNaN(this.value)},getValue(){return this.hasValue()?+this.value:null},setValue(t){let e=(0,s.isObject)(t)?t.value:t;const{code:n,ctx:i}=this.validate(e);return this.value!==e&&(this.value=(0,s.isNullOrWhitespace)(e)?null:+e,this.notify("value.changed",e),this.propagate("value.changed",e,this)),200!==n?{success:!1,message:"Validation failed."}:{success:!0,message:"The value has been successfully updated."}},removeValue(){return this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},restore(t){const{value:e}=t;this.setValue(e)},getCandidates(){return this.values.forEach((t=>{(0,s.isObject)(t)&&(t.type="value")})),this.values},getChildren:t=>[],update:(t,e)=>!0,validate(t){if(this.errors=[],isNaN(t)){let t=400;return this.errors.push(nt.call(this,t).message),{code:t}}if(!this.hasConstraint())return{code:200};if(this.hasConstraint("value")){let e=this.getConstraint("value");const{type:n}=e;if("range"===n){const{min:i,max:s}=e[n];if(i&&+t<i.value){let t=402;return this.errors.push(nt.call(this,t,i).message),{code:t,ctx:i}}if(s&&+t>s.value){let t=403;return this.errors.push(nt.call(this,t,s).message),{code:t,ctx:s}}}else if("fixed"===n){const{value:i}=e[n];if(t!==i){let t=404;return this.errors.push(nt.call(this,t,e[n]).message),{code:t,ctx:e[n]}}}}if(this.hasConstraint("values")){let e=this.getConstraint("values").map((t=>st.call(this,t))).flat(),n=!1;for(let i=0;!n&&i<e.length;i++){const a=e[i];n=(0,s.isObject)(a)?a.value===t:a===t}if(!n){let t=401;return this.errors.push(nt.call(this,t,e).message),{code:t,ctx:e}}}return{code:200}},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.getValue()};return t&&this.model.addValue(e),e},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let t=this.getName();return`<${t} id="${this.id}">`+this.getValue()+`</${t}>`}};function st(t){if("reference"===t.type){let t=[];return this.model.isPrototype("model concept")&&(t=this.model.getConceptsByPrototype("model concept")),t.map((t=>t.getChildren(this.name))).flat().map((t=>t.value))}return t}const at=Object.assign(Object.create(Q),it),rt={nature:"primitive",reference:null,path:null,init(t={}){return this.parent=t.parent,this.ref=t.ref,this.accept=this.schema.accept,this.path=this.schema.path,this.values=(0,s.valOrDefault)(this.schema.values,[]),this.constraint=this.schema.constraint,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(t.value),this},initValue(t){return(0,s.isNullOrUndefined)(t)||this.setValue(t.value),this},restore(t){const{value:e}=t;this.setValue(e)},hasValue(){return!(0,s.isNullOrWhitespace)(this.value)},getValue(t=!1){return(0,s.isNullOrUndefined)(this.value)?null:t?this.reference:this.value},removeValue(){return this.reference&&this.reference.unregister(this),this.reference=null,this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},getReference(){return(0,s.isNullOrUndefined)(this.reference)?null:this.reference},setValue(t,e=!0){let n=(0,s.isObject)(t)?t.id:t;return 200!==this.validate(n)?{success:!1,message:"Validation failed: The value could not be updated."}:(0,s.isNullOrUndefined)(n)||this.value===n?{success:!0,message:"The value has been ignored."}:(this.reference&&this.reference.unregister(this),this.value=n,this.reference=this.model.getConcept(n),(0,s.isNullOrUndefined)(this.reference)&&e?setTimeout((()=>this.setValue(t,!1)),20):(this.reference.register(this),this.notify("value.changed",this.reference)),{success:!0,message:"The value has been successfully updated."})},getCandidates(){if((0,s.isNullOrUndefined)(this.accept))throw new Error("Bad reference: 'accept' property is not defined");var t=ot.call(this,this.accept);return this.path&&lt(this,this.path).map((t=>({type:this.accept.type,value:t}))),t},getChildren(t){return(0,s.isNullOrUndefined)(this.reference)||t&&this.reference.name!==t?[]:[this.reference]},delete(t=!1){if(!t){const{object:t}=this.ref;let e={success:!0};if("concept"===t?e=this.getParent().removeValue(this):"attribute"===t&&(e=this.getParent().removeAttribute(this.ref.name)),!e.success)return e}return this.reference&&this.reference.unregister(this),this.model.removeConcept(this.id),this.notify("delete"),{message:`The concept '${name}' was successfully deleted.`,success:!0}},update(t,e){switch(t){case"delete":this.reference.unregister(this),this.value=null,this.reference=null,this.notify("value.changed",this.reference);break;case"value.changed":this.setValue(this.value)}return!0},validate(t){return this.errors=[],(0,s.isNullOrUndefined)(t)||this.model.hasConcept(t)?200:(this.errors.push("This element is not valid"),401)},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.getValue()};return t&&this.model.addValue(e),e},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){var t=[];return this.value.forEach((e=>{t.push(e.toString())})),t},toXML(){let t=this.getName();return`<${t} id="${this.id}">`+this.getValue()+`</${t}>`}};function ot(t){const{name:e,scope:n,rel:i}=t;return"parent"===i?this.getParent(n).getChildren(e):"children"===i?this.getChildren(e):this.model.isPrototype(e)?this.model.getConceptsByPrototype(e):this.model.getConcepts(e)}function lt(t,e){if((0,s.isNullOrUndefined)(e))return t;const{target:n,value:i,rel:a}=e;var r=[];return"parent"===a?r.push(t.getParentWith(n)):"children"===a?r.push(...t.getChildren(n)):"property"===a&&r.push(t.getProperty(n)),r.map((t=>lt(t,i))).flat()}const ct=Object.assign({},Q,rt),ht={SUCCESS:200,INVALID_VALUE:401,MIN_CARDINALITY_ERROR:402,MAX_CARDINALITY_ERROR:403,FIX_CARDINALITY_ERROR:404};function ut(t,e){switch(t){case ht.INVALID_VALUE:return{success:!1,message:`Valid values: ${e}`};case ht.MAX_CARDINALITY_ERROR:return{success:!1,message:`Maximum cardinality: ${this.value.length}/${e.value}.`};case ht.MIN_CARDINALITY_ERROR:return{success:!1,message:`Minimum cardinality: ${this.value.length}/${e.value}.`};case ht.FIX_CARDINALITY_ERROR:return{success:!1,message:`Fixed cardinality: ${e.value}.`};case ht.PATTERN_ERROR:return{success:!1,message:"The value is not valid."}}}const dt={nature:"primitive",init(t={}){return this.parent=t.parent,this.ref=t.ref,this.accept=this.schema.accept,this.ordered=(0,s.valOrDefault)(this.schema.ordered,!0),this.constraint=this.schema.constraint,this.watchers=new Map,this.value=[],this.initObserver(),this.initAttribute(),this.initValue(t.value),this},initValue(t){this.removeAllElement();let e=pt.call(this);if((0,s.isNullOrUndefined)(t)){let t=e;for(let e=0;e<t;e++)this.createElement();return this}const{id:n="",name:i,value:a}=t;n.length>10&&(this.id=n);for(let t=0;t<a.length;t++)this.createElement(a[t]);let r=e-a.length;for(let t=0;t<r;t++)this.createElement();return this},hasValue(){return!(0,s.isEmpty)(this.value)},getValue(t=!1){const e=this.value.map((t=>this.model.getConcept(t)));return t?e.map((t=>t.getValue())):e},removeValue(t){return this.hasValue()?(this.removeElement(t),{success:!0,message:"The value has been successfully updated."}):{success:!0,message:"The value has been successfully updated."}},isValidElement(t){const{name:e,accept:n}=this.accept;return this.model.isPrototype(e)?(0,s.isNullOrUndefined)(n)?this.model.hasPrototype(t.name,e):Array.isArray(n)?n.some((e=>e.name===t.name)):n.name===t.name:this.accept.name===t.name},setValue(t){let e=t.value||t;if(Array.isArray(e)){this.removeAllElement();for(let t=0;t<e.length;t++)this.createElement(e[t])}else this.isValidElement(e)&&this.createElement(e)},restore(t){const{value:e}=t;e.forEach(((t,e)=>{this.value.includes(t.id)||this.createElement(t)}))},getElements(){return this.value.map((t=>this.model.getConcept(t)))},getElement(t){var e=this.value.find((e=>e===t));if(!(0,s.isNullOrUndefined)(e))return this.model.getConcept(e)},getElementAt(t){if(!(t<0||t>=this.value.length))return this.model.getConcept(this.value[t])},getFirstElement(){return this.getElementAt(0)},getLastElement(){return this.getElementAt(this.count-1)},addElement(t){return!(0,s.isNullOrUndefined)(t)&&(this.value.push(t.id),t.index=this.value.length-1,t.parent=this,t.ref=this,this.validate(),this.notify("value.added",t),this.propagate("value.changed",t,this),!0)},addElementAt(t,e=0){return(0,s.isNullOrUndefined)(t)&&(t=this.createElement()),this.value.splice(e,0,t.id),this.validate(),this.notify("value.added",t),this.propagate("value.changed",t,this),this},swapElement(t,e){if(!this.ordered)return this;let n=this.value[t];this.value[t]=this.value[e],this.value[e]=n;let i=this.getElementAt(t);i.index=+t;let s=this.getElementAt(e);return s.index=+e,this.notify("value.swapped",[i,s]),this},removeElement(t){let e=(0,s.valOrDefault)(t.index,this.value.indexOf(t.id));return-1!==e&&this.removeElementAt(e)},removeElementAt(t){let e=this.getElementAt(t);if((0,s.isNullOrUndefined)(e))return{message:`The element at index '${t}' was not found.`,success:!1};e.delete(!0),this.value.splice(t,1);const n=this.getValue();for(let e=t;e<n.length;e++)n[e].index=e;return this.validate(),this.notify("value.removed",e),this.propagate("value.changed",e,this),{message:`The element '${e.name}' was successfully removed.`,success:!0}},removeAllElement(){return this.value.forEach((t=>{this.model.removeConcept(t)})),this.value=[],this.notify("value.changed",this.value),this.propagate("value.changed",this.value,this),this},createElement(t){const e={value:this.model.getValue(t),parent:this,ref:this},n=this.model.createConcept(this.accept,e);return this.addElement(n),n},getProperty(t,e){if("refname"===t)return this.ref.name;if("name"===t)return this.name;if("value"===t)return this.value;if("length"===t||"cardinality"===t)return this.value.length;let n=this.properties.find((e=>e.name===t));if((0,s.isNullOrUndefined)(n))return;const{type:i,value:a}=n;return"string"===i?a:"number"===i?+a:"boolean"===i?(0,s.toBoolean)(a):a},hasProperty(t){return!!["refname","name","value","length","cardinality"].includes(t)||-1!==this.properties.findIndex((e=>e.name===t))},getCandidates(){return mt.call(this,this.accept)},getChildren(t){if(!this.hasValue())return[];const e=this.getElements();return(0,s.isNullOrUndefined)(t)?e:e.filter((e=>e.name===t))},validate(){if(this.errors=[],!this.hasConstraint())return{code:ht.SUCCESS};if(this.hasConstraint("cardinality")){let t=this.getConstraint("cardinality");const{type:e}=t;if("range"===e){const{min:n,max:i}=t[e];if(n&&this.value.length<n.value){let t=ht.MIN_CARDINALITY_ERROR;return this.errors.push(ut.call(this,t,n).message),{code:t,ctx:n}}if(i&&this.value.length>i.value){let t=ht.MAX_CARDINALITY_ERROR;return this.errors.push(ut.call(this,t,i).message),{code:t,ctx:i}}}else if("fixed"===e){const{value:n}=t[e];if(this.value.length!==n){let n=ht.FIX_CARDINALITY_ERROR;return this.errors.push(ut.call(this,n,t[e]).message),{code:n,ctx:t[e]}}}}return{code:ht.SUCCESS}},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.getValue().map((t=>t.copy(!1)))};return t&&this.model.addValue(e),e},clone(){return{id:this.id,name:this.name,value:this.getValue().map((t=>t.clone()))}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.value}},toString(){return this.getValue().map((t=>t.toString()))},toXML(){let t=this.getName();return`<${t} id="${this.id}">`+this.getValue().map((t=>t.toXML())).join("")+`</${t}>`}};function pt(){if(!this.hasConstraint("cardinality"))return 0;const t=this.getConstraint("cardinality"),{type:e}=t;if("range"===e){const{min:n}=t[e];return n.value}if("fixed"===e){const{value:n}=t[e];return n}return 0}function mt(t){return this.model.getConceptSchema(t)}const ft=Object.assign(Object.create(Q),dt);Object.defineProperty(ft,"count",{get(){return this.value.length}}),Object.defineProperty(ft,"canAddValue",{get:()=>!0});const gt=200,yt=405;function bt(t,e){switch(t){case 401:return{success:!1,message:`Valid values: ${e}`};case 403:return{success:!1,message:`Maximum length: ${e.value}.`};case 402:return{success:!1,message:`Minimum length: ${e.value}.`};case 404:return{success:!1,message:`Fixed length: ${e.value}.`};case yt:return{success:!1,message:"The value is not valid."};case 406:return{success:!1,message:"The value is already used."}}}const vt={nature:"primitive",initValue(t){if((0,s.isNullOrUndefined)(t))return this.value=this.default,this;if((0,s.isObject)(t)){const{id:e="",value:n}=t;e.length>10&&(this.id=e),this.setValue(n)}else this.setValue(t);return this},restore(t){const{value:e}=t;this.setValue(e)},hasValue(){return!(0,s.isNullOrWhitespace)(this.value)},getValue(){return this.value},removeValue(){return this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},setValue(t){let e=(0,s.isObject)(t)?t.value:t;var{code:n,ctx:i}=this.validate(e);return this.value!==e&&(this.value=e,this.notify("value.changed",e),this.propagate("value.changed",e,this)),n!==gt?{success:!1,message:"Validation failed."}:{success:!0,message:"The value has been successfully updated."}},getProperty(t,e){if("refname"===t)return this.ref.name;if("name"===t)return this.name;if("value"===t)return this.value;if("length"===t)return this.value.length;let n=this.properties.find((e=>e.name===t));if((0,s.isNullOrUndefined)(n))return;const{type:i,value:a}=n;return"string"===i?a:"number"===i?+a:"boolean"===i?(0,s.toBoolean)(a):a},hasProperty(t){return!!["refname","name","value","length"].includes(t)||-1!==this.properties.findIndex((e=>e.name===t))},getCandidates(){let t=(0,s.valOrDefault)(this.getConstraint("values"),[]);return(0,s.isEmpty)(t)?[...this.src.map((t=>{if("reference"===t.type){const{source:e,target:n}=t;let i=this.model.environment.getModel(e.name||e);if((0,s.isNullOrUndefined)(i))return null;let r=i.concept||i;if(!Array.isArray(r))return null;if(r.forEach((t=>{const e=function(t,e){var n=e;const i=[],r=e=>{let n=t.find((t=>t.name===e));if(!(0,s.isNullOrUndefined)(n))return(0,a.p$)(n)};for(;!(0,s.isNullOrUndefined)(n);){const t=(0,s.valOrDefault)(r(n),{});o=t.attributes,Array.isArray(o)&&o.forEach((t=>{const e=i.find((e=>e.name===t.name));(0,s.isNullOrUndefined)(e)?i.push(t):t.required&&(e.required=t.required)})),n=t.prototype}var o;return{attributes:i}}(r,t.prototype);t.attributes.push(...e.attributes)})),(0,s.isNullOrUndefined)(n.rel))return r.map((t=>t[n.value]));let o=wt.call(this,n,r);return(0,s.isNullOrUndefined)(o)?[]:o}if("concept"===t.type){const{concept:e,value:n}=t;let i=this.model.getConceptsByPrototype(e.prototype);return"attribute"===n.type?i.map((t=>t.getAttribute(n.name).getValue())):[]}return t}))].flat().filter((t=>!(0,s.isNullOrUndefined)(t))):t.map((t=>xt.call(this,t))).flat().filter((t=>!(0,s.isNullOrWhitespace)(t)))},getChildren:t=>[],update:(t,e)=>!0,validate(t){if(this.errors=[],(0,s.isNullOrWhitespace)(t))return{code:gt};if(!this.hasConstraint())return{code:gt};if(this.hasConstraint("length")){let e=this.getConstraint("length");const{type:n}=e;if("range"===n){const{min:i,max:s}=e[n];if(i&&t.length<i.value){let t=402;return this.errors.push(bt.call(this,t,i).message),{code:t,ctx:i}}if(s&&t.length>s.value){let t=403;return this.errors.push(bt.call(this,t,s).message),{code:t,ctx:s}}}else if("fixed"===n){const{value:i}=e[n];if(t.length!==i){let t=404;return this.errors.push(bt.call(this,t,e[n]).message),{code:t,ctx:e[n]}}}}if(this.hasConstraint("value")){let e=this.getConstraint("value");const{type:n}=e;if("pattern"===n){const{value:n,insensitive:i=!0,global:s=!0}=e.pattern;let a="";if(i&&(a+="g"),s&&(a+="i"),!new RegExp(n,a).test(t)){let t=yt;return this.errors.push(bt.call(this,t,e.pattern).message),{code:t,ctx:e.pattern}}}else if(n==="match".startsWith){const{start:i,end:s}=e[n];if(i&&!t.startsWith<i.value){let t=yt;return this.errors.push(bt.call(this,t,e.match).message),{code:t,ctx:e.match}}if(s&&t.length>s.value){let t=yt;return this.errors.push(bt.call(this,t,e.match).message),{code:t,ctx:e.match}}}else if("unique"===n){const{rel:n="parent",prototype:i}=e.unique;let s=this.getParent(),a=[];if(i?(s.hasPrototype()||(a=[]),a=this.model.getConceptsByPrototype(s._prototype)):a=this.model.getConcepts(s.name),a.some((e=>e!==s&&At(e,this.ref.name)===t))){let t=406;return this.errors.push(bt.call(this,t,e.unique).message),{code:t,ctx:e.unique}}}}if(this.hasConstraint("values")){let e=this.getConstraint("values").map((t=>xt.call(this,t))).flat(),n=!1;for(let i=0;!n&&i<e.length;i++){const a=e[i];n=(0,s.isObject)(a)?a.value===t:a===t}if(!n){let t=401;return this.errors.push(bt.call(this,t,e).message),{code:t,ctx:e}}}return{code:gt}},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.getValue()};return t&&this.model.addValue(e),e},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let t=this.getName();return`<${t} id="${this.id}">`+this.getValue()+`</${t}>`}};function xt(t){if("reference"===t.type){let t=[];return this.model.isPrototype("model concept")&&(t=this.model.getConceptsByPrototype("model concept")),t.map((t=>t.getChildren(this.name))).flat().map((t=>t.value))}if("meta-reference"===t.type){let t=[];return this.model.isPrototype("model concept")&&(t=this.model.getConceptsByPrototype("model concept")),t.map((t=>t.getChildren(this.name))).flat().map((t=>t.value))}return t}function wt(t,e){const{name:n,rel:i,scope:a,value:r}=t;let o=null;if("parent"===i){let t=this.getParent(n);if((0,s.isNullOrUndefined)(r))return t;if("reference"===r.type)return wt.call(t,r);if("attribute"===r.type)return t.getAttributeByName(r.name).getValue()}if("children"===i){let t=this.getChildren(n);if((0,s.isNullOrUndefined)(r))return t;if("reference"===r.type)return t.map((t=>wt.call(t,r)));if("attribute"===r.type)return t.filter((t=>kt(t,r.name)&&jt(t,r.name))).map((t=>At(t,r.name)))}if(t.source){const{type:e,value:n}=t.source;o="reference"===e?wt.call(this,t.source):n}if((0,s.isNullOrUndefined)(o))return e.map((t=>t[n].map((t=>t[r]))));if((0,s.isIterable)(o)&&(0,s.isEmpty)(o))return[];let l=e.find((t=>Array.isArray(o)?o.includes(t.name):t.name===o));return(0,s.isNullOrUndefined)(l)||!(0,s.hasOwn)(l,n)?[]:l[n].map((t=>t[r]))}const Et=(t,e)=>t.getAttributeByName(e).target,At=(t,e)=>Et(t,e).getValue(),jt=(t,e)=>Et(t,e).hasValue(),kt=(t,e)=>t.isAttributeCreated(e),Nt=Object.assign(Object.create(Q),vt),_t={nature:"concrete",initValue(t){if((0,s.isNullOrUndefined)(t))return!1;const{id:e="",attributes:n=[]}=t;return e.length>10&&(this.id=e),n.forEach((t=>{const{name:e,id:n,value:i}=t;this.createAttribute(e,i)})),!0},restore(t){const{attributes:e}=t;e.forEach((t=>{const{name:e,id:n,value:i}=t;this.isAttributeCreated(e)||this.createAttribute(e,i)}))},hasValue:()=>!0,getValue(){return{name:this.name,attributes:this.getAttributes().map((t=>({name:t.name,value:t.copy(!1)})))}},setValue(t){const{attributes:e=[]}=t;return e.forEach((t=>{const{name:e,id:n,value:i}=t;this.hasAttribute(e)&&this.createAttribute(e,i)})),!0}},Ot=Object.assign(Object.create(Q),_t),Lt=200;function Mt(t){switch(t){case 401:return{success:!1,message:"The value is not included in the list of valid values."}}}const Ct={name:"prototype",nature:"prototype",initValue(t){if((0,s.isNullOrUndefined)(t)){if(this.default){let t=this.createConcept(this.default);this.setValue(t)}return this}const{id:e="",value:n}=t;e.length>10&&(this.id=e);let i=null;return n?(i=this.createConcept(n.name,n),this.setValue(i)):t.name&&t.attributes&&(i=this.createConcept(t.name,t),this.setValue(i)),this},getValue(t=!1){return(0,s.isNullOrUndefined)(this.value)?null:t?this.target:this.value},getTarget(){return this.target},restore(t){const{value:e}=t;if((0,s.isNullOrUndefined)(e))return;let n=this.createConcept(e.name,e);this.setValue(n)},setValue(t){let e=t.name||t;if(this.validate(e)!==Lt)return{success:!1,message:"Validation failed: The value could not be updated."};let n=t;if(t&&"concept"===t.object&&(0,s.hasOwn)(t,"id")||(n=t.attributes?this.createConcept(e,t):this.createConcept(e)),this.target){let t=this.target.copy(!1);this.target.delete(!0),n.setValue(t)}return this.target=n,this.value=e,this.notify("value.changed",this.getCandidates().find((t=>t.name===this.value))),this.propagate("value.changed",e,this),{success:!0,message:"The value has been successfully updated."}},removeValue(){return(0,s.isNullOrUndefined)(this.value)||(this.value=null,this.notify("value.changed",this.value)),{success:!0,message:"The value has been successfully updated."}},hasValue(){return!(0,s.isNullOrUndefined)(this.value)},getCandidates(){return this.candidates||(this.candidates=St.call(this,this.schema.accept).map((t=>({type:"meta-concept",name:t.name,concept:Object.create(Tt,{object:{value:"meta-concept"},type:{value:"meta-concept"},name:{value:t.name},model:{value:this.model},schema:{value:t}})})))),this.candidates},getChildren(t){if(!this.hasValue())return[];const e=[];return((0,s.isNullOrUndefined)(t)||this.target.name===t)&&e.push(this.target),e},createConcept(t,e){let n=this.model.getValue(e);const i={parent:this,ref:this};n&&(i.value=n);const s=this.model.createConcept(t,i);return s.prototype=this,s},validate(t){if((0,s.isNullOrWhitespace)(t))return Lt;if((0,s.isEmpty)(this.values))return Lt;var e=!1;for(let n=0;!e&&n<this.values.length;n++){const i=this.values[n];e=(0,s.isObject)(i)?i.value===t:i===t}if(!e){let t=401;return this.errors.push(Mt.call(this,t).message),t}return Lt},copy(t=!0){if(!this.hasValue())return null;const e={name:this.name,nature:this.nature,value:this.target.copy(!1)};return t&&this.model.addValue(e),e},clone(){let t=null;return this.hasValue()&&(t=this.target.clone()),{id:this.id,name:this.name,value:t}},export(){let t=null;return this.hasValue()&&(t={id:this.target.id,name:this.target.name}),{id:this.id,name:this.name,root:this.isRoot(),value:t}},toXML(){if(!this.hasValue())return"";let t=this.getName();return`<${t} id="${this.id}">`+this.target.attributes.map((t=>t.toXML())).join("")+`</${t}>`}};function St(t){const e=this.model.getConcreteConcepts(this.name);return(0,s.isNullOrUndefined)(t)?e:Array.isArray(t)?e.filter((e=>t.some((t=>t.name===e.name)))):e.filter((e=>t===e.name))}const Tt={getProperty(t,e){if("refname"===t)return this.name;if("name"===t)return this.name;let n=this.properties.find((e=>e.name===t));if((0,s.isNullOrUndefined)(n))return;const{type:i,value:a}=n;return"string"===i?a:"number"===i?+a:"boolean"===i?(0,s.toBoolean)(a):a},hasPrototype(t){if((0,s.isNullOrUndefined)(this.schema.prototype))return!1;let e=this.model.getConceptSchema(this.schema.prototype);for(;!(0,s.isNullOrUndefined)(e);){if(e.name===t)return!0;e=this.model.getConceptSchema(e.prototype)}return!1}},It=Object.assign({},Q,Ct);function Ut(t){switch(t){case 401:return{success:!1,message:"The value is not included in the list of valid values."}}}const Dt={name:"meta",reference:null,initValue(t){return(0,s.isNullOrUndefined)(t)||this.setValue(t.value),this},hasValue(){return!(0,s.isNullOrWhitespace)(this.value)},getValue(){return(0,s.isNullOrUndefined)(this.value)?null:this.value},getProperty(t){const e=this.schema[t];if((0,s.isObject)(e)){const t=[];for(const n in e){const i=e[n];t.push(Object.assign({},{name:n},i))}return t}return e},setValue(t){var e=this.validate(t);return 200!==e?{success:!1,message:"Validation failed: The value could not be updated.",errors:[Ut(e).message]}:(0,s.isNullOrUndefined)(t)||this.value===t?void 0:(this.reference&&this.reference.unregister(this),this.reference=this.model.getConcept(t),this.reference.register(this),this.value=t,this.notify("value.changed",this.reference),{success:!0,message:"The value has been successfully updated."})},getChildren:t=>[],delete(t=!1){if(!t){let t=this.getParent().remove(this);if(!t.success)return t}return this.reference&&this.reference.unregister(this),this.model.removeConcept(this.id),this.notify("delete"),{message:`The concept '${name}' was successfully deleted.`,success:!0}},update(t,e){switch(t){case"delete":this.reference.unregister(this),this.value=null,this.reference=null,this.notify("value.changed",this.reference)}return!0},validate(t){return(0,s.isNullOrWhitespace)(t)||(0,s.isEmpty)(this.values),200},export(){return{id:this.id,name:this.name,value:this.value}},toString(){var t=[];return this.value.forEach((e=>{t.push(e.toString())})),t}},Ht=Object.assign({},Q,Dt);function Pt(t,e){return{object:{value:"concept"},type:{value:"concept"},model:{value:t},name:{value:e.name},base:{value:e.base},schema:{value:e,writable:!0}}}const Rt={boolean:(t,e)=>Object.create(et,Pt(t,e)),number:(t,e)=>Object.create(at,Pt(t,e)),reference:(t,e)=>Object.create(ct,Pt(t,e)),set:(t,e)=>Object.create(ft,Pt(t,e)),string:(t,e)=>Object.create(Nt,Pt(t,e)),meta:(t,e)=>Object.create(Ht,Pt(t,e))},Bt={primitive:(t,e)=>Rt[e.name](t,e),prototype:(t,e)=>Object.create(It,Pt(t,e)),concrete:(t,e)=>Object.create(Ot,Pt(t,e)),derivative:(t,e)=>Rt[e.base](t,e)},Vt={createConcept(t,e,n){const{name:i,nature:a}=e,r=Bt[a];if((0,s.isNullOrUndefined)(r))throw new Error(`Missing handler: The '${i}' concept could not be handled`);const o=r(t,e);if((0,s.isNullOrUndefined)(o))throw new Error(`Bad request: The '${i}' concept could not be created`);return o.init(n),(0,s.isNullOrUndefined)(o.id)&&(o.id=F.h.generate()),o}};var zt=0;const Ft={concepts:null,values:null,listeners:null,get hasError(){return this.concepts.some((t=>t.hasError))},init(t){return this.concepts=[],this.values=[],this.listeners=[],Array.isArray(t)&&(this.values=t,t.filter((t=>t.root)).forEach((t=>{this.createConcept({name:t.name},{value:t})})),this.values=t.filter((t=>t.id.startsWith("value")))),this},initValue(t){return Array.isArray(t)&&(this.values=t,t.filter((t=>t.root)).forEach((t=>{this.createConcept({name:t.name},{value:t})})),this.values=t.filter((t=>t.id.startsWith("value")))),this},done(){return this.concepts.forEach((t=>{t.done()})),this.concepts=[],!0},createConcept(t,e){const n=this.getCompleteModelConcept(t);if((0,s.isNullOrUndefined)(n))throw new Error(`Concept not found: ${t}`);var i=Vt.createConcept(this,n,e);return this.addConcept(i),i},getConcepts(t){if((0,s.isIterable)(t)){const e=Array.isArray(t)?e=>t.includes(e.name):e=>e.name===t;return this.concepts.filter((t=>e(t)))}return this.concepts.slice()},getRootConcepts(){return this.concepts.filter((t=>t.isRoot()))},getConceptsByPrototype(t){return this.concepts.filter((e=>e.hasPrototype(t)))},getConcept(t){if(!(0,s.isString)(t)||(0,s.isEmpty)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");return this.concepts.find((e=>e.id===t))},addConcept(t){if((0,s.isNullOrUndefined)(t))throw new TypeError("Bad request: The 'concept' argument must be a Concept");return this.concepts.push(t),t.register(this.environment),this},removeConcept(t){if(!(0,s.isObject)(t)&&!(0,s.isString)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");var e=this.concepts.findIndex((e=>e.id===t));return-1===e?null:this.concepts.splice(e,1)[0]},hasConcept(t){if(!(0,s.isObject)(t)&&!(0,s.isString)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");if((0,s.isEmpty)(this.concepts))return!1;let e=t.id||t;return t.name,this.concepts.some((t=>t.id===e))},getValues(t){if((0,s.isIterable)(t)){const e=Array.isArray(t)?e=>t.includes(e.name):e=>e.name===t;return this.values.filter((t=>e(t)))}return this.values.slice()},getValue(t){return(0,s.isNullOrUndefined)(t)?null:(0,s.hasOwn)(t,"value")||(0,s.hasOwn)(t,"attributes")?t:(0,s.hasOwn)(t,"id")?this.values.find((e=>e.id===t.id)):this.values.find((e=>e.id===t))},addValue(t){if((0,s.isNullOrUndefined)(t))throw new TypeError("Bad request: The 'value' argument must be a Value");return this.values.some((e=>{return i=t,(n=e).name===i.name&&(n.value?n.value===i.value:JSON.stringify(n.attributes)===JSON.stringify(i.attributes));var n,i}))||(t.id="value"+zt++,this.values.push(t),this.notify("value.added",t)),this},removeValue(t){if(!(0,s.isObject)(t)&&!(0,s.isString)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");var e=this.values.findIndex((e=>e.id===t));if(-1===e)return null;let n=this.values.splice(e,1)[0];return this.notify("value.removed",n),n},register(t){return this.listeners.includes(t)||this.listeners.push(t),!0},unregister(t){let e=this.listeners.indexOf(t);return-1!==e&&(this.listeners.splice(e,1),!0)},unregisterAll(){this.listeners=[]},notify(t,e){this.listeners.forEach((n=>{n.update(t,e)}))},isConcept(t){return!!(0,s.isString)(t)&&-1!==this.schema.findIndex((e=>e.name===t))},isConcrete(t){if(!(0,s.isString)(t))return!1;const e=this.schema.find((e=>e.name===t));return!(0,s.isNullOrUndefined)(e)&&"concrete"===e.nature},isPrototype(t){if(!(0,s.isString)(t))return!1;const e=this.schema.find((e=>e.name===t));return!(0,s.isNullOrUndefined)(e)&&"prototype"===e.nature},hasPrototype(t,e){if(!this.isConcept(t))return!1;let n=this.getConceptSchema(t);for(;!(0,s.isNullOrUndefined)(n);){if(n.prototype===e)return!0;n=this.model.getConceptSchema(n.prototype)}return!1},addConceptSchema(t){let e=t.concept||t;return this.schema.push(...e),this.environment.update("concept-model.updated"),!0},getSchema(t){if((0,s.isIterable)(t)){const e=Array.isArray(t)?e=>t.includes(e.nature):e=>e.nature===t;return this.schema.filter((t=>e(t)))}return this.schema.slice()},getConceptSchema(t){const e=Wt(this.schema,t);if(!(0,s.isNullOrUndefined)(e))return(0,a.p$)(e)},getCompleteModelConcept(t){let e=t;(0,s.isString)(t)&&(e={name:t});const n=this.getConceptSchema(e.name);if((0,s.isNullOrUndefined)(n))return;Object.assign(n,e),(0,s.hasOwn)(n,"attributes")||(n.attributes=[]);const i=qt.call(this,n.prototype);return n.attributes.push(...i.attributes),n},getConcreteConcepts(t){const e=e=>{for(var n=e.prototype;!(0,s.isNullOrUndefined)(n);){if(n===t)return!0;n=(0,s.valOrDefault)(Wt(this.schema,n),{}).prototype}return!1},n=this.schema.filter((t=>"concrete"===t.nature));return t?n.filter((t=>e(t))):n},getDerivedConcepts(t){if((0,s.isNullOrUndefined)(t))throw new TypeError("Bad argument");return this.schema.filter((e=>e.base===t))},export(){const t=[];return this.getConcepts().forEach((e=>{t.push(e.export())})),t.push(...this.getValues()),t},toString(){return JSON.stringify({[this.root.name]:this.root.toString()})},toXML(){return"<model:gentleman>"+this.getRootConcepts().map((t=>t.toXML())).join("")+"</model:gentleman>"},toXMI(){return'\n            <?xml version="1.0" encoding="ISO-8859-1"?>\n            <xmi:XMI xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:gent="geodes.sms.gentleman">\n                <gent:Model name="MindMap">\n        '+this.getRootConcepts().map((t=>t.toXMI())).join("")+"\n                </gent:Model>\n            </xmi:XMI>\n        "}};function qt(t){var e=t;const n=[];for(;!(0,s.isNullOrUndefined)(e);){const t=(0,s.valOrDefault)(this.getConceptSchema(e),{});i=t.attributes,Array.isArray(i)&&i.forEach((t=>{const e=n.find((e=>e.name===t.name));(0,s.isNullOrUndefined)(e)?n.push(t):t.required&&(e.required=t.required)})),e=t.prototype}var i;return{attributes:n}}const $t=[{name:"string",nature:"primitive"},{name:"number",nature:"primitive"},{name:"boolean",nature:"primitive"},{name:"reference",nature:"primitive"},{name:"set",nature:"primitive"}];function Wt(t,e){let n=t.find((t=>t.name===e));return(0,s.isNullOrUndefined)(n)&&(n=$t.find((t=>t.name===e))),n}const Zt=[],Xt={createModel(t,e){var n=Object.create(Ft,{schema:{value:(0,s.valOrDefault)(t,[])},environment:{value:e}});return Zt.push(n),n}};function Yt(t){const{type:e}=t;let n=this.concept||this.source;return"property"===e?(0,s.valOrDefault)(n.getProperty(t.name),""):"param"===e?this.getParam(t.name):t}const Gt={css:function(t,e){return(0,s.isIterable)(e)?(ee(t,e),t):t},ref:function(t,e){return(0,s.isIterable)(e)?(e.forEach((e=>{const{style:n={}}=(0,s.valOrDefault)(this.model.getStyleSchema(e),{});n.gss?Kt.call(this,t,n):Qt.call(this,t,n)})),t):t},gss:Qt,text:te,box:ae,html:function(t,e){return(0,s.isIterable)(e)?(e.forEach((e=>{let n=`style${(0,s.capitalizeFirstLetter)(e.name)}`;t.dataset[n]=Yt.call(this,e.value),"property"===e.value.type&&this.registerHandler("value.changed",(i=>{t.dataset[n]=Yt.call(this,e.value)}))})),t):t}},Jt={text:te,box:ae};function Kt(t,e){if(!(0,s.isObject)(e))return t;for(const n in e){const i=e[n];let a=Gt[n];(0,s.isFunction)(a)&&a.call(this,t,i)}return t}function Qt(t,e){if(!(0,s.isObject)(e))return t;for(const n in e){const i=e[n];let a=Jt[n];(0,s.isFunction)(a)&&a.call(this,t,i)}return t}function te(t,e){for(const n in e){const i=e[n];if(!1!==i)switch(n){case"bold":t.style.fontWeight=ie(i);break;case"italic":t.style.fontStyle="italic";break;case"underline":t.style.textDecoration="underline";break;case"strikethrough":t.style.textDecoration="line-through";break;case"color":t.style.color=ne(i);break;case"font":t.style.fontFamily=i.toString();break;case"size":t.style.fontSize=se(i);break;case"transform":t.style.textTransform=i}}return t}function ee(t,e){if(Array.isArray(e))t.classList.add(...e);else{let n=e.replace(/\s+/g," ").trim();(0,s.isNullOrWhitespace)(t.className)?t.className=n:ee(t,n.split(" "))}return t}function ne(t){if((0,s.isNullOrUndefined)(t))return"";const{type:e,value:n}=t;switch(e){case"rgb":return(0,s.isObject)(n)?`rgb(${n.red}, ${n.green}, ${n.blue})`:n;case"rgba":return(0,s.isObject)(n)?`rgba(${n.red}, ${n.green}, ${n.blue}, ${n.opacity/100})`:n;case"name":case"hexadecimal":return n;default:return n||t}}function ie(t){if((0,s.isNullOrUndefined)(t))return"";const{type:e,value:n}=t;return Number.isInteger(t)?`${t}`:"bold"}function se(t){if((0,s.isNullOrUndefined)(t))return"";const{value:e,unit:n}=t;return(0,s.isNullOrUndefined)(e)?"":`${e}${n}`}function ae(t,e){for(const n in e){const i=e[n];if(!1!==i)switch(n){case"inner":re.call(this,t,i,"padding");break;case"outer":re.call(this,t,i,"margin");break;case"border":ce.call(this,t,i);break;case"corner":he.call(this,t,i);break;case"background":oe.call(this,t,i);break;case"width":t.style.width=se.call(this,i);break;case"height":t.style.height=se.call(this,i);break;case"opacity":t.style.opacity=i/100;break;case"shadow":le.call(this,t,i,"shadow")}}return t}function re(t,e,n){if(!(0,s.isNullOrUndefined)(e))for(const i in e){const s=e[i];switch(i){case"all":t.style[`${[n]}`]=se.call(this,s);break;case"top":t.style[`${[n]}Top`]=se.call(this,s);break;case"right":t.style[`${[n]}Right`]=se.call(this,s);break;case"bottom":t.style[`${[n]}Bottom`]=se.call(this,s);break;case"left":t.style[`${[n]}Left`]=se.call(this,s)}}}function oe(t,e){if((0,s.isNullOrUndefined)(e))return;const{color:n,image:i}=e;n&&(t.style.backgroundColor=ne.call(this,n)),i&&(t.style.backgroundImage=`url(${i})`)}function le(t,e){if((0,s.isNullOrUndefined)(e))return null;const{offsetX:n,offsetY:i,blur:a,spread:r,inset:o=!1,color:l}=e;if((0,s.isNullOrUndefined)(n)||(0,s.isNullOrUndefined)(i))return null;let c=se.call(this,n),h=se.call(this,i),u=se.call(this,a),d=se.call(this,r),p=ne.call(this,l);t.style.boxShadow=o?`inset ${c} ${h} ${u} ${d} ${p}`.trim():`${c} ${h} ${u} ${d} ${p}`.trim()}function ce(t,e){if(!(0,s.isNullOrUndefined)(e))for(const n in e){const i=e[n];switch(n){case"all":t.style.borderStyle=(0,s.valOrDefault)(i.type,"solid"),t.style.borderWidth=se.call(this,i.width),t.style.borderColor=ne.call(this,i.color);break;case"top":t.style.borderTopStyle=(0,s.valOrDefault)(i.type,"solid"),t.style.borderTopWidth=se.call(this,i.width),t.style.borderTopColor=ne.call(this,i.color);break;case"right":t.style.borderRightStyle=(0,s.valOrDefault)(i.type,"solid"),t.style.borderRightWidth=se.call(this,i.width),t.style.borderRightColor=ne.call(this,i.color);break;case"bottom":t.style.borderBottomStyle=(0,s.valOrDefault)(i.type,"solid"),t.style.borderBottomWidth=se.call(this,i.width),t.style.borderBottomColor=ne.call(this,i.color);break;case"left":t.style.borderLeftStyle=(0,s.valOrDefault)(i.type,"solid"),t.style.borderLeftWidth=se.call(this,i.width),t.style.borderLeftColor=ne.call(this,i.color)}}}function he(t,e){if((0,s.isNullOrUndefined)(e))return null;for(const n in e){const i=e[n];switch(n){case"all":t.style.borderRadius=se.call(this,i);break;case"top-left":t.style.borderTopLeftRadius=se.call(this,i);break;case"top-right":t.style.borderTopRightRadius=se.call(this,i);break;case"bottom-right":t.style.borderBottomRightRadius=se.call(this,i);break;case"bottom-left":t.style.borderBottomLeftRadius=se.call(this,i)}}}const ue={init(){throw new Error("This function has not been implemented")},element:null,statusElement:null,attached:null,children:null,readonly:!1,visible:!1,disabled:!1,active:!1,focused:!1,get hasError(){return this.source.hasError},get hasAttached(){return!(0,s.isEmpty)(this.attached)},attach(t,e){this.attached.push(t)},detach(t){this.attached.slice(this.attached.indexOf(t),1)},getAttached(t){return(0,s.isFunction)(t)?this.attached.filter((e=>t(e))):this.attached},show(){return(0,a.$Z)(this.element),this.visible=!0,this.active=!0,this},hide(){return(0,a.Cp)(this.element),this.visible=!1,this},toggle(){return(0,a.ZN)(this.container),this.visible=!this.visible,this},focus(t){return this.element.contentEditable=!1,this.element.focus(),this.focused=!0,this},getContainer(){return this.element},notify(t,e,n){(0,a.lL)(this.element),this.environment.notify(t,e)},append(t){if(!(0,s.isHTMLElement)(t))throw new TypeError("Bad argument: The 'element' argument must be an HTML Element");return this.element.append(t),this},_focusIn:t=>!1,enable(){return this.disabled=!1,this},disable(){return this.disabled=!0,this},clear:()=>!0,delete(){var t=this.source.delete();t.success?(this.clear(),(0,s.removeChildren)(this.element),this.element.remove()):(this.environment.notify(t.message),(0,a.lL)(this.element))},spaceHandler(t){return console.warn(`SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},_spaceHandler(t){return console.warn(`CTRL_SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},escapeHandler(t){return console.warn(`ESCAPE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},enterHandler(t){this.focusOut()},deleteHandler(t){if(this.projection.element!==this)return(0,a.lL)(t),!1;if(!this.projection.optional)return(0,a.lL)(this.element),!1;let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex)),n=this.container.cloneNode(!0);this.source.hasParent()&&this.environment.save(this.source.getParent(),n),this.source.delete();let i=this.environment.resolveElement(e);return(0,s.isNullOrUndefined)(i)||i.focus(),!1},backspaceHandler(t){return console.warn(`BACKSPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},arrowHandler(t,e){return console.warn(`ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},_arrowHandler(t,e){return console.warn(`CTRL_ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},clickHandler(t){return console.warn(`CLICK_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},controlHandler(t){this.toolbar&&this.toolbar.remove()},shiftHandler(t,e){return console.warn(`SHIFT_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1}},de=Object.assign(ue);function pe(t){if(!(0,s.isHTMLElement)(t))return!1;const{nature:e,id:n}=t.dataset;return"field-component"===e&&n===this.id}const me={init(){return this.elements=new Map,this},render(){const t=(0,s.createDocFragment)(),{content:e="Add",items:n}=this.schema;(0,s.isHTMLElement)(this.element)||(this.element=(0,s.createDiv)({id:this.id,class:["field","add-button"],tabindex:-1,dataset:{nature:"field",view:"list",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),Kt.call(this.projection,this.element,this.schema.style));let i=(0,s.createButton)({class:["field-action","field--list__add"],tabindex:0,dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"add"}});return(0,s.isNullOrUndefined)(n)||(this.item=n),i.append(e),t.appendChild(i),t.hasChildNodes()&&this.element.append(t),this.bindEvent(),this.element},focusIn(){},clickHandler(t){const e=(t=>pe.call(this,t)?t:(0,s.findAncestor)(t,(t=>pe.call(this,t)),5))(t);if((0,s.isNullOrUndefined)(e))return;const{action:n,index:i,name:a}=e.dataset;"add"===n?(this.parent.prio=this.element,this.createElement()):"remove"===n&&this.delete(e.parentElement),this.parent.prio=this.element},createElement(){this.source.createElement()},addItem(t){return this.parent.addItem(t,this),this},removeItem(t){this.parent.removeItem(t)},refresh(){this.element&&this.source.getValue().forEach((t=>{this.addItem(t)}))},focusOut(){},bindEvent(){this.projection.registerHandler("value.added",(t=>{this.addItem(t)})),this.projection.registerHandler("value.removed",(t=>{this.removeItem(t)}))}},fe=Object.assign(Object.create(de),me);function ge(t,e){if(!Array.isArray(e))return!1;t.currentState=null;for(let n=0;n<e.length;n++){const i=e[n],{rule:a,result:r}=i;if((0,s.isNullOrUndefined)(a))return r;let o=!1,l=ye[a.type];if((0,s.isFunction)(l)&&(o=l.call(this,a[a.type])),o)return t.currentState=n,r}return null}const ye={ref:function(t){const{rule:e={}}=(0,s.valOrDefault)(this.model.getRuleSchema(t),{});let n=ye[e.type];return!!(0,s.isFunction)(n)&&n.call(this,e[e.type])},eq:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return be.call(this,t[0])==be.call(this,t[1])},ne:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return be.call(this,t[0])!=be.call(this,t[1])},lt:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return be.call(this,t[0])<be.call(this,t[1])},le:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return be.call(this,t[0])<=be.call(this,t[1])},gt:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return be.call(this,t[0])>be.call(this,t[1])},ge:function(t){if(!Array.isArray(t))throw new TypeError("Terms need to be an array");if(t.length<2)return null;return be.call(this,t[0])>=be.call(this,t[1])},and:function(t){return ve.call(this,t[0])&&ve.call(this,t[1])},or:function(t){return ve.call(this,t[0])||ve.call(this,t[1])},not:function(t){return!ve.call(this,t[0])},no:function(t){let e=be.call(this,t);return(0,s.isIterable)(e)?(0,s.isEmpty)(e):(0,s.isNullOrUndefined)(e)}};function be(t,e){if(t&&"property"===t.type){const{name:e}=t;let n=`get${(0,s.pascalCase)(e)}`;return this[n]?this[n]():this[e]}if(t&&"param"===t.type){const{name:e}=t;return this.projection.getParam(e)}if((0,s.isObject)(t)){let e=`get${(0,s.pascalCase)(t.prop)}`;return this[e]?this[e]():this[t.prop]}return e||t}function ve(t){let e=ye[t.type];return(0,s.isFunction)(e)?e.call(this,t[t.type]):(0,s.toBoolean)(be.call(this,t))}function xe(t){const{type:e}=t;return"property"===e?(this.hasProperty=!0,(0,s.valOrDefault)(this.source.getProperty(t.name),"")):"param"===e?this.projection.getParam(t.name):"html"===e?(0,s.htmlToElement)(t.html):"raw"===e?(0,s.htmlToElement)(t.raw):t}const we={input:null,label:null,value:"",state:null,init(){const{focusable:t=!0}=this.schema;return this.focusable=t,this.children=[],this},refresh(){if((0,s.valOrDefault)(ge.call(this,this.schema,this.schema.state),this.schema),this.schema.state){let t=this.schema.state[this.getValue().toString()];if(t&&t.content){const{style:e,content:n,value:i}=t;let a=(0,s.createDocFragment)();n.forEach((t=>{a.append(da.call(this,t))})),(0,s.removeChildren)(this.label).append(a),Kt.call(this.projection,this.label,e)}}this.input.checked?this.element.dataset.state="on":this.element.dataset.state="off",this.hasError?(this.element.classList.add("error"),this.input.classList.add("error")):(this.element.classList.remove("error"),this.input.classList.remove("error"))},render(){const t=(0,s.createDocFragment)(),{checkbox:e}=this.schema;var n;if((0,s.isHTMLElement)(this.element)||(this.element=(n=this.id,(0,s.createDiv)({id:n,class:["field","field--binary"],tabindex:-1,dataset:{nature:"field",view:"binary",id:n}})),this.readonly&&this.element.classList.add("readonly"),Kt.call(this.projection,this.element,this.schema.style)),!(0,s.isHTMLElement)(this.input)){if(this.input=function(t){return(0,s.createInput)({id:`checkbox${t}`,type:"checkbox",class:["field--binary__input"],tabindex:0,dataset:{nature:"field-component",view:"binary",id:t}})}(this.id),this.input.checked=this.source.getValue(),this.value=this.input.checked,this.readonly&&(this.input.classList.add("readonly"),this.input.disabled=!0),e){const{style:t}=e;Kt.call(this.projection,this.input,t)}else(0,a.Cp)(this.input);t.append(this.input)}if(!(0,s.isHTMLElement)(this.label)){if(this.label=(0,s.createLabel)({class:["field--checkbox__label"],for:this.input.id,tabindex:0,dataset:{nature:"field-component",view:"binary",id:this.id}}),this.label.htmlFor=this.input.id,e&&e.label){const{content:t}=e.label;if(Array.isArray(t))t.forEach((t=>{let e=xe.call(this,t),n=(0,s.createSpan)({class:["field--checkbox__label-content"],dataset:{ignore:"all"}},e);Kt.call(this.projection,n,t.style),this.label.append(n)}));else{let e=xe.call(this,t);this.label.append(e)}Kt.call(this.projection,this.label,e.label.style)}t.append(this.label)}return t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.value=this.input.checked,this.element.classList.add("active"),this},focusOut(){if(!this.readonly)return this.hasChanges()&&this.setValue(this.input.checked),this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.choice&&(0,a.Cp)(this.choice),this.input.blur(),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},hasChanges(){return this.value!==this.input.checked},hasValue(){return this.input.checked},getValue(){return this.input.checked},setValue(t,e=!1){var n;(n=e?this.source.setValue(t):{success:!0}).success||this.environment.notify(n.message,"error"),this.input.checked=t,this.value=t,this.refresh()},getCandidates(){return this.source.getCandidates()},enable(){this.input.disabled=!1,this.input.tabIndex=0,this.disabled=!1},disable(){this.input.disabled=!0,this.input.tabIndex=-1,this.disabled=!0},escapeHandler(t){let e=!0;if(this.messageElement&&!(0,a.xj)(this.messageElement)&&((0,a.Cp)(this.messageElement),e=!1),e){let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex));return this.environment.resolveElement(e).focus(e),!0}},backspaceHandler(t){return this.arrowHandler("left",t)},enterHandler(t){this.setValue(!this.input.checked,!0)},arrowHandler(t,e){return!!this.parent&&this.parent.arrowHandler(t,this.element)},bindEvents(){this.element.addEventListener("change",(t=>{this.setValue(this.getValue(),!0)})),this.projection.registerHandler("value.changed",(t=>{this.setValue(t)}))}},Ee=Object.assign(Object.create(de),we);function Ae(t){const e=t=>t.parentElement===this.choices;return e(t)?t:(0,s.findAncestor)(t,e,5)}function je(t){const{type:e}=t.dataset;return e}function ke(t){const{type:e,value:n}=t.dataset;return"concept"===e?this.values.find((t=>t.id===n)).id:"meta-concept"===e?this.values.find((t=>t.name===n)).name:"value"===e?n:"placeholder"===e?null:n}const Ne=(t,e)=>"concept"===t.type?Ne(t.id,e):"concept"===e.type?Ne(t,e.id):"meta-concept"===t.type?Ne(t.name,e):"meta-concept"===e.type?Ne(t,e.name):t===e,_e={value:null,placeholder:null,expanded:null,values:null,choices:null,input:null,items:null,selection:null,selectList:null,selectListValue:null,icoToggle:null,init(t={}){Object.assign(this.schema,t);const{focusable:e=!0,placeholder:n=!1,expanded:i=!0}=this.schema;return this.items=new Map,this.focusable=e,this.expanded=i,this.placeholder=n,this.children=[],(0,s.hasOwn)(this.schema,"choice")||(this.schema.choice={}),(0,s.hasOwn)(this.schema.choice,"option")||(this.schema.choice.option={}),this},hasChanges(){return this.value!=this.source.getValue()},reset(){this.source.removeValue()},hasValue(){return!(0,s.isNullOrUndefined)(this.value)},getValue(){return this.selection},setValue(t,e=!1){var n=null;if(e)return(n=this.source.setValue(t)).success||this.environment.notify(n.message,a.k$.ERROR),!0;(0,s.isNullOrUndefined)(t)?(this.selection&&this.selection.classList.remove("selected"),this.expanded||(0,s.removeChildren)(this.selectListValue),this.selection=null):this.setChoice(t),(0,s.isNullOrUndefined)(t)?this.value=null:"concept"===t.type?this.value=t.id:"meta-concept"===t.type?this.value=t.name:this.value=t;const{template:i={}}=this.schema.choice.option;if(this.selection&&!this.expanded&&t)if((0,s.removeChildren)(this.selectListValue),"meta-concept"===t.type){let e=this.model.getProjectionSchema(t.concept,(0,s.valOrDefault)(i.tag))[0],n=e.type,a={type:n,[n]:e.content||e.projection},r=da.call(this,a,t.concept,{focusable:!1,meta:t.name});this.selectListValue.append(r)}else if("concept"===t.type){let e=this.model.createProjection(t,i.tag).init({focusable:!1});e.readonly=!0,e.focusable=!1,e.parent=this.projection,this.selectListValue.append(e.render())}else this.selectListValue.append(t.toString());this.refresh()},refresh(){return this.hasValue()?(this.element.classList.remove("empty"),this.element.dataset.value=this.value.name||this.value):(this.element.classList.add("empty"),this.element.dataset.value="",!this.expanded&&this.placeholder&&(0,s.removeChildren)(this.selectListValue).append(this.placeholder)),this.input&&(this.element.dataset.input=this.input.value),this.element.classList.remove("querying"),this.hasError?(this.element.classList.add("error"),this.input&&this.input.classList.add("error")):(this.element.classList.remove("error"),this.input&&this.input.classList.remove("error")),this},render(){const t=(0,s.createDocFragment)(),{choice:e,input:n,style:i}=this.schema;if((0,s.isHTMLElement)(this.element)||(this.element=(0,s.createDiv)({id:this.id,class:["field","field--choice"],tabindex:-1,dataset:{nature:"field",view:"choice",input:"",id:this.id}})),!(0,s.isHTMLElement)(this.input)&&n){const{placeholder:e="",type:i,style:a}=n;let r=la.call(this,e);this.input=(0,s.createInput)({class:["field--choice__input"],type:(0,s.valOrDefault)(i,"text"),placeholder:r,title:r,dataset:{nature:"field-component",view:this.type,id:this.id}}),Kt.call(this,this.input,a),t.append(this.input)}if(!(0,s.isHTMLElement)(this.choices)){const{style:n}=e;this.choices=(0,s.createUnorderedList)({class:["bare-list","field--choice__choices"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}}),Kt.call(this,this.choices,n),t.append(this.choices)}if(!this.expanded){let e=(0,s.createDiv)({class:["field--choice__select-wrapper"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}});this.selectListValue=(0,s.createDiv)({class:["field--choice__select-value"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}}),this.icoToggle=(0,s.createI)({class:["field--choice__select-icon"],dataset:{nature:"field-component",view:"choice",id:this.id}}),e.append(this.selectListValue,this.icoToggle),this.selectList=(0,s.createDiv)({class:["field--choice__select-list","hidden"],dataset:{nature:"field-component",view:"choice",id:this.id}}),this.input&&this.selectList.append(this.input),this.selectList.append(this.choices),t.append(e),t.append(this.selectList)}if(Kt.call(this,this.element,i),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),(0,s.removeChildren)(this.choices),this.placeholder){const{style:t}=this.schema.choice.option;let e=(0,s.createListItem)({class:["field--choice__choice","field--choice__choice--placeholder"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:"placeholder"}},this.placeholder);this.choices.append(e),Kt.call(this,e,t)}return this.values=this.source.getCandidates(),this.values.forEach((t=>{this.choices.append(this.createChoiceOption(t))})),this.source.hasValue()&&this.setValue(this.source.getValue()),this.refresh(),this.element},focus(t){if(this.expanded)if(this.choices.hasChildNodes()){let t=(0,a.sB)(this.choices);t&&t.focus()}else this.input&&!(0,a.xj)(this.input)?this.input.focus():this.selection&&this.selection.focus();else this.input&&!(0,a.xj)(this.input)?this.input.focus():this.selectListValue.focus();return this.element.classList.add("active"),this},navigate(t,e,n){let i=null;if("up"===t?i=(0,a.GV)(this.element):"down"===t?i=(0,a.Sd)(this.element):"left"===t?i=(0,a.GF)(this.element):"right"===t&&(i=(0,a.EE)(this.element)),(0,s.isNullOrUndefined)(i))return!1;i.focus()},focusIn(){this.focused=!0,this.element.classList.add("active");const t=(0,s.createDocFragment)();return this.source.getCandidates().filter((t=>!this.values.some((e=>Ne(e,t))))).forEach((e=>{t.append(this.createChoiceOption(e)),this.values.push(e)})),this.choices.append(t),this.expanded||((0,a.$Z)(this.selectList),this.selectList.dataset.state="open"),this},focusOut(){if(this.readonly)return;this.input&&(0,s.isNullOrWhitespace)(this.input.value)&&(this.input.value=""),this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.input&&this.input.blur(),this.element.classList.remove("active"),this.element.classList.remove("querying");const{children:t}=this.choices;for(let e=0;e<t.length;e++){const n=t[e];(0,a.$Z)(n),n.hidden=!1}return this.expanded||((0,a.Cp)(this.selectList),this.selectList.dataset.state="close"),this.focused=!1,this},showChoices(){const{children:t}=this.choices;for(let e=0;e<t.length;e++){const n=t[e];(0,a.$Z)(n),n.hidden=!1}},enable(){return this.input&&(this.input.disabled=!1,this.input.tabIndex=0),this.disabled=!1,this},disable(){return this.input&&(this.input.disabled=!0,this.input.tabIndex=-1),this.disabled=!0,this},filterChoice(t){const{children:e}=this.choices;if(this.element.dataset.input=t.trim(),(0,s.isNullOrWhitespace)(t)){for(let t=0;t<e.length;t++){const n=e[t];(0,a.$Z)(n),n.hidden=!1}return}this.element.classList.add("querying");let n=t.trim().toLowerCase().replace(/\s+/g," ").split(" ");for(let t=0;t<e.length;t++){const i=e[t];let s=i.textContent.toLowerCase(),r=s.replace(/[_-]+/g," ").replace(/\s+/g,"").trim();n.some((t=>s.includes(t)||r.includes(t)))?((0,a.$Z)(i),i.hidden=!1):((0,a.Cp)(i),i.hidden=!0)}return!0},createChoiceOption(t){const{template:e={},style:n}=this.schema.choice.option,i=(0,s.isObject)(t),a=(0,s.createListItem)({class:["field--choice__choice"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:i?"concept":"value",value:i?t.id:t}});if(Kt.call(this,a,n),this.items.set(t.id,a),"meta-concept"===t.type){let n=this.model.getProjectionSchema(t.concept,(0,s.valOrDefault)(e.tag))[0],i=n.type,r={type:i,[i]:n.content||n.projection},o=da.call(this,r,t.concept,{focusable:!1,meta:t.name});a.dataset.type="meta-concept",a.dataset.value=t.name,a.append(o)}else if(i){if(!this.model.hasProjectionSchema(t,e.tag))return a;let n=this.model.createProjection(t,e.tag).init({focusable:!1});n.readonly=!0,n.focusable=!1,n.parent=this.projection,a.append(n.render())}else a.append(t.toString());return a},setChoice(t){const{children:e}=this.choices;let n=!1;for(let i=0;i<e.length;i++){const s=e[i];let r=ke.call(this,s);r&&Ne(r,t)?(s.classList.add("selected"),s.dataset.selected="selected",this.selection=s,(0,a.$Z)(s),n=!0):(s.classList.remove("selected"),delete s.dataset.selected)}return this},delete(){if(this.hasValue())this.reset();else{let t=this.source.delete();t.success?(this.clear(),(0,s.removeChildren)(this.element),this.element.remove()):(this.environment.notify(t.message),(0,a.lL)(this.element))}},_spaceHandler(t){let e=this.source.getCandidates();if((0,s.isEmpty)(e))return void this.notify("No candidates found.",a.k$.INFO);const n=(0,s.createDocFragment)();if(e.forEach((t=>{n.append(this.createChoiceOption(t))})),(0,s.removeChildren)(this.choices),this.placeholder){const{style:t}=this.schema.choice.option;let e=(0,s.createListItem)({class:["field--choice__choice","field--choice__choice--placeholder"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:"placeholder"}},this.placeholder);this.choices.append(e),Kt.call(this,e,t)}this.choices.append(n),this.filterChoice(this.input.value),(0,a.$Z)(this.choices),this.element.classList.add("querying")},escapeHandler(t){let e=!0;if(this.messageElement&&!(0,a.xj)(this.messageElement)&&((0,a.Cp)(this.messageElement),e=!1),!this.expanded&&"open"===this.selectList.dataset.state)return(0,a.Cp)(this.selectList),this.selectList.dataset.state="close",!0;if(e){let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex));return this.environment.resolveElement(e).focus(e),!0}this.focus()},enterHandler(t){const e=Ae.call(this,t);(0,s.isHTMLElement)(e)&&this.selection!==e&&("placeholder"===je(e)?this.source.removeValue():this.setValue(ke.call(this,e),!0),this.expanded||((0,a.Cp)(this.selectList),this.selectList.dataset.state="close",this.focus()))},backspaceHandler(t){Ae.call(this,t)&&this.input&&this.input.focus()},clickHandler(t){const e=Ae.call(this,t);(0,s.isHTMLElement)(e)&&this.selection!==e?("placeholder"===je(e)?this.source.removeValue():this.setValue(ke.call(this,e),!0),this.expanded||((0,a.Cp)(this.selectList),this.selectList.dataset.state="close")):t===this.selectListValue&&((0,a.$Z)(this.selectList),this.selectList.dataset.state="open")},arrowHandler(t,e){if(!(0,s.isHTMLElement)(e))return!1;const{parentElement:n}=e,i=()=>!!this.parent&&this.parent.arrowHandler(t,this.element);if(!this.expanded&&e===this.selectListValue)return this.arrowHandler(t,this.selectListValue.parentElement);let r=Ae.call(this,e);if(r){let e=(0,a.As)(r,t,this.choices,!1);return(0,s.isHTMLElement)(e)?(e.focus(),!0):this.arrowHandler(t,this.choices)}if(this.expanded&&n!==this.element)return i();let o=(0,a.As)(e,t,n,!1);return(0,s.isHTMLElement)(o)?(o===this.selectList&&(o=this.input||this.choices),o===this.choices&&this.choices.hasChildNodes()&&("up"===t?o=(0,a.GV)(this.choices):"down"===t?o=(0,a.Sd)(this.choices):"left"===t?o=(0,a.GF)(this.choices):"right"===t&&(o=(0,a.EE)(this.choices))),o.focus(),!0):i()},bindEvents(){(0,s.isHTMLElement)(this.input)&&this.element.addEventListener("input",(t=>{this.filterChoice(this.input.value)})),this.projection.registerHandler("value.changed",((t,e)=>{this.setValue(t)}))}},Oe=Object.assign(Object.create(de),_e),Le={init(){return this},render(){const t=(0,s.createDocFragment)(),{content:e,markers:n,marker:i,self:a}=this.schema;var r=new DOMParser;return(0,s.isHTMLElement)(this.element)||(this.element=(0,s.createDiv)({id:this.id,class:[],dataset:{nature:"field",view:"dynamic",id:this.id}})),(0,s.isHTMLElement)(this.content)||(this.content=r.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,t.appendChild(this.content)),(0,s.isNullOrUndefined)(this.place)&&(this.place=this.content.querySelector("[data-"+i+"]")),(0,s.isNullOrUndefined)(this.markers)&&(this.markers=new Map,this.content.querySelectorAll("[data-"+i+"]").forEach((t=>{let e=t.getAttribute("data-"+i);(0,s.isNullOrUndefined)(this.markers.get(e))?this.markers.set(e,[t]):this.markers.set(e,this.markers.get(e).concat([t]))}))),(0,s.isNullOrUndefined)(this.aliases)&&(this.aliases=new Map,n.forEach((t=>{let e=[];t.aliases.forEach((t=>{let n=this.markers.get(t.mv);const i=[];n.forEach((e=>{const n={};n.target=e;let a=[];t.props.forEach((t=>{const n={};n.property=t.props,n.value=t.value,(0,s.isNullOrUndefined)(e.style)||(0,s.isNullOrUndefined)(e.style[t.props])?n.default=e[t.props]:n.default=e.style[t.props],a.push(n)})),n.impacts=a,i.push(n)})),e.push(i)})),this.aliases.set(t.mv,e)}))),(0,s.isNullOrUndefined)(this.self)&&!(0,s.isEmpty)(a)&&(this.self=[],a.forEach((t=>{const e={};e.property=t,(0,s.isNullOrUndefined)(this.place.style[t])?e.default=this.place[t]:e.default=this.place.style[t],this.self.push(e)}))),t.hasChildNodes()&&this.element.appendChild(t),this.update=this.refresh,this.clear=this.clean,this},refresh(t){let e=this.aliases.get(t.toString());(0,s.isNullOrUndefined)(e)||e.forEach((t=>{t.forEach((t=>{t.impacts.forEach((e=>{(0,s.isNullOrUndefined)(t.target[e.property])?t.target.style[e.property]=e.value:t.target[e.property]=e.value}))}))})),(0,s.isNullOrUndefined)(this.self)||this.self.forEach((e=>{(0,s.isNullOrUndefined)(this.place.style[e.property])?this.place[e.property]=t:this.place.style[e.property]=t}))},clean(t){let e=this.aliases.get(t);(0,s.isNullOrUndefined)(e)||e.forEach((t=>{t.forEach((t=>{t.impacts.forEach((e=>{(0,s.isNullOrUndefined)(t.target.style[e.property])?t.target[e.property]=e.default:t.target.style[e.property]=e.default}))}))})),(0,s.isNullOrUndefined)(this.self)||this.self.forEach((t=>{(0,s.isNullOrUndefined)(this.place.style[t.property])?this.place[t.property]=t.default:this.place.style[t.property]=t.default}))}},Me=Object.assign(Object.create(de),Le),Ce={content:"",init(){return this},render(){const t=(0,s.createDocFragment)(),{content:e,marker:n,tag:i}=this.schema;var a=new DOMParser;return(0,s.isHTMLElement)(this.element)||(this.element=(0,s.createDiv)({id:this.id,class:[],dataset:{nature:"field",view:"interactive",id:this.id}})),(0,s.isHTMLElement)(this.content)||(this.content=a.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,t.appendChild(this.content)),(0,s.isNullOrUndefined)(this.place)&&(this.place=this.content.querySelector("[data-"+n+"]")),(0,s.isHTMLElement)(this.field)||(0,s.isNullOrUndefined)(i)||(this.field=da.call(this,{type:"external",tag:i},null,this.args)),t.hasChildNodes()&&this.element.appendChild(t),this.initValue=this.update,this.bindEvents(),this.element},createForeign(){let t=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),n=this.place.getBBox(),i=document.createElementNS("http://www.w3.org/2000/svg","rect");i.setAttribute("x",n.x),i.setAttribute("y",n.y),i.setAttribute("width",n.width),i.setAttribute("height",n.height),i.style.fill="red",e.setAttribute("width",n.width),e.setAttribute("height",n.height),t.setAttribute("width",n.width),t.setAttribute("height",n.height),t.append(e),e.append(this.field),this.place.replaceWith(t),t.setAttribute("x",120),t.setAttribute("y",50);let s=this.field.getBoundingClientRect();e.setAttribute("width",s.width),e.setAttribute("height",s.height),t.setAttribute("viewBox","0 0 "+s.width+" "+s.height)},selfUpdate(){let t;(0,s.isNullOrUndefined)(this.aliases)||(t=this.aliases.get(this.value)),(0,s.isNullOrUndefined)(t)||t.forEach((t=>{t.forEach((t=>{t.impacts.forEach((e=>{(0,s.isNullOrUndefined)(t.target[e.property])?t.target.style[e.property]=e.value:t.target[e.property]=e.value}))}))})),(0,s.isNullOrUndefined)(this.self)||this.self.forEach((t=>{(0,s.isNullOrUndefined)(this.place.style[t.property])?this.place[t.property]=this.value:this.place.style[t.property]=this.value}))},clear(){let t;(0,s.isNullOrUndefined)(this.aliases)||(t=this.aliases.get(this.value)),(0,s.isNullOrUndefined)(t)||t.forEach((t=>{t.forEach((t=>{t.impacts.forEach((e=>{(0,s.isNullOrUndefined)(t.target.style[e.property])?t.target[e.property]=e.default:t.target.style[e.property]=e.default}))}))})),(0,s.isNullOrUndefined)(this.self)||this.self.forEach((t=>{(0,s.isNullOrUndefined)(this.place.style[t.property])?this.place[t.property]=t.default:this.place.style[t.property]=t.default}))},updateStatics(){if(!(0,s.isNullOrUndefined)(this.sd)){let t=this.sd.get(this.value);(0,s.isNullOrUndefined)(t)||this.content.appendChild(t.content)}},clearStatics(){if(!(0,s.isNullOrUndefined)(this.sd)){let t=this.sd.get(this.value);(0,s.isNullOrUndefined)(t)||t.content.parentNode.removeChild(t.content)}},updateDynamics(t){(0,s.isNullOrUndefined)(this.dd)||this.dd.forEach((e=>{e.update(t)}))},clearDynamics(t){(0,s.isNullOrUndefined)(this.dd)||this.dd.forEach((e=>{e.clear(t)}))},update(t){(0,s.isNullOrUndefined)(this.value)||(this.clearStatics(),this.clearDynamics(this.value),this.clear()),""===t?this.value=this.attributeName:(0,s.isNullOrUndefined)(this.property)?this.value=t:this.value=this.translateProperty(t),this.selfUpdate(),this.updateDynamics(this.value),this.updateStatics()},bindEvents(){this.place.addEventListener("click",(t=>{(0,s.isNullOrUndefined)(this.foreign)?this.createForeign():(this.place.replaceWith(this.foreign),this.field.focus())}))},getContent(){return(0,s.isHTMLElement)(this.content)||(this.content=parser.parseFromString(content.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement),this.content},arrowHandler(t,e){return this.parent.arrowHandler(t,this)},focus(){this.focusIn()},focusIn(){this.place.replaceWith(this.foreign),this.field.focus()},focusOut(){this.foreign.replaceWith(this.place),""===this.field.value?this.update(this.attributeName):this.update(this.field.value)}},Se=Object.assign(Object.create(de),Ce),Te={content:[{type:"static",static:{type:"text",content:"+",focusable:!1}}]};function Ie(t){if(!(0,s.isHTMLElement)(t))return!1;const{nature:e,id:n}=t.dataset;return"field-component"===e&&n===this.id}function Ue(t){const e=t=>t.parentElement===this.list;return e(t)?t:(0,s.findAncestor)(t,e,3)}const De={list:null,items:null,elements:null,selection:null,content:null,init(t){const{focusable:e=!0}=this.schema;return this.items=new Map,this.elements=new Map,this.children=[],this.focusable=e,(0,s.hasOwn)(this.schema,"list")||(this.schema.list={item:{}}),this},hasChanges:()=>!1,hasValue(){return this.items.size>0},getValue(){return this.list.children},setValue(t,e=!1){e&&this.source.setValue(t),this.list&&((0,s.removeChildren)(this.list),t.forEach((t=>{var e=this.createItem(t);this.list.append(e)}))),this.refresh()},clear(){this.items.clear(),this.list&&(0,s.removeChildren)(this.list)},focus(t){if(this.hasValue()&&this.list)this.list.firstElementChild.focus();else{let t=(0,a.Sd)(this.element,(t=>t!==this.list));if(!(0,s.isHTMLElement)(t))return this;t.focus()}return this},navigate(t,e,n){let i=null;if("up"===t?i=(0,a.GV)(this.element,(t=>t!==this.notification&&t.hasChildNodes())):"down"===t?i=(0,a.Sd)(this.element,(t=>t!==this.notification&&t.hasChildNodes())):"left"===t?i=(0,a.GF)(this.element,(t=>t!==this.notification&&t.hasChildNodes())):"right"===t&&(i=(0,a.EE)(this.element,(t=>t!==this.notification&&t.hasChildNodes()))),!(0,s.isHTMLElement)(i))return!1;let r=this.environment.resolveElement(i);return!(0,s.isNullOrUndefined)(r)&&(r.focus(),!0)},focusIn(t){this.focused=!0,this.element.classList.add("active");const{component:e}=t.dataset},focusOut(){if(!this.readonly)return this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},createElement(){return this.source.createElement()},getItem(t){return(0,s.isNullOrUndefined)(t)?null:(0,s.hasOwn)(t,"id")?this.items.get(t.id):this.items.get(t)},getItemIndex:t=>(0,s.isHTMLElement)(t)?t.dataset.index:null,createItem(t){const{template:e={},style:n}=this.schema.list.item;if(!this.model.hasProjectionSchema(t,e.tag))return"";let i=this.model.createProjection(t,e.tag);i.optional=!0,i.collapsible=!0,i.parent=this.projection;let s=i.init(e.options).render();return s.dataset.index=t.index,i.element.parent=this,i.registerHandler("view.changed",(t=>{Kt.call(this.projection,t,n)})),Kt.call(this.projection,s,n),this.items.set(t.id,s),s},addItem(t){if(!(0,s.isHTMLElement)(this.list))return;const e=this.createItem(t);t.index?this.list.children[t.index-1].after(e):this.list.append(e),this.refresh()},removeItem(t){this.hasList&&!(0,s.isNullOrUndefined)(t)&&(this.items.delete(t.id),this.items.forEach(((t,e)=>{let n=this.source.getElement(e);n&&(t.dataset.index=n.index)})),this.refresh())},moveItem(t,e,n=!1){return this.list.children[e].before(t),t.dataset.index=e,n&&this.source.swapElement(+this.getItemIndex(t),+e),this},swapItem(t,e,n=!1){const i=this.getItemIndex(t),s=this.getItemIndex(e);return this.moveItem(e,i),this.moveItem(t,s),n&&this.source.swapElement(+i,+s),this},delete(t){if(t===this.element)return this.environment.save(this.source.getParent()),void this.source.remove();const{index:e}=t.dataset;var n=this.source.removeElementAt(+e);if(n.success)if(this.hasValue()){let t=+e<this.list.childElementCount?+e:this.list.childElementCount-1;this.list.children[t].focus()}else this.focus();else this.environment.notify(`This element cannot be deleted: ${n.message}`),(0,a.lL)(t)},refresh(){this.hasValue()?(this.element.classList.remove("empty"),this.list&&this.list.classList.remove("empty")):(this.element.classList.add("empty"),this.list&&this.list.classList.add("empty")),this.elements.forEach(((t,e)=>{if(!Array.isArray(e.state))return;const{currentState:n}=e,i=ge.call(this,e,e.state);if(n===e.currentState)return;let a=e.content;i&&(a=i.content);let r=(0,s.createDocFragment)();a.forEach((t=>{let e=da.call(this,t,null,{focusable:!1});r.append(e)})),(0,s.removeChildren)(t).append(r)})),this.hasError?this.element.classList.add("error"):this.element.classList.remove("error")},render(){const t=(0,s.createDocFragment)(),{list:e,style:n,action:i={}}=this.schema;if((0,s.isHTMLElement)(this.element)||(this.element=(0,s.createDiv)({id:this.id,class:["field","field--list"],tabindex:-1,dataset:{nature:"field",view:"list",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),Kt.call(this.projection,this.element,this.schema.style)),e&&!(0,s.isHTMLElement)(this.list)){const{style:n}=e;this.list=(0,s.createDiv)({class:["field--list__list"],dataset:{nature:"field-component",view:"list",id:this.id}}),this.source.hasValue()||this.list.classList.add("empty"),e.currentState=null,this.elements.set(e,this.list),Kt.call(this.projection,this.list,n),t.append(this.list)}let a=(0,s.valOrDefault)(i.add,Te);if(a){const{position:e="after",content:n,help:i,style:r}=a;let o=(0,s.createButton)({class:["field-action","field--list__add"],tabindex:0,title:i,dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"add"}});n.forEach((t=>{let e=da.call(this,t,null,{focusable:!1});o.append(e)})),a.currentState=null,this.elements.set(a,o),Kt.call(this.projection,o,r),"before"===e&&this.list?this.list.before(o):t.append(o)}return this.list&&this.source.getValue().forEach((t=>{var e=this.createItem(t);this.list.append(e)})),Kt.call(this.projection,this.element,n),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},_spaceHandler(t){this.notify(`Add or remove ${this.source.accept.name}`)},spaceHandler(t){return!!(0,s.isHTMLElement)(t)&&t.parentElement===this.list&&(this.createElement(),!0)},deleteHandler(t){return!(!Ie.call(this,t)||t.parentElement!==this.list||(this.delete(t),0))},escapeHandler(t){let e=!0;if(this.messageElement&&!(0,a.xj)(this.messageElement)&&((0,a.Cp)(this.messageElement),e=!1),e){let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex));return this.environment.resolveElement(e).focus(e),!0}return this.focus(),!1},enterHandler(t){const e=(t=>Ie.call(this,t)?t:(0,s.findAncestor)(t,(t=>Ie.call(this,t)),5))(t);if((0,s.isNullOrUndefined)(e))return this.focus(),!1;const{action:n,index:i,component:a}=e.dataset;return"add"===n?(this.createElement(),!0):"remove"===n&&(this.delete(e.parentElement),!0)},backspaceHandler:t=>!1,clickHandler(t){const e=(t=>Ie.call(this,t)?t:(0,s.findAncestor)(t,(t=>Ie.call(this,t)),5))(t);if((0,s.isNullOrUndefined)(e))return;const{action:n,index:i,name:a}=e.dataset;"add"===n?this.createElement():"remove"===n&&this.delete(e.parentElement)},_arrowHandler(t,e){if(!(0,s.isHTMLElement)(e))return!1;let n=Ue.call(this,e);if(n){let e=(0,a.As)(n,t,this.list);return!!(0,s.isHTMLElement)(e)&&(this.swapItem(n,e,!0),n.focus(),!0)}return!1},arrowHandler(t,e){if(!(0,s.isHTMLElement)(e))return!1;const{parentElement:n}=e,i=()=>!!this.parent&&this.parent.arrowHandler(t,this.element);if(n===this.list){let n=(0,a.As)(e,t,this.list);return(0,s.isHTMLElement)(n)?(this.environment.resolveElement(n).focus(),!0):this.arrowHandler(t,this.list)}if(n!==this.element)return i();let r=(0,a.As)(e,t,this.element);if(!(0,s.isHTMLElement)(r))return i();if(r===this.notification)return this.arrowHandler(t,r);if(r===this.list){if(!this.list.hasChildNodes())return i();"up"===t?r=(0,a.GV)(this.list):"down"===t?r=(0,a.Sd)(this.list):"left"===t?r=(0,a.GF)(this.list):"right"===t&&(r=(0,a.EE)(this.list))}return r.focus(),!0},bindEvents(){this.projection.registerHandler("value.added",(t=>{this.projection.listen&&!(0,s.isNullOrUndefined)(this.environment.activeReceiver)?this.environment.activeReceiver.addItem(t,this,this.schema.list.item.template.tag):this.addItem(t)})),this.projection.registerHandler("value.removed",(t=>{this.projection.listen&&!(0,s.isNullOrUndefined)(this.environment.activeReceiver)?this.environment.activeReceiver.removeItem(t):this.removeItem(t)})),this.projection.registerHandler("value.changed",(t=>{this.clear(),this.list&&this.source.getValue().forEach((t=>{let e=this.createItem(t);this.list.append(e)}))})),this.projection.registerHandler("value.swapped",(t=>{const[e,n]=t;let i=this.getItem(e),s=this.getItem(n),a=+this.getItemIndex(i);this.getItemIndex(s),a!==e.index&&this.swapItem(i,s)}))}},He=Object.assign(Object.create(de),De);Object.defineProperty(He,"size",{get(){return this.items.size}}),Object.defineProperty(He,"hasList",{get(){return(0,s.isHTMLElement)(this.list)}});const Pe={init(){return this},render(){const t=(0,s.createDocFragment)(),{content:e,mv:n}=this.schema;var i=new DOMParser;return(0,s.isHTMLElement)(this.element)||(this.element=(0,s.createDiv)({id:this.id,class:[],dataset:{nature:"field",view:"static",id:this.id}})),(0,s.isHTMLElement)(this.content)||(this.content=i.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,t.appendChild(this.content)),(0,s.isNullOrUndefined)(this.mv)&&(this.mv=n),t.hasChildNodes()&&this.element.appendChild(t),this}},Re=Object.assign(Object.create(de),Pe);var Be=0;const Ve={content:{type:"static",static:{type:"text",content:"Add"}}},ze={content:{type:"static",static:{type:"text",content:"Remove"}}},Fe={table:null,header:null,body:null,footer:null,elements:null,contentElements:null,content:null,init(){const{content:t=[],template:e,focusable:n=!0}=this.schema;return this.elements=new Map,this.focusable=n,this.content=t,this.contentElements=new Map,this.template=this.model.getProjectionSchema(this.source.accept,e.tag)[0].projection,this},render(){const{content:t,action:e={}}=this.schema,{disposition:n}=this.template,i=(0,s.createDocFragment)();if(!Array.isArray(t))throw new Error("Empty content for listfield");if((0,s.isHTMLElement)(this.element)||(this.element=(0,s.createDiv)({class:["field","field--table"],id:this.id,tabindex:-1,dataset:{nature:"field",view:"table",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),Kt.call(this.projection,this.element,this.schema.style)),t.forEach((t=>{if("table"===t.type){let e=(0,s.valOrDefault)(t.table,{});const{style:n,header:a,body:r={},footer:o}=e;if(this.table=(0,s.createTable)({class:["field--table__table"],tabindex:0,dataset:{nature:"field-component",view:"table",id:this.id}}),a){const{style:t}=a;this.header=(0,s.createTableHeader)({class:["field--table-header"],dataset:{nature:"field-component",view:"table",id:this.id}}),Kt.call(this.projection,this.header,t),this.table.append(this.header)}if(r){const{style:t}=r;this.body=(0,s.createTableBody)({class:["field--table-body"],dataset:{nature:"field-component",view:"table",id:this.id}}),Kt.call(this.projection,this.body,t),this.table.append(this.body)}if(o){const{style:t}=o;this.footer=(0,s.createTableFooter)({class:["field--table-footer"],dataset:{nature:"field-component",view:"table",id:this.id}}),Kt.call(this.projection,this.footer,t),this.table.append(this.footer)}e.currentState=null,this.contentElements.set(e,this.table),Kt.call(this.projection,this.table,n),i.append(this.table)}else if("action"===t.type){let e=(0,s.valOrDefault)(t,Ve);const{content:n,style:a}=e;let r=da.call(this,n,null),o=(0,s.createButton)({class:["field-action","field--table__add"],tabindex:0,dataset:{nature:"field-component",view:"table",component:"action",id:this.id,action:"add"}},[r]);e.currentState=null,this.contentElements.set(e,o),Kt.call(this.projection,o,a),i.append(o)}else{let e=da.call(this,t);this.contentElements.set(t,e),i.append(e)}})),this.header){let t=(0,s.createTableRow)({class:["field--table-header-row"],tabindex:-1,dataset:{nature:"field-component",view:"table",id:this.id}});n.forEach((e=>{const{header:n}=e,{style:i,content:a}=n;var r=da.call(this,a),o=(0,s.createTableHeaderCell)({class:["field--table-header-cell"],dataset:{nature:"field-component",view:"table",id:this.id}},r);Kt.call(this.projection,o,i),t.append(o)}));let e=(0,s.createTableCell)({class:["field--table-header-cell","field--table-header-cell--action"]},"Action");t.append(e),this.header.append(t)}return this.source.hasValue()&&this.source.getValue().forEach((t=>{this.addRow(t)})),i.hasChildNodes()&&(this.element.append(i),this.bindEvents()),this.refresh(),this.element},hasChanges:()=>!1,hasValue(){return this.body.rows.length>0},getValue(){return this.body.rows},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){if(!this.readonly)return this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){this.hasValue()?(this.element.classList.remove("empty"),this.table.classList.remove("empty")):(this.element.classList.add("empty"),this.table.classList.add("empty")),this.contentElements.forEach(((t,e)=>{if(!Array.isArray(e.state))return;const{currentState:n}=e,i=ge.call(this,e,e.state);if(n===e.currentState)return;let a=null;a=i?da.call(this,i.content,null):da.call(this,e.content,null),(0,s.removeChildren)(t).append(a)})),this.hasError?this.element.classList.add("error"):this.element.classList.remove("error")},createElement(){return this.source.createElement()},addRow(t){const{action:e={},before:n={},after:i={}}=this.schema,{disposition:a}=this.template,r=(0,s.valOrDefault)(t.index,this.table.rows.length),o="row"+Be++,l=(0,s.createTableRow)({class:["field--table-row"],tabindex:-1,dataset:{nature:"field-component",view:"table",id:this.id,index:r,elementId:o}});this.elements.set(o,l),a.forEach((e=>{const{body:n}=e,{style:i,content:a}=n;var r=da.call(this,a,t),o=(0,s.createTableCell)({class:["field--table-cell"],dataset:{nature:"field-component",view:"table",id:this.id}},r);Kt.call(this.projection,o,i),l.append(o)}));var c=(0,s.createTableCell)({class:["field--table__cell-action"]}),{content:h,style:u}=(0,s.valOrDefault)(e.remove,ze),d=da.call(this,h),p=(0,s.createButton)({class:["btn","field--table__button"],dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"remove",rowId:o}},d),m=(0,s.createButton)({class:["btn","field--table__button"],dataset:{nature:"field-component",id:this.id,action:"move-up",rowId:o}},"Move up"),f=(0,s.createButton)({class:["btn","field--table__button"],dataset:{nature:"field-component",id:this.id,action:"move-down",rowId:o}},"Move down");Kt.call(this.projection,p,u),c.append(p,m,f),l.append(c),this.body.append(l),this.refresh()},removeRow(t){var e=this.body.rows.item(t.index);if(!(0,s.isHTMLElement)(e))throw new Error("Table error: Row not found");(0,s.removeChildren)(e),e.remove();for(let e=t.index;e<this.body.rows.length;e++){const t=this.body.rows.item(e),{index:n}=t.dataset;t.dataset.index=+n-1}this.refresh()},removeElement(t){return this.source.removeElement(t)},delete(t){if(t===this.element||t===this.table)return void this.source.delete();const{index:e}=t.dataset;this.source.removeElementAt(+e)||(this.environment.notify("This element cannot be deleted"),(0,a.lL)(t))},bindEvents(){this.element.addEventListener("click",(t=>{const{target:e}=t,n=function(t){const e="field-component";return t.dataset.nature===e?t:(0,s.findAncestor)(t,(t=>t.dataset.nature===e))}(e);if(!(0,s.isHTMLElement)(n))return;const{id:i,action:a}=n.dataset;if(i===this.id)if("add"===a)this.createElement();else if("remove"===a){const{rowId:t}=n.dataset;let e=this.elements.get(t);this.delete(e)}else if("move-up"===a){const{rowId:t}=n.dataset;let e=this.elements.get(t),i=e.previousElementSibling;i&&i.before(e)}else if("move-down"===a){const{rowId:t}=n.dataset;let e=this.elements.get(t),i=e.nextElementSibling;i&&i.after(e)}}),!0),this.projection.registerHandler("value.added",(t=>{this.addRow(t)})),this.projection.registerHandler("value.removed",(t=>{this.removeRow(t)})),this.projection.registerHandler("value.changed",(t=>{(0,s.removeChildren)(this.body),this.source.getValue().forEach((t=>{this.addRow(t)}))}))}},qe=Object.assign(Object.create(de),Fe),$e=t=>(0,s.isHTMLElement)(t,["input","textarea"]),We="error";function Ze(){return(0,s.isHTMLElement)(this.choice)||(this.choice=(0,s.createUnorderedList)({class:["bare-list","field--textbox__choices"],dataset:{nature:"field-component",view:"text",component:"choice",id:this.id}}),this.append(this.choice)),this.choice}function Xe(t){return(0,s.createListItem)({class:["field--textbox__choice"],tabindex:0,dataset:{nature:"field-component",view:"text",component:"choice-item",value:t,id:this.id}},t)}function Ye(t){return t.parentElement===this.choice?t:(0,s.findAncestor)(t,(t=>t.parentElement===this.choice),3)}function Ge(t){const{placeholder:e="",type:n}=t;let i="";return i=this._placeholder?(0,s.valOrDefault)(la.call(this,this._placeholder),""):(0,s.valOrDefault)(la.call(this,e),""),this.readonly||this.resizable?(0,s.createSpan)({class:["field--textbox__input","field--textbox__input-pseudo"],editable:!this.readonly,title:i,dataset:{placeholder:i,nature:"field-component",view:this.type,id:this.id}}):this.multiline?(0,s.createTextArea)({class:["field--textbox__input"],placeholder:i,title:i,dataset:{nature:"field-component",view:this.type,id:this.id}}):(0,s.createInput)({class:["field--textbox__input"],type:(0,s.valOrDefault)(n,"text"),placeholder:i,title:i,dataset:{nature:"field-component",view:this.type,id:this.id}})}const Je={input:null,choice:null,value:"",placeholder:null,multiline:!1,resizable:!1,content:null,hasOwnSource:!1,init(t={}){Object.assign(this.schema,t);const{multiline:e=!1,placeholder:n="",resizable:i=!1,focusable:a=!0,source:r}=this.schema;if(this.multiline=e,this.focusable=a,this.resizable=i,this.children=[],this._placeholder=n,r){const t=this.projection.concept.getAttribute(r).getTarget();t.register(this),this.source=t,this.hasOwnSource=!0}return(0,s.hasOwn)(this.schema,"choice")||(this.schema.choice={}),this},focus(t){return this.input.focus(),this},focusIn(){return this.focused=!0,this.value=this.getValue(),this.element.classList.add("active"),this.element.classList.add("focus"),this},focusOut(){return this.hasChanges()&&this.setValue(this.getValue(),!0),(0,s.isNullOrWhitespace)(this.getValue())&&(this.input.textContent=""),this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.choice&&(0,a.Cp)(this.choice),this.input.blur(),this.element.classList.remove("active"),this.element.classList.remove("focus"),this.refresh(),this.focused=!1,this},hasChanges(){return this.value!=this.getValue()},hasValue(){return!(0,s.isEmpty)(this.getValue())},getValue(){return $e(this.input)?this.input.value:this.input.textContent},setValue(t,e=!1){var n;(n=e?this.source.setValue(t):{success:!0}).success||((0,a.lL)(this.element),this.environment.notify(n.message,"error")),this.setInputValue(t),this.value=t,this.refresh()},setInputValue(t){$e(this.input)?this.input.value=t:this.input.textContent=t},getCandidates(){let t=this.source.getCandidates();return Array.isArray(t)?t:[]},enable(){return this.input.disabled=!1,this.input.tabIndex=0,this.disabled=!1,this.element.classList.add("disabled"),this},disable(){return this.input.disabled=!0,this.input.tabIndex=-1,this.disabled=!0,this.element.classList.remove("disabled"),this},refresh(){ge.call(this,this.schema,this.schema.state),this.hasValue()?this.element.classList.remove("empty"):this.element.classList.add("empty"),this.element.dataset.value=this.value,this.hasError?(this.element.classList.add(We),this.input.classList.add(We)):(this.element.classList.remove(We),this.input.classList.remove(We)),this.choice&&this.filterChoice(this.getValue())},render(){const t=(0,s.createDocFragment)(),{container:e,input:n={},style:i}=this.schema;if((0,s.isHTMLElement)(this.element)||(this.element=(0,s.createDiv)({id:this.id,class:["field","text-field","field--textbox"],dataset:{nature:"field",view:"text",id:this.id,disabled:this.disabled,readonly:this.readonly,value:""}}),this.readonly&&this.element.classList.add("readonly"),this.disabled&&this.element.classList.add("disabled"),Kt.call(this.projection,this.element,this.schema.style)),e){const{content:n=[],style:i}=e;n.forEach((e=>{if("input"===e.type){const{style:n}=e.input;this.input=Ge.call(this,e.input),this.disabled&&(this.input.disabled=!0),this.focusable?this.input.tabIndex=0:this.input.dataset.ignore="all",Kt.call(this.projection,this.input,n),this.multiline&&this.input.classList.add("field--textbox__input--multiline"),t.append(this.input)}else{let n=da.call(this,e,null,{focusable:!1});t.append(n)}})),Kt.call(this.projection,this.element,i)}else{if(!(0,s.isHTMLElement)(this.input)){const{style:e}=n;this.input=Ge.call(this,n),this.disabled&&(this.input.disabled=!0),this.focusable?this.input.tabIndex=0:this.input.dataset.ignore="all",Kt.call(this,this.input,e),this.multiline&&this.input.classList.add("field--textbox__input--multiline"),t.append(this.input)}Kt.call(this.projection,this.element,i)}return t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.source.hasValue()&&this.setValue(this.source.getValue()),this.refresh(),this.element},filterChoice(t){const{children:e}=this.choice;if((0,s.isNullOrWhitespace)(t)){for(let t=0;t<e.length;t++){const n=e[t];(0,a.$Z)(n),n.hidden=!1}return!0}let n=t.trim().toLowerCase().replace(/\s+/g," ").split(" ");for(let t=0;t<e.length;t++){const i=e[t],{value:s}=i.dataset;n.some((t=>s.toLowerCase().includes(t)))?((0,a.$Z)(i),i.hidden=!1):((0,a.Cp)(i),i.hidden=!0)}return!0},selectChoice(t){if(!(0,s.isHTMLElement)(t))return;const e=function(t){return t.dataset.value}(t);return this.setValue(e,!0),this.input.focus(),(0,a.Cp)(this.choice),this},update(t,e,n){"delete"!==t?"value.changed"===t&&this.setValue(e):this.delete()},_spaceHandler(t){const e=new Set(this.getCandidates());if(0===e.size)this.notify("Enter any text.",a.k$.INFO);else{Ze.call(this);const t=(0,s.createDocFragment)();e.forEach((e=>t.append(Xe.call(this,e)))),(0,s.removeChildren)(this.choice).append(t),this.filterChoice(this.getValue()),(0,a.$Z)(this.choice)}},escapeHandler(t){let e=!0;if(this.messageElement&&!(0,a.xj)(this.messageElement)&&((0,a.Cp)(this.messageElement),e=!1),this.choice&&!(0,a.xj)(this.choice)&&((0,a.Cp)(this.choice),e=!1),e){let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex)),n=this.environment.resolveElement(e);return n&&n.focus(e),!1}return this.input.focus(),!0},enterHandler(t){const e=Ye.call(this,t);return e?this.selectChoice(e):this.multiline||(t===this.input?this.setValue(this.getValue(),!0):this.focus()),!0},backspaceHandler(t){Ye.call(this,t)&&this.input.focus()},clickHandler(t){const e=Ye.call(this,t);(0,s.isHTMLElement)(e)&&this.selectChoice(e)},arrowHandler(t,e){if(!(0,s.isHTMLElement)(e))return!1;const{parentElement:n}=e,i=()=>!!this.parent&&this.parent.arrowHandler(t,this.element);let r=Ye.call(this,e);if((0,s.isHTMLElement)(r)){let e=(0,a.As)(r,t,this.choice);return(0,s.isHTMLElement)(e)?(e.focus(),!0):this.arrowHandler(t,this.choice)}if(n!==this.element)return i();let o=null;if("right"===t){if(e===this.input&&!(this.getValue().length<(0,a.qO)(this.input)+1))return!1;o=(0,a.As)(e,t,this.element,!1)}else if("left"===t){if(e===this.input&&0!==(0,a.qO)(this.input))return!1;o=(0,a.As)(e,t,this.element,!1)}else o=(0,a.As)(e,t,this.element,!1);return(0,s.isHTMLElement)(o)&&o.dataset.id===this.id?("up"===t?o=(0,a.GV)(this.choice):"down"===t?o=(0,a.Sd)(this.choice):"left"===t?o=(0,a.GF)(this.choice):"right"===t&&(o=(0,a.EE)(this.choice)),o.focus(),!0):i()},bindEvents(){this.element.addEventListener("input",(t=>{this.hasError&&this.source.setValue(this.getValue(),!0),this.refresh()})),this.hasOwnSource||this.projection.registerHandler("value.changed",(t=>{this.setValue(t)}))}},Ke=Object.assign(Object.create(de),Je);var Qe=n(185);const tn={init(){const{arrowStyle:t=null,path:e,attach:n={}}=this.schema;return(0,s.isNullOrUndefined)(t)?this.arrowStyle={}:this.arrowStyle=t,e&&(this.meet=e.meet),n&&(this.attach=n.type),this},render(){const{reference:t,decorator:e=!1}=this.schema;if((0,s.isHTMLElement)(this.element)||(this.element=document.createElementNS("http://www.w3.org/2000/svg","path"),this.element.style.fill="transparent",this.element.id=this.id,this.element.classList.add("field"),this.element.tabindex=-1,this.element.dataset.nature="field",this.element.dataset.view="arrow",this.element.dataset.id=this.id),(0,s.isNullOrUndefined)(this.reference))switch(t.type){case"multiple":this.reference=this.source.getAttributeByName(t.listen).target,this.multiple=!0;break;case"duo":this.from=this.source.getAttributeByName(t.from).target,this.to=this.source.getAttributeByName(t.to).target,this.multiple=!1}return this.computeStyle(),this.bindEvent(),this.element},getStyle(){},signal(){(0,s.isNullOrUndefined)(this.valSource)||(0,s.isNullOrUndefined)(this.valTarget)||this.projection.parent.accept(this.valSource,this.valTarget,this)},computeStyle(){const{stroke:t="black",dasharray:e=null,width:n=1,linecap:i="butt",end:a=!1,start:r=!1}=this.arrowStyle;this.element.style.stroke=t,(0,s.isNullOrUndefined)(e)||(this.element.style["stroke-dasharray"]=e),this.element.style["stroke-width"]=(0,s.valOrDefault)(n,5),this.element.style["stroke-linecap"]=i,a&&this.createMarkerEnd()},createMarkerEnd(){(0,s.isNullOrUndefined)(this.definitions)&&(this.definitions=document.createElementNS("http://www.w3.org/2000/svg","defs")),this.end=document.createElementNS("http://www.w3.org/2000/svg","marker"),this.end.id="marker"+this.id,this.end.setAttribute("refY",5),this.end.setAttribute("refX",10),this.end.setAttribute("markerUnit","strokeWidth"),this.end.setAttribute("markerWidth",10),this.end.setAttribute("markerHeight",10),this.end.setAttribute("orient","auto"),this.end.classList.add("end");let t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),t.setAttribute("fill","black"),this.end.appendChild(t),this.definitions.appendChild(this.end),this.path.setAttribute("marker-end","url(#"+this.end.id+")")},createMarkerStart(){(0,s.isNullOrUndefined)(this.definitions)&&(this.definitions=document.createElementNS("http://www.w3.org/2000/svg","defs")),this.start=document.createElementNS("http://www.w3.org/2000/svg","marker"),this.start.id="marker"+this.id,this.start.setAttribute("refY",5),this.start.setAttribute("refX",1),this.start.setAttribute("markerUnit","strokeWidth"),this.start.setAttribute("markerWidth",10),this.start.setAttribute("markerHeight",10),this.start.setAttribute("orient","auto"),this.start.classList.add("start");let t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),t.setAttribute("fill","black"),this.start.appendChild(t),this.definitions.appendChild(this.end),this.element.setAttribute("marker-start","url(#"+this.end.id+")")},setValues(){(0,s.isNullOrUndefined)(this.source.getAttributeByName("target").target.value)||(this.valTarget=this.source.getAttributeByName("target").target.value),(0,s.isNullOrUndefined)(this.source.getAttributeByName("source").target.value)||(this.valSource=this.source.getAttributeByName("source").target.value)},refresh(){this.setValues(),this.updateRegister(),this.signal()},deleteRef(t,e){this.valTarget!==t.id&&this.valSource!==t.id||this.projection.parent.removeArrow(this,e)},setLine(t,e){this.element.setAttribute("d","M "+t.x+", "+t.y+"L "+e.x+", "+e.y)},setPath(t){this.element.setAttribute("d",t)},updateRegister(){for(let t=0;t<this.registered.length;t++)this.registered[t]={name:this.registered[t].name,value:this.source.getAttributeByName(this.registered[t].name).target.value}},register(t){(0,s.isNullOrUndefined)(this.getAttribute)&&(this.registered.push({name:t,value:this.source.getAttributeByName(t).target.value}),this.source.getAttributeByName(t).target.register(this.projection),this.projection.registerHandler("value.added",(t=>{this.refresh()})))},get(t){for(let e=0;e<this.registered.length;e++)if(this.registered[e].name===t)return this.registered[e].value},registerValue(t){(0,s.isNullOrUndefined)(this.registered)&&(this.registered=[]),t.register(this),this.registered.push({concept:t,currentVal:t.value})},update(t,e){switch(t){case"value.changed":this.updatePath(e)}},updatePath(){this.lineUpdate(),this.parent.container.append(this.element)},updatePathDuo(){switch(this.attach){case"anchor":this.anchorAttach()}},anchorAttach(){this.occupied&&Qe.AnchorHandler.freeOccupation(this),this.occupant&&this.occupant.removeAnchor(this);let t=this.parent.container.querySelector('[data-concept="'+this.valueF+'"]'),e=this.parent.container.querySelector('[data-concept="'+this.valueT+'"]'),n=Qe.AnchorHandler.findCommonIndex(t.dataset.id,e.dataset.id,this.occupant,this),i=Qe.AnchorHandler.getAnchorAt(t.dataset.id,n),s=Qe.AnchorHandler.getAnchorAt(e.dataset.id,n),a=t.getBoundingClientRect(),r=this.parent.container.createSVGPoint();r.x=a.x+i.x,r.y=a.y+i.y;let o=r.matrixTransform(this.parent.container.getScreenCTM().inverse());a=e.getBoundingClientRect(),r.x=a.x+s.x,r.y=a.y+s.y;let l=r.matrixTransform(this.parent.container.getScreenCTM().inverse());this.setPath("M "+o.x+" "+o.y+" L "+l.x+" "+l.y),this.parent.container.append(this.element),this.occupant&&this.occupant.accept(this,o,l,n),Qe.AnchorHandler.registerOccupation(this,n,t.dataset.id,e.dataset.id),this.occupied=!0},forceAnchor(t){let e=this.parent.container.querySelector('[data-concept="'+this.valueF+'"]'),n=this.parent.container.querySelector('[data-concept="'+this.valueT+'"]'),i=Qe.AnchorHandler.getAnchorAt(e.dataset.id,t),s=Qe.AnchorHandler.getAnchorAt(n.dataset.id,t),a=e.getBoundingClientRect(),r=this.parent.container.createSVGPoint();r.x=a.x+i.x,r.y=a.y+i.y;let o=r.matrixTransform(this.parent.container.getScreenCTM().inverse());a=n.getBoundingClientRect(),r.x=a.x+s.x,r.y=a.y+s.y;let l=r.matrixTransform(this.parent.container.getScreenCTM().inverse());return this.setPath("M "+o.x+" "+o.y+" L "+l.x+" "+l.y),this.parent.container.append(this.element),this.occupant&&this.occupant.accept(this,o,l,t),Qe.AnchorHandler.registerOccupation(this,t,e.dataset.id,n.dataset.id),this.occupied=!0,{e:this,from:e.dataset.id,to:n.dataset.id,index:t}},lineUpdate(){let t=this.targetInformations();switch(this.meet){case"minY":let e=t[0].y,n=t[0];for(let i=1;i<t.length;i++){let s=t[i].y;s<e&&(e=s,n=t[i])}this.computeLineMin(t,t[0],n)}},computeLineMin(t,e,n,i){let a=e.x,r=n.x,o=e.y,l=(o-n.y)/(a-r),c=o-l*a;(0,s.isNullOrUndefined)(i)||(c-=i);for(let i=0;i<t.length;i++){let s=l*t[i].x+c;if(s>t[i].y)return this.computeLineMin(t,e,n,s-t[i].y)}let h="M "+(a-.5)+" "+(r*l+c)+" L "+(t[t.length-1].x+.5)+" "+(r*l+c);this.setPath(h),(0,s.isNullOrUndefined)(this.subPath)&&(this.subPath=[]),(0,s.isEmpty)(this.subPath)||(this.subPath.forEach((t=>{t.remove()})),this.subPath=[]);let u=r*l+c;for(let e=0;e<t.length;e++)if(t[e].y>u){let n=document.createElementNS("http://www.w3.org/2000/svg","line");n.classList.add("subPath"),this.subPath.push(n),n.setAttribute("x1",t[e].x),n.setAttribute("x2",t[e].x),n.setAttribute("y1",t[e].y),n.setAttribute("y2",u),this.parent.container.append(n),n.style["stroke-width"]=.75,n.setAttribute("stroke","black")}},targetInformations(){let t=[],e=!1;return this.registered.forEach((n=>{let i=n.concept.value;if((0,s.isNullOrUndefined)(i))return void(e=!0);let a=this.parent.container.querySelector('[data-concept="'+i+'"]'),r=this.projection.resolveElement(a),o=this.parent.container.createSVGPoint(),l=a.getBoundingClientRect();o.x=l.x,o.y=l.y;let c=o.matrixTransform(this.parent.container.getScreenCTM().inverse());(0,s.isNullOrUndefined)(r.schema.arrowAnchor)||(c.x+=r.schema.arrowAnchor.x,c.y+=r.schema.arrowAnchor.y),t.push({x:c.x,y:c.y})})),!e&&t},duoUpdate(){this.valueF=this.from.value,this.valueT=this.to.value,(0,s.isNullOrUndefined)(this.valueF)||(0,s.isNullOrUndefined)(this.valueT)||this.updatePathDuo()},updatePosition(t){let e=this.projection.resolveElement(this.projection.parent.findItem(t.id).render),n=this.projection.resolveElement(this.projection.parent.findAncestor(this.bind.container).render),i=n.findAnchorIndex(this.bind.container),s=e.findAnchor(i),a=n.findAnchor(i);const r=Number(n.container.getAttribute("x"))+a.x,o=Number(n.container.getAttribute("y"))+a.y,l=Number(e.container.getAttribute("x"))+s.x,c=Number(e.container.getAttribute("y"))+s.y;this.element.setAttribute("d","M "+r+" "+o+" L "+l+" "+c),this.projection.parent.container.append(this.element)},bindProj(t){this.bind=t;const e=this.schema.reference.target;this.objectiv=this.source.getAttributeByName(e).target,this.objectiv.register(this.projection),this.projection.registerHandler("value.changed",(t=>{this.updatePosition(t)}))},bindEvent(){switch(this.schema.reference.type){case"duo":this.from.register(this.projection),this.to.register(this.projection),this.projection.registerHandler("value.changed",(t=>{this.duoUpdate()}));break;case"multiple":this.reference.register(this.projection),this.projection.registerHandler("value.added",(t=>{this.registerValue(t)}))}}},en=Object.assign(Object.create(de),tn),nn={init(t){if(!(0,s.isNullOrUndefined)(t)){const{focusable:e=!1}=t;this.focusable=e}return this},render(){const{placeholder:t,style:e,readonly:n,breakDown:i=!1,linebreak:a=!1}=this.schema;return(0,s.isNullOrUndefined)(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","text"),this.element.id=this.id,this.element.classList.add("field"),this.element.tabindex=-1,this.element.dataset.nature="field",this.element.dataset.view="svg",this.element.style["dominant-baseline"]="hanging",this.element.dataset.id=this.id,this.element.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")),this.source.hasValue()?this.content=this.source.getValue().toString():this.content=t,i&&(this.breakDown=i),this.breakDown?this.element.textContent=this.content.substring(0,i):this.element.textContent=this.content,a&&(this.linebreak=a),this.caps=!1,this.readonly=n,this.bindEvents(),this.style(),this.element},registerDimensionsObserver(t){(0,s.isNullOrUndefined)(this.observers)&&(this.observers=[]),this.observers.push(t)},setActiveChar(t,e,n){let{target:i,end:s=!1}=this.findChar(e,n);this.index=i,this.end=s,this.char=s?this.element.getEndPositionOfChar(i):this.element.getStartPositionOfChar(i),this.createCursor(),this.switchOn(),this.addListeners()},style(){const{font:t,size:e,anchor:n="left",weight:i,baseline:s}=this.schema.style;this.element.setAttribute("text-anchor",n),this.element.setAttribute("font-family",t),this.element.setAttribute("font-size",e),this.element.style["dominant-baseline"]=s,i&&this.element.setAttribute("font-weight",i),this.baseline=s,this.size=e},setValue(){"number"===this.source.name?this.source.setValue(Number(this.content)):this.source.setValue(this.content),this.parent.updateSize()},addListeners(){this.element.addEventListener("keydown",(t=>{let e=t.keyCode;if(27===e)return""===this.content&&(this.content=this.schema.placeholder,this.element.textContent=this.content),this.setValue(this.content),void this.switchOff();if(t.stopPropagation(),e!==this.lastKey||!this.repeat){switch(e){case 8:0===this.index&&this.end&&""!==this.content&&(this.content="",this.element.textContent=""),this.index>0&&(this.end?(this.content=this.content.slice(0,this.index),this.element.textContent=this.content):(this.content=this.content.slice(0,this.index-1)+this.content.slice(this.index),this.element.textContent=this.content),this.index--);break;case 46:this.index<this.content.length-1&&!this.end&&(this.content=this.content.slice(0,this.index)+this.content.slice(this.index+1),this.element.textContent=this.content),this.index!==this.content.length-1||this.end||(this.content=this.content.slice(0,this.index),this.element.textContent=this.content,this.end=!0,this.index--),0===this.index&&1===this.content.length&&(this.content="",this.element.textContent=this.content);break;case 20:this.caps=!this.caps;break;case 32:t.preventDefault(),this.end?(this.content+=" ",this.element.textContent=this.content):(this.content=this.content.slice(0,this.index)+" "+this.content.slice(this.index),this.element.textContent=this.content),this.index++}"number"!==this.source.name&&(e>=65&&e<=90||e>=48&&e<=57||e>=90&&e<=105)&&(this.caps?this.end?this.content=this.content+String.fromCharCode(t.keyCode):this.content=this.content.slice(0,this.index)+String.fromCharCode(t.keyCode)+this.content.slice(this.index):this.end?this.content=this.content+String.fromCharCode(t.keyCode).toLowerCase():this.content=this.content.slice(0,this.index)+String.fromCharCode(t.keyCode).toLowerCase()+this.content.slice(this.index),this.element.textContent=this.content,this.index++),"number"===this.source.name&&(e>=48&&e<=57||e>=96&&e<=105)&&(e>=96&&e<=105&&(e-=48),this.end?this.content=this.content+String.fromCharCode(e):this.content=this.content.slice(0,this.index)+String.fromCharCode(e)+this.content.slice(this.index),this.element.textContent=this.content,this.index++),this.lastKey=t.keyCode,this.repeat=!0,setTimeout((()=>{this.repeat=!1}),50),this.updateCursor(),this.setValue(this.content)}}))},switchOn(){this.on=!0,this.element.parentNode.append(this.cursor),(0,s.isNullOrUndefined)(this.interval)||clearInterval(this.interval),this.interval=setInterval((()=>{this.on?(this.cursor.remove(),this.on=!1):(this.element.parentNode.append(this.cursor),this.on=!0)}),1e3)},switchOff(){this.on=!1,(0,s.isNullOrUndefined)(this.cursor)||this.cursor.remove(),clearInterval(this.interval)},createCursor(){(0,s.isNullOrUndefined)(this.cursor)||this.cursor.remove();let t=this.element.getBBox();switch(s.isNullOrUndefined&&(this.cursor=document.createElementNS("http://www.w3.org/2000/svg","rect")),this.cursor.setAttribute("x",this.char.x),this.baseline){case"middle":case"auto":this.cursor.setAttribute("y",Number(this.element.getAttribute("y"))-t.height/2);break;case"hanging":this.cursor.setAttribute("y",this.element.getAttribute("y"))}this.cursor.setAttribute("width",1),this.cursor.setAttribute("height",t.height)},updateCursor(){if(""!==this.content){if(this.end)return this.char=this.element.getEndPositionOfChar(this.content.length-1),void this.cursor.setAttribute("x",this.char.x);this.char=this.element.getStartPositionOfChar(this.index),this.cursor.setAttribute("x",this.char.x)}else this.cursor.setAttribute("x",Number(this.element.getAttribute("x")))},findChar(t,e){let n=0,i=this.element.getStartPositionOfChar(0),s=i.x,a=this.element.getBoundingClientRect().x,r=(t-a)*(t-a);for(let e=1;e<this.element.getNumberOfChars();e++){let i=t-(a-s+this.element.getStartPositionOfChar(e).x);if(!(r>i*i))return{target:e,end:!1};r=i*i,n=e}i=this.element.getEndPositionOfChar(this.element.getNumberOfChars()-1);let o=t-(a-s+i.x);return o*o<r?{target:this.element.getNumberOfChars()-1,end:!0}:{target:this.element.getNumberOfChars()-1,end:!1}},findCharRelative(t){let e,n=0,i=this.element.getStartPositionOfChar(0),s=t.x-i.x,a=t.y-i.y,r=Math.sqrt(s*s+a*a),o=r;for(e=1;e<this.element.getNumberOfChars();e++){if(i=this.element.getStartPositionOfChar(e),s=t.x-i.x,a=t.y-i.y,r=Math.sqrt(s*s+a*a),!(r<o))return{target:n,start:!0};o=r,n=e}return i=this.element.getEndPositionOfChar(e-1),s=t.x-i.x,a=t.y-i.y,r=Math.sqrt(s*s+a*a),r<o?{target:e-1,start:!1,end:!0}:{target:n,start:!0}},focusIn(){},focusOut(){this.readonly||(this.switchOff(),this.setValue(this.content))},bindEvents(){this.readonly||this.element.addEventListener("click",(t=>{this.setActiveChar(t.target,t.clientX,t.clientY)})),this.projection.registerHandler("value.changed",(t=>{this.content=t.toString(),this.breakDown&&t.length>this.breakDown?this.element.textContent=this.content.substring(0,this.breakDown):this.element.textContent=this.content}))}},sn=Object.assign(Object.create(de),nn),an={createHolder(t){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return e.append(n),n.append(t),e},analysePos(t,e){let n=e.coordinates;const i={};switch(i.type=n.type,i.render=t,n.type){case"delegate":i.await=!1;break;default:i.anchor=n.anchor,i.x=n.x,i.y=n.y,i.await=!0}return i},positionElement(t,e){switch(t.anchor){case"middle":return e.setAttribute("x",t.x-Number(e.getAttribute("width"))/2),void e.setAttribute("y",t.y);case"right":return e.setAttribute("x",t.x-Number(e.getAttribute("width"))),void e.setAttribute("y",t.y);case"center":return e.setAttribute("x",t.x-Number(e.getAttribute("width"))/2),void e.setAttribute("y",t.x-Number(e.getAttribute("height"))/2);default:e.setAttribute("x",t.x),e.setAttribute("y",t.y)}},analyseDim(t,e){let n=e.dimension;const i={};switch(i.type=n.type,i.item=t,n.type){case"fixed":i.value=n.value,i.holder=this.createHolder(t),i.await=!0;break;case"absolute":i.width=n.width,i.height=n.height,i.holder=this.createHolder(t),i.await=!0;break;case"ratio":i.ratio=n.ratio,i.holder=this.createHolder(t),i.await=!0;break;case"pure":i.await=!1}return i},setDimensions(t){switch(t.type){case"fixed":this.adaptFixed(t.item,t.value);break;case"absolute":this.adaptAbsolute(t.item,t.width,t.height);break;case"ratio":this.adaptRatio(t.item,t.ratio)}},adaptFixed(t,e){let n=t.parentNode,i=n.parentNode,s=t.getBoundingClientRect();n.setAttribute("width",s.width),n.setAttribute("height",s.height),i.setAttribute("width",e),i.setAttribute("height",e*s.height/s.width),i.setAttribute("viewBox","0 0 "+s.width+" "+s.height)},adaptAbsolute(t,e,n){let i=t.parentNode,s=i.parentNode;i.setAttribute("width",e),i.setAttribute("height",n),s.setAttribute("width",e),s.setAttribute("height",n)},adaptRatio(t,e){let n=Number(t.getAttribute("width")),i=Number(t.getAttribute("height")),s=t.parentNode,a=s.parentNode;s.setAttribute("width",n),s.setAttribute("height",i),a.setAttribute("width",n*e),a.setAttribute("height",i*e),a.setAttribute("viewBox","0 0 "+n+" "+i)}},{createDocFragment:rn,isNullOrUndefined:on,createI:ln,createArticle:cn,findAncestor:hn,removeChildren:un,windowWidth:dn,isObject:pn,valOrDefault:mn}=n(835);function fn(t){const{type:e,value:n}=t.dataset;return"concept"===e?this.candidates.find((t=>t.id===n)).id:"meta-concept"===e?this.candidates.find((t=>t.name===n)).name:"value"===e?n:"placeholder"===e?null:n}const gn={init(){return this.width=0,this.height=0,this.items=new Map,this},render(){const{selection:t,dimensions:e,openSelection:n}=this.schema;if(on(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.element.dataset.id=this.id,this.element.dataset.nature="field",this.element.dataset.view="svg-choice",this.element.id=this.id,this.element.classList.add("field"),this.element.classList.add("field--svg_choice")),e?(this.element.setAttribute("width",e.width),this.element.setAttribute("height",e.height)):this.element.style.overflow="visible",this.candidates=this.source.getCandidates(),on(this.selection)&&(this.createSelection(t),this.element.append(this.selection)),n&&on(this.openSelection)){const t=new DOMParser;this.openSelection=t.parseFromString(n.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.element.append(this.openSelection),this.openSelection.addEventListener("click",(()=>{if(this.open)return this.selection.remove(),void(this.open=!1);this.element.append(this.selection),this.open=!0}))}return this.open=!0,this.bindEvents(),this.element},setValue(t){this.source.setValue(t)},createSelection(t){const{item:e,breakPoint:n=!1,direction:i,close:s}=t;this.selection=document.createElementNS("http://www.w3.org/2000/svg","svg");let a=0;this.candidates.forEach((t=>{const s=pn(t),{dimension:r,tag:o}=e;let{holder:l,foreign:c}=this.createChoiceContainer(r);if(this.items.set(t.id,l),"meta-concept"===t.type){let e=this.model.getProjectionSchema(t.concept,mn(o))[0],n=e.type,i={type:n,[n]:e.content||e.projection},s=da.call(this,i,t.concept,{focusable:!1,meta:t.name});l.dataset.type="meta-concept",l.dataset.value=t.name,s.style.position="fixed",c.append(s)}else if(s){if(!this.model.hasProjectionSchema(t,o))return container;let e=this.model.createProjection(t,o).init({focusable:!1});e.readonly=!0,e.focusable=!1,e.parent=this.projection,c.append(e.render()),c.childNodes[0].style.position="fixed",l.dataset.type="concept",l.dataset.value=t.id}else c.append(t.toString());switch(i){case"horizontal":n?(l.setAttribute("y",~~(a/n)*r.height),l.setAttribute("x",a%n*r.width),this.width=n*r.width,this.height=(1+~~(a/n))*r.height):(l.setAttribute("x",a*r.width),this.width=(a+1)*r.width,this.height=r.height);break;case"vertical":n?(l.setAttribute("x",~~(a/n)*r.width),l.setAttribute("y",a%n*r.height)):l.setAttribute("y",a*r.height)}this.bindEvent(l),this.selection.append(l),l.style.border="dotted black",a++}))},registerDimensionsObserver(t){on(this.observers)&&(this.observers=[]),this.observers.push(t)},notifyDimObservers(){on(this.observers)||this.observers.forEach((t=>{t.analyseContentDim()}))},bindEvent(t){t.addEventListener("click",(()=>{this.setValue(fn.call(this,t)),this.schema.selection.close&&(this.open=!1,this.selection.remove(),this.width=0,this.height=0,this.notifyDimObservers())}))},bindEvents(){this.projection.registerHandler("displayed",(()=>{this.displayed||(this.displayed=!0,this.items.forEach(((t,e)=>{const n=t.childNodes[0].childNodes[0];this.projection.resolveElement(n).projection.update("displayed")})))})),this.projection.registerHandler("value.changed",(()=>{this.schema.selection.close&&(this.open=!1,this.selection.remove(),this.width=0,this.height=0,this.notifyDimObservers())}))},createChoiceContainer(t){const{width:e,height:n}=t;let i=document.createElementNS("http://www.w3.org/2000/svg","svg"),s=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return i.setAttribute("width",e),i.setAttribute("height",n),s.setAttribute("width",e),s.setAttribute("height",n),i.append(s),{holder:i,foreign:s}},focusIn(){},focusOut(){}},yn=Object.assign(Object.create(de),gn),{createDocFragment:bn,isNullOrUndefined:vn,createI:xn,createArticle:wn,findAncestor:En,removeChildren:An,windowWidth:jn,isObject:kn,valOrDefault:Nn}=n(835);function _n(t){const{type:e,value:n}=t.dataset;return"concept"===e?this.candidates.find((t=>t.id===n)).id:"meta-concept"===e?this.candidates.find((t=>t.name===n)).name:"value"===e?n:"placeholder"===e?null:n}const On={init(){return this.width=0,this.height=0,this.items=new Map,this},render(){const{selection:t,dimensions:e,open:n,overflow:i=!1}=this.schema;if(vn(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.element.dataset.id=this.id,this.element.dataset.nature="field",this.element.dataset.view="svg-placeholder",this.element.id=this.id,this.element.classList.add("field"),this.element.classList.add("field--svg_choice")),i&&(this.element.style.overflow="visible"),e&&(this.element.setAttribute("width",e.width),this.element.setAttribute("height",e.height)),vn(this.openBack)){const{render:t,coordinates:e,dimensions:i}=n;this.openBack=da.call(this,Object.assign(t,{action:{type:"OPEN",target:this}})),this.openBack.setAttribute("x",Nn(e.x,0)),this.openBack.setAttribute("y",Nn(e.y,0))}return this.candidates=this.source.getCandidates(),vn(this.selection)&&(this.createSelection(t),this.element.append(this.selection)),vn(this.source.value)?this.opened=!0:(this.opened=!1,this.element.append(this.openBack)),this.element},clickHandler(t){},setValue(t){this.source.setValue(t),this.element.append(this.openBack),this.opened=!1},open(){this.opened=!0,this.element.append(this.selection),this.openBack.remove(),this.source.removeValue()},createSelection(t){const{item:e,breakPoint:n=!1,direction:i,close:s}=t;this.selection=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.candidates.forEach((t=>{const n=kn(t),{tag:i}=e;if("meta-concept"===t.type){let e=this.model.getProjectionSchema(t.concept,Nn(i))[0],n=e.type,s={type:n,[n]:e.content||e.projection},a=da.call(this,s,t.concept,{focusable:!1,meta:t.name});a.dataset.type="meta-concept",a.dataset.value=t.name;const r=this.projection.resolveElement(a).schema.coordinates;a.setAttribute("x",r.x),a.setAttribute("y",r.y),this.bindEvent(a),this.selection.append(a),this.items.set(t.id,a)}else if(n){if(!this.model.hasProjectionSchema(t,i))return container;let e=this.model.createProjection(t,i).init({focusable:!1});e.readonly=!0,e.focusable=!1,e.parent=this.projection;let n=e.render();const s=e.element.schema.coordinates;n.setAttribute("x",s.x),n.setAttribute("y",s.y),this.bindEvent(n),this.selection.append(n),this.items.set(t.id,n)}}))},focusIn(){this.opened||this.element.append(this.openBack)},focusOut(){this.opened||this.openBack.remove()},registerDimensionsObserver(t){vn(this.observers)&&(this.observers=[]),this.observers.push(t)},notifyDimObservers(){vn(this.observers)||this.observers.forEach((t=>{t.analyseContentDim()}))},bindEvent(t){t.addEventListener("click",(()=>{const e=_n.call(this,t);this.setValue(e),this.selection.remove(),this.element.append(this.openBack)}))}},Ln=Object.assign(Object.create(de),On),{isNull:Mn,isNullOrUndefined:Cn}=n(835),Sn={init(){return this},render(){const{order:t,dimensions:e=!1}=this.schema;if(Cn(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.element.dataset.id=this.id,this.element.dataset.nature="field",this.element.dataset.view="svg-switch",this.element.id=this.id,this.element.classList.add("field"),this.element.classList.add("field--svg_choice")),e&&(this.element.setAttribute("width",e.width),this.element.setAttribute("height",e.height)),Cn(this.index)&&(this.index=0),this.order=t,this.source.hasValue())for(let t=0;t<this.order.length;t++)if(this.order[t]===this.source.value){this.index=t;break}return this.bindEvents(),this.element},clickHandler(){this.index=(this.index+1)%this.order.length,this.source.setValue(this.order[this.index])},registerDimensionsObserver(t){},focusIn(){},focusOut(){},bindEvents(){}},Tn=Object.assign(Object.create(de),Sn),In={binary:(t,e,n)=>Object.create(Ee,{object:{value:"field"},name:{value:"binary-field"},type:{value:"binary"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),choice:(t,e,n)=>Object.create(Oe,{object:{value:"field"},name:{value:"choice-field"},type:{value:"choice"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),list:(t,e,n)=>Object.create(He,{object:{value:"field"},name:{value:"list-field"},type:{value:"list"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),table:(t,e,n)=>Object.create(qe,{object:{value:"field"},name:{value:"table-field"},type:{value:"table"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),text:(t,e,n)=>Object.create(Ke,{object:{value:"field"},name:{value:"text-field"},type:{value:"text"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),interactive:(t,e,n)=>Object.create(Se,{object:{value:"field"},name:{value:"interactive-field"},type:{value:"interactive"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),static:(t,e,n)=>Object.create(Re,{object:{value:"field"},name:{value:"static-field"},type:{value:"static"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),dynamic:(t,e,n)=>Object.create(Me,{object:{value:"field"},name:{value:"dynamic-field"},type:{value:"dynamic"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),add:(t,e,n)=>Object.create(fe,{object:{value:"field"},name:{value:"add-field"},type:{value:"add"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),arrow:(t,e,n)=>Object.create(en,{object:{value:"field"},name:{value:"arrow"},type:{value:"arrow"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),svg:(t,e,n)=>Object.create(sn,{object:{value:"field"},name:{value:"svg"},type:{value:"svg"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),"svg-choice":(t,e,n)=>Object.create(yn,{object:{value:"field"},name:{value:"switch"},type:{value:"switch"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),"svg-placeholder":(t,e,n)=>Object.create(Ln,{object:{value:"field"},name:{value:"switch"},type:{value:"switch"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}}),"svg-switch":(t,e,n)=>Object.create(Tn,{object:{value:"field"},name:{value:"switch"},type:{value:"switch"},id:{value:Dn()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept}})};var Un=0;const Dn=()=>"field"+Un++,Hn={createField(t,e,n){const{type:i}=e,a=In[i];if((0,s.isNullOrUndefined)(a))throw new Error(`Missing handler: The '${i}' field could not be handled`);var r=a(t,e,n);if((0,s.isNullOrUndefined)(r))throw new Error(`Bad request: The '${i}' field could not be created`);return r.errors=[],r.readonly=(0,s.valOrDefault)(e.readonly,!1),(0,s.isNullOrUndefined)(r.id)&&(r.id=Dn()),r}},Pn={init(){throw new Error("This function has not been implemented")},element:null,children:null,statusElement:null,attached:null,readonly:!1,visible:!1,disabled:!1,active:!1,focused:!1,get hasAttached(){return!(0,s.isEmpty)(this.attached)},attach(t,e){this.attached.push(t)},detach(t){this.attached.slice(this.attached.indexOf(t),1)},getAttached(t){return(0,s.isFunction)(t)?this.attached.filter((e=>t(e))):this.attached},show(){return(0,a.$Z)(this.element),this.visible=!0,this.active=!0,this},hide(){return(0,a.Cp)(this.element),this.visible=!1,this},toggle(){return(0,a.ZN)(this.container),this.visible=!this.visible,this},focus(){return this.element.focus(),this.focused=!0,this.active=!0,this},_focusIn:t=>!1,navigate(t,e,n){return this.focusable?(this.element.focus(),!0):this.parent.arrowHandler(t,this.element)},clear:()=>!0,delete(){this.environment.notify("This element cannot be removed",a.k$.WARNING,1500),(0,a.lL)(this.element)},spaceHandler(t){return this.arrowHandler("right",t)},_spaceHandler(t){return this.environment.notify("Nothing do here.",a.k$.NORMAL,1500),!1},escapeHandler(t){let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex));return this.projection.resolveElement(e).focus(e),!0},enterHandler(t){this.element.click()},deleteHandler(t){return this.environment.notify("This element cannot be removed",a.k$.WARNING,1500),(0,a.lL)(this.element),!1},backspaceHandler(t){return this.arrowHandler("left",t)},arrowHandler(t,e){return!!this.parent&&this.parent.arrowHandler(t,e)},clickHandler:t=>(console.warn("CLICK_HANDLER NOT IMPLEMENTED"),!1),controlHandler:t=>(console.warn("CONTROL NOT IMPLEMENTED"),!1)},Rn=Object.assign(Pn),Bn={init(){return this.children=[],this},render(){const t=(0,s.createDocFragment)(),{help:e,style:n,content:i}=this.schema;return(0,s.isHTMLElement)(this.element)||(this.element=(0,s.createAudio)({class:["static","audio-static"],src:i,dataset:{nature:"static",static:"audio",id:this.id,ignore:"all"}})),(0,s.isNullOrUndefined)(e)||(this.element.title=e),Kt.call(this.projection,this.element,n),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this},bindEvents(){}},Vn=Object.assign(Object.create(Rn),Bn);function zn(t,e){let n=t.param.find((t=>t.name===e));if((0,s.isNullOrUndefined)(n))return;const{type:i="string",value:a}=n;let r=(0,s.valOrDefault)(a,n.default);return(0,s.isNullOrUndefined)(r)?null:"string"===i?r.toString():"number"===i?+r:void 0}function Fn(t){if((0,s.isNullOrUndefined)(t))return"";const{type:e}=t;return"property"===e?(this.hasProperty=!0,(0,s.valOrDefault)(this.source.getProperty(t.name),"")):"param"===e?zn.call(this,this.schema.template,t.name):"raw"===e?(0,s.htmlToElement)(t.raw):t}function qn(t){return(0,s.isNullOrWhitespace)(t)?"":t.startsWith("http://")||t.startsWith("https://")?new URL(t).href:qn(`https://${t}`)}const $n={url:null,alt:null,width:null,height:null,init(){const{url:t,width:e,height:n,alt:i}=this.schema;return this.width=e,this.height=n,this.alt=i,this},render(){let t=!1;const{help:e,style:n,url:i}=this.schema;return this.url=qn(Fn.call(this,i)),(0,s.isHTMLElement)(this.element)||(this.element=(0,s.createImage)({class:["static","image-static"],src:this.url,alt:this.alt,dataset:{nature:"static",static:"image",id:this.id,ignore:"all"}}),t=!0),(0,s.isNullOrUndefined)(this.width)||isNaN(this.width)||(this.element.width=this.width),(0,s.isNullOrUndefined)(this.height)||isNaN(this.height)||(this.element.height=this.height),(0,s.isNullOrUndefined)(e)||(this.element.title=e),Kt.call(this.projection,this.element,n),t&&this.bindEvents(),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return(0,s.isNullOrWhitespace)(this.url)?this.element.classList.add("empty"):this.element.classList.remove("empty"),this},update(){const{url:t}=this.schema;return this.url=qn(Fn.call(this,t)),this.element.src=this.url,this.refresh(),this},bindEvents(){this.hasProperty&&(this.projection.registerHandler("value.changed",(t=>{this.update()})),this.projection.registerHandler("value.added",(t=>{this.update()})),this.projection.registerHandler("value.removed",(t=>{this.update()})))}},Wn=Object.assign(Object.create(Rn),$n),Zn={email:t=>`mailto:${t}`,phone:t=>`tel:${t}`,link:t=>`${t}`,url:t=>`${t}`};function Xn(t,e){let n=t.param.find((t=>t.name===e));if((0,s.isNullOrUndefined)(n))return;const{type:i="string",value:a}=n;let r=(0,s.valOrDefault)(a,n.default);return(0,s.isNullOrUndefined)(r)?null:"string"===i?r.toString():"number"===i?+r:void 0}function Yn(t){if((0,s.isNullOrUndefined)(t))return"";const{type:e}=t;return"property"===e?(this.hasProperty=!0,(0,s.valOrDefault)(this.source.getProperty(t.name),"")):"param"===e?Xn.call(this,this.schema.template,t.name):"raw"===e?(0,s.htmlToElement)(t.raw):t}const Gn={url:null,urlType:null,href:null,hrefHandler:null,content:null,init(){const{content:t=[],urlType:e="link"}=this.schema;if(this.content=t,this.urlType=e,this.children=[],this.hrefHandler=Zn[this.urlType],!(0,s.isFunction)(this.hrefHandler))throw new TypeError("type not handled");return this},render(){let t=!1;const e=(0,s.createDocFragment)(),{help:n,style:i,url:a}=this.schema;return this.href=this.hrefHandler(Yn.call(this,a)),(0,s.isHTMLElement)(this.element)||(this.element=(0,s.createAnchor)({class:["static","link"],href:this.href,dataset:{nature:"static",static:"link",id:this.id,ignore:"all"}}),"link"===this.urlType&&(this.element.target="_blank"),t=!0),this.content.forEach((t=>{let n=da.call(this,t,this.projection.concept,{focusable:!1});e.append(n)})),(0,s.isNullOrUndefined)(n)||(this.element.title=n),Kt.call(this.projection,this.element,i),e.hasChildNodes()&&this.element.append(e),t&&this.bindEvents(),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this},update(){const{url:t}=this.schema;return this.element.href=this.hrefHandler(Yn.call(this,t)),(0,s.removeChildren)(this.element),this.content.forEach((t=>{this.element.append(da.call(this,t,this.projection.concept,{focusable:!1}))})),this},bindEvents(){this.hasProperty&&(this.projection.registerHandler("value.changed",(t=>{this.update()})),this.projection.registerHandler("value.added",(t=>{this.update()})),this.projection.registerHandler("value.removed",(t=>{this.update()})))}},Jn=Object.assign(Object.create(Rn),Gn);function Kn(t,e){let n=t.param.find((t=>t.name===e));if((0,s.isNullOrUndefined)(n))return;const{type:i="string",value:a}=n;let r=(0,s.valOrDefault)(a,n.default);return(0,s.isNullOrUndefined)(r)?null:"string"===i?r.toString():"number"===i?+r:void 0}function Qn(t){if((0,s.isNullOrUndefined)(t))return"";const{type:e}=t;return"property"===e?(this.hasProperty=!0,(0,s.valOrDefault)(this.source.getProperty(t.name),"")):"param"===e?Kn.call(this,this.schema.template,t.name):"html"===e?(0,s.htmlToElement)(t.html):"raw"===e?(0,s.htmlToElement)(t.raw):t}const ti={editable:null,focusable:null,hasProperty:!1,asHTML:!1,init(t={}){Object.assign(this.schema,t);const{content:e,editable:n=!1,focusable:i=!1}=this.schema;return this.children=[],this._content=e,this.editable=n,this.focusable=i,this},render(){let t=!1;const{content:e,help:n,style:i}=this.schema;if(!(0,s.isHTMLElement)(this.element)){if(this.element=(0,s.createSpan)({class:["text","static","text-static"],editable:this.editable,dataset:{nature:"static",view:"text",static:"text",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0),Array.isArray(e))e.forEach((t=>{let e=Qn.call(this,t),n=(0,s.createSpan)({class:["text","static","text-static"],dataset:{nature:"static-component",view:"text",static:"text",content:e,id:this.id,ignore:"all"}},e);Kt.call(this.projection,n,t.style),this.element.append(n)}));else{let t=Qn.call(this,e);this.element.append(t),this.element.content=t}t=!0}return(0,s.isNullOrUndefined)(n)||(this.element.title=n),Kt.call(this.projection,this.element,i),t&&this.bindEvents(),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},getLength(){return this.element.textContent.length},backspaceHandler(t){return this.arrowHandler("left",t)},arrowHandler(t,e){if(!this.editable&&this.parent)return this.parent.arrowHandler(t,e);if("right"===t){if(this.getLength()<(0,a.qO)(this.element)+1&&this.parent)return this.parent.arrowHandler(t,e)}else if("left"===t){if(0===(0,a.qO)(this.element)&&this.parent)return this.parent.arrowHandler(t,e)}else if(this.parent)return this.parent.arrowHandler(t,e);return!1},escapeHandler(t){let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex));this.projection.resolveElement(e).focus(e)},update(){const{content:t}=this.schema;return(0,s.removeChildren)(this.element),Array.isArray(t)?t.forEach((t=>{this.element.append((0,s.createSpan)({class:["text","static","text-static"],dataset:{nature:"static-component",view:"text",static:"text",id:this.id,ignore:"all"}},Qn.call(this,t)))})):this.element.append(Qn.call(this,t)),this},refresh(){return this},bindEvents(){this.hasProperty&&(this.projection.registerHandler("value.changed",(t=>{this.update()})),this.projection.registerHandler("value.added",(t=>{this.update()})),this.projection.registerHandler("value.removed",(t=>{this.update()})))}},ei=Object.assign(Object.create(Rn),ti),ni={contentType:null,editable:null,focusable:null,init(t={}){Object.assign(this.schema,t);const{focusable:e=!0}=this.schema;return this.children=[],this.focusable=e,this},render(){const t=(0,s.createDocFragment)(),{help:e,style:n,content:i}=this.schema;return(0,s.isHTMLElement)(this.element)||(this.element=(0,s.createButton)({class:["btn","static"],dataset:{nature:"static",view:"plink",static:"plink",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0)),i.forEach((e=>{let n=da.call(this,e,this.projection.concept,{focusable:!1});t.append(n)})),(0,s.isNullOrUndefined)(e)||(this.element.title=e),Kt.call(this.projection,this.element,n),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},arrowHandler(t,e){return(!this.editable&&this.parent||!!this.parent)&&this.parent.arrowHandler(t,e)},escapeHandler(t){let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex));this.environment.resolveElement(e).focus(e)},enterHandler(t){const e=this.projection.schema.findIndex((t=>t.tags.includes(this.schema.tag)));return this.projection.changeView(e),!1},clickHandler(t){let e=this.projection.findView(this.schema.tag);return-1===e||this.projection.changeView(e),!1},refresh(){return this},bindEvents(){}},ii=Object.assign(Object.create(Rn),ni),si={template:null,selector:null,content:null,init(){return this.selector=this.schema.selector,this.template=(0,s.getTemplate)(this.selector),this},render(){const{style:t,content:e}=this.schema;return(0,s.isNode)(this.element)||(this.element=(0,s.cloneTemplate)(this.template)),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this}},ai=Object.assign(Object.create(Rn),si);function ri(t,e){let n=t.param.find((t=>t.name===e));if((0,s.isNullOrUndefined)(n))return;const{type:i="string",value:a}=n;let r=(0,s.valOrDefault)(a,n.default);return(0,s.isNullOrUndefined)(r)?null:"string"===i?r.toString():"number"===i?+r:void 0}const oi={contentType:null,editable:null,focusable:null,disabled:null,init(t={}){Object.assign(this.schema,t);const{focusable:e=!0,disabled:n=!1}=this.schema;return this.children=[],this.focusable=e,this.disabled=n,this},render(){const t=(0,s.createDocFragment)(),{help:e,style:n,content:i}=this.schema;return(0,s.isHTMLElement)(this.element)||(this.element=(0,s.createButton)({class:["btn","static"],dataset:{nature:"static",view:"button",static:"button",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0)),i.forEach((e=>{let n=da.call(this,e,this.projection.concept,{template:this.schema.template,focusable:!1});t.append(n)})),(0,s.isNullOrUndefined)(e)||(this.element.title=e),Kt.call(this.projection,this.element,n),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},arrowHandler(t,e){return(!this.editable&&this.parent||!!this.parent)&&this.parent.arrowHandler(t,e)},escapeHandler(t){let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex));this.environment.resolveElement(e).focus(e)},enterHandler(t){const e=this.projection.schema.findIndex((t=>t.tags.includes(this.schema.tag)));return this.projection.changeView(e),!1},clickHandler(t){let e=this.source;if(this.schema.bind&&(e=this.source.getValue(!0)),this.schema.action){const{type:t,value:n,target:i}=this.schema.action;if((0,s.isObject)(n))for(const t in n){const e=n[t];"param"===e.type&&(n[t]=ri.call(this,this.schema.template,e.name))}switch(t){case"CREATE":(0,s.isNullOrUndefined)(i)?e.createElement():"attribute"===i.type&&e.getAttribute(i.name).target.createElement({value:n});break;case"SELECT":if((0,s.isNullOrUndefined)(i)&&e.createElement(),(0,s.isObject)(n))for(const t in n){const e=n[t];"param"===e.type&&(n[t]=ri.call(this,this.schema.template,e.name))}"attribute"===i.type&&e.getAttribute(i.name).target.setValue((0,s.valOrDefault)(n.name,n)),"bind"===i.type&&e.setValue((0,s.valOrDefault)(n.name,n));break;case"CREATES":if((0,s.isNullOrUndefined)(i)&&e.createElement(),(0,s.isObject)(n))for(const t in n){const e=n[t];"param"===e.type&&(n[t]=ri.call(this,this.schema.template,e.name))}"attribute"===i.type&&e.getAttribute(i.name).target.createElement().getAttribute(i.attribute).target.setValue((0,s.valOrDefault)(n.name,n));break;case"SIDE":let t=this.environment.createProjection(e,i),a=this.environment.findWindow("side-instance");(0,s.isNullOrUndefined)(a)&&(a=this.environment.createWindow("side-instance"),a.container.classList.add("model-projection-sideview")),a.instances.size>0&&Array.from(a.instances)[0].delete();let r=this.environment.createInstance(e,t,{type:"projection",close:"DELETE-PROJECTION"});a.addInstance(r)}return!1}return this.environment.triggerEvent({name:this.schema.trigger,args:[e]}),!1},refresh(){return this},bindEvents(){}},li=Object.assign(Object.create(Rn),oi),ci={editable:null,focusable:null,init(t={}){Object.assign(this.schema,t);const{focusable:e=!0}=this.schema;return this.focusable=e,this},render(){(0,s.createDocFragment)();const{help:t,style:e,content:n,external:i=!0,tag:a}=this.schema,r=new DOMParser;return(0,s.isHTMLElement)(this.element)||(this.element=r.parseFromString(n.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.element.classList.add(["btn","static"]),this.element.dataset.nature="static",this.element.dataset.view="svg-alt",this.element.dataset.id=this.id,this.element.dataset.ignore="all",this.focusable&&(this.element.tabIndex=0)),(0,s.isNullOrUndefined)(t)||(this.element.title=t),this.refresh(),this.bindEvents(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,a.Cp)(this.messageElement),(0,s.removeChildren)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},arrowHandler(t,e){return(!this.editable&&this.parent||!!this.parent)&&this.parent.arrowHandler(t,e)},escapeHandler(t){let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex));this.environment.resolveElement(e).focus(e)},enterHandler(t){const e=this.projection.schema.findIndex((t=>t.tags.includes(this.schema.tag)));return this.projection.changeView(e),!1},clickHandler(t){},refresh(){return this},bindEvents(){this.element.addEventListener("click",(()=>{let t=this.source,e=this.environment.createProjection(t,this.schema.tag),n=this.environment.findWindow("side-instance");(0,s.isNullOrUndefined)(n)&&(n=this.environment.createWindow("side-instance"),n.container.classList.add("model-projection-sideview")),n.instances.size>0&&Array.from(n.instances)[0].delete();let i=this.environment.createInstance(t,e,{type:"projection",close:"DELETE-PROJECTION"});n.addInstance(i)}))}},hi=Object.assign(Object.create(Rn),ci),ui={CREATE:function(t,e){this.source.createElement(e)},CREATES:function(t,e){this.source.createElement().setValue((0,s.valOrDefault)(e.name,e))},DELETE:di,EXTRACT:function(t,e){let n=this.projection.environment.actions.get("extract-instance")("graphical").getAttribute("shape").target.getAttribute("elements").target.createElement();n.setValue(this.source.name),pi.call(this,n.getValue(!0)),mi.call(this,n.getValue(!0)),di.call(this)},SIDE:function(t,e){let n=this.environment.createProjection(this.source,t),i=this.environment.findWindow("side-instance");(0,s.isNullOrUndefined)(i)&&(i=this.environment.createWindow("side-instance"),i.container.classList.add("model-projection-sideview")),i.instances.size>0&&Array.from(i.instances)[0].delete();let a=this.environment.createInstance(this.source,n,{type:"projection",close:"DELETE-PROJECTION"});i.addInstance(a)},OPEN:function(t){(0,s.isNullOrUndefined)(this.target)&&(this.target=t),this.target.open()},"CREATE-TREE":function(t,e){let n=this.container;for(;(0,s.isNullOrUndefined)(n.getAttribute("data-tree"))&&n.getAttribute("data-tree")!==t;)n=n.parentNode;let i=this.source.createElement();this.environment.getActiveReceiver(t).accept(i,n,(0,s.valOrDefault)(e,"main"))}};function di(t,e){"prototype"!==this.source.parent.schema.nature?this.source.delete():this.source.parent.delete()}function pi(t){switch(this.source.name){case"circle":t.getAttributeByName("cx").target.setValue(this.source.getAttributeByName("cx").target.value),t.getAttributeByName("cy").target.setValue(this.source.getAttributeByName("cy").target.value),t.getAttributeByName("r").target.setValue(this.source.getAttributeByName("r").target.value);break;case"ellipse":t.getAttributeByName("cx").target.setValue(this.source.getAttributeByName("cx").target.value),t.getAttributeByName("cy").target.setValue(this.source.getAttributeByName("cy").target.value),t.getAttributeByName("rx").target.setValue(this.source.getAttributeByName("rx").target.value),t.getAttributeByName("ry").target.setValue(this.source.getAttributeByName("ry").target.value);break;case"rectangle":t.getAttributeByName("x").target.setValue(this.source.getAttributeByName("x").target.value),t.getAttributeByName("y").target.setValue(this.source.getAttributeByName("y").target.value),t.getAttributeByName("width").target.setValue(this.source.getAttributeByName("width").target.value),t.getAttributeByName("height").target.setValue(this.source.getAttributeByName("height").target.value);break;case"polygon":t.getAttributeByName("points").target.setValue(this.source.getAttributeByName("points").target.value);break;case"path":t.getAttributeByName("d").target.setValue(this.source.getAttributeByName("d").target.value)}}function mi(t){const e=t.getAttributeByName("style").target,n=this.source.getAttributeByName("style").target;e.getAttributeByName("fill").target.setValue(n.getAttributeByName("fill").target.value),e.getAttributeByName("stroke").target.setValue(n.getAttributeByName("stroke").target.value),e.getAttributeByName("s-width").target.setValue(n.getAttributeByName("s-width").target.value),e.getAttributeByName("s-dash").target.setValue(n.getAttributeByName("s-dash").target.value),e.getAttributeByName("rx").target.setValue(n.getAttributeByName("rx").target.value),e.getAttributeByName("ry").target.setValue(n.getAttributeByName("ry").target.value)}const fi={init(){return this},render(){const{action:t,content:e}=this.schema;if((0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="static",this.container.dataset.algorithm="button",this.container.dataset.id=this.id),e&&(0,s.isNullOrUndefined)(this.content)&&this.createContent(e),this.schema.dimensions){const{width:t,height:e}=this.schema.dimensions;this.container.setAttribute("width",t),this.container.setAttribute("height",e)}return this.container.style.width="fit-content",this.container},createContent(t){const e=new DOMParser;this.content=e.parseFromString(t.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.container.append(this.content)},focusIn(){},focusOut(){},clickHandler(){const{type:t,target:e,value:n}=this.schema.action;ui[t].call(this,e,n)}},gi=Object.assign({},Object.create(Rn),fi),yi={init(){return this},render(){const t=new DOMParser,{content:e}=this.schema;return(0,s.isNullOrUndefined)(this.element)&&(this.element=t.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement),this.element},focusIn(){},focusOut(){},clickHandler(t){}},bi=Object.assign(Object.create(Rn),yi),vi={init(){return this},render(){new DOMParser;const{content:t,style:e}=this.schema;return(0,s.isNullOrUndefined)(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","text"),this.element.textContent=t),this.style(),this.element},style(){const{font:t,size:e,anchor:n="left",weight:i,baseline:s}=this.schema.style;this.element.setAttribute("text-anchor",n),this.element.setAttribute("font-family",t),this.element.setAttribute("font-size",e),this.element.style["dominant-baseline"]=s,i&&this.element.setAttribute("font-weight",i)},focusIn(){},focusOut(){},clickHandler(t){}},xi=Object.assign(Object.create(Rn),vi);var wi=0;const Ei=()=>"static"+wi++,Ai={audio:(t,e,n)=>Object.create(Vn,{object:{value:"static"},name:{value:"audio-static"},type:{value:"audio"},id:{value:Ei()},model:{value:t},schema:{value:e},projection:{value:n}}),plink:(t,e,n)=>Object.create(ii,{object:{value:"static"},name:{value:"plink-static"},type:{value:"plink"},id:{value:Ei()},model:{value:t},schema:{value:e},projection:{value:n}}),image:(t,e,n)=>Object.create(Wn,{object:{value:"static"},name:{value:"image-static"},type:{value:"image"},id:{value:Ei()},model:{value:t},schema:{value:e},projection:{value:n}}),link:(t,e,n)=>Object.create(Jn,{object:{value:"field"},name:{value:"link-static"},type:{value:"link"},id:{value:Ei()},model:{value:t},schema:{value:e},projection:{value:n}}),text:(t,e,n)=>Object.create(ei,{object:{value:"static"},name:{value:"text-static"},type:{value:"text"},id:{value:Ei()},model:{value:t},schema:{value:e},projection:{value:n}}),html:(t,e,n)=>Object.create(ai,{object:{value:"static"},name:{value:"html-static"},type:{value:"html"},id:{value:Ei()},model:{value:t},schema:{value:e},projection:{value:n}}),button:(t,e,n)=>Object.create(li,{object:{value:"static"},name:{value:"button-static"},type:{value:"button"},id:{value:Ei()},model:{value:t},schema:{value:e},projection:{value:n}}),"svg-alt":(t,e,n)=>Object.create(hi,{object:{value:"static"},name:{value:"svg-static"},type:{value:"svgAlt"},id:{value:Ei()},model:{value:t},schema:{value:e},projection:{value:n}}),"svg-button":(t,e,n)=>Object.create(gi,{object:{value:"static"},name:{value:"svg-button"},type:{value:"svgButton"},id:{value:Ei()},model:{value:t},schema:{value:e},projection:{value:n}}),svg:(t,e,n)=>Object.create(bi,{object:{value:"static"},name:{value:"svg-static"},type:{value:"svg"},id:{value:Ei()},model:{value:t},schema:{value:e},projection:{value:n}}),"svg-text":(t,e,n)=>Object.create(xi,{object:{value:"static"},name:{value:"svgText-static"},type:{value:"svgText"},id:{value:Ei()},model:{value:t},schema:{value:e},projection:{value:n}})},ji={createStatic(t,e,n){const{type:i}=e,a=Ai[i];if((0,s.isNullOrUndefined)(a))throw new Error(`Missing handler: The '${i}' static could not be handled`);var r=a(t,e,n);if((0,s.isNullOrUndefined)(r))throw new Error(`Bad request: The '${i}' static could not be created`);return(0,s.isNullOrUndefined)(r.id)&&(r.id=Ei()),r}},ki={focusable:null,readonly:!1,visible:!1,editable:!1,active:!1,container:null,elements:null,children:null,editing:!1,getStyle(){return this.schema.style},setStyle(t){return this.schema.style=t,Kt.call(this.projection,this.container,t),this.refresh(),!0},getContainer(){return this.container},isRoot(){return(0,s.isNullOrUndefined)(this.parent)},getField(t){return this.projection.getField(t)},getStatic(t){return this.projection.getStatic(t)},getLayout(t){return this.environment.getLayout(t)},show(){return(0,a.$Z)(this.element),this.visible=!0,this.active=!0,this},hide(){return(0,a.Cp)(this.element),this.visible=!1,this},toggle(){return(0,a.ZN)(this.container),this.visible=!this.visible,this},_focusIn:t=>!1,spaceHandler(t){return t===this.container&&!(0,s.isNullOrUndefined)(this.parent)&&this.parent.spaceHandler(this.container)},_spaceHandler(t){return console.warn(`CTRL_SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},escapeHandler(t){if(this.isRoot())return!1;let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex)),n=this.environment.resolveElement(e);return!(0,s.isNullOrUndefined)(n)&&(n.focus(e),!0)},enterHandler(t){let e=(0,s.getElement)('[tabindex]:not([tabindex="-1"])',this.container),n=this.environment.resolveElement(e);return!(0,s.isNullOrUndefined)(n)&&(n.focus(),!0)},delete(){var t=this.source.delete();t.success||this.environment.notify(t.message)},deleteHandler(t){if(this.projection.element!==this)return!1;if(!this.projection.optional)return(0,a.lL)(this.container),!1;let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex)),n=this.container.cloneNode(!0);this.source.hasParent()&&this.environment.save(this.source.getParent(),n),this.source.delete();let i=this.environment.resolveElement(e);return(0,s.isNullOrUndefined)(i)||i.focus(),!1},backspaceHandler(t){return console.warn(`BACKSPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},arrowHandler(t,e){if(e===this.container)return!(0,s.isNullOrUndefined)(this.parent)&&this.parent.arrowHandler(t,this.container);let n=(0,a.As)(e,t,this.container);if(!(0,s.isHTMLElement)(n))return!(0,s.isNullOrUndefined)(this.parent)&&"layout"===this.parent.object&&this.parent.arrowHandler(t,this.container);let i=this.environment.resolveElement(n);return i&&((0,s.isFunction)(i.navigate)?i.navigate(t):i.focus()),!0},shiftHandler(t,e){if("up"===t){let t=(0,a.a2)(window.getComputedStyle(this.container).marginTop);this.container.style.marginTop=`${t+1}px`}return!0},_arrowHandler(t,e){return console.warn(`CTRL_ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},clickHandler(t){return console.warn(`CLICK_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},updateSize:()=>!1,controlHandler(t){this.toolbar&&this.toolbar.remove()}},Ni={ROW:"row",COLUMN:"column"},_i={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center",stretch:"stretch",baseline:"baseline"},Oi={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center","space-between":"space-between","space-around":"space-around","space-evenly":"space-evenly"};var Li=0;function Mi(t,e,n){return Object.create(Si,{object:{value:"layout"},name:{value:"flex-layout"},type:{value:"flex"},id:{value:"layout"+Li++},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})}const Ci={orientation:null,wrappable:null,alignItems:null,justifyContent:null,args:null,init(t={}){const{editable:e=!0,focusable:n=!1}=this.schema,{orientation:i=Ni.ROW,wrappable:s=!0,alignItems:a,justifyContent:r}=this.schema.layout;return this.orientation=i,this.wrappable=s,this.alignItems=a,this.justifyContent=r,this.focusable=n,this.editable=e,this.elements=[],this.children=[],this.args=t,Object.assign(this,t),this},getOrientation(){return this.orientation},setOrientation(t){(0,s.hasOwn)(Ni,t)&&(this.orientation=t,this.refresh())},collapse(t=!1){if(!this.collapsed||t)return this.collapseContainer=(0,s.createDiv)({class:"layout-container-collapse"},this.elements),this.btnCollapse.after(this.collapseContainer),this.collapsed=!0,this.refresh(),this},expand(t=!1){if(!this.collapsed&&!t)return;let e=(0,s.createDocFragment)(Array.from(this.collapseContainer.children));return this.btnCollapse.after(e),this.collapseContainer.remove(),this.collapsed=!1,this.refresh(),this},render(){const{label:t,content:e,style:n,help:i}=this.schema,a=(0,s.createDocFragment)();(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["layout-container"],dataset:{nature:"layout",layout:"flex",id:this.id}})),i&&(this.container.title=i);for(let t=0;t<e.length;t++){let n=da.call(this,e[t],null,this.args),i=this.environment.resolveElement(n);i&&(i.parent=this),this.elements.push(n),a.append(n)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",Kt.call(this.projection,this.container,n),a.hasChildNodes()&&(this.container.append(a),this.bindEvents()),this.collapsed&&this.collapse(!0),this.container.style.display="flex",this.refresh(),this.container},refresh(){return this.container.style.flexDirection=this.orientation,this.container.style.justifyContent=Oi[this.justifyContent],this.container.style.alignItems=_i[this.alignItems],this.wrappable?this.container.style.flexWrap="wrap":this.container.style.flexWrap="nowrap",this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,s.getElement)('[tabindex]:not([tabindex="-1"])',this.container);if((0,s.isNullOrUndefined)(t))return!1;let e=this.environment.resolveElement(t);e&&e.focus(t)}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.container.addEventListener("change",(t=>{const{target:e}=t,{prop:n}=e.dataset;"orientation"===n&&this.setOrientation(e.value)})),this.projection.registerHandler("view.changed",((t,e)=>{e&&e.parent===this.projection&&(t.parent=this)})),this.btnCollapse&&this.btnCollapse.addEventListener("click",(t=>{this.collapsed?this.expand():this.collapse()}))}},Si=Object.assign({},ki,Ci),Ti={circle:function(t){let e=this.content[0].element.getBBox(),n=e.x,i=e.y,s=e.x+e.width,a=e.y+e.height;this.content.forEach((t=>{e=t.element.getBBox(),n=Math.min(e.x,n),i=Math.min(e.y,i),s=Math.max(e.x+e.width,s),a=Math.max(e.y+e.height,a)}));let r={x:Number(t.getAttribute("cx")),y:Number(t.getAttribute("cy")),r:Number(t.getAttribute("r"))},o=Math.sqrt(Math.pow(n-r.x,2)+Math.pow(i-r.y,2)),l=Math.sqrt(Math.pow(s-r.x,2)+Math.pow(i-r.y,2)),c=Math.sqrt(Math.pow(s-r.x,2)+Math.pow(a-r.y,2)),h=Math.sqrt(Math.pow(n-r.x,2)+Math.pow(a-r.y,2)),u=Math.max(o,l,c,h);u>r.r-10&&Ii.call(this,u,r.r,t)}};function Ii(t,e,n){let i=Number(n.getAttribute("stroke-width"));(0,s.isNullOrUndefined)(this.containerView)&&(this.containerView={x:0,y:0,w:2*(e+(0,s.valOrDefault)(i,0)),h:2*(e+(0,s.valOrDefault)(i,0)),radius:e,defaultRadius:e});let a=Math.max(e,t)-Math.min(e,t)+5;this.containerView.x-=a,this.containerView.y-=a,this.containerView.radius+=a,this.containerView.h=2*(this.containerView.radius+i),this.containerView.w=2*(this.containerView.radius+i),this.container.setAttribute("viewBox",this.containerView.x+" "+this.containerView.y+" "+this.containerView.w+" "+this.containerView.h),this.container.setAttribute("width",this.containerView.w),this.container.setAttribute("height",this.containerView.h),this.width=this.containerView.w,this.height=this.containerView.h,n.setAttribute("r",this.containerView.radius)}const Ui={clickHandler(t){return console.warn(`CLICK_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},getContainer(){return this.container},getWidth(){return this.width},getHeight(){return this.height},setViewBox(t){this.container.setAttribute("viewBox",t),this.notifyObsevers()},setWidth(t){this.width=t,this.container.setAttribute("width",t),this.notifyObsevers()},setWidth(t){this.height=t,this.container.setAttribute("height",t),this.notifyObsevers()},notifyDimObservers(){(0,s.isNullOrUndefined)(this.observers)||this.observers.forEach((t=>{t.analyseContentDim()}))},registerDimensionsObserver(t){(0,s.isNullOrUndefined)(this.observers)&&(this.observers=[]),this.observers.push(t)},setInteraction(t){(0,s.isNullOrUndefined)(this.items)||((0,s.isNullOrUndefined)(this.warnings)&&(this.warnings=[]),this.warnings.push(t),this.items.forEach((e=>{this.projection.resolveElement(e.render).warn(t)})))},checkAugment(t,e){if(!(0,s.isNullOrUndefined)(this.background))if(t.x+Number(e.getAttribute("x"))>Number(this.background.getAttribute("x"))+Number(this.background.getAttribute("width"))||t.y+Number(e.getAttribute("y"))>Number(this.background.getAttribute("y"))+Number(this.background.getAttribute("height"))){let n=this.background.querySelector("[data-augment]");const i=Number(n.getAttribute("y")),s=t.y+Number(e.getAttribute("y"));n.setAttribute("height",s-i)}else if(t.y+Number(e.getAttribute("y"))<Number(this.background.getAttribute("y"))+Number(this.background.getAttribute("height"))){let n=this.background.querySelector("[data-augment]");const i=Number(n.getAttribute("y")),s=t.y+Number(e.getAttribute("y"));n.setAttribute("height",s-i)}},createDelete(){const{type:t}=this.schema.rmv;switch(t){case"bind":this.deleteMap=new Map;let t=0;this.schema.rmv.bind.forEach((e=>{t++;const{alias:n,focus:i,coordinates:s,content:a}=e;let r=(new DOMParser).parseFromString(a.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement;r.dataset.nature="static",r.dataset.algorithm="button",r.setAttribute("x",s.x),r.setAttribute("y",s.y),r.addEventListener("click",(()=>{this.source.delete()})),this.deleteMap.set(n,r)})),this.projection.registerHandler("value.changed",(t=>{(0,s.isNullOrUndefined)(this.deleteElem)||this.deleteElem.remove(),this.deleteMap.get("default").remove();const e=t.name||t;let n=this.deleteMap.get(e);if(!n.dataset.focusable||this.focused)return(0,s.isNullOrUndefined)(n)?(this.container.append(this.deleteMap.get("default")),void(this.deleteElem=this.deleteMap.get("default"))):(this.container.append(n),void(this.deleteElem=n));this.deleteElem=n})),this.source.hasValue()?(this.container.append(this.deleteMap.get(this.source.value)),this.deleteElem=this.deleteMap.get(this.source.value)):(this.container.append(this.deleteMap.get("default")),this.deleteElem=this.deleteMap.get("default"));break;default:const{focus:e,coordinates:n,dimensions:i,render:a}=this.schema.rmv;let r=da.call(this,a);r.setAttribute("x",n.x),r.setAttribute("y",n.y),this.container.append(r),r.addEventListener("click",(()=>{this.source.delete()})),e&&(this.rmv=r)}},findItem(t){for(let e=0;e<this.items.length;e++)if(this.items[e].render.dataset.concept===t)return this.items[e]},findAncestor(t){for(let e=0;e<this.items.length;e++)if(this.items[e].render.contains(t))return this.items[e]},findAnchorIndex(t){for(let e=0;e<this.items.length;e++)if(this.items[e].render===t)return this.items[e].index},findAnchorIndex(t){return this.anchors.indexes[t]},updateSize(){if(this.wrapped)return void this.updateSizeWrap();if(this.fixed)return;let t=this.container.querySelector("[data-adapter]");Ti[t.tagName].call(this,t),(0,s.isNullOrUndefined)(this.parent)||this.parent.updateSize()},updateSizeWrap(){if((0,s.isEmpty)(this.content))return this.width=0,this.height=0,this.container.setAttribute("width",0),void this.container.setAttribute("width",0);let t=this.content[0],e=this.getBox(t),n=e.x,i=e.y,a=e.x+e.width,r=e.y+e.height;for(let t=0;t<this.content.length;t++)e=this.getBox(this.content[t]),n=Math.min(n,e.x),i=Math.min(i,e.y),a=Math.min(a,e.x+e.width),r=Math.min(r,e.y+e.height);this.containerView={x:n,y:i,w:a-n,h:r-i},this.container.setAttribute("viewBox",this.containerView.x+" "+this.containerView.y+" "+this.containerView.w+" "+this.containerView.h),this.container.setAttribute("width",this.containerView.w),this.container.setAttribute("height",this.containerView.h),this.width=this.containerView.w,this.height=this.containerView.h,(0,s.isNullOrUndefined)(this.parent)||this.parent.updateSize()},getBox(t){let e=t.container||t.element;return e.getBBox(),(0,s.isNullOrUndefined)(t.width)?e.getBBox():{width:t.width,height:t.height,x:(0,s.valOrDefault)(Number(e.getAttribute("x")),0),y:(0,s.valOrDefault)(Number(e.getAttribute("y")),0)}}},Di={init(){const{dimensions:t={}}=this.schema;return this.ratio=.4,this.width=(0,s.valOrDefault)(t.width,500),this.height=(0,s.valOrDefault)(t.height,500),this.buttons=[],this.dummies=[],this.transLink=[],this.transLinkId=[],this.arrowInventory=[],this.linkInventory=new Map,this},render(){const{dimensions:t,style:e}=this.schema,n=(0,s.createDocFragment)();return(0,s.isNullOrUndefined)(this.instances)&&(this.instances=new Map),(0,s.isNullOrUndefined)(this.holders)&&(this.holders=new Map),(0,s.isHTMLElement)(this.container)||(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="force",this.container.dataset.id=this.id,this.container.tabindex=1,this.container.id=this.id),t&&(this.container.setAttribute("width",t.width),this.container.setAttribute("height",t.height)),this.focusable=!0,(0,s.isHTMLElement)(this.ids)||(this.ids=[]),n.hasChildNodes()&&this.container.append(n),e&&(this.container.style=e),(0,s.isNullOrUndefined)(this.content)&&(this.content=[]),this.bindEvents(),this.container},setUpForce(){const{intensity:t,linkval:e}=this.schema.force;this.force=d3.layout.force().size([this.width,this.height]).nodes([]).links([]).linkDistance(e).charge(t).on("tick",this.ticked.bind(this));var n=d3.select("#"+this.id);this.nodes=this.force.nodes(),this.node=n.selectAll("svg"),this.links=this.force.links(),this.link=n.selectAll(".link"+this.id),this.force.start()},restart(){let t=d3.select("#"+this.id);this.node=t.selectAll(".node"+this.id).data(this.nodes),(0,s.isNullOrUndefined)(this.links)||(0,s.isEmpty)(this.links)||(this.link=t.selectAll(".link"+this.id).data(this.links)),console.log(this.nodes),this.force.start()},addItem(t){if((0,s.isNullOrUndefined)(this.force)&&this.setUpForce(this.width,this.height,this.intensity,this.direction),"prototype"===t.schema.nature)if(t.hasValue())for(let e=0;e<this.nodes.length;e++)this.nodes[e].concept===t.id&&(this.nodes[e].meta=this.nodes[e].concept,this.nodes[e].concept=t.getValue(!0).id);else t.register(this.projection),this.projection.registerHandler("value.changed",(e=>{if(t.hasValue())for(let e=0;e<this.nodes.length;e++)this.nodes[e].concept===t.id&&(this.nodes[e].meta=this.nodes[e].concept,this.nodes[e].concept=t.getValue(!0).id)}));let e=this.createItem(t,this.schema.tag);e.classList.add("node"+this.id),this.container.append(e);let n=this.projection.resolveElement(e);if(n.projection.update("displayed"),console.log(n),this.content.push(n),"prototype"===t.schema.nature)if(t.force)t.force.index=this.nodes.length,t.force.id=n.id,this.nodes.push(t.force),t.force=this.nodes[this.nodes.length-1];else{const e={nbLink:0,points:[],width:n.width,height:n.height,id:n.id,concept:t.id};this.nodes.push(e),t.force=e}else if(t.force)t.force.index=this.nodes.length,t.force.id=n.id,this.nodes.push(t.force),t.force=this.nodes[this.nodes.length-1];else{const i={nbLink:0,points:[],width:n.width,height:n.height,id:n.id,concept:t.id,shape:this.computeShape(e)};this.nodes.push(i),t.force=i}this.restart()},checkForContent(t,e){const n=this.findIndex(t),i=this.findIndex(e);return n>=0&&i>=0},addArrow(t,e,n){if((0,s.isNullOrUndefined)(this.force)&&this.setUpForce(),(0,s.isNullOrUndefined)(this.links)&&(this.links=this.force.links()),this.containsArrow(t,e,n))return;this.containsTransArrow(t,e,n),this.force.stop();const i=e.id||e,a=n.id||n,r=this.findIndex(i),o=this.findIndex(a);if(r<0||o<0){let i=this.environment.getReceivers(this.projection.rtag);for(let s=0;s<i.length;s++)if(i[s].checkForContent(e,n))return t.projection.parent=i[s],void i[s].addArrow(t,e,n);return this.environment.getRootReceiver(this.projection.rtag).addTransLink(t,e,n),void this.restart()}let l=this.linkInventory.get(r+","+o);(0,s.isNullOrUndefined)(l)?(this.linkInventory.set(r+","+o,{length:1}),this.links.push({source:r,target:o,id:t.id,indexL:1})):(l.length++,this.links.push({source:r,target:o,id:t.id,indexL:l.length})),t.path.classList.add("link"+this.id),this.container.append(t.path),t.definitions&&this.container.append(t.definitions),this.addDummy(t,t.decorator,this.links.length-1),this.restart()},addDummy(t,e,n){if((0,s.isNullOrUndefined)(e)){let t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("node"+this.id),t.classList.add("dummy"),this.container.append(t),this.nodes.push({dummy:!0,ref:n,fixed:!0,width:10,height:10})}else{this.container.append(e),e.classList.add("node"+this.id),e.classList.add("dummy");const t=e.getBBox();this.nodes.push({dummy:!0,ref:n,fixed:!0,width:t.width,height:t.height})}},addTransLink(t,e,n){t.projection.parent=this,(0,s.isNullOrUndefined)(this.transLinks)&&(this.transLinks=[]),this.transLinks.push({id:t.id,from:e.id||e,to:n.id||n,arrow:t}),this.container.append(t.path),t.definitions&&this.container.append(t.definitions),this.restart()},containsTransArrow(t,e,n){if(!(0,s.isNullOrUndefined)(this.transLinks))for(let e=0;e<this.transLinks.length;e++)if(this.transLinks[e].id===t.id)return void this.transLinks.splice(e,1)},containsArrow(t,e,n){for(let i=0;i<this.links.length;i++)if(this.links[i].id===t.id){const a=e.id||e,r=n.id||n,o=this.findIndex(a),l=this.findIndex(r);if(o<0||l<0)this.removeArrow(t,i),this.addTransLink(t,e,n);else{let t=this.links[i].source.index,e=this.links[i].target.index;if(!(0,s.isNullOrUndefined)(this.linkInventory.get(t+","+e))){let n=this.linkInventory.get(t+","+e);n.length--,n.length<=0&&this.linkInventory.delete(t+","+e)}this.links[i].source=o,this.links[i].target=l,(0,s.isNullOrUndefined)(this.linkInventory.get(o+","+l))?this.linkInventory.set(o+","+l,{length:1}):this.linkInventory.get(o+","+l).length++}return this.restart(),!0}return!1},removeArrow(t,e=-1,n,i){if((0,s.isNullOrUndefined)(this.links))return;let a=0;if(e>=0){if(!(0,s.isNullOrUndefined)(this.linkInventory.get(this.links[e].source.index+","+this.links[e].target.index))){let t=this.linkInventory.get(this.links[e].source.index+","+this.links[e].target.index);t.length--,0===t.length&&this.linkInventory.delete(this.links[e].source.index+","+this.links[e].target.index)}return this.links.splice(e,1),t.decorator&&(a=this.removeDummy(e),t.decorator.remove()),t.path.remove(),this.restart(),a}for(let e=0;e<this.links.length;e++)if(this.links[e].id===t.id){if(!(0,s.isNullOrUndefined)(this.linkInventory.get(this.links[e].source.index+","+this.links[e].target.index))){let t=this.linkInventory.get(this.links[e].source.index+","+this.links[e].target.index);t.length--,0===t.length&&this.linkInventory.delete(this.links[e].source.index+","+this.links[e].target.index)}return t.decorator&&(a=this.removeDummy(e),t.decorator.remove()),this.links.splice(e,1),t.path.remove(),void this.restart()}},findIndex(t){for(let e=0;e<this.nodes.length;e++)if(this.nodes[e].concept===t)return e;return-1},createItem(t,e){console.log("Item");const n=this.schema.item;console.log(n);let i=this.model.createProjection(t,n);i.optional=!0;let s=i.init().render();return i.element.parent=this,this.instances.set(i.element.source.id,s),s},removeItem(t){let e;for(this.force.stop(),e=0;e<this.nodes.length&&this.nodes[e].meta!==t.id&&this.nodes[e].concept!==t.id;e++);if((0,s.isNullOrUndefined)(this.links)||(0,s.isEmpty)(this.links))return this.nodes.splice(e,1),void this.restart();for(let t=0;t<this.links.length;t++){let n;if(this.links[t].source.index===e||this.links[t].target.index===e){let i=this.projection.model.getArrow(this.links[t].id);n=this.removeArrow(i,t,null,e),t--}(0,s.isNullOrUndefined)(this.links[t])||(this.links[t].source.index>e&&this.links[t].source.index--,this.links[t].target.index>e&&this.links[t].target.index--)}this.nodes.splice(e,1),this.restart()},removeDummy(t){for(let e=0;e<this.nodes.length;e++)this.nodes[e].ref===t&&(this.nodes.splice(e,1),e--),this.nodes[e].ref>t&&this.nodes[e].ref--},ticked(){let t=!0;for(;t&&!(0,s.isEmpty)(this.nodes);)this.nodes.forEach((e=>{this.nodes.forEach((n=>{t=this.collide(e,n)}))}));let e=this.links,n=this.container,i=this.linkInventory;const a=this.width,r=this.height;(0,s.isNullOrUndefined)(this.link)||(0,s.isEmpty)(this.links)||this.link.attr("d",(function(t){if(t.source===t.target)return;const e=Hi.computeBorder(t.source,t.target),n=Hi.computeBorder(t.target,t.source);let s=n.x-e.x,a=n.y-e.y,r=Math.sqrt(s*s+a*a);t.dr=r,t.s=e,t.t=n;let o=i.get(t.source.index+","+t.target.index);return o.length>1&&(r/=1+1/o.length*(t.indexL-1)),"M"+n.x+","+n.y+"A"+r+","+r+" 0 0 1,"+e.x+","+e.y+"A"+r+","+r+" 0 0 0,"+n.x+","+n.y})),this.node.attr("x",(function(t){if(!(0,s.isNullOrUndefined)(t.ref)){let a=e[t.ref].dr,r=i.get(e[t.ref].source.index+","+e[t.ref].target.index);r.length>1&&(a/=1+1/r.length*(e[t.ref].indexL-1));let o=Hi.getEllipseCenter(a,e[t.ref].s,e[t.ref].t,n),l=Hi.getPerpendicularLine(e[t.ref].s,e[t.ref].t),c=Hi.getPointConstructedEllipse(l,a,a,o),h=Hi.getCloserBorder(c,e[t.ref].t);return t.fx=h.x,(0,s.isNullOrUndefined)(t.width)?h.x:(t.fx=h.x-t.width/2,h.x-t.width/2)}return(t.x=Math.max(t.width/2,Math.min(a-t.width/2,t.x)))-t.width/2})).attr("y",(function(t){if(!(0,s.isNullOrUndefined)(t.ref)){let a=e[t.ref].dr,r=i.get(e[t.ref].source.index+","+e[t.ref].target.index);r.length>1&&(a/=1+1/r.length*(e[t.ref].indexL-1));let o=Hi.getEllipseCenter(a,e[t.ref].s,e[t.ref].t,n),l=Hi.getPerpendicularLine(e[t.ref].s,e[t.ref].t),c=Hi.getPointConstructedEllipse(l,a,a,o),h=Hi.getCloserBorder(c,e[t.ref].t);return t.fy=h.y,(0,s.isNullOrUndefined)(t.height)?h.y:h.y-t.height/2}return(t.y=Math.max(t.height/2,Math.min(r-t.height/2,t.y)))-t.height/2}))},analyseContentDim(){this.content.forEach((t=>{for(let e=0;e<this.nodes.length;e++)if(this.nodes[e].id===t.id){this.nodes[e].width=t.width,this.nodes[e].height=t.height,this.nodes[e].shape=this.computeShape(t.container||t.element);break}})),this.force.start()},computeRelativeShape(t,e){const n=e.querySelector("[data-shape]");if((0,s.isUndefined)(n))return;const i=t.getBoundingClientRect(),a=n.getBoundingClientRect(),r=e.getBoundingClientRect(),o=Number(t.getAttribute("width")),l=Number(t.getAttribute("height")),c={};c.width=o*a.width/i.width,c.height=l*a.height/i.height;const h=t.createSVGPoint();h.x=a.x,h.y=a.y;const u=h.matrixTransform(t.getScreenCTM().inverse());c.x=u.x,c.y=u.y;const d={};d.width=o*r.width/i.width,d.height=l*r.height/i.height;const p=t.createSVGPoint();p.x=a.x,p.y=a.y;const m=p.matrixTransform(t.getScreenCTM().inverse());let f;switch(d.x=m.x,d.y=m.y,n.tagName){case"circle":return{type:"circle",r:c.width/2};case"ellipse":return f=Number(n.getAttribute("width"))/a.width,r.width,f=Number(n.getAttribute("height"))/a.height,r.height,{type:"ellipse",rx:c.width/2,ry:c.height/2};default:f=Number(n.getAttribute("width"))/a.width;const t=r.width*f;return f=Number(n.getAttribute("height"))/a.height,{type:"rect",w:t,h:r.height*f}}},computeShape(t){const e=t.querySelector("[data-shape]");if(console.log("ComputingShape"),console.log(e),(0,s.isNullOrUndefined)(e))return;const n=e.getBBox(),i=t.getBoundingClientRect();let a;switch(console.log(n),console.log(i),e.tagName){case"circle":return a=Number(e.getAttribute("r"))/(n.width/2),{type:"circle",r:i.width*a/2};case"ellipse":a=Number(e.getAttribute("width"))/n.width;const t=i.width*a;return a=Number(e.getAttribute("height"))/n.height,{type:"ellipse",rx:t,ry:i.height*a};case"polygon":let s=e.getAttribute("data-points").split(" "),r=[];for(let t=0;t<s.length;t++)r.push({x:Number(s[t].split(",")[0])/n.width,y:Number(s[t].split(",")[1])/n.height});return{type:"polygon",points:r};case"rect":return{type:"rect",w:n.width,h:n.height,yOff:n.y,xOff:n.x};default:a=Number(e.getAttribute("width"))/n.width;const o=i.width*a;return a=Number(e.getAttribute("height"))/n.height,{type:"rect",w:o,h:i.height*a}}},collide(t,e){let n=!1;const i=this.width,a=this.height;if(!(0,s.isNullOrUndefined)(t.ref)&&!(0,s.isNullOrUndefined)(e.ref))return n;if(!(0,s.isNullOrUndefined)(t.ref)){if(t.fx<e.x&&t.fy<e.y&&t.fx+t.width/2>e.x-e.width/2&&t.fy+t.height>e.x-e.height/2){let n=t.fx+t.width/2-(e.x-e.width/2),i=1.1*(t.fy+t.height/2-(e.y-e.height/2));switch(Math.min(n,i)){case n:e.x+=n;break;case i:e.y+=i}}else if(t.fx>e.x&&t.fy<e.y&&e.x+e.width/2>t.fx-t.width/2&&t.fy+t.height/2>e.y-e.height/2){let n=e.x+e.width/2-(t.fx-t.width/2),i=1.1*(t.fy+t.height/2-(e.y-e.height/2));switch(Math.min(n,i)){case n:e.x-=n;break;case i:e.y+=i}}else if(t.fx>e.x&&t.fy>e.y&&e.x+e.width/2>t.fx-t.width/2&&e.y+e.height/2>t.fy-t.height){let n=e.x+e.width/2-(t.fx-t.width/2),i=1.1*(e.y+e.height/2-(t.fy-t.height/2));switch(Math.min(n,i)){case n:e.x-=n;break;case i:e.y-=i}}else if(t.fx<e.x&&t.fy>e.y&&t.fx+t.width/2>e.x-e.width/2&&t.fy-t.height<e.y+e.height/2){let n=t.x+t.width-(e.x-e.width/2),i=1.1*(e.y+e.height/2-(t.y-t.height/2));switch(Math.min(n,i)){case n:e.x+=n;break;case i:e.y-=i}}return n}if(!(0,s.isNullOrUndefined)(e.ref)){if(t.x<e.fx&&t.y<e.fy&&t.x+t.width/2>e.fx-e.width/2&&t.y+t.height/2>e.fx-e.height/2){let n=t.x+t.width/2-(e.fx-e.width/2),i=1.1*(t.y+t.height/2-(e.fy-e.height/2));switch(Math.min(n,i)){case n:t.x-=n;break;case i:t.y-=i}}else if(t.x>e.fx&&t.y<e.fy&&e.fx+e.width/2>t.x-t.width/2&&t.y+t.height/2>e.fy-e.height/2){let n=e.fx+e.width/2-(t.x-t.width/2),i=1.1*(t.y+t.height/2-(e.fy-e.height/2));switch(Math.min(n,i)){case n:t.x+=n;break;case i:t.y-=i}}else if(t.x>e.fx&&t.y>e.fy&&e.fx+e.width/2>t.x-t.width/2&&e.fy+e.height/2>t.y-t.height/2){let n=e.fx+e.width/2-(t.x-t.width/2),i=1.1*(e.fy+e.height/2-(t.y-t.height/2));switch(Math.min(n,i)){case n:t.x+=n;break;case i:t.y+=i}}else if(t.x<e.fx&&t.y>e.fy&&t.x+t.width/2>e.fx-e.width/2&&t.y-t.height/2<e.fy+e.height/2){let n=t.x+t.width/2-(e.fx-e.width/2),i=1.1*(e.fy+e.height/2-(t.y-t.height/2));switch(Math.min(n,i)){case n:t.x-=n;break;case i:t.y+=i}}return n}if(e&&e!==t)if(t.x<=e.x&&t.y<=e.y&&t.x+t.width/2>=e.x-e.width/2&&t.y+t.height/2>=e.y-e.height/2){let n=t.x+t.width/2-(e.x-e.width/2),s=1.1*(t.y+t.height/2-(e.y-e.height/2));switch(Math.min(n,s)){case n:if(t.x-n/2<0){e.x+=n;break}if(e.x+n/2>i){t.x-=n;break}t.x-=n/2,e.x+=n/2;break;case s:if(t.y-s/2<0){e.x+=s;break}if(e.y+s/2>a){t.x-=s;break}t.y-=s/2,e.y+=s/2}}else if(t.x>e.x&&t.y<e.y&&e.x+e.width/2>t.x-t.width/2&&t.y+t.height/2>e.y-e.height/2){let n=e.x+e.width/2-(t.x-t.width/2),s=1.1*(t.y+t.height/2-(e.y-e.height/2));switch(Math.min(n,s)){case n:if(t.x+n/2>i){e.x-=n;break}if(e.x-n/2<0){t.x+=n;break}t.x+=n/2,e.x-=n/2;break;case s:if(t.y-s/2<0){e.x+=s;break}if(e.y+s/2>a){t.x-=s;break}t.y-=s/2,e.y+=s/2}}else if(t.x>e.x&&t.y>e.y&&e.x+e.width/2>t.x-t.width/2&&e.y+e.height/2>t.y-t.height/2){let n=e.x+e.width/2-(t.x-t.width/2),s=1.1*(e.y+e.height/2-(t.y-t.height/2));switch(Math.min(n,s)){case n:if(t.x+n/2>i){e.x-=n;break}if(e.x-n/2<0){t.x+=n;break}t.x+=n/2,e.x-=n/2;break;case s:if(t.y+s/2>a){e.y-=s;break}if(e.y-s/2<0){t.y+=s;break}t.y+=s/2,e.y-=s/2}}else if(t.x<e.x&&t.y>e.y&&t.x+t.width/2>e.x-e.width/2&&t.y-t.height/2<e.y+e.height/2){let n=t.x+t.width/2-(e.x-e.width/2),s=1.1*(e.y+e.height/2-(t.y-t.height/2));switch(Math.min(n,s)){case n:if(t.x-n/2<0){e.x+=n;break}if(e.x+n/2>i){t.x-=n;break}t.x-=n/2,e.x+=n/2;break;case s:if(t.y+s/2>a){e.y-=s;break}if(e.y-s/2<0){t.y+=s;break}t.y+=s/2,e.y-=s/2}}return n},focus(){return this.container.focus(),this},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this.container.focus(),this},focusOut(){return this.focused=!1,this.container.classList.remove("active"),this.container.classList.remove("focus"),this},updateSize(){for(let t=0;t<this.nodes.length;t++)if(!this.nodes[t].dummy){let e=this.instances.get(this.nodes[t].meta||this.nodes[t].concept);console.log("UpdatingSize Here?"),console.log(e),console.log(this.instances),console.log(this.nodes[t]),console.log(t),console.log(this.nodes);let n=this.projection.resolveElement(e);this.nodes[t].width=n.width,this.nodes[t].height=n.height,this.nodes[t].shape=this.computeShape(e)}this.restart()},bindEvents(){this.projection.registerHandler("value.added",(t=>{this.addItem(t)})),this.projection.registerHandler("value.removed",(t=>{this.removeItem(t)})),this.projection.registerHandler("displayed",(()=>{(0,s.isEmpty)(this.source.value)||this.source.values.forEach((t=>{this.addItem(t),"prototype"===value.schema.nature&&(this.nodes[this.nodes.length-1].meta=this.nodes[i].concept,this.nodes[this.nodes.length-1].concept=value.getValue(!0).id)}))}))}},Hi={getPointEllipse(t,e,n){const i=n.rx/2,s=n.ry/2,a=t.x,r=t.y,o=this.getDeq(t,e);let l=s*s+i*i*o.a*o.a,c=2*i*i*o.a*o.b-2*a*s*s-2*r*o.a*i*i,h=c*c-4*l*(a*a*s*s+i*i*r*r+i*i*o.b*o.b-2*r*i*i*o.b-i*i*s*s);if(h>=0){let t=(-c-Math.sqrt(h))/(2*l),e=t*o.a+o.b,n=(-c+Math.sqrt(h))/(2*l);return{x1:{x:t,y:e},x2:{x:n,y:n*o.a+o.b}}}},getPointConstructedEllipse(t,e,n,i){const s=e,a=n,r=i.x,o=i.y;let l=a*a+s*s*t.a*t.a,c=2*s*s*t.a*t.b-2*r*a*a-2*o*t.a*s*s,h=c*c-4*l*(r*r*a*a+s*s*o*o+s*s*t.b*t.b-2*o*s*s*t.b-s*s*a*a);if(h>=0){let e=(-c-Math.sqrt(h))/(2*l),n=e*t.a+t.b,i=(-c+Math.sqrt(h))/(2*l);return[{x:e,y:n},{x:i,y:i*t.a+t.b}]}},getEllipseCenter(t,e,n,i){let s=(e.x-n.x)/2,a=(e.y-n.y)/2,r=-Math.sqrt((t*t*(t*t)-t*t*(a*a)-t*t*(s*s))/(t*t*(a*a)+t*t*s*s)),o=r*(-t*s/t);return{x:r*(t*a/t)+(e.x+n.x)/2,y:o+(e.y+n.y)/2}},getPerpendicularLine(t,e){let n=(t.x+e.x)/2,i=(t.y+e.y)/2,s=-1/Hi.getDeq(t,e).a;return{a:s,b:i-s*n}},getSelfPointEllipse(t){let e={x:t.x-t.ellipse.rx/2,y:t.y},n={x:t.x+t.ellipse.rx/2,y:t.y},i={x:t.x,y:t.y-t.ellipse.ry/2},s={x:t.x,y:t.y-t.ellipse.ry/2},a=0,r=0,o=0,l=0;switch(t.points.forEach((t=>{a+=Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)),r+=Math.sqrt((t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y)),o+=Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)),l+=Math.sqrt((t.x-s.x)*(t.x-s.x)+(t.y-s.y)*(t.y-s.y))})),Math.max(a,r,o,l)){case o:return{x:i.x,y:i.y,direction:"top"};case r:return{x:n.x,y:n.y,direction:"right"};case l:return{x:s.x,y:s.y,direction:"bot"};default:return{x:e.x,y:e.y,direction:"left"}}},getPointPolygon(t,e,n){let i=[];n.points.forEach((e=>{i.push({x:e.x*t.width+t.x-t.width/2,y:e.y*t.height+t.y-t.height/2})}));let s=i[0].x-e.x,a=i[0].y-e.y,r=Math.sqrt(s*s+a*a),o=r,l=0;for(let t=1;t<i.length;t++)s=i[t].x-e.x,a=i[t].y-e.y,r=Math.sqrt(s*s+a*a),r<o&&(o=r,l=t);return i[l]},getDeq(t,e){let n=(e.y-t.y)/(e.x-t.x);return{a:n,b:t.y-n*t.x}},getCloserBorder(t,e){let n=Math.sqrt((t[0].x-e.x)*(t[0].x-e.x)+(t[0].y-e.y)*(t[0].y-e.y));return Math.sqrt((t[1].x-e.x)*(t[1].x-e.x)+(t[1].y-e.y)*(t[1].y-e.y))<n?t[1]:t[0]},getPointRect(t,e,n){let i=t.x-t.width/2+n.xOff,s=t.y-t.height/2+n.yOff,a=s,r=t.x-t.width/2+n.xOff+n.w,o=t.y-t.height/2+n.yOff+n.h;console.log(t),console.log(e),console.log(i,s,r,a,o);let l=Hi.getDeq({x:t.x,y:t.y},{x:e.x,y:e.y}),c=Hi.getDeq({x:i,y:s},{x:r,y:a}),h=Hi.getLineIntersection(l,c);return h&&h.x>i&&h.x<r?[h,{x:(o-l.b)/l.a,y:o}]:[{x:r,y:l.a*r+l.b},{x:i,y:l.a*i+l.b}]},getLineIntersection(t,e){if(t.a===e.a)return!1;let n=t.a-e.a,i=e.b-t.b;return{x:i/n,y:t.a*(i/n)+t.b}},getPointCircle(t,e,n){let i=Hi.getDeq({x:t.x,y:t.y},{x:e.x,y:e.y}),s=i.a*i.a+1,a=2*i.a*i.b-2*i.a*t.y-2*t.x,r=a*a-4*s*(i.b*i.b-i.b*t.y*2+t.y*t.y+t.x*t.x-n.r*n.r);if(r>0){let t=(-a+Math.sqrt(r))/(2*s),e=(-a-Math.sqrt(r))/(2*s);return[{x:t,y:i.a*t+i.b},{x:e,y:i.a*e+i.b}]}},computeBorder(t,e){let n={},i={};switch(t.shape.type){case"rect":return n=Hi.getPointRect(t,e,t.shape),i=Hi.getCloserBorder(n,e),i;case"circle":return n=Hi.getPointCircle(t,e,t.shape),i=Hi.getCloserBorder(n,e),i;case"ellipse":return n=Hi.getPointEllipse(t,e,t.shape),i=Hi.getCloserBorder(n,e),i;case"polygon":return n=Hi.getPointPolygon(t,e,t.shape),n}}},Pi=Object.assign({},Ui,Di),Ri={init(){const{dimensions:t}=this.schema;return this.dimensions=t,this},render(){(0,s.createDocFragment)();const{dimensions:t,saturation:e,overflow:n=!1,create:i,add:a,style:r}=this.schema;if(this.focusable=!0,(0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),t&&(this.container.setAttribute("width",t.width),this.container.setAttribute("height",t.height)),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="pattern",this.container.dataset.id=this.id,this.container.dataset.click="container",this.container.tabIndex=0),n&&(this.container.style.overflow="visible"),e&&(this.saturation=e.value,this.satTarget=e.target,(0,s.isNullOrUndefined)(e.satParams)||(this.satParams=e.satParams),(0,s.isNullOrUndefined)(e.acceptTarget)||(this.acceptTarget=e.acceptTarget)),(0,s.isNullOrUndefined)(this.anchors)&&this.setUpAnchors(),a&&(0,s.isNullOrUndefined)(this.add)){const{coordinates:t=!1,render:e}=a;this.add=da.call(this,e),t?(this.add.setAttribute("x",t.x),this.add.setAttribute("y",t.y)):(this.add.setAttribute("x",this.anchors.current.x),this.add.setAttribute("y",this.anchors.current.y)),this.container.append(this.add),this.add.style.overflow="visible",this.add.addEventListener("click",(()=>{}))}return this.displayed=!1,r&&(this.container.style=r),this.bindEvents(),i&&this.source.createElement(),r&&(this.container.style=r),this.container},checkDim(t,e,n){e+20+Number(n.getAttribute("y"))>Number(this.items[0].render.getAttribute("height"))&&this.items.forEach((t=>{this.projection.resolveElement(t.render).augment()}))},checkSpeDim(t,e,n){for(;e+20+Number(n.getAttribute("y"))>Number(this.items[this.items.length-1].render.getAttribute("height"));)this.projection.resolveElement(this.items[this.items.length-1].render).augment()},createItem(t){const{tag:e}=this.schema.pattern;let n=this.model.createProjection(t,e);return n.optional=!0,n.parent=this.projection,{render:n.init().render(),projection:n}},addItem(t){if(this.saturation&&((0,s.isNullOrUndefined)(this.count)&&(this.count=0),this.count>=this.saturation))return this.environment.getActiveReceiver(this.satTarget).source.createElement(),void this.saturate(t);let{render:e,projection:n}=this.createItem(t);(0,s.isNullOrUndefined)(this.dimSchema)&&(this.dimSchema=new Map),this.dimSchema.set(e.dataset.id,an.analyseDim(e,this.schema.pattern)),this.container.append(e);let i=this.anchors.current;(0,s.isNullOrUndefined)(this.items)&&(this.items=[]),this.items.push({render:e,position:i,index:this.anchorIndex,id:t.id}),this.displayed?(an.setDimensions(this.dimSchema.get(e.dataset.id)),n.update("displayed",e.dataset.id)):((0,s.isNullOrUndefined)(this.waiting)&&(this.waiting=[]),this.waiting.push({render:e,projection:n})),(0,s.isNullOrUndefined)(this.anchors)&&this.setUpAnchors(),an.positionElement(i,e),this.nextAnchor(!0),this.count++,this.warnings&&this.warnings.forEach((t=>{n.warn(t)}))},placeAdd(){this.add.setAttribute("x",this.anchors.current.x),this.add.setAttribute("y",this.anchors.current.y)},setUpAnchors(){const{first:t,next:e}=this.schema.pattern;this.anchors={},this.anchors.current=t,this.anchors.next=e,this.anchors.indexes=[t],this.anchorIndex=0},saturate(t){let e=this.environment.projectionModel.createProjection(this.projection.concept,this.projection.tag).init();e.render(),this.environment.getActiveReceiver("solo").accept(e.element.container,this.satParams.dimension,this.satParams.coordinates),e.element.addItem(t),this.full=!0,this.saturated=!0},accept(t,e=!1){const{render:n,params:i}=t;if(e){let t=this.projection.resolveElement(n);return t.parent=this,void(t.definitions&&this.container.append(t.definitions))}this.container.append(n)},acceptAnchor(t){this.container.append(t);let e=this.anchors.current;this.items.push({render:t,anchor:e,index:this.anchorIndex,id:t.id}),an.positionElement(e,t),this.nextAnchor(!0),this.count++,this.count>=this.saturation&&(this.full=!0)},nextAnchor(t=!1){let{x:e,y:n}=this.anchors.current,i=this.anchors.next.x,a=this.anchors.next.y;this.anchors.current={x:e+i,y:n+a},t&&this.anchorModel&&Qe.AnchorHandler.nextAnchor(this.schema.handler.id,this.id),(0,s.isNullOrUndefined)(this.add)||this.schema.add.coordinates||this.placeAdd(),this.anchors.indexes.push({x:e+i,y:n+a}),this.anchorIndex++,(0,s.isNullOrUndefined)(this.parent)||this.parent.checkAugment(this.anchors.current,this.container)},createHolder(t){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return n.append(t),e.append(n),e},adapt(t,e){let n,i=t.parentNode.parentNode,s=t.parentNode;switch(e.type){case"fixed":i.setAttribute("width",e.value),s.setAttribute("width",e.value),n=t.getBoundingClientRect(),s.setAttribute("height",n.height),s.setAttribute("width",n.width),i.setAttribute("height",n.height*e.value/n.width),i.setAttribute("viewBox","0 0 "+n.width+" "+n.height)}},transmitFirst(){const{render:t,position:e,index:n,id:i}=this.items[0];return this.removeItem({id:i}),t},removeItem(t){let e,n;for(n=0;n<this.items.length;n++)if(this.items[n].id===t.id){const{position:t}=this.items[n];e=t;break}if(n>=this.items.length||(0,s.isNullOrUndefined)(this.items[n]))return;const i=this.items[n].index;for(this.items.splice(n,1),n>this.items.length&&n--;n<this.items.length;){let t=this.items[n].position;this.items[n].position=e,this.items[n].render.setAttribute("x",e.x),this.items[n].render.setAttribute("y",e.y),this.items[n].index--,e=t,n++}this.anchors.indexes.splice(this.anchors.indexes.length-1,1),this.anchors.current=this.anchors.indexes[this.anchors.indexes.length-1],(0,s.isNullOrUndefined)(this.add)||this.schema.add.coordinates||this.placeAdd(),(0,s.isNullOrUndefined)(this.parent)||this.parent.checkAugment(this.anchors.current,this.container),this.anchorModel&&Qe.AnchorHandler.deleteItem(this.schema.handler.id,this.id,i),(0,s.isNullOrUndefined)(this.count)||(this.count--,this.full&&(this.full=!1,this.environment.saturationRevolved(this,this.projection.rtag),this.saturated=!0),this.count)},removeAnchor(t){if(!(0,s.isNullOrUndefined)(this.items))for(let e=0;e<this.items.length;e++)this.items[e].index>t&&(this.items[e].position.x-=this.anchors.next.x,this.items[e].position.y-=this.anchors.next.y,this.items[e].render.setAttribute("x",this.items[e].position.x),this.items[e].render.setAttribute("y",this.items[e].position.y),this.items[e].index--);this.anchors.indexes.splice(this.anchors.indexes.length-1,1),this.anchors.current=this.anchors.indexes[this.anchors.indexes.length-1],(0,s.isNullOrUndefined)(this.add)||this.schema.add.coordinates||this.placeAdd(),(0,s.isNullOrUndefined)(this.parent)||this.parent.checkAugment(this.anchors.current,this.container)},moveElemToAnchor(t,e){this.anchors.indexes.length<=t+1&&(this.nextAnchor(!0),(0,s.isNullOrUndefined)(this.add)||this.schema.add.coordinates||this.placeAdd());let n=this.anchors.indexes[t];this.items[e].position=n,this.items[e].index=t;let i=this.items[e].render;return i.setAttribute("x",n.x),i.setAttribute("y",n.y),i},increaseAnchors(t,e,n,i){e>this.anchors.indexes.length&&this.nextAnchor(!0),(0,s.isNullOrUndefined)(this.items)||this.items.forEach((s=>{s.render!==n&&s.index>=t&&s.index<=e&&(s.index++,i.includes(s.index)?this.projection.resolveElement(s.render).increaseAnchor():(s.position=this.anchors.indexes[s.index],s.render.setAttribute("x",s.position.x),s.render.setAttribute("y",s.position.y)))}))},decreaseAnchors(t,e,n,i){(0,s.isNullOrUndefined)(this.items)||this.items.forEach((s=>{s.render!==n&&s.index>=t&&s.index<=e&&(s.index--,i.includes(s.index)?this.projection.resolveElement(s.render).decreaseAnchor():(s.position=this.anchors.indexes[s.index],s.render.setAttribute("x",s.position.x),s.render.setAttribute("y",s.position.y)))}))},clickHandler(t){},focusIn(){return this.add&&this.container.append(this.add),this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.hide&&this.add&&this.add.remove(),this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.projection.registerHandler("displayed",(t=>{this.displayed||(this.displayed=!0,(0,s.isNullOrUndefined)(this.waiting)||this.waiting.forEach((t=>{let{render:e,projection:n}=t;an.setDimensions(this.dimSchema.get(e.dataset.id)),n.update("displayed")}))),this.schema.handler&&(this.anchorModel=Qe.AnchorHandler.create(this,this.schema.handler))})),this.projection.registerHandler("value.added",(t=>{this.full?this.saturated||this.saturate():this.addItem(t)})),this.projection.registerHandler("value.removed",(t=>{this.removeItem(t)}))}},Bi=Object.assign({},Ui,Ri),{isHTMLElement:Vi,createDiv:zi,isNullOrUndefined:Fi,createDocFragment:qi,isEmpty:$i,isNull:Wi,valOrDefault:Zi,isUndefined:Xi}=n(835),Yi={init(){return this},render(){const{content:t=[],coordinates:e=!1,overflow:n=!1,background:i,data:s=!1,reference:a=!1,dimensions:r=!1,style:o,rmv:l=!1,anchor:c=!1}=this.schema,h=qi(),u=new DOMParser;if(Fi(this.container)){if(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),i&&(this.background=u.parseFromString(i.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.background.childNodes.forEach((t=>{this.container.append(t)})),this.container.setAttribute("width",this.background.getAttribute("width")),this.container.setAttribute("height",this.background.getAttribute("height")),this.width=Number(this.background.getAttribute("width")),this.height=Number(this.background.getAttribute("height"))),r&&"wrap"!==r.type){const{width:t,height:e,viewBox:n=!1}=r;this.container.setAttribute("width",t),this.container.setAttribute("height",e),this.width=r.width,this.height=r.height,this.fixed=!0,n&&this.container.setAttribute("viewBox",n.minX+" "+n.minY+" "+n.width+" "+n.height),this.fixed=!0}if("wrap"!==r.type||i||(this.wrapped=!0,this.projection.registerHandler("displayed",(()=>{this.updateSizeWrap()}))),n&&(this.container.style.overflow="visible"),i||r||(this.container.style.overflow="visible"),e){const{x:t,y:n}=e;this.container.setAttribute("x",t),this.container.setAttribute("y",n)}this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="decoration",this.container.dataset.id=this.id,this.container.id=this.id,a&&(this.container.dataset.reference=!0)}return s&&this.container.setAttribute("data-shape",s),c&&(this.attachPoint=c),Fi(this.content)&&!$i(t)&&(this.waiting=[],this.positioning=[],this.itemsPos=new Map,this.itemsDim=new Map,this.content=[],t.forEach((t=>{let e=da.call(this,t.render),n=an.analyseDim(e,t);this.itemsDim.set(e.dataset.id,n);let i=this.projection.resolveElement(e);Fi(i)?this.waitingRendered=!0:(i.source.register(this.projection),this.content.push(i)),n.await&&this.waiting.push(e.dataset.id);let s=an.analysePos(e,t);this.itemsPos.set(e.dataset.id,s),s.await&&this.positioning.push(s),Fi(n.holder)?this.container.append(n.item):this.container.append(n.holder)}))),h.hasChildNodes()&&this.container.append(h),o&&(this.container.style=o),this.displayed=!1,this.bindEvents(),this.container},focus(t){this.container.focus()},focusIn(){return!Fi(this.deleteElem)&&this.deleteElem.dataset.focusable&&this.container.append(this.deleteElem),Fi(this.focusedElement)||this.focusedElement.forEach((t=>{this.container.append(t)})),Fi(this.content)||this.content.forEach((t=>{t.focusIn()})),this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this.rmv&&this.container.append(this.rmv),this},focusOut(){return!Fi(this.deleteElem)&&this.deleteElem.dataset.focusable&&this.deleteElem.remove(),Fi(this.focusedElement)||this.focusedElement.forEach((t=>{t.remove()})),Fi(this.content)||this.content.forEach((t=>{t.focusOut()})),this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this.rmv&&this.rmv.remove(),this},notify(t){this.updateContentDim(t.id)},augment(){let t=this.container.querySelector("[data-augment]");t.setAttribute("height",Number(t.getAttribute("height"))+30),Fi(this.container.getAttribute("height"))||this.container.setAttribute("height",Number(this.container.getAttribute("height"))+30),Wi(this.background)||this.background.setAttribute("height",Number(this.background.getAttribute("height"))+30)},updateContentDim(t){let e=this.itemsDim.get(t),n=this.itemsPos.get(t);"ratio"===e.type&&(an.adaptRatio(e.item,e.ratio),an.positionElement(n,e.holder))},accept(t,e,n){let i=an.analyseDim(t,{dimension:e}),s=an.analysePos(t,{coordinates:n});Fi(this.itemsDim)&&(this.itemsDim=new Map),this.itemsDim.set(t.dataset.id,i),Fi(this.itemsPos)&&(this.itemsPos=new Map),this.itemsPos.set(t.dataset.id,s),this.displayed?(an.setDimensions(i),Fi(i.holder)?an.positionElement(s,t):an.positionElement(s,i.holder)):(Fi(this.content)&&(this.content=[],this.waiting=[],this.positioning=[]),this.content.push(this.projection.resolveElement(t)),i.await&&this.waiting.push(t.dataset.id),s.await&&this.positioning.push(s)),Fi(i.holder)?this.container.append(i.item):this.container.append(i.holder)},analyseContentDim(){if(this.fixed)return;let t=0;if(0===this.content.length)return;for(;t<this.content.length&&Fi(this.content[t]);)t++;if(t>this.content.length)return;let e=this.itemsDim.get(this.content[t].id);if("pure"===e.type){let e,n,i,s;Fi(this.content[t].container)?(e=Number(this.content[t].element.getAttribute("x")),n=Number(this.content[t].element.getAttribute("y")),i=Number(this.content[t].width),s=Number(this.content[t].height)):(e=Number(this.content[t].container.getAttribute("x")),n=Number(this.content[t].container.getAttribute("y")),i=Number(this.content[t].width),s=Number(this.content[t].height)),this.width=e+i,this.height=n+s}for(let n=t+1;n<this.content.length;n++)if(!Fi(this.content[n])&&(e=this.itemsDim.get(this.content[n].id),"pure"===e.type)){let t,e,i,s;Fi(this.content[n].container)?(t=Number(this.content[n].element.getAttribute("x")),e=Number(this.content[n].element.getAttribute("y")),i=Number(this.content[n].width),s=Number(this.content[n].height)):(t=Number(this.content[n].container.getAttribute("x")),e=Number(this.content[n].container.getAttribute("y")),i=Number(this.content[n].width),s=Number(this.content[n].height)),(Fi(this.width)||this.width<t+i)&&(this.width=t+i),(Fi(this.height)||this.height<e+s)&&(this.height=e+s)}this.notifyDimObservers()},clickHandler(t){if(this.container.contains(t)){for(;t!==this.container&&Fi(t.dataset.nature);)t=t.parentNode;t!==this.container&&this.projection.resolveElement(t).clickHandler(t)}return!1},bindEvents(){this.projection.registerHandler("displayed",(t=>{this.displayed||(this.displayed=!0,Fi(this.waiting)||this.waiting.forEach((t=>{an.setDimensions(this.itemsDim.get(t))})),Fi(this.positioning)||this.positioning.forEach((t=>{let e=this.itemsDim.get(t.render.dataset.id);e.holder?an.positionElement(t,e.holder):an.positionElement(t,t.render)})),Fi(this.content)||this.content.forEach((t=>{Fi(t)||t.projection.update("displayed",t.id)})),Fi(this.width)&&this.analyseContentDim(),Fi(this.parent)||this.parent.updateSize())})),this.waitingRendered&&this.projection.registerHandler("binding",(t=>{this.content.push(this.projection.resolveElement(t))}))}},Gi=Object.assign({},Ui,Yi),Ji={init(){return this},render(){const{interaction:t,algorithm:e}=this.schema,n=(0,s.createDocFragment)();if((0,s.isNullOrUndefined)(this.container)&&(this.container=(0,s.createDiv)({id:this.id,class:["algorithm","algorithm--holder"],tabindex:-1,dataset:{nature:"algorithm",view:"holder",id:this.id}})),(0,s.isNullOrUndefined)(this.interactionArea)&&(this.interactionArea=da.call(this,t),n.append(this.interactionArea)),(0,s.isNullOrUndefined)(this.svgArea)){let t=this.source.getAttributeByName(e.name).target,i=this.environment.projectionModel.createProjection(t,e.tag);this.svgArea=i.init().render(),n.append(this.svgArea)}return n.hasChildNodes()&&this.container.append(n),this.container}},Ki=Object.assign({},Ui,Ji),{createDocFragment:Qi,isNullOrUndefined:ts,isEmpty:es,isNull:ns}=n(835),{AnchorHandler:is}=n(185),ss={init(){return this},render(){const{dimensions:t,overflow:e=!1,contains:n,reserve:i,model:s,style:a,offset:r,zindex:o,content:l=[]}=this.schema;if(ts(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="anchor",this.container.dataset.id=this.id),e&&(this.container.style.overflow="visible"),t){const{width:e,height:n}=t;this.container.setAttribute("width",e),this.container.setAttribute("height",n)}return!es(l)&&ts(this.items)&&(this.items=[],l.forEach((t=>{const{coordinates:e,render:n,dimension:i}=t;let s=da.call(this,n);s.setAttribute("x",e.x),s.setAttribute("y",e.y),this.container.append(s),this.items.push(s)}))),s&&(is.createSubModel(s,this),this.anchorModel=s),this.bindEvents(),a&&this.createStyleMimic(a),this.container},focusIn(){},focusOut(){},increaseSize(){const t=Number(this.container.getAttribute("height"));this.container.setAttribute("height",t+this.anchors.y),this.mimic.setAttribute("height",t+this.anchors.y)},decreaseSize(){const t=Number(this.container.getAttribute("height"));this.container.setAttribute("height",t-this.anchors.y),this.mimic.setAttribute("height",t-this.anchors.y)},increaseAnchor(){const t=Number(this.container.getAttribute("y"));this.container.setAttribute("y",t+this.anchors.y)},decreaseAnchor(){const t=Number(this.container.getAttribute("y"));this.container.setAttribute("y",t-this.anchors.y)},createStyleMimic(t){this.mimic=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.mimic.setAttribute("width",this.container.getAttribute("width")),this.mimic.setAttribute("height",this.container.getAttribute("height")),this.mimic.style=t,this.container.prepend(this.mimic)},checkCover(){let t,e;for(let n=0;n<this.covering.length;n++)ts(t)?(t=Math.min(this.covering[n].from.x,this.covering[n].to.x),e=Math.max(this.covering[n].from.x,this.covering[n].to.x)):(t>Math.min(this.covering[n].from.x,this.covering[n].to.x)&&(t=Math.min(this.covering[n].from.x,this.covering[n].to.x)),e<Math.max(this.covering[n].from.x,this.covering[n].to.x)&&(e=Math.max(this.covering[n].from.x,this.covering[n].to.x)));const n=Number(this.container.getAttribute("x"));n<t?(this.container.setAttribute("width",e-t+2*this.schema.offset.x+(t-n)),this.mimic.setAttribute("width",e-t+2*this.schema.offset.x+(t-n))):(this.container.setAttribute("width",e-t+2*this.schema.offset.x),this.mimic.setAttribute("width",e-t+2*this.schema.offset.x))},bindEvents(){this.projection.registerHandler("displayed",(()=>{let t=is.estimatePositionCondamn(this.anchorModel,this);const{offset:e=!1}=this.schema;e&&(this.container.setAttribute("x",t.x-e.x),this.container.setAttribute("y",t.y-e.y)),this.anchors=t.anchors,this.rtag=this.environment.getActiveReceiver(this.schema.rtag),this.rtag.container.prepend(this.container)})),this.projection.registerHandler("accept",(t=>{is.registerSubModel(this.anchorModel,this,t)})),this.projection.registerHandler("cover",(t=>{ts(this.rtag)&&(this.rtag=this.findActiveReceiver(this.schema.rtag));const e=is.estimatePosition(t.calcS),n=is.estimatePosition(t.calcT);ts(this.covering)&&(this.covering=[]),this.setCovering(t,e,n),this.checkCover()}))},setCovering(t,e,n){for(let i=0;i<this.covering.length;i++)if(this.covering[i].item===t)return this.covering[i].from=e,void(this.covering[i].to=n);this.covering.push({item:t,from:e,to:n})}},as=Object.assign({},Ui,ss),rs={init(){return this},render(){const{button:t,view:e}=this.schema;if((0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="decoration",this.container.dataset.id=this.id),(0,s.isNullOrUndefined)(this.button)){const e=new DOMParser,{content:n,coordinates:i}=t;this.button=e.parseFromString(parseFromString(n.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement),this.button.setAttribute("x",i.x),this.button.setAttribute("y",i.y),this.container.append(t)}return this.bindEvents(),this.container},bindEvents(){}},os=Object.assign({},Ui,rs),{isHTMLElement:ls,createDiv:cs,isNullOrUndefined:hs,createDocFragment:us,isEmpty:ds,isNull:ps,valOrDefault:ms}=n(835),fs={init(){return this},render(){const{content:t,dimensions:e}=this.schema;return hs(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","text"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="add",this.container.dataset.id=this.id,this.container.setAttribute("font-size",12),this.container.style["dominant-baseline"]="hanging"),this.container.textContent=t,this.container},focusIn(){},focusOut(){},clickHandler(){this.source.createElement()},bindEvents(){this.container.addEventListener("click",(()=>{this.source.createElement()}))}},gs=Object.assign({},Ui,fs),ys={init(){return this},render(){const{action:t,content:e,background:n}=this.schema;if((0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="button",this.container.dataset.id=this.id),e&&(0,s.isNullOrUndefined)(this.content)&&this.createContent(e),n){const t=new DOMParser;this.background=t.parseFromString(n.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.container.append(this.background)}return this.container},createContent(t){switch(t.type){case"text":this.content=document.createElementNS("http://www.w3.org/2000/svg","text");const{placeholder:e,font:n,size:i,anchor:s}=t.text;this.content.setAttribute("font-family",n),this.content.setAttribute("font-size",i),this.content.setAttribute("text-anchor",s),this.content.style["dominant-baseline"]="hanging",this.content.textContent=e,this.container.append(this.content)}},focusIn(){},focusOut(){}},bs=Object.assign({},Ui,ys),vs={init(){const{width:t,height:e}=this.schema.dimensions,{depth:n}=this.schema;return this.width=t,this.height=e,this.intensity=n,this},render(){const{tag:t,duration:e,orientation:n}=this.schema;if((0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("algorithm-container"),this.container.dataset.nature="algorithm",this.container.dataset.algorithm="tree",this.container.dataset.id=this.id,this.container.tabindex=1,this.container.id=this.id,this.container.setAttribute("width",this.width),this.container.setAttribute("height",this.height)),(0,s.isNullOrUndefined)(this.linkSpace)&&(this.linkSpace=document.createElementNS("http://www.w3.org/2000/svg","g"),this.container.append(this.linkSpace),this.linkSpace.classList.add("linkSpace")),(0,s.isNullOrUndefined)(this.nodeSpace)&&(this.nodeSpace=document.createElementNS("http://www.w3.org/2000/svg","g"),this.container.append(this.nodeSpace),this.nodeSpace.classList.add("nodeSpace")),this.rootTag=t,this.duration=e,this.orientation=n,(0,s.isNullOrUndefined)(this.tree))switch(this.orientation){case"vertical":this.tree=d3.layout.tree().size([this.width,this.height]);break;default:this.tree=d3.layout.tree().size([this.height,this.width])}return this.createRoot(),this.setData(),this.bindEvents(),this.container},accept(t,e,n){let i=this.findData(e.getAttribute("data-concept")),a=this.model.createProjection(t,n).init();a.optional=!0;let r=a.render();t.register(this.projection);let o=this.createHolder();o.append(r),o.setAttribute("id",r.getAttribute("data-concept")),r.setAttribute("data-tree",this.schema.treeId),r.classList.add("node"),this.nodeSpace.append(o),a.element.source.notify("displayed"),(0,s.isNullOrUndefined)(i.children)&&(i.children=[]);let l=r.getBBox();i.children.push({proj:o,id:r.getAttribute("data-concept"),offW:l.width/2,offH:l.height/2,children:[]}),(0,s.isNullOrUndefined)(this.treeIndex)&&(this.treeIndex=new Map),this.treeIndex.set(r.getAttribute("data-concept"),o),this.update()},findData(t){let e=this.data[0];return this.findDataAt(t,e)},findDataAt(t,e){if(e.id===t)return e;if((0,s.isNullOrUndefined)(e.children)||(0,s.isEmpty)(e.children))return!1;for(let n=0;n<e.children.length;n++){let i=this.findDataAt(t,e.children[n]);if(i)return i}return!1},createRoot(){this.rootProj=this.model.createProjection(this.source,this.rootTag).init(),this.rootProj.parent=this.projection;let t=this.rootProj.render();t.setAttribute("data-tree",this.schema.treeId),this.root=t;let e=this.createHolder();switch(this.projMap=new Map,this.projMap.set(t,{group:e,index:0}),e.setAttribute("id",t.getAttribute("data-concept")),this.orientation){case"horizontal":e.setAttribute("x",0),e.setAttribute("y",this.height/2-this.rootProj.element.height/2);break;case"vertical":e.setAttribute("y",0),e.setAttribute("x",this.width/2-this.rootProj.element.width/2)}e.append(t),this.nodeSpace.appendChild(e)},createHolder(){let t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.classList.add("node"),t},setData(){this.data=[{name:"root",index:0,id:this.root.getAttribute("data-concept"),children:[]}]},update(){switch((0,s.isNullOrUndefined)(this.svg)&&(this.svg=d3.select("#"+this.id)),this.orientation){case"vertical":this.updateVertical();break;default:this.updateHorizontal()}},arrange(){let t=this.data[0],e=1;if((0,s.isNullOrUndefined)(t.children))return 0;for(let n=0;n<t.children.length;n++)e=this.arrangeChildren(t.children[n],e);return e>3?1:0},arrangeChildren(t,e){let n=this.treeIndex.get(t.id);if(n.setAttribute("example",e),this.nodeSpace.children.length>e?this.nodeSpace.insertBefore(n,this.nodeSpace.children[e]):this.nodeSpace.append(n),(0,s.isNullOrUndefined)(t.children))return e+1;let i=e+1;for(let e=0;e<t.children.length;e++)i=this.arrangeChildren(t.children[e],i),i++;return i},updateVertical(){var t=d3.svg.diagonal().projection((function(t){return[t.y,t.x]}));let e=this.data[0];e.x0=this.width/2,e.y0=50;let n=this.tree.nodes(e),i=this.tree.links(n);const s=this.intensity,a=this.duration;n.forEach((function(t){t.y=t.depth*s+50}));var r=this.svg.select("g.node").data(n),o=this.svg.select("path.link").data(i);r.enter().append("g").attr("class","node").attr("data-content",(function(t){return t.id})).attr("data-moved",(function(t){return"true"})).attr("transform",(function(t){return"translate("+e.x0+", "+e.y0+")"})),this.arrange(),r.transition().duration(a).attr("transform",(function(t){return"translate("+t.x+", "+t.y+")"})),r.exit().transition().attr("transform",(function(t){return"translate("+e.x+", "+e.y+")"})).remove(),n.forEach((function(t){t.x0=t.x,t.y0=t.y})),(o=svg.selectAll("path.link").data(i)).enter().insert("path","g").attr("class","link").attr("fill",r).attr("stroke",black).attr("stroke-width",2).attr("d",(function(e){var n={x:source.x0,y:source.y0};return t({source:n,target:n})})),o.transition().duration(a).attr("d",t),o.exit().transition().duration(a).attr("d",(function(e){var n={x:source.x,y:source.y};return t({source:n,target:n})})).remove()},updateHorizontal(){var t=d3.svg.diagonal().projection((function(t){return[t.y,t.x]}));let e=this.data[0];e.x0=this.width/2,e.y0=50;let n=this.tree.nodes(e),i=this.tree.links(n);const s=this.intensity,a=this.duration;n.forEach((function(t){t.y=t.depth*s+2*e.offW})),this.arrange();var r=this.svg.select("g.nodeSpace").selectAll("g.node").data(n);r.enter().append("g").attr("class","node").attr("transform",(function(t){return"translate("+(e.y0-e.offW)+", "+(e.x0-e.offH)+")"})),r.transition().duration(a).attr("transform",(function(t){return"translate("+(t.y-t.offW)+", "+(t.x-t.offH)+")"})),r.exit().transition().attr("transform",(function(t){return"translate("+(e.y-e.offW)+", "+(e.x-e.offH)+")"})).remove(),n.forEach((function(t){t.x0=t.x,t.y0=t.y}));var o=this.svg.select("g.linkSpace").selectAll("path.link").data(i);o.enter().insert("path","g").attr("class","link").attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("d",(function(n){var i={x:e.x0,y:e.y0};return t({source:i,target:i})})),o.transition().duration(a).attr("d",t),o.exit().transition().duration(a).attr("d",(function(n){var i={x:e.x,y:e.y};return t({source:i,target:i})})).remove()},removeNode(t,e){if(!e.children)return!1;for(let n=0;n<e.children.length;n++){if(e.children[n].id===t)return e.children.splice(n,1),0===e.children.length&&(e.children=null),!0;if(deleteItem(t,e.children[n]))return!0}return!1},bindEvents(){this.projection.registerHandler("displayed",(()=>{if(!this.displayed){this.displayed=!0,this.rootProj.element.source.notify("displayed");let t=this.rootProj.element.container.getBBox();this.data[0].offW=t.width/2,this.data[0].offH=t.height/2,this.update()}})),this.projection.registerHandler("delete",((t,e)=>{this.removeNode(e.id,this.data[0]),this.treeIndex.delete(e.id),this.update()}))}},xs=Object.assign(Object.create(Ui),vs);var ws=0;const Es=()=>"algo"+ws++,As={force:(t,e,n)=>Object.create(Pi,{object:{value:"algorithm"},name:{value:"force-algorithm"},type:{value:"force"},id:{value:Es()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),pattern:(t,e,n)=>Object.create(Bi,{object:{value:"algorithm"},name:{value:"pattern-algorithm"},type:{value:"pattern"},id:{value:Es()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),decoration:(t,e,n)=>Object.create(Gi,{object:{value:"algorithm"},name:{value:"decoration-algorithm"},type:{value:"decoration"},id:{value:Es()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),holder:(t,e,n)=>Object.create(Ki,{object:{value:"algorithm"},name:{value:"holder-algorithm"},type:{value:"holder"},id:{value:Es()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),anchor:(t,e,n)=>Object.create(as,{object:{value:"algorithm"},name:{value:"anchor-algorithm"},type:{value:"anchor"},id:{value:Es()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),"alt-view":(t,e,n)=>Object.create(os,{object:{value:"algorithm"},name:{value:"alt-view"},type:{value:"alt-view"},id:{value:Es()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),add:(t,e,n)=>Object.create(gs,{object:{value:"algorithm"},name:{value:"add"},type:{value:"add"},id:{value:Es()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),button:(t,e,n)=>Object.create(bs,{object:{value:"algorithm"},name:{value:"svg-button"},type:{value:"button"},id:{value:Es()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),tree:(t,e,n)=>Object.create(xs,{object:{value:"algorithm"},name:{value:"tree-layout"},type:{value:"tree"},id:{value:Es()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})},js={createAlgo(t,e,n){const{type:i}=e,a=As[i];if((0,s.isNullOrUndefined)(a))throw new TypeError(`Missing handler: The '${i}' algo could not be handled`);const r=a(t,e,n);if((0,s.isNullOrUndefined)(r))throw new Error(`Bad request: The '${i}' algo could not be created`);return r.createAlgo=this.createAlgo,(0,s.isNullOrUndefined)(r.id)&&(r.id=Es()),r}};var ks=n(127),Ns=n(78);const _s={init(){return this.width=700,this.height=700,this},render(){(0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.setAttribute("width",350),this.container.setAttribute("height",350),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="force",this.container.dataset.id=this.id,this.simulationArea=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.simulationArea.setAttribute("width",350),this.simulationArea.setAttribute("height",350),this.simulationArea.setAttribute("viewBox","0 0 700 700"),this.simulationArea.setAttribute("preserveAspectRatio","xMidYMid meet"),this.simulationArea.id=this.id,this.settingArea=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.settingArea.setAttribute("x",0),this.settingArea.setAttribute("y",0),this.container.append(this.settingArea),this.container.append(this.simulationArea)),(0,s.isNullOrUndefined)(this.circleRadiusTxt)&&(this.circleRadiusTxt=document.createElementNS("http://www.w3.org/2000/svg","text"),this.circleRadiusTxt.textContent="Radius:",this.circleRadiusTxt.setAttribute("x",5),this.circleRadiusTxt.setAttribute("y",30),this.circleRadiusTxt.setAttribute("font-size",8),this.circleRadiusTxt.setAttribute("font-weight",500),this.circleRadiusTxt.setAttribute("font-family","Segoe UI"),this.settingArea.append(this.circleRadiusTxt)),(0,s.isNullOrUndefined)(this.radiusTxt)&&(this.radiusTxt=da.call(this,{type:"attribute",name:"radius",tag:"simulation"}),this.radiusTxt.setAttribute("x",37),this.radiusTxt.setAttribute("y",30),this.settingArea.append(this.radiusTxt)),(0,s.isNullOrUndefined)(this.widthTxt)&&(this.widthTxt=document.createElementNS("http://www.w3.org/2000/svg","text"),this.widthTxt.textContent="Width:",this.widthTxt.setAttribute("x",5),this.widthTxt.setAttribute("y",40),this.widthTxt.setAttribute("font-size",8),this.widthTxt.setAttribute("font-weight",500),this.widthTxt.setAttribute("font-family","Segoe UI"),this.settingArea.append(this.widthTxt)),(0,s.isNullOrUndefined)(this.wTxt)&&(this.wTxt=da.call(this,{type:"attribute",name:"width",tag:"simulation"}),this.wTxt.setAttribute("x",37),this.wTxt.setAttribute("y",40),this.settingArea.append(this.wTxt)),(0,s.isNullOrUndefined)(this.heightTxt)&&(this.heightTxt=document.createElementNS("http://www.w3.org/2000/svg","text"),this.heightTxt.textContent="Height",this.heightTxt.setAttribute("x",5),this.heightTxt.setAttribute("y",50),this.heightTxt.setAttribute("font-size",8),this.heightTxt.setAttribute("font-weight",500),this.heightTxt.setAttribute("font-family","Segoe UI"),this.settingArea.append(this.heightTxt)),(0,s.isNullOrUndefined)(this.hTxt)&&(this.hTxt=da.call(this,{type:"attribute",name:"height",tag:"simulation"}),this.hTxt.setAttribute("x",37),this.hTxt.setAttribute("y",50),this.settingArea.append(this.hTxt)),this.button=document.createElementNS("http://www.w3.org/2000/svg","text"),this.button.textContent="Simulate",this.settingArea.append(this.button),this.button.addEventListener("click",(()=>{this.setUpForce()})),this.button.setAttribute("x",5),this.button.setAttribute("y",12),this.button.setAttribute("font-size",12),this.button.setAttribute("font-weight",500),this.button.setAttribute("font-family","Segoe UI");let t=document.createElementNS("http://www.w3.org/2000/svg","path");t.classList.add("linkSimulation"),t.id="linkSimulation"+this.id,t.setAttribute("stroke","black"),this.simulationArea.append(t),this.svgNode=[];for(let t=0;t<3;t++){let t=document.createElementNS("http://www.w3.org/2000/svg","circle");t.style.fill="red",t.style.stroke="black",t.setAttribute("r",50),t.classList.add("nodeSimulation"),t.classList.add("hidden"),this.svgNode.push(t),this.simulationArea.append(t)}let e=document.createElementNS("http://www.w3.org/2000/svg","circle");return e.classList.add("nodeSimulation"),e.classList.add("hidden"),this.svgNode.push(e),this.simulationArea.append(e),this.bindEvents(),this.intensity=Number(this.intensityAttr.value),this.linkVal=Number(this.linkDistAttr.value),this.container},branch(){this.setUpForce()},setUpForce(){if((0,s.isNullOrUndefined)(this.force)){this.svgNode.forEach((t=>{t.classList.remove("hidden")})),this.source.getAttributeByName("intensity").target.value;const e=Number(this.source.getAttributeByName("linkVal").target.value);this.force=Ns.layout.force().size([this.width,this.height]).nodes([]).links([{source:0,target:1}]).linkDistance(e).charge(-500).on("tick",this.tick.bind(this));var t=Ns.select("#"+this.id);this.nodes=this.force.nodes(),this.nodes.push({x:25,y:25}),this.nodes.push({x:325,y:25}),this.nodes.push({x:175,y:75}),this.nodes.push({ref:!0}),this.node=t.selectAll("circle").data(this.nodes),this.links=this.force.links(),this.link=t.selectAll("path").data(this.links)}this.force.start()},clickHandler(){},tick(){let t=this.nodes;this.node.attr("cx",(function(e){if(e.ref){Os.getMediatrice(t[0],t[1]);let e={x:(t[0].x+t[1].x)/2,y:(t[0].y+t[1].y)/2};return t[0].x,t[1].x,t[0].x,t[1].x,t[0].y,t[1].y,t[0].y,t[1].y,e.x}return e.x})).attr("cy",(function(e){if(e.ref){Os.getMediatrice(t[0],t[1]);let e={x:(t[0].x+t[1].x)/2,y:(t[0].y+t[1].y)/2};return t[0].x,t[1].x,t[0].x,t[1].x,t[0].y,t[1].y,t[0].y,t[1].y,e.y}return e.y})),this.link.attr("d",(function(t){return"M"+t.target.x+","+t.target.y+"A1,1 0 0 1,"+t.source.x+","+t.source.y+"A1,1 0 0 0,"+t.target.x+","+t.target.y}))},updateClean(){this.height=this.heightAttr.value,this.width=this.widthAttr.value,this.height>0&&this.width>0&&this.simulationArea.setAttribute("viewBox","0 0 "+this.width+" "+this.height);for(let t=0;t<3;t++)this.radius.value>0&&this.svgNode[t].setAttribute("r",this.radius.value)},focusIn(){},focusOut(){},updateParams(){if((0,s.isNullOrUndefined)(this.force))this.updateClean();else{this.force.stop(),this.intensity=Math.min(-1*Number(this.intensityAttr.value),-1*Number(this.intensityAttr.value)),this.linkVal=Number(this.linkDistAttr.value);for(let t=0;t<3;t++)this.radius.value>0&&this.svgNode[t].setAttribute("r",this.radius.value);this.height=this.heightAttr.value,this.width=this.widthAttr.value,this.height>0&&this.width>0&&(this.simulationArea.setAttribute("viewBox","0 0 "+this.width+" "+this.height),this.force.size([this.width,this.height])),this.force.linkDistance(this.linkVal).charge(this.intensity),this.force.start()}},bindEvents(){this.intensityAttr=this.source.getAttributeByName("intensity").target,this.linkDistAttr=this.source.getAttributeByName("linkVal").target,this.widthAttr=this.source.getAttributeByName("width").target,this.heightAttr=this.source.getAttributeByName("height").target,this.radius=this.source.getAttributeByName("radius").target,this.intensityAttr.register(this.projection),this.linkDistAttr.register(this.projection),this.widthAttr.register(this.projection),this.heightAttr.register(this.projection),this.radius.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.updateParams()}))}},Os={getMediatrice(t,e){let n=(t.x+e.x)/2,i=(t.y+e.y)/2,s=(e.y-t.y)/(e.x-t.x);return{k:-1/s,h:i+-1/s*n}},findPoint(t,e,n){let i=1-t.k*t.k,s=2*e.y*t.k-2-2*t.k*t.h,a=s*s-4*i*(e.x*e.x-e.y*e.y-t.h*t.h+2*e.y*t.h-n);if(a>0)return(-s-Math.sqrt(a))/(2*i)}},Ls=Object.assign(Object.create(ks.Simulation),_s),Ms={init(){return this.width=350,this.height=100,this},focusIn(){},focusOut(){},render(){return(0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.setAttribute("width",300),this.container.setAttribute("height",50),this.container.setAttribute("x",100),this.container.setAttribute("y",0),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.schema.wider?this.path.setAttribute("d","M 0 25 L 275 25"):this.path.setAttribute("d","M 0 25 L 200 25"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="arrow",this.container.dataset.id=this.id,this.container.id=this.id,this.path.id="path"+this.id,this.container.append(this.path)),this.markerStart=da.call(this,{type:"attribute",name:"start",placeholder:!1,tag:"simulation-start"}),this.markerEnd=da.call(this,{type:"attribute",name:"end",placeholder:!1,tag:"simulation-end"}),this.container.append(this.markerStart),this.container.append(this.markerEnd),this.bindEvents(),this.container},applyStyle(){this.stroke.hasValue()&&this.path.setAttribute("stroke",this.stroke.value),this.width.hasValue()&&this.path.setAttribute("stroke-width",this.width.value),this.dasharray.hasValue()&&this.path.setAttribute("stroke-dasharray",this.dasharray.value),this.linecap.hasValue()&&this.path.setAttribute("stroke-linecap",this.linecap.value)},bindEvents(){this.stroke=this.source.getAttributeByName("stroke").target,this.stroke.register(this.projection),this.path.setAttribute("stroke","black"),this.width=this.source.getAttributeByName("width").target,this.width.register(this.projection),this.width.hasValue()&&this.path.setAttribute("stroke-width",this.width.value),this.dasharray=this.source.getAttributeByName("dasharray").target,this.dasharray.register(this.projection),this.dasharray.hasValue()&&this.path.setAttribute("stroke-dasharray",this.dasharray.value),this.linecap=this.source.getAttributeByName("linecap").target,this.linecap.register(this.projection),this.linecap.hasValue()&&this.path.setAttribute("stroke-linecap",this.linecap.value),this.projection.registerHandler("value.changed",(()=>{this.applyStyle()}))}},Cs=Object.assign(Object.create(ks.Simulation),Ms),Ss={init(){return this.width=350,this.height=100,this},render(){return(0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.setAttribute("width",200),this.container.setAttribute("height",200),this.container.setAttribute("viewBox","0 0 50 50"),this.text=document.createElementNS("http://www.w3.org/2000/svg","text"),this.text.setAttribute("x",25),this.text.setAttribute("y",25),this.text.textContent="Element",this.heightTxt=document.createElementNS("http://www.w3.org/2000/svg","text"),this.heightTxt.setAttribute("x",2),this.heightTxt.setAttribute("y",45),this.heightTxt.setAttribute("font-size",2),this.heightTxt.textContent="dimensions: 50x50",this.xyText=document.createElementNS("http://www.w3.org/2000/svg","text"),this.xyText.setAttribute("x",2),this.xyText.setAttribute("y",47),this.xyText.setAttribute("font-size",2),this.xyText.textContent="x,y: 25, 25",this.container.append(this.text),this.container.append(this.widthTxt),this.container.append(this.heightTxt),this.container.append(this.xyText),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="text",this.container.dataset.id=this.id,this.container.style="border:solid rgb(135, 161, 255); border-radius:10%;",this.container.id=this.id),this.bindEvents(),this.container},applyStyle(){this.font.hasValue()&&this.text.setAttribute("font-family",this.font.value),this.size.hasValue()&&this.text.setAttribute("font-size",this.size.value),this.anchor.hasValue()&&this.text.setAttribute("text-anchor",this.anchor.value),this.weight.hasValue()&&this.text.setAttribute("font-weight",this.weight.value),this.baseline.hasValue()&&(this.text.style["dominant-baseline"]=this.baseline.value)},bindEvents(){this.font=this.source.getAttributeByName("font").target,this.font.register(this.projection),this.text.setAttribute("font-family","Verdana"),this.size=this.source.getAttributeByName("size").target,this.size.register(this.projection),this.size.hasValue()&&this.text.setAttribute("font-size",this.size.value),this.weight=this.source.getAttributeByName("weight").target,this.weight.register(this.projection),this.weight.hasValue()&&this.text.setAttribute("font-weight",this.weight.value),this.anchor=this.source.getAttributeByName("anchor").target,this.anchor.register(this.projection),this.anchor.hasValue()&&this.text.setAttribute("text-anchor",this.anchor.value),this.baseline=this.source.getAttributeByName("baseline").target,this.baseline.register(this.projection),this.baseline.hasValue()&&this.text.setAttribute("dominant-baseline",this.anchor.value),this.projection.registerHandler("value.changed",(()=>{this.applyStyle()}))}},Ts=Object.assign(Object.create(ks.Simulation),Ss),Is={init(){return this.width=400,this.height=200,this},render(){return(0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.setAttribute("width",200),this.container.setAttribute("height",200),this.container.setAttribute("viewBox","0 0 400 400"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.simulation="selection",this.container.dataset.id=this.id,this.container.style="border:solid rgb(135, 161, 255); border-radius:10%;",this.container.id=this.id),this.bindEvents(),this.setUpSimulation(),this.container},bindEvents(){this.nbItem=this.source.getAttributeByName("nbItem").target,this.orientation=this.source.getAttributeByName("orientation").target,this.break=this.source.getAttributeByName("break").target,this.itemW=this.source.getAttributeByName("dimensions").target.getAttributeByName("width").target,this.itemH=this.source.getAttributeByName("dimensions").target.getAttributeByName("height").target,this.nbItem.register(this.projection),this.orientation.register(this.projection),this.break.register(this.projection),this.itemW.register(this.projection),this.itemH.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.setUpSimulation()}))},setUpSimulation(){this.baseLetter=65,(0,s.isNullOrUndefined)(this.selection)||this.selection.remove(),this.selection=document.createElementNS("http://www.w3.org/2000/svg","svg");for(let t=0;t<this.nbItem.value;t++){let e=this.createItem();this.place(e,t),this.baseLetter++}this.center(),this.container.append(this.selection)},focusIn(){},focusOut(){},place(t,e){const n=(0,s.valOrDefault)(this.itemW.value,50),i=(0,s.valOrDefault)(this.itemH.value,50),a=this.break.value;switch(this.orientation.value){case"horizontal":a>0?(t.setAttribute("x",e%a*n),t.setAttribute("y",~~(e/a)*i)):t.setAttribute("x",e*n);break;case"vertical":a>0?(t.setAttribute("x",~~(e/a)*i),t.setAttribute("y",e%a*n)):t.setAttribute("y",e*i)}},createItem(){let t=document.createElementNS("http://www.w3.org/2000/svg","svg");const e=(0,s.valOrDefault)(this.itemW.value,50),n=(0,s.valOrDefault)(this.itemH.value,50);this.break.value,t.setAttribute("width",e),t.setAttribute("height",n);let i=document.createElementNS("http://www.w3.org/2000/svg","text");return i.textContent=String.fromCharCode(this.baseLetter),i.setAttribute("x",e/2),i.setAttribute("y",n/2),i.setAttribute("text-anchor","middle"),i.setAttribute("font-size",n/2),i.setAttribute("font-family","Segoe UI"),i.setAttribute("font-weight",500),t.append(i),this.selection.append(t),t},center(){const t=this.orientation.value,e=this.break.value,n=(0,s.valOrDefault)(this.itemW.value,50),i=(0,s.valOrDefault)(this.itemH.value,50),a=this.nbItem.value;switch(t){case"horizontal":e>0&&a>e?(this.selection.setAttribute("x",200-e*n/2),this.selection.setAttribute("y",200-Math.ceil(a/e)*i/2)):(this.selection.setAttribute("x",200-a*n/2),this.selection.setAttribute("y",200-i/2));break;case"vertical":e>0&&a>e?(this.selection.setAttribute("y",200-e*i/2),this.selection.setAttribute("x",200-Math.ceil(a/e)*n/2)):(this.selection.setAttribute("y",200-a*i/2),this.selection.setAttribute("x",200-n/2))}}},Us=Object.assign(Object.create(ks.Simulation),Is),Ds={init(){return this},focusIn(){},focusOut(){},render(){return(0,s.isNullOrUndefined)(this.def)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.def=document.createElementNS("http://www.w3.org/2000/svg","defs"),this.marker=document.createElementNS("http://www.w3.org/2000/svg","marker"),this.marker.setAttribute("orient","auto"),this.marker.setAttribute("markerUnit","strokeWidth"),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="marker",this.container.dataset.id=this.id,this.def.append(this.marker),this.marker.append(this.path),this.container.append(this.def)),this.bindEvents(),this.container},focus(){},updateParams(){(0,s.isNullOrUndefined)(this.idAttr.value)||(this.marker.setAttribute("id",this.idAttr.value),this.user=this.container.parentNode.getElementById("path"+this.container.parentNode.id),this.user.setAttribute("marker-"+(this.schema.start?"start":"end"),"url(#"+this.idAttr.value+")")),(0,s.isNullOrUndefined)(this.minX.value)||(0,s.isNullOrUndefined)(this.minY.value)||(0,s.isNullOrUndefined)(this.width.value)||(0,s.isNullOrUndefined)(this.height.value)||this.marker.setAttribute("viewBox",this.minX.value+" "+this.minY.value+" "+this.width.value+" "+this.height.value),(0,s.isNullOrUndefined)(this.refX.value)||this.marker.setAttribute("refX",this.refX.value),(0,s.isNullOrUndefined)(this.refY.value)||this.marker.setAttribute("refY",this.refY.value),(0,s.isNullOrUndefined)(this.markerWidth.value)||this.marker.setAttribute("markerWidth",this.markerWidth.value),(0,s.isNullOrUndefined)(this.markerHeight.value)||this.marker.setAttribute("markerHeight",this.markerHeight.value),(0,s.isNullOrUndefined)(this.d.value)||this.path.setAttribute("d",this.d.value)},bindEvents(){this.idAttr=this.source.getAttributeByName("id").target,this.idAttr.register(this.projection),this.minX=this.source.getAttributeByName("minX").target,this.minX.register(this.projection),this.minY=this.source.getAttributeByName("minY").target,this.minY.register(this.projection),this.width=this.source.getAttributeByName("width").target,this.width.register(this.projection),this.height=this.source.getAttributeByName("height").target,this.height.register(this.projection),this.refX=this.source.getAttributeByName("refX").target,this.refX.register(this.projection),this.refY=this.source.getAttributeByName("refY").target,this.refY.register(this.projection),this.markerWidth=this.source.getAttributeByName("markerWidth").target,this.markerWidth.register(this.projection),this.markerHeight=this.source.getAttributeByName("markerHeight").target,this.markerHeight.register(this.projection),this.d=this.source.getAttributeByName("d").target,this.d.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.updateParams()}))}},Hs=Object.assign(Object.create(ks.Simulation),Ds),Ps={init(){return this.width=350,this.height=350,this},render(){return(0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="content",this.container.dataset.id=this.id,this.container.setAttribute("width",300),this.container.setAttribute("height",300),this.holder=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.append(this.holder)),this.bindEvent(),this.container},focusIn(){},focusOut(){},scale(){const t=this.content.width.baseVal.value,e=this.content.height.baseVal.value;let n=Math.max(t,e)/100;this.holder.setAttribute("viewBox","0 0 "+t+" "+e),this.holder.setAttribute("width",t/n),this.holder.setAttribute("height",e/n),this.holder.setAttribute("x",100),this.holder.setAttribute("y",100)},bindEvent(){const t=new DOMParser;this.projection.registerHandler("value.changed",(e=>{(0,s.isNullOrUndefined)(this.content)||this.content.remove(),this.content=t.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.holder.append(this.content),this.scale()})),this.source.hasValue()&&(this.content=t.parseFromString(this.source.value.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,this.holder.append(this.content),this.scale())}},Rs=Object.assign(Object.create(ks.Simulation),Ps),Bs={init(){return this.width=350,this.height=350,this},render(){return(0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.setAttribute("width",400),this.container.setAttribute("height",400),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="pattern",this.container.dataset.id=this.id),(0,s.isNullOrUndefined)(this.visualization)&&(this.visualization=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.visualization.setAttribute("viewBox","0 0 400 400"),this.visualization.setAttribute("width",400),this.visualization.setAttribute("height",400),this.visualization.setAttribute("preserveAspectRatio","xMidYMid meet"),this.container.append(this.visualization)),(0,s.isNullOrUndefined)(this.interaction)&&(this.interaction=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.interaction.setAttribute("viewBox","0 0 400 400"),this.interaction.setAttribute("width",400),this.interaction.setAttribute("height",400),this.container.append(this.interaction)),(0,s.isNullOrUndefined)(this.firstX)&&(this.firstX=this.source.getAttributeByName("first").target.getAttributeByName("x").target,this.firstY=this.source.getAttributeByName("first").target.getAttributeByName("y").target),(0,s.isNullOrUndefined)(this.nextX)&&(this.nextX=this.source.getAttributeByName("next").target.getAttributeByName("x").target,this.nextY=this.source.getAttributeByName("next").target.getAttributeByName("y").target),(0,s.isNullOrUndefined)(this.itemWidth)&&(this.itemWidth=this.source.getAttributeByName("itemWidth").target,this.itemWidthTextual=da.call(this,{type:"attribute",name:"itemWidth",tag:"simulation-large"}),this.itemWidthTextual.setAttribute("x",57),this.itemWidthTextual.setAttribute("y",30),this.itemWidthStatic=da.call(this,{kind:"static",type:"svg-text",content:"ItemWidth:",style:{font:"Segoe UI",size:11,anchor:"end",baseline:"auto",color:"black",weight:500}}),this.itemWidthStatic.setAttribute("x",56),this.itemWidthStatic.setAttribute("y",30),this.interaction.append(this.itemWidthTextual),this.interaction.append(this.itemWidthStatic)),(0,s.isNullOrUndefined)(this.widthTextual)&&(this.widthAttr=this.source.getAttributeByName("width").target,this.widthTextual=da.call(this,{type:"attribute",name:"width",tag:"simulation-large"}),this.widthTextual.setAttribute("x",34),this.widthTextual.setAttribute("y",45),this.widthStatic=da.call(this,{kind:"static",type:"svg-text",content:"Width:",style:{font:"Segoe UI",size:11,anchor:"end",baseline:"auto",color:"black",weight:500}}),this.widthStatic.setAttribute("x",33),this.widthStatic.setAttribute("y",45),this.interaction.append(this.widthTextual),this.interaction.append(this.widthStatic)),(0,s.isNullOrUndefined)(this.heightTextual)&&(this.heightAttr=this.source.getAttributeByName("height").target,this.heightTextual=da.call(this,{type:"attribute",name:"height",tag:"simulation-large"}),this.heightTextual.setAttribute("x",38),this.heightTextual.setAttribute("y",60),this.heightStatic=da.call(this,{kind:"static",type:"svg-text",content:"Height:",style:{font:"Segoe UI",size:11,anchor:"end",baseline:"auto",color:"black",weight:500}}),this.heightStatic.setAttribute("x",37),this.heightStatic.setAttribute("y",60),this.interaction.append(this.heightTextual),this.interaction.append(this.heightStatic)),(0,s.isNullOrUndefined)(this.nbItem)&&(this.nbItem=this.source.getAttributeByName("nbItem").target,this.nbItemText=da.call(this,{type:"attribute",name:"nbItem",tag:"simulation-large"}),this.nbItemStatic=da.call(this,{kind:"static",type:"svg-text",content:"nbItem:",style:{font:"Segoe UI",size:11,anchor:"end",baseline:"auto",color:"black",weight:500}}),this.nbItemText.setAttribute("x",26),this.nbItemText.setAttribute("y",15),this.nbItemStatic.setAttribute("x",25),this.nbItemStatic.setAttribute("y",15),this.interaction.append(this.nbItemStatic),this.interaction.append(this.nbItemText),this.setUpItems()),this.bindEvents(),this.container},setUpItems(){let t=this.nbItem.value;this.items=[];for(let e=0;e<t;e++){let t=document.createElementNS("http://www.w3.org/2000/svg","rect");t.setAttribute("width",this.itemWidth.value),t.setAttribute("height",this.itemWidth.value),t.setAttribute("fill","white"),t.setAttribute("stroke","#738CFF"),t.setAttribute("stroke-width",5),t.setAttribute("x",e*this.nextX.value+this.firstX.value),t.setAttribute("y",e*this.nextY.value+this.firstY.value),this.visualization.append(t),this.items.push(t)}},updateContainer(){(0,s.isNullOrUndefined)(this.widthAttr.value)||(0,s.isNullOrUndefined)(this.heightAttr.value)||this.visualization.setAttribute("viewBox","0 0 "+this.widthAttr.value+" "+this.heightAttr.value)},updateItems(){let t=this.nbItem.value;if(!(0,s.isNullOrUndefined)(t)){if(this.items.length>t){for(let e=t;e<this.items.length;e++)this.items[e].remove();this.items.splice(t,this.items.length-t)}if(this.items.length<t)for(let e=this.items.length;e<t;e++){let t=document.createElementNS("http://www.w3.org/2000/svg","rect");t.setAttribute("fill","white"),t.setAttribute("stroke","#738CFF"),t.setAttribute("stroke-width",5),this.visualization.append(t),this.items.push(t)}for(let t=0;t<this.items.length;t++)this.items[t].setAttribute("width",(0,s.valOrDefault)(this.itemWidth.value,50)),this.items[t].setAttribute("height",(0,s.valOrDefault)(this.itemWidth.value,50)),this.items[t].setAttribute("x",t*this.nextX.value+this.firstX.value),this.items[t].setAttribute("y",t*this.nextY.value+this.firstY.value)}},bindEvents(){this.nbItem.register(this.projection),this.firstX.register(this.projection),this.firstY.register(this.projection),this.nextX.register(this.projection),this.nextY.register(this.projection),this.itemWidth.register(this.projection),this.widthAttr.register(this.projection),this.heightAttr.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.updateContainer(),this.updateItems()}))}},Vs=Object.assign(Object.create(ks.Simulation),Bs),zs={init(){return this.width=460,this.height=220,this},render(){if((0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="force",this.container.dataset.id=this.id,this.container.setAttribute("width",this.width),this.container.setAttribute("height",this.height)),(0,s.isNullOrUndefined)(this.nodes)){this.nodes=[];for(let t=0;t<3;t++){let t=da.call(this,{kind:"static",type:"svg",content:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10" width="10" height="10" version="1"><circle r="5" cx="5" cy="5"></circle></svg>'});this.container.append(t),this.nodes.push(t)}this.nodes[0].setAttribute("x",50),this.nodes[0].setAttribute("y",110),this.nodes[1].setAttribute("x",225),this.nodes[1].setAttribute("y",35),this.nodes[2].setAttribute("x",400),this.nodes[2].setAttribute("y",190)}return(0,s.isNullOrUndefined)(this.path)&&(this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.setAttribute("stroke","black"),this.path.setAttribute("fill","transparent"),this.container.append(this.path)),this.sp=da.call(this,{type:"attribute",name:"sub-paths",tag:"simulation"}),this.container.append(this.sp),this.subPaths=this.projection.resolveElement(this.sp),this.bindEvents(),this.bindStyle(),this.bindSubPath(),this.bindSubStyle(),this.setPath(),this.container},setPath(){let t=this.meet.value;switch(t){case"free":this.path.setAttribute("d","M 55 115 L 230 40 L 405 195");break;case"minX":this.path.setAttribute("d","M 55 40 L 55 195");break;case"maxX":this.path.setAttribute("d","M 405 40 L 405 195");break;case"minY":this.path.setAttribute("d","M 55 40 L 405 40");break;case"maxY":this.path.setAttribute("d","M 55 195 L 405 195")}this.style(),this.subPaths.setPath(t,{x:0,y:0})},bindEvents(){this.meet=this.source.getAttributeByName("meet").target,this.meet.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.setPath()}))},style(){this.path.setAttribute("stroke",this.stroke.value),this.path.setAttribute("stroke-width",this.width.value),this.path.setAttribute("stroke-linecap",this.linecap.value),(0,s.isNullOrUndefined)(this.dasharray.value)||(this.path.style["stroke-dasharray"]=this.dasharray.value)},bindStyle(){const t=this.source.getAttributeByName("arrow-style").target;this.dasharray=t.getAttributeByName("dasharray").target,this.dasharray.register(this.projection),this.stroke=t.getAttributeByName("stroke").target.getAttributeByName("value").target,this.stroke.register(this.projection),this.width=t.getAttributeByName("width").target,this.width.register(this.projection),this.linecap=t.getAttributeByName("linecap").target,this.linecap.register(this.projection)},bindSubPath(){},bindSubStyle(){}},Fs=Object.assign(Object.create(ks.Simulation),zs),qs={init(){return this.width=460,this.height=220,this},render(){if((0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="force",this.container.dataset.id=this.id,this.container.setAttribute("width",this.width),this.container.setAttribute("height",this.height)),(0,s.isNullOrUndefined)(this.paths)){this.paths=[];for(let t=0;t<3;t++){let t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("stroke","black"),t.setAttribute("fill","transparent"),this.container.append(t),this.paths.push(t)}}return this.bindEvents(),this.bindStyle(),this.container},setPath(t,e){if((0,s.isNullOrUndefined)(t)||(this.meet=t),(0,s.isNullOrUndefined)(e)||(this.offset=e),"free"===this.meet)return this.paths[0].remove(),this.paths[1].remove(),this.paths[2].remove(),void this.style();switch(this.container.append(this.paths[0]),this.container.append(this.paths[1]),this.container.append(this.paths[2]),this.meet){case"minX":this.paths[0].setAttribute("d","M "+(55+this.offset.x)+" 110 L 60 110"),this.paths[1].setAttribute("d","M "+(55+this.offset.x)+" 40 L 230 40"),this.paths[2].setAttribute("d","M "+(55+this.offset.x)+" 195 L 405 195");break;case"maxX":this.paths[0].setAttribute("d","M "+(405+this.offset.x)+" 110 L 60 110"),this.paths[1].setAttribute("d","M "+(405+this.offset.x)+" 35 L 230 110"),this.paths[2].setAttribute("d","M "+(405+this.offset.x)+" 190 L 405 190");break;case"minY":this.paths[0].setAttribute("d","M 110 "+(35+this.offset.y)+" 110 L 60 110"),this.paths[1].setAttribute("d","M 35 "+(35+this.offset.y)+" 35 L 230 110"),this.paths[2].setAttribute("d","M 190 "+(35+this.offset.y)+" 190 L 405 190");break;case"maxY":this.paths[0].setAttribute("d","M 110 "+(190+this.offset.y)+" 110 L 60 110"),this.paths[1].setAttribute("d","M 35 "+(190+this.offset.y)+" 35 L 230 110"),this.paths[2].setAttribute("d","M 190 "+(190+this.offset.y)+" 190 L 405 190")}this.style()},bindEvents(){this.projection.registerHandler("value.changed",(()=>{this.setPath()}))},style(){for(let t=0;t<3;t++)this.paths[t].setAttribute("stroke",this.stroke.value),this.paths[t].setAttribute("stroke-width",this.width.value),this.paths[t].setAttribute("stroke-linecap",this.linecap.value),(0,s.isNullOrUndefined)(this.dasharray.value)||(this.path.style["stroke-dasharray"]=this.dasharray.value)},bindStyle(){const t=this.source.getAttributeByName("arrow-style").target;this.dasharray=t.getAttributeByName("dasharray").target,this.dasharray.register(this.projection),this.stroke=t.getAttributeByName("stroke").target.getAttributeByName("value").target,this.stroke.register(this.projection),this.width=t.getAttributeByName("width").target,this.width.register(this.projection),this.linecap=t.getAttributeByName("linecap").target,this.linecap.register(this.projection)}},$s=Object.assign(Object.create(ks.Simulation),qs),{isNullOrUndefined:Ws,valOrDefault:Zs}=n(835),Xs={init(){return this},render(){return Ws(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="anchor",this.container.dataset.id=this.id),Ws(this.path)&&(this.path=da.call(this,{type:"attribute",name:"arrow-style",tag:"simulation-wider"}),this.container.append(this.path),this.path.setAttribute("x",25),this.path.setAttribute("y",0)),this.bindEvents(),this.container},bindEvents(){this.offSetX=this.source.getAttributeByName("offSet").target.getAttributeByName("x").target,this.offSetX.register(this.projection),this.offSetY=this.source.getAttributeByName("offSet").target.getAttributeByName("y").target,this.offSetY.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.path.setAttribute("x",25+Zs(this.offSetX.value,0)),this.path.setAttribute("y",Zs(this.offSetY.value,0))}))}},Ys=Object.assign(Object.create(ks.Simulation),Xs),{isNullOrUndefined:Gs,valOrDefault:Js,isEmpty:Ks}=n(835),Qs={init(){return this},render(){return Gs(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="anchor",this.container.dataset.id=this.id,this.container.setAttribute("width",250),this.container.setAttribute("height",250),this.middle={x:125,y:125},this.container.setAttribute("preserveAspectRatio","xMidYMid meet"),this.container.style="border: 2px solid black"),Gs(this.path)&&(this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.style.stroke="black",this.path.style["stroke-width"]=3,this.container.append(this.path),this.path.setAttribute("fill","transparent")),Gs(this.center)&&(this.center=document.createElementNS("http://www.w3.org/2000/svg","circle"),this.center.setAttribute("cx",125),this.center.setAttribute("cy",125),this.center.setAttribute("fill","white"),this.center.setAttribute("stroke","#738CFF"),this.center.setAttribute("stroke-width",3),this.center.setAttribute("r",5),this.container.append(this.center)),this.bindEvents(),this.container},registerPoint(t){Gs(this.d)&&(this.d=[]),this.d.push(t),t.getAttributeByName("x").target.register(this.projection),t.getAttributeByName("y").target.register(this.projection)},drawPath(){(Gs(this.d)||Ks(this.d))&&this.path.setAttribute("d","");let t=this.middle.x,e=this.middle.y;this.minX=this.middle.x,this.minY=this.middle.y,this.maxX=this.middle.x,this.maxY=this.middle.y;let n="M "+t+" "+e;for(let i=0;i<this.d.length;i++){let s=this.d[i].getAttributeByName("x").target,a=this.d[i].getAttributeByName("y").target;t+=Js(s,0),e+=Js(a,0),n+=" L "+t+" "+e,this.minX>t&&(this.minX=t),this.maxX<t&&(this.maxX=t),this.minY>e&&(this.minY=e),this.maxY<e&&(this.maxY=e)}this.path.setAttribute("d",n),this.setDimensions()},setDimensions(){let t=Math.min(this.minX-5,0),e=Math.min(this.minY-5,0),n=Math.max(this.maxX+5-Math.min(this.minX-5,0),250),i=Math.max(this.maxY+5-Math.min(this.minY-5,0),250);this.container.setAttribute("viewBox",t+" "+e+" "+n+" "+i)},unregisterPoint(t){if(!Gs(this.d))for(let e=0;e<this.d.length;e++)if(d.id===t.id)return void this.d.splice(e,0)},bindEvents(){this.projection.registerHandler("value.added",(t=>{this.registerPoint(t)})),this.projection.registerHandler("value.removed",(t=>{this.unregisterPoint(t)})),this.projection.registerHandler("value.changed",(()=>{this.drawPath()}))}},ta=Object.assign(Object.create(ks.Simulation),Qs),{Simulation:ea}=n(127),na={init(){return this.depth=(0,s.valOrDefault)(20,this.source.getAttributeByName("depth").target.value),this.width=(0,s.valOrDefault)(400,this.source.getAttributeByName("width").target.value),this.height=(0,s.valOrDefault)(400,this.source.getAttributeByName("height").target.value),this},render(){if((0,s.isNullOrUndefined)(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("simulation-container"),this.container.dataset.nature="simulation",this.container.dataset.shape="tree",this.container.dataset.id=this.id,this.container.id=this.id,this.container.setAttribute("width",this.width),this.container.setAttribute("height",this.height)),(0,s.isNullOrUndefined)(this.nodeSpace)&&(this.nodeSpace=document.createElementNS("http://www.w3.org/2000/svg","g"),this.nodeSpace.classList.add("nodeSpace"),this.container.append(this.nodeSpace)),(0,s.isNullOrUndefined)(this.linkSpace)&&(this.linkSpace=document.createElementNS("http://www.w3.org/2000/svg","g"),this.linkSpace.classList.add("linkSpace"),this.container.prepend(this.linkSpace)),(0,s.isNullOrUndefined)(this.data)&&(this.data=[{id:0,children:[{id:1,children:[{id:2},{id:3}]},{id:4,children:[{id:5}]}]}]),(0,s.isNullOrUndefined)(this.tree))switch(this.orientation){case"vertical":this.tree=d3.layout.tree().size([this.width,this.height]);break;default:this.tree=d3.layout.tree().size([this.height,this.width])}return this.bindEvents(),this.container},update(){switch(this.svg=d3.select("#"+this.id),this.direction.value){case"horizontal":this.updateHorizontal();break;case"vertical":this.updateVertical()}},updateHorizontal(){var t=d3.svg.diagonal().projection((function(t){return[t.y,t.x]}));let e=this.data[0];e.x0=this.width/2,e.y0=50;let n=this.tree.nodes(e),i=this.tree.links(n);const s=this.depth.value;n.forEach((function(t){t.y=t.depth*s+40}));var a=this.svg.select("g.nodeSpace").selectAll("g.node").data(n);a.enter().append("g").attr("class","node").attr("transform",(function(t){return"translate("+e.y0+", "+e.x0+")"})).append("circle").attr("fill","red").attr("r",12.5),a.transition().duration(500).attr("transform",(function(t){return"translate("+t.y+", "+t.x+")"})),a.exit().transition().attr("transform",(function(t){return"translate("+e.y+", "+e.x+")"})).remove(),n.forEach((function(t){t.x0=t.x,t.y0=t.y}));var r=this.svg.select("g.linkSpace").selectAll("path.link").data(i);r.enter().insert("path","g").attr("class","link").attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("d",(function(n){var i={x:e.x0,y:e.y0};return t({source:i,target:i})})),r.transition().duration(500).attr("d",t),r.exit().transition().duration(500).attr("d",(function(n){var i={x:e.x,y:e.y};return t({source:i,target:i})})).remove()},bindEvents(){this.depth=this.source.getAttributeByName("depth").target,this.depth.register(this.projection),this.direction=this.source.getAttributeByName("direction").target,this.direction.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.update()})),this.projection.registerHandler("displayed",(()=>{this.update()}))}},ia=Object.assign(Object.create(ea),na);var sa=0;const aa=()=>"algo"+sa++,ra={force:(t,e,n)=>Object.create(Ls,{object:{value:"simulation"},name:{value:"force-simulation"},type:{value:"force"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),arrow:(t,e,n)=>Object.create(Cs,{object:{value:"simulation"},name:{value:"arrow-simulation"},type:{value:"arrow"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),text:(t,e,n)=>Object.create(Ts,{object:{value:"simulation"},name:{value:"text-simulation"},type:{value:"text"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),selection:(t,e,n)=>Object.create(Us,{object:{value:"simulation"},name:{value:"selection-simulation"},type:{value:"selection"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),marker:(t,e,n)=>Object.create(Hs,{object:{value:"simulation"},name:{value:"marker-simulation"},type:{value:"marker"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),content:(t,e,n)=>Object.create(Rs,{object:{value:"simulation"},name:{value:"content-simulation"},type:{value:"content"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),pattern:(t,e,n)=>Object.create(Vs,{object:{value:"simulation"},name:{value:"pattern-simulation"},type:{value:"pattern"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),multi:(t,e,n)=>Object.create(Fs,{object:{value:"simulation"},name:{value:"multi-simulation"},type:{value:"multi"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),"sub-path":(t,e,n)=>Object.create($s,{object:{value:"simulation"},name:{value:"subPath-simulation"},type:{value:"subPath"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),anchor:(t,e,n)=>Object.create(Ys,{object:{value:"simulation"},name:{value:"anchor-simulation"},type:{value:"anchor"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),set:(t,e,n)=>Object.create(ta,{object:{value:"simulation"},name:{value:"set-simulation"},type:{value:"set"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),tree:(t,e,n)=>Object.create(ia,{object:{value:"simulation"},name:{value:"tree-simulation"},type:{value:"tree"},id:{value:aa()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})},oa={createSimulation(t,e,n){const{type:i}=e,a=ra[i];if((0,s.isNullOrUndefined)(a))throw new TypeError(`Missing handler: The '${i}' simulation could not be handled`);const r=a(t,e,n);if((0,s.isNullOrUndefined)(r))throw new Error(`Bad request: The '${i}' simulation could not be created`);return r.createSimulation=this.createSimulation,(0,s.isNullOrUndefined)(r.id)&&(r.id=aa()),r}};function la(t){return"property"===t.type?this.projection.concept.getProperty(t.name):t}function ca(t,e,n){const{tag:i,placeholder:r={},style:o,options:l,listen:c}=e;if(!n.hasAttribute(t)){let e=`Attribute '${t}' does not exist in the concept '${n.name}'`;return this.environment.notify(e,a.k$.ERROR),this.environment.addError({source:"projection",code:"attribute_not_found",message:e}),(0,s.createI)({hidden:!0},t)}(0,s.valOrDefault)(e.required,n.isAttributeRequired(t))&&!n.isAttributeCreated(t)&&n.createAttribute(t);const h={name:t,get created(){return n.isAttributeCreated(t)},schema:e,placeholder:(0,s.createI)({class:["projection-element"],hidden:!0},t),parent:this,projection:this.projection,element:null};if(this.projection.attributes.push(h),!h.created){const{content:e}=r;return h.placeholder=e?da.call(this,e,n,{focusable:!0}):(0,s.createI)({class:["projection-element","projection-element--placeholder"],tabindex:0,dataset:{object:"attribute",id:t}},`Add ${t}`),h.placeholder.addEventListener("click",(e=>{n.createAttribute(t),this.projection.resolveElement(h.element).focus()})),h.placeholder}{const{target:e,schema:a}=n.getAttributeByName(t);let r=this.projection.model.createProjection(e,i).init(l);if(c&&(r.listen=!0),r.parent=this.projection,r._style=o,h.element=r.render(),(0,s.isNullOrUndefined)(h.element))return(0,s.createI)({hidden:!0},t);r.element.parent=this}return h.element}function ha(t,e){const{value:n,placement:i}=t,{target:a,description:r}=e.getAttributeByName(n);let o=this.projection.model.createProjection(a,i.tag).init();o.parent=this.projection,o.render(),(0,s.isNullOrUndefined)(a.value)||o.element.initValue(a.value),o.element.parent=this;let l=n[0].toUpperCase()+n.substring(1);return o.element.attributeName=l,o.element}function ua(t,e){let n=this.projection.model.createProjection(e,t).init();return n.parent=this.projection,n.render(),n.element.parent=this,n.element.container}function da(t,e,n={}){if(t.kind)return pa.call(this,t,e,n);const i=(0,s.valOrDefault)(e,this.projection.concept);if("container"===t.type){let e=Mi(this.model,t,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerLayout(e),e.render()}if("layout"===t.type){let e=Va.createLayout(this.model,t.layout,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerLayout(e),e.render()}if("field"===t.type){let e=Hn.createField(this.model,t.field,this.projection);return e.parent=this,e.init(n),this.model.registerField(e),e.render()}if("static"===t.type){let e=ji.createStatic(this.model,t.static,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerStatic(e),e.render()}if("algorithm"===t.type){let e=js.createAlgo(this.model,t.algorithm,this.projection);return e.init(),this.model.registerAlgorithm(e),e.render()}if("simulation"===t.type){let e=oa.createSimulation(this.model,t.simulation,this.projection);return e.init(),this.model.registerSimulation(e),e.render()}if("dynamic"===t.type)return da.call(this,t.dynamic,e,n);if("attribute"===t.type)return ca.call(this,t.name,t,i);if("svg-attribute"===t.type)return ha.call(this,t,i);if("external"===t.type)return ua.call(this,t.tag,i);if("g-fragment"===t.type){let e=t.name,n=this.model.getGFragmentSchema(e.toLowerCase());return(new DOMParser).parseFromString(n.content.content.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement}if("template"===t.type){let i=t.name;"param"===i.type&&(i=this.projection.getParam(i.name));let a=this.model.getTemplateSchema(i);a.param&&(t.param&&a.param.forEach((e=>{Object.assign(e,t.param.find((t=>t.name===e.name)))})),this.projection.addParam(a.param));const r=(0,s.createDocFragment)();let o,l=Object.assign({template:a},n),c=!1;return a.content.forEach((t=>{r.append(da.call(this,t,e,l))})),c?o:r}if("projection"===t.type){const{tag:e,style:n,src:a,required:r=!1}=t;if(a&&"attribute"===a.type)return ca.call(this,a.name,t,i);const o={schema:t,placeholder:(0,s.createI)({class:["projection-element"],hidden:!0}),parent:this,projection:this.projection,element:null};return o.update=function(t,a,r){if(o.element&&(o.element.remove(),o.element=null),i.hasValue()){let t=i.getValue(!0);console.log("ContentConcept"),console.log(e);let a=this.projection.model.createProjection(t,e).init();a.placeholder=o.placeholder,a.parent=this.projection,o.element=a.render(),o.placeholder&&o.placeholder.after(o.element),(0,s.isHTMLElement)(o.element)&&Kt.call(this.projection,o.element,n),a.element.parent=this.projection.element,this.projection.update("binding",a.element.container||a.element.element),a.update("displayed")}},i.register(o),o.update(),o.element||o.placeholder}if("property"===t.type){const{name:e}=t;return this.projection.concept.getProperty(e)}if("html"===t.type){const{html:e}=t;return(0,s.htmlToElement)(e)}if("raw"===t.type){const{raw:e}=t;return e}if("state"===t.type){let i={},s=ge.call(this,i,t.state);return da.call(this,s.content,e,n)}throw console.error(t),new TypeError("Bad argument: The type is not recognized")}function pa(t,e,n={}){const i=(0,s.valOrDefault)(e,this.projection.concept),{kind:a}=t;if("container"===a){let e=Mi(this.model,t,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerLayout(e),e.render()}if("layout"===a){let e=Va.createLayout(this.model,t,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerLayout(e),e.render()}if("field"===a){let e=Hn.createField(this.model,t,this.projection);return e.parent=this,e.init(n),this.model.registerField(e),e.render()}if("static"===a){let e=ji.createStatic(this.model,t,this.projection);return e.source=i,e.parent=this,e.init(n),this.model.registerStatic(e),e.render()}if("attribute"===a||"dynamic"===a)return ca.call(this,t.name,t,i);if("template"===a){let i=t.name;"param"===i.type&&(i=this.projection.getParam(i.name));let a=this.model.getTemplateSchema(i);a.param&&(t.param&&a.param.forEach((e=>{Object.assign(e,t.param.find((t=>t.name===e.name)))})),this.projection.addParam(a.param));const r=(0,s.createDocFragment)();return a.content.forEach((t=>{r.append(da.call(this,t,e,n))})),r}if("projection"===a){const{tag:e,style:n,required:a=!1}=t,r={schema:t,placeholder:(0,s.createI)({class:["projection-element"],hidden:!0}),parent:this,projection:this.projection,element:null};return r.update=function(t,a,o){if(r.element&&(r.element.remove(),r.element=null),i.hasValue()){let t=i.getValue(!0),a=this.projection.model.createProjection(t,e).init();a.placeholder=r.placeholder,a.parent=this.projection,r.element=a.render(),r.placeholder&&r.placeholder.after(r.element),(0,s.isHTMLElement)(r.element)&&Kt.call(this.projection,r.element,n),a.element.parent=this.projection.element}},i.register(r),r.update(),r.element||r.placeholder}if("property"===a){const{name:e}=t;return this.projection.concept.getProperty(e)}if("html"===a){const{html:e}=t;return(0,s.htmlToElement)(e)}if("raw"===a){const{raw:e}=t;return e}if("state"===a){let i={},s=ge.call(this,i,t.state);return da.call(this,s.content,e,n)}throw console.error(t),new TypeError("Bad argument: The type is not recognized")}const ma={HORIZONTAL:"horizontal",VERTICAL:"vertical"},fa=[{concept:{name:"stack-layout"},type:"layout",tags:[],projection:{type:"stack",orientation:"vertical",disposition:[{type:"attribute",name:"orientation"}]}}],ga={orientation:null,args:null,init(t={}){const{orientation:e=ma.HORIZONTAL,editable:n=!0,focusable:i=!1}=this.schema;return this.orientation=e,this.focusable=i,this.editable=n,this.elements=[],this.children=[],this.args=t,Object.assign(this,t),this},getOrientation(){return this.orientation},setOrientation(t){this.orientation=t,this.refresh()},render(){const{disposition:t,style:e,help:n}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const i=(0,s.createDocFragment)();(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["layout-container","stack-layout"],title:n,dataset:{nature:"layout",layout:"stack",id:this.id}}));for(let e=0;e<t.length;e++){let n=da.call(this,t[e],null,this.args),s=this.environment.resolveElement(n);s&&(s.parent=this),this.elements.push(n),i.append(n)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",Kt.call(this.projection,this.container,e),i.hasChildNodes()&&(this.container.append(i),this.bindEvents()),this.container.style.display="flex",this.container.style.flexWrap="nowrap",this.refresh(),this.container},design(){return{concept:[{name:"stack-layout",nature:"concrete",attributes:[{name:"orientation",target:{name:"string",default:this.orientation,constraint:{values:["horizontal","vertical"]}}}]}],projection:fa,handlers:{orientation:(t,e)=>{this.setOrientation(e)}}}},refresh(){return this.orientation===ma.VERTICAL?this.container.style.flexDirection="column":this.orientation===ma.HORIZONTAL&&(this.container.style.flexDirection="row"),this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,s.getElement)('[tabindex]:not([tabindex="-1"])',this.container);if((0,s.isNullOrUndefined)(t))return!1;let e=this.environment.resolveElement(t);e&&e.focus(t)}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.container.addEventListener("change",(t=>{const{target:e}=t,{prop:n}=e.dataset;"orientation"===n&&this.setOrientation(e.value)})),this.projection.registerHandler("view.changed",((t,e)=>{e&&e.parent===this.projection&&(t.parent=this)}))}},ya=Object.assign({},ki,ga),ba={args:null,init(t={}){const{editable:e=!0,focusable:n=!1}=this.schema;return this.focusable=n,this.editable=e,this.elements=[],this.children=[],this.args=t,Object.assign(this,t),this},render(){const{disposition:t,style:e,help:n}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const i=(0,s.createDocFragment)();(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["layout-container"],title:n,dataset:{nature:"layout",layout:"wrap",id:this.id}}));for(let e=0;e<t.length;e++){let n=da.call(this,t[e],this.source,this.args),s=this.environment.resolveElement(n);s&&(s.parent=this),this.elements.push(n),i.append(n)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",Kt.call(this.projection,this.container,e),i.hasChildNodes()&&(this.container.append(i),this.bindEvents()),this.collapsed&&this.collapse(!0),this.container.style.display="inline-flex",this.container.style.alignItems="baseline",this.refresh(),this.container},refresh(){return this.collapsed?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,s.getElement)('[tabindex]:not([tabindex="-1"])',this.container);if((0,s.isNullOrUndefined)(t))return!1;let e=this.environment.resolveElement(t);e&&e.focus(t)}},bindEvents(){this.projection.registerHandler("view.changed",((t,e)=>{e&&e.parent===this.projection&&(t.parent=this)}))}},va=Object.assign({},ki,ba),xa={elements:null,edit:!1,btnEdit:!1,btnCollapse:!1,menu:!1,collapsed:!1,init(t={}){const{editable:e=!0,collapsible:n=!1,focusable:i=!1}=this.schema;return this.focusable=i,this.collapsible=n,this.editable=e,this.elements=[],this.children=[],Object.assign(this,t),this},collapse(t){if(!this.collapsed)return this.collapseContainer=(0,s.createDiv)({class:"layout-container-collapse"},this.elements),this.btnCollapse.after(this.collapseContainer),this.collapsed=!0,this.refresh(),this},expand(t){if(!this.collapsed)return;let e=(0,s.createDocFragment)(Array.from(this.collapseContainer.children));return this.btnCollapse.after(e),this.collapseContainer.remove(),this.collapsed=!0,this.refresh(),this},refresh(){return this.collapsed?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this},render(){const{disposition:t,style:e,help:n}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const i=(0,s.createDocFragment)();(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["layout-container"],dataset:{nature:"layout",layout:"table"}})),this.focusable?this.container.tabIndex=-1:this.container.dataset.ignore="all";for(let e=0;e<t.length;e++){let n=t[e],a=(0,s.createDiv)({class:["table-row"]});a.style.display="table-row";for(let t=0;t<n.length;t++){const e=n[t];let i=(0,s.createDiv)({class:["table-cell"]},da.call(this,e.content));i.style.display="table-cell",Kt.call(this.projection,i,e.style),a.append(i)}i.append(a)}return Kt.call(this.projection,this.container,e),i.hasChildNodes()&&(this.container.append(i),this.bindEvents()),this.container.style.display="table",this.refresh(),this.container},bindEvents(){this.projection.registerHandler("view.changed",((t,e)=>{e&&e.parent===this.projection&&(t.parent=this)})),this.btnCollapse&&this.btnCollapse.addEventListener("click",(t=>{this.collapsed?this.expand():this.collapse()}))}},wa=Object.assign({},ki,xa),Ea={ROW:"row",COLUMN:"column"},Aa={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center",stretch:"stretch",baseline:"baseline"},ja={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center","space-between":"space-between","space-around":"space-around","space-evenly":"space-evenly"},ka={orientation:null,wrappable:null,alignItems:null,justifyContent:null,args:null,init(t={}){const{orientation:e=Ea.ROW,wrappable:n=!0,alignItems:i,justifyContent:s,editable:a=!0,focusable:r=!1}=this.schema;return this.orientation=e,this.wrappable=n,this.alignItems=i,this.justifyContent=s,this.focusable=r,this.editable=a,this.elements=[],this.children=[],this.args=t,Object.assign(this,t),this},getOrientation(){return this.orientation},setOrientation(t){(0,s.hasOwn)(Ea,t)&&(this.orientation=t,this.refresh())},collapse(t=!1){if(!this.collapsed||t)return this.collapseContainer=(0,s.createDiv)({class:"layout-container-collapse"},this.elements),this.btnCollapse.after(this.collapseContainer),this.collapsed=!0,this.refresh(),this},expand(t=!1){if(!this.collapsed&&!t)return;let e=(0,s.createDocFragment)(Array.from(this.collapseContainer.children));return this.btnCollapse.after(e),this.collapseContainer.remove(),this.collapsed=!1,this.refresh(),this},render(){const{disposition:t,style:e,help:n}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const i=(0,s.createDocFragment)();(0,s.isHTMLElement)(this.container)||(this.container=(0,s.createDiv)({class:["layout-container"],dataset:{nature:"layout",layout:"flex",id:this.id}})),n&&(this.container.title=n);for(let e=0;e<t.length;e++){let n=da.call(this,t[e],null,this.args),s=this.environment.resolveElement(n);s&&(s.parent=this),this.elements.push(n),i.append(n)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",Kt.call(this.projection,this.container,e),i.hasChildNodes()&&(this.container.append(i),this.bindEvents()),this.collapsed&&this.collapse(!0),this.container.style.display="flex",this.refresh(),this.container},refresh(){return this.container.style.flexDirection=this.orientation,this.container.style.justifyContent=ja[this.justifyContent],this.container.style.alignItems=Aa[this.alignItems],this.wrappable?this.container.style.flexWrap="wrap":this.container.style.flexWrap="nowrap",this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,s.getElement)('[tabindex]:not([tabindex="-1"])',this.container);if((0,s.isNullOrUndefined)(t))return!1;let e=this.environment.resolveElement(t);e&&e.focus(t)}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.container.addEventListener("change",(t=>{const{target:e}=t,{prop:n}=e.dataset;"orientation"===n&&this.setOrientation(e.value)})),this.projection.registerHandler("view.changed",((t,e)=>{e&&e.parent===this.projection&&(t.parent=this)})),this.btnCollapse&&this.btnCollapse.addEventListener("click",(t=>{this.collapsed?this.expand():this.collapse()}))}},Na=Object.assign({},ki,ka),_a={content:"",init(){return this},render(){const t=(0,s.createDocFragment)(),{content:e,attributes:n=[],link:i,dimensions:a={}}=this.schema;var r=new DOMParser;return(0,s.isHTMLElement)(this.element)||(this.element=(0,s.createDiv)({id:this.id,class:[],dataset:{nature:"layout",view:"svg",id:this.id}})),this.element.setAttribute("tabIndex",0),this.focusable=!0,!(0,s.isHTMLElement)(this.content)&&e?(this.content=r.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,t.appendChild(this.content)):(0,s.isHTMLElement)(this.content)||(this.content=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.appendChild(this.content)),(0,s.isEmpty)(n)||n.forEach((t=>{let e=da.call(this,t.attribute);this.environment.resolveElement(e),t.marker?this.content.querySelector("[data-"+t.marker+"]").append(e):this.content.append(e)})),a.type&&(this.dimensions=a),t.hasChildNodes()&&this.element.appendChild(t),this.element},getWidth(){return Number(this.content.getAttribute("width"))},getHeight(){return Number(this.content.getAttribute("height"))},registerDimObsever(t){(0,s.isNullOrUndefined)(this.observers)&&(this.observers=[]),this.observers.push(t)},attributeHandler(t,e){switch(t.type){case"interactive":this.content.querySelector("[data-"+e+"]").append(t.content);break;case"text-svg":case"choice":break;default:let n=this.content.querySelector("[data-"+e+"]");t.element.append(t.element);let i=this.createHolder(t.element);n.append(i),this.adapt(t.element,t.ratio)}},createHolder(t){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","foreign");n.append(t),e.append(n)},adapt(t,e){let n=t.getBoundingClientRect();t.parentNode.setAttribute("width",n.width),t.parentNode.setAttribute("height",n.height);let i=t.parentNode.parentNode;if(!(0,s.isNullOrUndefined)(e)){let t=this.content.width.baseVal.value;this.content.height.baseVal.value,i.setAttribute("width",t*e),i.setAttribute("height",t*e)}},_attributeHandler(t){let e=[];return t.forEach((t=>{switch(t.placement.type){case"in-place":let n=this.content.querySelector("[data-"+t.placement.marker+"]");t.type="svg-attribute";let i=da.call(this,t,null,this.args);(0,s.isNullOrUndefined)(t.property)||(i.property=propertyHandler(t.property)),e.push(i),n.appendChild(i.content);break;case"link-place":let{type:a,sd:r=[],dd:o=[]}=t.placement;(0,s.isNullOrUndefined)(this.linkAttr)&&(this.linkAttr=[]);let l={};l.name=t.value,l.field=this.informations.get(t.value),"list"===l.field.type?l.value=l.field.items:l.value=l.field.value,(0,s.isNullOrUndefined)(t.property)||(l.property=propertyHandler(t.property)),(0,s.isEmpty)(r)||(l.sd=new Map,r.forEach((t=>{t.type="template";const e={};var n=da.call(this,t,null,this.args);e.render=n,e.parent=this.content.querySelector("[data-"+t.marker+"]"),l.sd.set(n.mv,e)}))),!(0,s.isNullOrUndefined)(this.dd)||(0,s.isEmpty)(o)||(0,s.isNullOrUndefined)(o)||(l.dd=[],o.forEach((t=>{t.type="template";var e=da.call(this,t,null,this.args);l.dd.push(e),e.property=l.property;var n=this.content.querySelector("[data-"+t.marker+"]");(0,s.isNullOrUndefined)(n)?"before"===this.content.getAttribute("data-"+t.marker)?this.content.prepend(e.content):this.content.appendChild(e.content):"before"===n.getAttribute("data-"+t.marker)?n.prepend(e.content):n.appendChild(e.content)}))),this.linkAttr.push(l)}})),e},update(){(0,s.isNullOrUndefined)(this.linkAttr)||this.linkAttr.forEach((t=>{this.clearStatics(t.sd,t.value),(0,s.isNullOrUndefined)(t.property)?this.clearDynamics(t.dd,t.value):this.clearDynamics(t.dd,this.translateProperty(t.value,t.property)),"list"===t.field.type?t.value=t.field.items:t.value=t.field.value,(0,s.isNullOrUndefined)(t.property)?this.updateDynamics(t.dd,t.value):this.updateDynamics(t.dd,this.translateProperty(t.value,t.property)),this.updateStatics(t.sd,t.value)})),(0,s.isNullOrUndefined)(this.deciders)||(0,s.isEmpty)(this.deciders)||this.deciders.forEach((t=>{t.update(t.field.value)}))},clearDynamics(t,e){(0,s.isNullOrUndefined)(t)||t.forEach((t=>{t.clear(e)}))},updateDynamics(t,e){(0,s.isNullOrUndefined)(t)||t.forEach((t=>{t.update(e)}))},clearStatics(t,e){if(!(0,s.isNullOrUndefined)(t)){let n=t.get(e);(0,s.isNullOrUndefined)(n)||n.parent.removeChild(n.render.content)}},updateStatics(t,e){if(!(0,s.isNullOrUndefined)(t)){let n=t.get(e);(0,s.isNullOrUndefined)(n)||n.parent.appendChild(n.render.content)}},focus(){return this.element.focus(),this.focused=!0,(0,s.isNullOrUndefined)(this.deciders)||this.deciders.forEach((t=>{t.focusOut()})),this},focusIn(){return this.focus(),this},focusOut(){return this.focused=!1,this},arrowHandler(t,e){if(e===this.element)return!(0,s.isNullOrUndefined)(this.parent)&&this.parent.arrowHandler(t,this.element);let n=getClosestSVG(e.foreign,t,this,!1);return!(0,s.isNullOrUndefined)(n)&&(e.focusOut(),n.focus(),!0)},enterHandler(t){this.index=0,this.deciders[0].focusIn()},escapeHandler(t){if(t!==this.element)return this.focus();let e=(0,s.findAncestor)(t,(t=>0===t.tabIndex)),n=this.environment.resolveElement(e);return n&&n.focus(e),!1},getDimensions(){switch(this.dimensions.type){case"absolute":return{height:this.dimensions.height,width:this.dimensions.width}}},setIndex(t){let e=0;this.deciders.forEach((n=>{n.id!==t.id?e++:this.index=e}))}},Oa=Object.assign(Object.create(ki),_a);function La(t){const{placeholder:e="",type:n}=t;let i=la.call(this,e);return this.readonly||this.resizable?(0,s.createSpan)({class:["field--textbox__input","field--textbox__input-pseudo"],editable:!this.readonly,title:i,dataset:{placeholder:i,nature:"field-component",view:this.type,id:this.id}}):this.multiline?(0,s.createTextArea)({class:["field--textbox__input"],placeholder:i,title:i,dataset:{nature:"field-component",view:this.type,id:this.id}}):(0,s.createInput)({class:["field--textbox__input"],type:(0,s.valOrDefault)(n,"text"),placeholder:i,title:i,dataset:{nature:"field-component",view:this.type,id:this.id}})}const Ma={init(){return this},render(){const t=(0,s.createDocFragment)(),{current:e={},root:n}=this.schema;this.isRoot=n;var i=new DOMParser;if((0,s.isHTMLElement)(this.element)||(this.element=(0,s.createDiv)({id:this.id,dataset:{nature:"layout",view:"visualizer",id:this.id}})),!(0,s.isHTMLElement)(this.content)&&(this.svg=this.source.value,!(0,s.isNullOrUndefined)(this.svg))){if(this.content=i.parseFromString(this.svg.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,"svg"!==this.content.tagName){let t=i.parseFromString('<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"/>',"image/svg+xml").documentElement;t.appendChild(this.content),this.content=t}t.appendChild(this.content)}if(!(0,s.isHTMLElement)(this.input)){const{placeholder:n="",type:i,style:s}=e;this.input=La.call(this,e),this.disabled&&(this.input.disabled=!0),this.focusable?this.input.tabIndex=0:this.input.dataset.ignore="all",Kt.call(this,this.input,s),this.multiline&&this.input.classList.add("field--textbox__input--multiline"),t.append(this.input)}if(n&&(0,s.isNullOrUndefined)(this.buttons)){this.buttons=[];const e={type:"static",static:{type:"button",trigger:"make interactive",content:[{type:"static",static:{type:"text",content:"Interactive",focusable:!0}}]}};this.mkeInteractive=da.call(this,e,null,this.args);let n=this.environment.resolveElement(this.mkeInteractive);n.parent=this,n.visualizer=this,this.buttons.push(n),t.append(this.mkeInteractive);const i={type:"static",static:{type:"button",trigger:"make dynamic",content:[{type:"static",static:{type:"text",content:"Dynamic",focusable:!0}}]}};this.mkeDynamic=da.call(this,i,null,this.args),n=this.environment.resolveElement(this.mkeDynamic),n.visualizer=this,n.parent=this,this.buttons.push(n),t.append(this.mkeDynamic);const s={type:"static",static:{type:"button",trigger:"make static",content:[{type:"static",static:{type:"text",content:"Static",focusable:!0}}]}};this.mkeStatic=da.call(this,s,null,this.args),n=this.environment.resolveElement(this.mkeStatic),n.visualizer=this,n.parent=this,this.buttons.push(n),t.append(this.mkeStatic)}return t.hasChildNodes()&&this.element.appendChild(t),this.bindEvent(),this.element},focusIn(t){return this.input.focus()},focusOut(){},createProj(){let t=this.current;"tspan"===t.tagName.toLowerCase()&&(t=t.parentNode);let e=new XMLSerializer;return this.cleanInput(),this.updateInput(e.serializeToString(this.content)),'<g xmlns="http://www.w3.org/2000/svg">'+e.serializeToString(t)+"</g>"},cleanInput(){this.input.value="",this.current.parentNode.removeChild(this.current)},updateInput(t){this.source.setValue(t)},bindEvent(){this.content.addEventListener("click",(t=>{var e=new XMLSerializer;let n=t.target;"tspan"===n.tagName.toLowerCase()&&(n=n.parentNode);var i=e.serializeToString(n);this.input.value=i,this.current=n})),this.input.addEventListener("keydown",(t=>{if(""!==this.input.value&&!(0,s.isNullOrUndefined)(this.current)&&"Enter"===t.key){var e=(new DOMParser).parseFromString(this.input.value.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement;this.current!==this.content?this.current.replaceWith(e):this.content=e,this.current=e;var n=new XMLSerializer;this.isRoot?this.updateInput(n.serializeToString(this.content)):this.updateInput(n.serializeToString(this.content.childNodes[0]))}}))}},Ca=Object.assign(Object.create(ki),Ma),{createDocFragment:Sa,isNullOrUndefined:Ta,isEmpty:Ia,isHTMLElement:Ua}=n(835),Da={init(){const{coordinates:t=null,dimensions:e=null}=this.schema;return this.coordinates=t,this.dimensions=e,this},render(){const{content:t}=this.schema,e=Sa();return Ta(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("layout-container"),this.container.dataset.nature="layout",this.container.dataset.layout="holder",this.container.dataset.id=this.id),Ta(this.foreign)&&(this.foreign=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),e.append(this.foreign)),Ta(this.content)&&!Ia(t)&&(this.content=new Map,t.forEach((t=>{switch(t.type){case"projection":let e=this.projection.model.createProjection(this.projection.concept.getValue(!0),t.tag).init().render(),n=this.projection.resolveElement(e);this.element=e,this.foreign.append(e),this.content.set(t.correspondance,{render:e,projection:n});break;case"attribute":this.container.append(da.call(this,t))}}))),e.hasChildNodes()&&this.container.append(e),this.bindEvents(),this.container},registerRelative(t){switch(this.apply=t.apply,this.relative=!0,t.listen.type){case"duo":this.from=this.source.getValue(!0).getAttributeByName(t.listen.from).target,this.from.register(this.projection),this.to=this.source.getValue(!0).getAttributeByName(t.listen.to).target,this.to.register(this.projection),this.rtag=this.environment.getActiveReceiver(t.rtag)}},adapt(){},getDimensions(){return{width:this.dimensions.width,height:this.dimensions.height}},placeItem(t){switch(this.coordinates.type){case"delegate":this.container.setAttribute("x",t.schema.coordinates.x),this.container.setAttribute("y",t.schema.coordinates.y)}},setDimensions(){if(this.relative){let t=this.rtag.container.querySelector('[data-concept="'+this.from.value+'"]'),e=this.rtag.container.querySelector('[data-concept="'+this.to.value+'"]'),n=this.rtag.container.createSVGPoint(),i=t.getBoundingClientRect();n.x=i.x,n.y=i.y;let s=n.matrixTransform(this.rtag.container.getScreenCTM().inverse());i=e.getBoundingClientRect(),n.x=i.x,n.y=i.y;let a=n.matrixTransform(this.rtag.container.getScreenCTM().inverse()),r=s.x-a.x,o=s.y-a.y,l=Math.sqrt(r*r+o+o);this.width=l,this.container.setAttribute("width",this.width),this.container.setAttribute("height",30),this.foreign.setAttribute("width",this.width),this.foreign.setAttribute("height",30),this.container.setAttribute("x",s.x),this.container.setAttribute("y",s.y),this.projection.resolveElement(this.element).setDimensions(this.width)}else this.adapt(),this.parent.notify(this.container)},setHolder(t,e){this.container.setAttribute("width",t),Ta(e)?this.container.setAttribute("height",t*this.height/this.width):this.container.setAttribute("height",e)},bindEvents(){this.projection.registerHandler("value.changed",(t=>{})),this.projection.registerHandler("displayed",(t=>{let{render:e,projection:n}=this.content.get(this.source.value);this.element=e,this.foreign.append(this.element),this.setDimensions(),this.coordinates&&this.placeItem(n)}))}},Ha=Object.assign(Object.create(ki),Da);var Pa=0;const Ra=()=>"layout"+Pa++,Ba={stack:(t,e,n)=>Object.create(ya,{object:{value:"layout"},name:{value:"stack-layout"},type:{value:"stack"},id:{value:Ra()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),wrap:(t,e,n)=>Object.create(va,{object:{value:"layout"},name:{value:"wrap-layout"},type:{value:"wrap"},id:{value:Ra()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),table:(t,e,n)=>Object.create(wa,{object:{value:"layout"},name:{value:"table-layout"},type:{value:"table"},id:{value:Ra()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),flex:(t,e,n)=>Object.create(Na,{object:{value:"layout"},name:{value:"flex-layout"},type:{value:"flex"},id:{value:Ra()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),svg:(t,e,n)=>Object.create(Oa,{object:{value:"layout"},name:{value:"svg-layout"},type:{value:"svg"},id:{value:Ra()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),visualizer:(t,e,n)=>Object.create(Ca,{object:{value:"layout"},name:{value:"svg-layout"},type:{value:"svg"},id:{value:Ra()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),holder:(t,e,n)=>Object.create(Ha,{object:{value:"layout"},name:{value:"holder-layout"},type:{value:"holder"},id:{value:Ra()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})},Va={createLayout(t,e,n){const{type:i}=e,a=Ba[i];if((0,s.isNullOrUndefined)(a))throw new TypeError(`Missing handler: The '${i}' layout could not be handled`);const r=a(t,e,n);if((0,s.isNullOrUndefined)(r))throw new Error(`Bad request: The '${i}' layout could not be created`);return r.createLayout=this.createLayout,(0,s.isNullOrUndefined)(r.id)&&(r.id=Ra()),r}},za={stylePath(t){const{stroke:e="black",dasharray:n=null,width:i=1,linecap:a="butt",end:r=!1,start:o=!1}=t;this.path.style.stroke=e,(0,s.isNullOrUndefined)(n)||(this.path.style["stroke-dasharray"]=n),this.path.style["stroke-width"]=(0,s.valOrDefault)(i,5),this.path.style["stroke-linecap"]=a,r&&this.createMarkerEnd()},styleSubPath(t,e){const{stroke:n="black",dasharray:i=null,width:a=1,linecap:r="butt",end:o=!1,start:l=!1}=t;e.style.stroke=n,(0,s.isNullOrUndefined)(i)||(e.style["stroke-dasharray"]=i),e.style["stroke-width"]=(0,s.valOrDefault)(a,5),e.style["stroke-linecap"]=r},createMarkerEnd(){(0,s.isNullOrUndefined)(this.definitions)&&(this.definitions=document.createElementNS("http://www.w3.org/2000/svg","defs")),this.end=document.createElementNS("http://www.w3.org/2000/svg","marker"),this.end.id="marker"+this.id,this.end.setAttribute("refY",5),this.end.setAttribute("refX",10),this.end.setAttribute("markerUnit","strokeWidth"),this.end.setAttribute("markerWidth",10),this.end.setAttribute("markerHeight",10),this.end.setAttribute("orient","auto"),this.end.classList.add("end");let t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),t.setAttribute("fill","black"),this.end.appendChild(t),this.definitions.appendChild(this.end),this.path.setAttribute("marker-end","url(#"+this.end.id+")")},setPath(t){this.path.setAttribute("d",t)}},Fa={init(){return this},render(){const{aiming:t,model:e,move:n,decorator:i=!1,style:a}=this.schema;return(0,s.isNullOrUndefined)(this.path)&&(this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.classList.add("arrow-path"),this.path.dataset.nature="arrow",this.path.dataset.algorithm="anchor",this.path.dataset.id=this.id),(0,s.isNullOrUndefined)(this.aiming)&&(this.aiming=this.source.getAttributeByName(t.name).target),(0,s.isNullOrUndefined)(this.anchorModel)&&(this.anchorModel=e,Qe.AnchorHandler.registerListener(e,this)),n&&(this.movingPiece=this.source.getAttributeByName(n.name).target,this.movingPiece.register(this)),i&&(0,s.isNullOrUndefined)(this.decorator)&&this.createDecorator(i),this.bind=this.projection.bind,this.bindEvents(),this.stylePath(a),this.path},update(){if(!(0,s.isNullOrUndefined)(this.movingPiece)&&this.movingPiece.hasValue()){let t=this.movingPiece.getValue();(0,s.isString)(t)&&(t=this.movingPiece.getValue(!0)),t.notify("accept",this.bind),(0,s.isNullOrUndefined)(this.path.parenNode)||t.notify("cover",this)}},deleteFromView(){Qe.AnchorHandler.unregister(this.anchorModel,this),this.movingPiece=null,this.path.remove(),this.decorator.remove()},createDecorator(t){this.decorator=da.call(this,t.render)},updateValue(){if(!this.aiming.hasValue())return this.path.remove(),this.decorator.remove(),void this.definitions.remove();let t=this.aiming.value.id||this.aiming.value,e=Qe.AnchorHandler.findSource(this.anchorModel,this.bind.element||this.bind.container),n=Qe.AnchorHandler.findTarget(this.anchorModel,t,e.index);if(this.schema.offset&&(e.x+=this.schema.offset.x,e.y+=this.schema.offset.y,n.x+=this.schema.offset.x,n.y+=this.schema.offset.y),this.decorator){const{origin:t,x:i,y:s}=this.schema.decorator.coordinates;switch(t){case"source":this.decorator.setAttribute("x",e.x+i),this.decorator.setAttribute("y",e.y+s),this.projection.parent.container.append(this.decorator);break;case"target":this.decorator.setAttribute("x",n.x+i),this.decorator.setAttribute("y",n.y+s),this.projection.parent.container.append(this.decorator);break;case"minX":e.x<n.x?(this.decorator.setAttribute("x",e.x+i),this.decorator.setAttribute("y",e.y+s)):(this.decorator.setAttribute("x",n.x+i),this.decorator.setAttribute("y",n.y+s)),this.projection.parent.container.append(this.decorator);break;case"minY":e.y<n.y?(this.decorator.setAttribute("x",e.x+i),this.decorator.setAttribute("y",e.y+s)):(this.decorator.setAttribute("x",n.x+i),this.decorator.setAttribute("y",n.y+s)),this.projection.parent.container.append(this.decorator);break;case"maxX":e.x>n.x?(this.decorator.setAttribute("x",e.x+i),this.decorator.setAttribute("y",e.y+s)):(this.decorator.setAttribute("x",n.x+i),this.decorator.setAttribute("y",n.y+s)),this.projection.parent.container.append(this.decorator);break;case"maxY":e.y>n.y?(this.decorator.setAttribute("x",e.x+i),this.decorator.setAttribute("y",e.y+s)):(this.decorator.setAttribute("x",n.x+i),this.decorator.setAttribute("y",n.y+s)),this.projection.parent.container.append(this.decorator)}}if(e.x===n.x&&e.y===n.y?this.setSelfPath(e):this.setPath("M "+e.x+" "+e.y+" L "+n.x+" "+n.y),this.definitions&&this.projection.parent.container.append(this.definitions),this.projection.parent.container.prepend(this.path),this.decorator&&this.environment.resolveElement(this.decorator).projection.update("displayed"),this.calcS=e.calc,this.calcT=n.calc,this.movingPiece&&this.movingPiece.hasValue()){let t=this.movingPiece.value;(0,s.isString)(t)&&(t=this.movingPiece.getValue(!0)),t.notify("cover",this)}},setSelfPath(t){const e=this.schema.self.points;let n={x:t.x,y:t.y},i="M "+t.x+" "+t.y+" ";for(let t=0;t<e.length;t++){const{x:s,y:a}=e[t];i+=" L "+(n.x+s)+" "+(n.y+a)+" ",n.x+=s,n.y+=a}this.path.setAttribute("d",i),this.path.setAttribute("fill","transparent")},bindEvents(){this.aiming.register(this.projection),this.projection.registerHandler("value.changed",(t=>{this.updateValue(t)}))}},qa=Object.assign({},za,Fa),$a={init(){return this},render(){const{style:t,from:e,to:n,decorator:i}=this.schema;return(0,s.isNullOrUndefined)(this.path)&&(this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.classList.add("arrow-path"),this.path.dataset.nature="arrow",this.path.dataset.algorithm="force",this.path.dataset.id=this.id),(0,s.isNullOrUndefined)(this.from)&&this.registerAttribute(e,!0),(0,s.isNullOrUndefined)(this.to)&&this.registerAttribute(n),t&&this.stylePath(t),i&&(0,s.isNullOrUndefined)(this.decorator)&&(this.decorator=da.call(this,i)),this.bindEvents(),this.path},registerAttribute(t,e=!1){const{name:n}=t;e?this.from=this.source.getAttributeByName(n).target:this.to=this.source.getAttributeByName(n).target},updateValue(){this.fromVal=this.from.value,this.toVal=this.to.value,(0,s.isNullOrUndefined)(this.fromVal)||(0,s.isNullOrUndefined)(this.toVal)?(0,s.isNullOrUndefined)(this.path.parentNode)||this.projection.parent.removeArrow(this,-1,this.decorator):this.projection.parent.addArrow(this,this.fromVal,this.toVal,this.decorator)},setPath(t){this.path.setAttribute("d",t)},bindEvents(){this.from.register(this.projection),this.to.register(this.projection),this.projection.registerHandler("value.changed",(()=>{this.updateValue()}))}},Wa=Object.assign({},za,$a),Za={minY:function(t){let e=t[0].y,n=t[0].x,i=t[0].x;for(let s=0;s<t.length;s++){const{x:a,y:r}=t[s];a<n&&(n=a),a>i&&(i=a),r<e&&(e=r)}this.setPath("M "+n+" "+e+" L "+i+" "+e),this.drawSupPath(t,e,!1)}},Xa={init(){return this.subPath=[],this.targets=[],this.elements=[],this},render(){const{style:t}=this.schema;return(0,s.isNullOrUndefined)(this.path)&&(this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.classList.add("arrow-path"),this.path.dataset.nature="arrow",this.path.dataset.algorithm="multi",this.path.dataset.id=this.id),this.bindEvents(),this.stylePath(t),this.path},addTarget(t){this.targets=[],this.elements.forEach((t=>{t.hasValue()&&this.targets.push(t.getValue())})),this.targets.length>1&&(this.drawPath(),this.projection.parent.container.append(this.path),this.subPath.forEach((t=>{this.projection.parent.container.append(t)})))},drawSupPath(t,e,n){(0,s.isEmpty)(this.subPath)||(this.subPath.forEach((t=>{t.remove()})),this.subPath=[]),t.forEach((t=>{if(t.y===e&&!n)return;if(t.x===e&&n)return;let i=document.createElementNS("http://www.w3.org/2000/svg","path");this.path.classList.add("arrow-subpath"),this.path.dataset.nature="arrow",this.path.dataset.algorithm="multi",this.path.dataset.id=this.id,n||i.setAttribute("d","M "+t.x+" "+e+" L "+t.x+" "+t.y),this.styleSubPath(this.schema.subpath.style,i),this.subPath.push(i)}))},drawPath(){const t=this.projection.parent.container;let e=[];for(let n=0;n<this.targets.length;n++){const i=this.targets[n];let a=t.querySelector("[data-concept='"+i+"']"),r=this.projection.resolveElement(a);if((0,s.isNullOrUndefined)(a))return;e.push({item:a,proj:r})}let n=[];for(let i=0;i<e.length;i++){let a=e[i].item.getBoundingClientRect();const r=t.createSVGPoint();r.x=a.x,r.y=a.y;const o=r.matrixTransform(t.getScreenCTM().inverse());(0,s.isNullOrUndefined)(e[i].proj.attachPoint)?n.push({x:o.x,y:o.y}):n.push({x:o.x+e[i].proj.attachPoint.x,y:o.y+e[i].proj.attachPoint.y})}Za[this.schema.meet].call(this,n)},removeTarget(t){(0,s.isNullOrUndefined)(this.targets)},registerElem(t){(0,s.isNullOrUndefined)(this.elements)&&(this.elements=[]),this.elements.push(t),t.register(this.projection)},unregisterElem(t){for(let e=0;e<this.elements.length;e++)if(this.elements[e]===t){this.elements[e].unregister(this.projection),this.elements.splice(e,1);break}this.elements.length>1?this.addTarget():(this.path.remove(),(0,s.isEmpty)(this.subPath)||this.subPath.forEach((t=>{t.remove()})))},deletePaths(){this.path.remove(),(0,s.isEmpty)(this.subPath)||this.subPath.forEach((t=>{t.remove()}))},bindEvents(){this.projection.registerHandler("value.added",(t=>{this.registerElem(t)})),this.projection.registerHandler("value.removed",(t=>{this.unregisterElem(t)})),this.projection.registerHandler("value.changed",(t=>{this.addTarget(t)}))}},Ya=Object.assign({},za,Xa);var Ga=0;const Ja=()=>"algo"+Ga++,Ka={force:(t,e,n)=>Object.create(Wa,{object:{value:"arrow"},name:{value:"force-arrow"},type:{value:"force"},id:{value:Ja()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),anchor:(t,e,n)=>Object.create(qa,{object:{value:"arrow"},name:{value:"anchor-arrow"},type:{value:"anchor"},id:{value:Ja()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),multi:(t,e,n)=>Object.create(Ya,{object:{value:"arrow"},name:{value:"multi-arrow"},type:{value:"multi"},id:{value:Ja()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})},Qa={createArrow(t,e,n){const{type:i}=e,a=Ka[i];if((0,s.isNullOrUndefined)(a))throw new TypeError(`Missing handler: The '${i}' arrow could not be handled`);const r=a(t,e,n);if((0,s.isNullOrUndefined)(r))throw new Error(`Bad request: The '${i}' arrow could not be created`);return r.createArrow=this.createArrow,(0,s.isNullOrUndefined)(r.id)&&(r.id=Ja()),r}},tr={},{isNullOrUndefined:er,valOrDefault:nr}=n(835),ir={init(){return this},render(){const{content:t}=this.schema;return er(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("shape-container"),this.container.dataset.nature="shape",this.container.dataset.shape="canas",this.container.dataset.id=this.id),er(t)||t.forEach((t=>{this.container.append(da.call(this,t))})),this.w=this.source.getAttributeByName("width").target,this.h=this.source.getAttributeByName("height").target,this.minX=this.source.getAttributeByName("minX").target,this.minY=this.source.getAttributeByName("minY").target,this.windowW=this.source.getAttributeByName("windowW").target,this.windowH=this.source.getAttributeByName("windowH").target,this.container.style.border="solid #87a1ff",this.refresh(),this.bindEvents(),this.container},refresh(){this.container.setAttribute("width",this.w.value),this.container.setAttribute("height",this.h.value);const t=nr(this.windowW.value,this.w.value),e=nr(this.windowH.value,this.h.value);this.container.setAttribute("viewBox",this.minX.value+" "+this.minY.value+" "+t+" "+e)},update(){this.refresh()},bindEvents(){this.w.register(this),this.h.register(this),this.minX.register(this),this.minY.register(this),this.windowW.register(this),this.windowH.register(this),this.container.addEventListener("click",(t=>{const e=t.target,{concept:n=null,nature:i=null,shape:s=null}=e.dataset;er(i)||"shape"!==i||"canvas"===s||this.source.getAttributeByName("current").setValue(n)}))},focusIn(){},focusOut(){},clickHandler(t){}},sr=Object.assign(Object.create(tr),ir),{isNullOrUndefined:ar,isEmpty:rr}=n(835),or={init(){return this.items=[],this},render(){const{add:t}=this.schema;return ar(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","g"),this.container.classList.add("shape-container"),this.container.dataset.nature="shape",this.container.dataset.shape="group",this.container.dataset.id=this.id),t&&(this.addButton=da.call(this,{kind:"static",type:"svg-button",action:{type:"CREATE"},content:'<svg style="overflow:visible" xmlns="http://www.w3.org/2000/svg" version="1.0"><text style="dominant-baseline:hanging;" font-family="Segoe UI" font-size="16">+</text></svg>'}),this.container.append(this.addButton)),rr(this.source)||this.reconstruct(),this.bindEvents(),this.container},reconstruct(){let t=this.source.value;for(let e=0;e<t.length;e++){let n=this.projection.environment.conceptModel.getConcept(t[e]).getValue(!0),i=this.model.createProjection(n,"shape");i.parent=this.projection;let s=i.init().render();this.items.push({concept:i.concept,projection:s,centered:!0}),i.concept.register(this.projection),this.container.append(s),this.blur()}},createItem(t){let e=this.model.createProjection(t,"shape");e.parent=this.projection;let n=e.init().render();return this.items.push({concept:e.concept,projection:n,centered:!1}),e.concept.register(this.projection),this.blur(),n},addItem(t){let e=this.createItem(t);this.container.append(e)},removeItem(t){for(let e=0;e<this.items.length;e++)if(this.items[e].concept.id===t.id)return this.items[e].projection.remove(),ar(this.items[e].container)||this.items[e].container.remove(),void this.items.splice(e,1)},update(){for(let t=0;t<this.items.length;t++)this.items[t].centered||this.center(this.items[t]),this.items[t].centered=!0},center(t){const e=t.concept.getValue(!0),n=this.getWindow();switch(e.name){case"circle":e.getAttributeByName("cx").setValue((n.minX+n.vW)/2),e.getAttributeByName("cy").setValue((n.minY+n.vH)/2),e.getAttributeByName("r").setValue(20*n.vW/n.width);break;case"rectangle":const t=40*n.vW/n.width,i=30*n.vH/n.height;e.getAttributeByName("x").setValue((n.minX+n.vW)/2-t/2),e.getAttributeByName("y").setValue((n.minY+n.vH)/2-i/2),e.getAttributeByName("width").setValue(t),e.getAttributeByName("height").setValue(i);break;case"ellipse":const s=40*n.vW/(2*n.width),a=30*n.vH/(2*n.height);e.getAttributeByName("cx").setValue((n.minX+n.vW)/2),e.getAttributeByName("cy").setValue((n.minY+n.vH)/2),e.getAttributeByName("rx").setValue(s),e.getAttributeByName("ry").setValue(a);break;case"polygon":const r=40*n.vW/(2*n.width),o=30*n.vH/(2*n.height),l=(n.minX+n.vW)/2,c=(n.minY+n.vH)/2,h={x:l-r/4,y:c-o/2},u={x:l+r/4,y:c-o/2},d={x:l+r/2,y:c-o/4},p={x:l+r/2,y:c+o/4},m={x:l+r/4,y:c+o/2},f={x:l-r/4,y:c+o/2},g={x:l-r/2,y:c+o/4},y={x:l-r/2,y:c-o/4};e.getAttributeByName("points").setValue(h.x+" "+h.y+", "+u.x+" "+u.y+", "+d.x+" "+d.y+", "+p.x+" "+p.y+", "+m.x+" "+m.y+", "+f.x+" "+f.y+", "+g.x+" "+g.y+", "+y.x+" "+y.y);break;case"path":const b=40*n.vW/(2*n.width),v=(n.vH,n.height,(n.minX+n.vW)/2),x=(n.minY+n.vH)/2;e.getAttributeByName("d").setValue("M "+(v-b/2)+" "+x+" L "+(v+b/2)+" "+x)}let i=this.model.createProjection(e,"shape");i.parent=this.projection;let s=i.init().render();this.container.append(s),t.container=s},focusIn(){},focusOut(){},blur(){},getWindow(){const t=this.container.parentNode,e=t.viewBox.baseVal;return{width:Number(t.getAttribute("width")),height:Number(t.getAttribute("height")),vW:e.width,vH:e.height,minX:e.x,minY:e.y}},bindEvents(){this.projection.registerHandler("value.added",(t=>{this.addItem(t)})),this.projection.registerHandler("value.changed",(t=>{this.update()})),this.projection.registerHandler("value.removed",(t=>{this.removeItem(t)}))}},lr=Object.assign(Object.create(tr),or),{isNullOrUndefined:cr}=n(835),hr={init(){return this},render(){return cr(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","circle"),this.element.classList.add("shape-container"),this.element.dataset.nature="shape",this.element.dataset.shape="circle",this.element.dataset.id=this.id),this.cx=this.source.getAttributeByName("cx").target,this.cy=this.source.getAttributeByName("cy").target,this.r=this.source.getAttributeByName("r").target,this.refresh(),this.bindEvents(),this.bindStyle(),this.element},refresh(){this.element.setAttribute("cx",this.cx.value),this.element.setAttribute("cy",this.cy.value),this.element.setAttribute("r",this.r.value)},bindEvents(){this.cx.register(this),this.cy.register(this),this.r.register(this),this.element.addEventListener("click",(()=>{this.source.notify("current.updated",this.source)}))},bindStyle(){const t=this.source.getAttributeByName("style").target;this.fill=t.getAttributeByName("fill").target,this.stroke=t.getAttributeByName("stroke").target,this.width=t.getAttributeByName("s-width").target,this.dash=t.getAttributeByName("s-dash").target,this.fill.register(this),this.stroke.register(this),this.width.register(this),this.dash.register(this)},update(t){this.refresh(),cr(this.fill.value)||this.element.setAttribute("fill",this.fill.value),cr(this.stroke.value)||this.element.setAttribute("stroke",this.stroke.value),cr(this.width.value)||(this.element.style["stroke-width"]=this.width.value),cr(this.dash.value)||(this.element.style["stroke-dasharray"]=this.dash.value)},focusIn(){},focusOut(){}},ur=Object.assign(Object.create(tr),hr),{isNullOrUndefined:dr}=n(835),pr={init(){return this},render(){return dr(this.container)&&(this.container=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.container.classList.add("shape-container"),this.container.dataset.nature="shape",this.container.dataset.shape="group",this.container.dataset.id=this.id),this.bindEvents(),this.container.style.overflow="visible",this.container},bindEvents(){this.projection.registerHandler("value.changed",(t=>{let e=this.model.createProjection(this.source.getValue(!0),"shape");e.parent=this.projection;let n=e.init().render();this.container.append(n)}))}},mr=Object.assign(Object.create(tr),pr),{isNullOrUndefined:fr}=n(835),gr={init(){return this},render(){return fr(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.element.classList.add("shape-container"),this.element.dataset.nature="shape",this.element.dataset.shape="circle",this.element.dataset.id=this.id),this.x=this.source.getAttributeByName("x").target,this.y=this.source.getAttributeByName("y").target,this.width=this.source.getAttributeByName("width").target,this.height=this.source.getAttributeByName("height").target,this.refresh(),this.bindEvents(),this.bindStyle(),this.element},refresh(){this.element.setAttribute("x",this.x.value),this.element.setAttribute("y",this.y.value),this.element.setAttribute("height",this.height.value),this.element.setAttribute("width",this.width.value)},bindStyle(){const t=this.source.getAttributeByName("style").target;this.fill=t.getAttributeByName("fill").target,this.stroke=t.getAttributeByName("stroke").target,this.widthS=t.getAttributeByName("s-width").target,this.dash=t.getAttributeByName("s-dash").target,this.rx=t.getAttributeByName("rx").target,this.ry=t.getAttributeByName("ry").target,this.fill.register(this),this.stroke.register(this),this.widthS.register(this),this.dash.register(this),this.rx.register(this),this.ry.register(this)},update(t){this.refresh(),fr(this.fill.value)||this.element.setAttribute("fill",this.fill.value),fr(this.stroke.value)||(this.element.style.stroke=this.stroke.value),fr(this.widthS.value)||(this.element.style["stroke-width"]=this.widthS.value),fr(this.dash.value)||(this.element.style["stroke-dasharray"]=this.dash.value),fr(this.rx.value)||this.element.setAttribute("rx",this.rx.value),fr(this.ry.value)||this.element.setAttribute("ry",this.ry.value)},bindEvents(){this.x.register(this),this.y.register(this),this.width.register(this),this.height.register(this)}},yr=Object.assign(Object.create(tr),gr),{isNullOrUndefined:br}=n(835),vr={init(){return this},render(){return br(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),this.element.classList.add("shape-container"),this.element.dataset.nature="shape",this.element.dataset.shape="ellipse",this.element.dataset.id=this.id),this.cx=this.source.getAttributeByName("cx").target,this.cy=this.source.getAttributeByName("cy").target,this.rx=this.source.getAttributeByName("rx").target,this.ry=this.source.getAttributeByName("ry").target,this.refresh(),this.bindEvents(),this.bindStyle(),this.element},refresh(){this.element.setAttribute("cx",this.cx.value),this.element.setAttribute("cy",this.cy.value),this.element.setAttribute("ry",this.ry.value),this.element.setAttribute("rx",this.rx.value)},bindStyle(){const t=this.source.getAttributeByName("style").target;this.fill=t.getAttributeByName("fill").target,this.stroke=t.getAttributeByName("stroke").target,this.width=t.getAttributeByName("s-width").target,this.dash=t.getAttributeByName("s-dash").target,this.fill.register(this),this.stroke.register(this),this.width.register(this),this.dash.register(this)},update(t){this.refresh(),br(this.fill.value)||this.element.setAttribute("fill",this.fill.value),br(this.stroke.value)||(this.element.style.stroke=this.stroke.value),br(this.width.value)||(this.element.style["stroke-width"]=this.width.value),br(this.dash.value)||(this.element.style["stroke-dasharray"]=this.dash.value)},bindEvents(){this.cx.register(this),this.cy.register(this),this.rx.register(this),this.ry.register(this)}},xr=Object.assign(Object.create(tr),vr),{isNullOrUndefined:wr}=n(835),Er={init(){return this},render(){return wr(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","polygon"),this.element.classList.add("shape-container"),this.element.dataset.nature="shape",this.element.dataset.shape="polygon",this.element.dataset.id=this.id),this.points=this.source.getAttributeByName("points").target,this.refresh(),this.bindEvents(),this.element},refresh(){this.element.setAttribute("points",this.points.value)},update(t){this.refresh()},bindEvents(){this.points.register(this)}},Ar=Object.assign(Object.create(tr),Er),{isNullOrUndefined:jr}=n(835),kr={init(){return this},render(){return jr(this.element)&&(this.element=document.createElementNS("http://www.w3.org/2000/svg","path"),this.element.classList.add("shape-container"),this.element.dataset.nature="shape",this.element.dataset.shape="path",this.element.dataset.id=this.id),this.d=this.source.getAttributeByName("d").target,this.element.style["stroke-width"]=5,this.element.style.stroke="black",this.source.getAttributeByName("style").target.getAttributeByName("s-width").setValue(5),this.refresh(),this.bindEvents(),this.bindStyle(),this.element},refresh(){this.element.setAttribute("d",this.d.value)},bindEvents(){this.d.register(this)},bindStyle(){},update(t){this.refresh(),jr(this.stroke.value)||this.element.setAttribute("fill",this.fill.value),jr(this.stroke.value)||(this.element.style.stroke=this.stroke.value),jr(this.width.value)||(this.element.style["stroke-width"]=this.width.value),jr(this.dash.value)||(this.element.style["stroke-dasharray"]=this.dash.value)},bindStyle(){const t=this.source.getAttributeByName("style").target;this.fill=t.getAttributeByName("fill").target,this.stroke=t.getAttributeByName("stroke").target,this.width=t.getAttributeByName("s-width").target,this.dash=t.getAttributeByName("s-dash").target,this.fill.register(this),this.stroke.register(this),this.width.register(this),this.dash.register(this)},focusIn(){},focusOut(){}},Nr=Object.assign(Object.create(tr),kr);var _r=0;const Or=()=>"algo"+_r++,Lr={canvas:(t,e,n)=>Object.create(sr,{object:{value:"shape"},name:{value:"canvas-shape"},type:{value:"canvas"},id:{value:Or()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),group:(t,e,n)=>Object.create(lr,{object:{value:"shape"},name:{value:"group-shape"},type:{value:"group"},id:{value:Or()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),circle:(t,e,n)=>Object.create(ur,{object:{value:"shape"},name:{value:"circle-shape"},type:{value:"circle"},id:{value:Or()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),holder:(t,e,n)=>Object.create(mr,{object:{value:"shape"},name:{value:"holder-shape"},type:{value:"holder"},id:{value:Or()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),rectangle:(t,e,n)=>Object.create(yr,{object:{value:"shape"},name:{value:"rectangle-shape"},type:{value:"rectangle"},id:{value:Or()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),ellipse:(t,e,n)=>Object.create(xr,{object:{value:"shape"},name:{value:"ellipse-shape"},type:{value:"ellipse"},id:{value:Or()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),polygon:(t,e,n)=>Object.create(Ar,{object:{value:"shape"},name:{value:"polygon-shape"},type:{value:"polygon"},id:{value:Or()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}}),path:(t,e,n)=>Object.create(Nr,{object:{value:"shape"},name:{value:"path-shape"},type:{value:"path"},id:{value:Or()},model:{value:t},schema:{value:e},projection:{value:n},source:{value:n.concept,writable:!0}})},Mr={createShape(t,e,n){const{type:i}=e,a=Lr[i];if((0,s.isNullOrUndefined)(a))throw new TypeError(`Missing handler: The '${i}' shape could not be handled`);const r=a(t,e,n);if((0,s.isNullOrUndefined)(r))throw new Error(`Bad request: The '${i}' shape could not be created`);return r.createShape=this.createShape,(0,s.isNullOrUndefined)(r.id)&&(r.id=Or()),r}};var Cr=0;const Sr={createProjection(t,e,n,i){var a=Object.create(Tr,{id:{value:(0,s.valOrDefault)(e.id,"projection"+Cr++)},model:{value:t},schema:{value:e,writable:!0},environment:{value:i}});return a.concept=n,a}},Tr={handlers:null,init(t={}){return this.containers=new Map,this.attributes=[],this.params=[],this.templates=[],this.handlers={},this.args=t,this.concept.register(this),this},schema:null,concept:null,environment:null,parent:null,containers:null,placeholder:null,element:null,attributes:null,params:null,index:0,editing:!1,optional:!1,collapsible:!1,searchable:!1,focusable:!0,get hasMultipleViews(){return this.schema.length>1},get isReadOnly(){return(0,s.valOrDefault)(this.getSchema().readonly,!1)},isRoot(){return(0,s.isNullOrUndefined)(this.parent)},getSchema(t){return this.schema[(0,s.valOrDefault)(t,this.index)]},hasSchema(t){return-1!==this.schema.findIndex((e=>e.tags.includes(t)))},getContainer(t){return this.containers.get((0,s.valOrDefault)(t,this.index))},getStyle(){const{style:t}=this.getSchema();return t},addTemplate(t){this.templates.push(t)},addParam(t){this.params.push(...Array.isArray(t)?t:[t])},getParam(t,e){let n=this.params.find((e=>e.name===t));if((0,s.isNullOrUndefined)(n))return;const{type:i="string",value:a}=n;let r=(0,s.valOrDefault)(a,n.default);return(0,s.isNullOrUndefined)(r)?null:"string"===i?r.toString():"number"===i?+r:"boolean"===i?(0,s.toBoolean)(r):void 0},getParent(){return this.isRoot()?null:this.parent},getAttributes(t){return this.attributes.filter((e=>e.name===t))},getField(t){return this.environment.getField(t)},getStatic(t){return this.environment.getStatic(t)},getLayout(t){return this.environment.getLayout(t)},resolveElement(t){return this.environment.resolveElement(t)},getHandlers(t){return(0,s.valOrDefault)(this.handlers[t],[])},update(t,e,n){if((0,s.isEmpty)(this.containers))return;if("delete"===t&&n===this.concept)return void this.delete();const i=this.getHandlers(t);switch((0,s.isEmpty)(i)||i.forEach((t=>{t(e,n)})),t){case"attribute.added":return void this.getAttributes(e.name).forEach((t=>{const{schema:n}=t,i=this.model.createProjection(e.target,n.tag).init();i.parent=this,i.optional=!0;const s=i.render();Kt.call(this,s,n.style),i.element.parent=t.parent,t.element=s,t.placeholder&&(t.placeholder.after(s),(0,a.Cp)(t.placeholder))}));case"attribute.removed":return void this.getAttributes(e.name).forEach((t=>{t.element&&((0,s.removeChildren)(t.element).remove(),t.element=null),t.placeholder&&(0,a.$Z)(t.placeholder)}))}},delete(){return this.concept&&setTimeout((()=>{this.concept.unregister(this)}),50),this.placeholder&&this.getContainer().after(this.placeholder),this.containers.forEach((t=>{if((0,s.removeChildren)(t),(0,s.isHTMLElement)(t)&&t.remove(),"path"===t.tagName){if("force"===t.dataset.algorithm){let e=this.environment.resolveElement(t);e.projection.parent.removeArrow(e)}"anchor"===t.dataset.algorithm&&this.environment.resolveElement(t).deleteFromView(),"multi"===t.dataset.algorithm&&this.environment.resolveElement(t).deletePaths()}["svg","text"].includes(t.tagName)&&t.remove(),this.sibling&&this.sibling.delete()})),this.model.removeProjection(this.id),!0},registerHandler(t,e){return Array.isArray(this.handlers[t])||(this.handlers[t]=[]),this.handlers[t].push(e),!0},unregisterHandler(t,e){if(!(0,s.hasOwn)(this.handlers,t))return!1;for(let n=0;n<this.handlers[t].length;n++)if(this.handlers[t][n]===e)return this.handlers[t].splice(n,1),!0;return!1},focus(){this.element.focus()},render(){const t=this.getSchema();if((0,s.isNullOrUndefined)(t))return null;const{type:e,projection:n,content:i,kind:a,sibling:r,rtag:o,ratio:l}=t;var c=null;if("layout"===e||"layout"===a)this.element=Va.createLayout(this.model,(0,s.valOrDefault)(n,i),this).init(this.args),this.model.registerLayout(this.element);else if("field"===e||"field"===a){let e=(0,s.hasOwn)(t,"field")?t.field:(0,s.valOrDefault)(n,i);this.element=Hn.createField(this.model,e,this).init(this.args),this.model.registerField(this.element)}else"static"===e||"static"===a?(this.element=ji.createStatic(this.model,(0,s.valOrDefault)(n,i),this).init(this.args),this.element.source=this.concept,this.model.registerStatic(this.element)):"dynamic"===e||"dynamic"===a?(this.element=ji.createStatic(this.model,(0,s.valOrDefault)(n,i),this).init(this.args),this.model.registerStatic(this.element)):"algorithm"===e?(this.element=js.createAlgo(this.model,(0,s.valOrDefault)(n,i),this).init(this.args),this.model.registerAlgorithm(this.element)):"arrow"===e?(this.element=Qa.createArrow(this.model,(0,s.valOrDefault)(n,i),this).init(this.args),this.model.registerArrow(this.element)):"shape"===e?(this.element=Mr.createShape(this.model,(0,s.valOrDefault)(n,i),this).init(this.args),this.model.registerShape(this.element)):"simulation"===e?(this.element=oa.createSimulation(this.model,(0,s.valOrDefault)(n,i),this).init(this.args),this.model.registerSimulation(this.element)):(this.element=Mi(this.model,t.container,this).init(this.args),this.model.registerLayout(this.element));if(this.isRoot()&&(this.element.focusable=!0),this.focusable||(this.element.focusable=!1),this.readonly&&(this.element.readonly=!0),c=this.element.render(),this.element.focusable||(c.tabIndex=-1),!(0,s.isNode)(c))throw new Error("Projection element container could not be created");if(c.classList.add("projection"),Object.assign(c.dataset,{projection:this.id,concept:this.concept.id,object:this.concept.object}),this.optional)if(this.element.schema.rmv)this.element.createDelete(),c.dataset.deletable=!0;else{let t=(0,s.createButton)({class:["btn","structure__btn-delete","projection__btn-delete"],title:`Delete ${this.concept.name}`,tabindex:-1,dataset:{action:"delete",projection:this.id}});t.addEventListener("click",(t=>{let e=this.getContainer(),n=(0,s.findAncestor)(e,(t=>0===t.tabIndex));this.environment.save(this.concept.getParent(),e.cloneNode(!0)),this.concept.delete();let i=this.environment.resolveElement(n);(0,s.isNullOrUndefined)(i)||i.focus()})),c.dataset.deletable=!0,c.prepend(t)}if(this.collapsible){let t=(0,s.createButton)({class:["btn","projection__btn-collapse"],title:`Collapse ${this.concept.name}`,tabindex:-1,dataset:{action:"collapse",projection:this.id}});t.addEventListener("click",(t=>{this.getContainer().classList.toggle("collapsed")})),c.dataset.collapsible=!0,c.prepend(t)}return this._style&&Kt.call(this,c,this._style),this.containers.set(this.index,c),r&&this.createSibling(this.concept,r,this.element),o&&(this.rtag=o,this.environment.registerReceiver(this.element,o)),c},refresh(){this.editing?this.containers.forEach((t=>{t.tabIndex=0})):this.containers.forEach((t=>{t.tabIndex=null}))},createSibling(t,e){const{render:n,params:i=!1,bind:a}=e,{tag:r,rtag:o}=n;if(this.checkForAliveSibling(t.id,r,o))return;let l=this.model.createProjection(t,r).init();a&&(l.bind=this.element);let c=l.render();if(i){const{coordinates:t,dimension:e}=i;c.setAttribute("x",t.x),c.setAttribute("y",t.y)}let h=this.environment.getActiveReceiver(o);l.parent=h,(0,s.isNullOrUndefined)(l.element.path)&&h.container.append(l.element.element||l.element.container),this.sibling=l},checkForAliveSibling(t,e,n){if((0,s.isNullOrUndefined)(this.environment.siblingModel)&&(this.environment.siblingModel=new Map),(0,s.isNullOrUndefined)(this.environment.siblingModel.get(t)))return this.environment.siblingModel.set(t,[{tag:e,rtag:n}]),!1;let i=this.environment.siblingModel.get(t);for(let t=0;t<i.length;t++)if(i[t].rtag===n&&i[t].tag===e)return!0;return i.push([{tag:e,rtag:n}]),this.environment.siblingModel.set(t,i),!1},changeView(t){if(!this.hasMultipleViews)return void this.environment.notify("There is no alternative projection for this concept");let e=this.getContainer();this.index=(0,s.valOrDefault)(t,(this.index+1)%this.schema.length);let n=this.getContainer();(0,s.isHTMLElement)(n)||(this.params=[],n=this.render()),e.replaceWith(n),this.element=this.resolveElement(n),"svg"===this.element.type&&this.element.update();const i=this.getHandlers("view.changed");return(0,s.isEmpty)(i)||i.forEach((t=>t(n))),this.focus(),this},findView(t){if(!this.hasSchema(t)){if(!this.model.hasProjectionSchema(this.concept,t))return-1;let e=this.model.getProjectionSchema(this.concept,t);this.schema.push(...e)}return this.schema.findIndex((e=>e.tags.includes(t)))},export(){return{id:this.id,root:this.isRoot(),concept:{id:this.concept.id,name:this.concept.name}}},bindEvents(){}},Ir=[{concept:{name:"set"},type:"field",tags:[],content:{type:"list"}},{concept:{name:"boolean"},type:"field",tags:[],content:{type:"binary"}},{concept:{name:"string"},type:"field",tags:[],content:{type:"text"}},{concept:{name:"number"},type:"field",tags:[],content:{type:"text",input:{type:"number"}}},{concept:{name:"reference"},type:"field",tags:[],content:{type:"choice"}}];function Ur(t,e){return Object.create(Dr,{schema:{value:(0,s.valOrDefault)(t,{projection:[],algorithm:[],template:[],style:[]}),writable:!0},editor:{value:e},environment:{value:e}})}const Dr={projections:null,fields:null,statics:null,layouts:null,algos:null,init(t){return this.projections=[],this.fields=new Map,this.statics=new Map,this.layouts=new Map,this.algos=new Map,this.arrows=new Map,this.shapes=new Map,this.simulations=new Map,this},addSchema(t){return Array.isArray(t.projection)&&this.schema.projection.push(...t.projection),Array.isArray(t.template)&&this.schema.template.push(...t.template),Array.isArray(t.style)&&this.schema.style.push(...t.style),this.environment.update("projection-model.updated"),!0},setSchema(t){return this.schema=[...t,...Ir],this.environment.update("projection-model.updated"),this},done(){for(;!(0,s.isEmpty)(this.projections);)this.projections[0].delete();return this.projections=[],this.fields.clear(),this.layouts.clear(),this.statics.clear(),this},createProjection(t,e){const n=this.getProjectionSchema(t,e);(0,s.isEmpty)(n)&&this.environment.notify(`Missing projection (#${e}) for ${t.name}`,a.k$.WARNING);const i=Sr.createProjection(this,n,t,this.environment);return i.tag=e,this.addProjection(i),i},getProjections(){return this.projections.slice()},getProjection(t){return Number.isInteger(t)?this.projections[t]:this.projections.find((e=>e.id===t))},addProjection(t){if((0,s.isNullOrUndefined)(t))throw new TypeError("Bad request: The 'projection' argument must be a Projection");return this.projections.push(t),this},removeProjection(t){var e=this.projections.findIndex((e=>e.id===t));return-1!==e&&(this.projections.splice(e,1),!0)},registerField(t){return t.environment=this.environment,t.editor=this.environment,this.fields.set(t.id,t),this},unregisterField(t){var e=this.fields.get(t.id);return e&&(e.environment=null,this.fields.delete(e.id)),this},getField(t){return this.fields.get(t)},registerStatic(t){return t.environment=this.environment,t.editor=this.environment,this.statics.set(t.id,t),this},unregisterStatic(t){var e=this.statics.get(t.id);return e&&(e.environment=null,this.statics.delete(e.id)),this},getStatic(t){return this.statics.get(t)},registerLayout(t){return t.environment=this.environment,t.editor=this.environment,this.layouts.set(t.id,t),this},unregisterLayout(t){var e=this.layouts.get(t.id);return e&&(e.environment=null,this.layouts.delete(e.id)),this},getLayout(t){return this.layouts.get(t)},registerArrow(t){return t.environment=this.environment,this.arrows.set(t.id,t),this},unregisterArrow(t){var e=this.arrows.get(t.id);return e&&(e.environment=null,this._arrow.delete(e.id)),this},getArrow(t){return this.arrows.get(t)},registerShape(t){return t.environment=this.environment,this.shapes.set(t.id,t),this},registerSimulation(t){return t.environment=this.environment,this.simulations.set(t.id,t),this},unregisterArrow(t){var e=this.shapes.get(t.id);return e&&(e.environment=null,this._shape.delete(e.id)),this},getArrow(t){return this.shapes.get(t)},registerAlgorithm(t){return t.environment=this.environment,this.algos.set(t.id,t),this},unregisterAlgorithm(t){var e=this.algos.get(t.id);return e&&(e.environment=null,this.algos.delete(e.id)),this},getAlgo(t){return this.algos.get(t)},getSimulation(t){return this.simulations.get(t)},getArrow(t){return this.arrows.get(t)},getMetadata(t){let e=this.schema.find((e=>e.id===t));return e?e.metadata:null},hasConceptProjection(t,e){let n=null;return n=(0,s.isString)(t)?this.schema.projection.filter((e=>e.concept.name===t)):this.schema.projection.filter((e=>{return(e=>e&&(e===t.name||t.schema&&e===t.schema.base))(e.concept.name)||(n=e.concept.prototype,!(0,s.isNullOrUndefined)(n)&&"prototype"!==t.nature&&t.hasPrototype(n));var n})),(0,s.isIterable)(e)&&!(0,s.isEmpty)(e)?-1!==n.findIndex((t=>(t=>Array.isArray(t.tags)&&t.tags.includes(e))(t))):!(0,s.isEmpty)(n)},getSchema(){return this.schema},getProjectionSchema(t,e){if((0,s.isNullOrUndefined)(t))throw new TypeError("Bad parameter: concept");var n=null;return n=(0,s.isString)(t)?this.schema.projection.filter((e=>e.concept.name===t)):this.schema.projection.filter((e=>{return(e=>e&&(e===t.name||t.schema&&e===t.schema.base))(e.concept.name)||(n=e.concept.prototype,!(0,s.isNullOrUndefined)(n)&&"prototype"!==t.nature&&t.hasPrototype(n));var n})),(0,s.isIterable)(e)&&!(0,s.isEmpty)(e)?n.filter((t=>t.tags&&t.tags.includes(e))):n},getTemplateSchema(t){let e=this.schema.template.find((e=>e.name===t));return(0,s.isNullOrUndefined)(e)?null:(0,a.p$)(e)},getGFragmentSchema(t){let e=this.schema.find((e=>"g-fragment"===e.type&&e.name===t));return(0,s.isNullOrUndefined)(e)?null:(0,a.p$)(e)},getRuleSchema(t){let e=this.schema.find((e=>"rule"===e.type&&e.name===t));return(0,s.isNullOrUndefined)(e)?null:(0,a.p$)(e)},getStyleSchema(t){let e=this.schema.style.find((e=>e.name===t));return(0,s.isNullOrUndefined)(e)?null:(0,a.p$)(e)},hasProjectionSchema(t,e){if((0,s.isNullOrUndefined)(t))throw new TypeError("Bad parameter: concept");let n=[];return n=(0,s.isString)(t)?this.schema.projection.filter((e=>e.concept.name===t)):this.schema.projection.filter((e=>{return(e=>e&&(e===t.name||t.schema&&e===t.schema.base))(e.concept.name)||(n=e.concept.prototype,!(0,s.isNullOrUndefined)(n)&&"prototype"!==t.nature&&t.hasPrototype&&t.hasPrototype(n));var n})),(0,s.isIterable)(e)&&!(0,s.isEmpty)(e)?n.some((t=>t.tags&&t.tags.includes(e))):!(0,s.isEmpty)(n)},export(){const t=[];return this.getProjections().forEach((e=>{t.push(e.export())})),t}},Hr={unloadAllConcept(){return this.hasConceptModel&&(this.conceptModel.done(),this.conceptModel=null,this.refresh()),this.triggerEvent({name:"editor.unload-concept@post"}),this},unloadAllProjection(){return this.hasProjectionModel&&(this.projectionModel.done(),this.projectionModel=null,this.refresh()),this.triggerEvent({name:"editor.unload-projection@post"}),this},loadSession(){this.conceptModel.getRootConcepts().forEach((t=>{this.createInstance(t)}))},loadConcept(t,e){let n=t.concept||t,i=t.values;return Array.isArray(n)?(0,s.isEmpty)(n)?(this.notify("The concept schema is empty",a.k$.ERROR),!1):((0,s.isNullOrUndefined)(this.conceptModel)&&(this.conceptModel=Xt.createModel(null,this).init()),this.conceptModel.addConceptSchema(n),this.conceptModel.init(i),this.triggerEvent({name:"editor.load-concept@post",args:[e,JSON.stringify(t)]}),this.refresh(),this):(this.notify("Invalid concept schema",a.k$.ERROR),!1)},loadValues(t,e){let n=t;if(!(0,s.isNullOrUndefined)(this.conceptModel))return this.conceptModel.initValue(n),this.loadSession(),this.triggerEvent({name:"editor.load-values@post",args:[e,JSON.stringify(n)]}),this.refresh(),this;console.error("concept model not found")},loadConcepts(t){return Array.isArray(t)?(0,s.isEmpty)(t)?(this.notify("The concept schema is empty",a.k$.ERROR),!1):((0,s.isNullOrUndefined)(this.conceptModel)&&(this.conceptModel=Xt.createModel(null,this).init()),t.forEach((t=>{this.conceptModel.addConceptSchema(t)})),this.refresh(),this):(this.notify("Invalid concept schema",a.k$.ERROR),!1)},loadProjection(t,e){return this.activeElement=null,this.activeInstance=null,this.activeConcept=null,this.activeProjection=null,(0,s.isNullOrUndefined)(this.projectionModel)&&(this.projectionModel=Ur(t,this).init()),this.projectionModel.addSchema(t),(0,s.isNullOrUndefined)(this.projectionModel),this.instances.forEach((t=>{t.projection=this.projectionModel.createProjection(t.concept).init(),t.render()})),this.triggerEvent({name:"editor.load-projection@post",args:[e,JSON.stringify(t)]}),this.refresh(),this},loadProjections(t){return Array.isArray(t)?(0,s.isEmpty)(t)?(this.notify("The concept schema is empty",a.k$.ERROR),!1):(this.activeElement=null,this.activeInstance=null,this.activeConcept=null,this.activeProjection=null,(0,s.isNullOrUndefined)(this.projectionModel)&&(this.projectionModel=Ur(null,this).init()),t.forEach((t=>{this.projectionModel.addSchema(t)})),this.refresh(),this):(this.notify("Invalid concept schema",a.k$.ERROR),!1)},load(t,e){let n=t.type;if((0,s.isNullOrWhitespace)(n)){let e=t.name.indexOf(".")+1;n=t.name.substring(e)}else n=a.D3[n];"jsoncp"===n&&"json"===n||this.addResource(t,e);let i=new FileReader;return i.onload=t=>{const n=JSON.parse(i.result),{type:s}=n;"concept"===s?this.loadConcept(n,e):"projection"===s?this.loadProjection(n,e):"model"===s&&(this.loadConcept(n.concept),this.loadProjection(n.projection),this.loadValues(n.values))},i.readAsText(t),!0},unload(){return this.unloadAllConcept(),this.unloadAllProjection(),this.clear(),this}},Pr={getField(t){if(!(0,s.isHTMLElement)(t)&&"path"!==t.tagName&&"text"!==t.tagName&&"svg"!==t.tagName)return console.warn("Field error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,s.isNullOrUndefined)(e)?(console.warn("Field error: Missing id attribute on field"),null):["field","field-component"].includes(n)?this.projectionModel.getField(e):(console.warn("Field error: Unknown nature attribute on field"),null)},getStatic(t){if(!(0,s.isHTMLElement)(t)&&"svg"!==t.tagName)return console.warn("Static error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,s.isNullOrUndefined)(e)?(console.warn("Static error: Missing id attribute on field"),null):["static","static-component"].includes(n)?this.projectionModel.getStatic(e):(console.warn("Static error: Unknown nature attribute on field"),null)},getLayout(t){if(!(0,s.isHTMLElement)(t)&&"svg"!==t.tagName)return console.warn("Layout error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,s.isNullOrUndefined)(e)?(console.warn("Layout error: Missing id attribute on field"),null):["layout","layout-component"].includes(n)?this.projectionModel.getLayout(e):(console.warn("Layout error: Unknown nature attribute on field"),null)},getAlgo(t){if(!(0,s.isHTMLElement)(t)&&"svg"!==t.tagName&&"text"!==t.tagName)return console.warn("Algo error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,s.isNullOrUndefined)(e)?(console.warn("Algo error: Missing id attribute on field"),null):["algorithm"].includes(n)?this.projectionModel.getAlgo(e):(console.warn("algo error: Unknown nature attribute on field"),null)},getSimulation(t){if(!(0,s.isHTMLElement)(t)&&"svg"!==t.tagName&&"text"!==t.tagName)return console.warn("Simulation error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,s.isNullOrUndefined)(e)?(console.warn("Simulation error: Missing id attribute on Simulation"),null):["simulation"].includes(n)?this.projectionModel.getSimulation(e):(console.warn("Simulation error: Unknown nature attribute on Simulation"),null)},getArrow(t){if("path"!==t.tagName)return console.warn("Arrow error: Bad argument"),null;const{id:e,nature:n}=t.dataset;return(0,s.isNullOrUndefined)(e)?(console.warn("Arrow error: Missing id attribute on field"),null):["arrow","arrow-path"].includes(n)?this.projectionModel.getArrow(e):(console.warn("Layout error: Unknown nature attribute on field"),null)},resolveElement(t){if(t instanceof SVGElement){let e=t;for(;!(0,s.isNullOrUndefined)(e.parentNode)&&(0,s.isNullOrUndefined)(e.dataset);)e=e.parentNode;(0,s.isNullOrUndefined)(e.dataset.nature)||(t=e)}if(!(0,s.isHTMLElement)(t)&&"path"!==t.tagName&&"svg"!==t.tagName&&"text"!==t.tagName)return null;const{nature:e}=t.dataset;if((0,s.isNullOrUndefined)(e))return null;let n=null;switch(e){case"field":case"field-component":n=this.getField(t);break;case"layout":case"layout-component":n=this.getLayout(t);break;case"static":case"static-component":n=this.getStatic(t);break;case"algorithm":n=this.getAlgo(t);break;case"simulation":n=this.getSimulation(t);break;case"arrow":n=this.getArrow(t)}return n&&(n.environment=this),n}};var Rr=0;const Br={createState(t,e){const{id:n,name:i}=t;let a="value"+Rr++,r=JSON.stringify(t.clone()),o=((0,s.formatDate)(new Date,"hh:dd"),(0,s.createI)({class:["ico","ico-delete"]},"✖")),l=(0,s.createButton)({class:["btn","btn-delete"],title:`Delete ${i} state`},o),c=(0,s.createDiv)({class:["model-state-preview"],title:`Preview ${i}`},e),h=(0,s.createSpan)({class:["model-state-content","fit-content"]},`${t.getName()}`),u=(0,s.createListItem)({class:["model-state"],title:`Restore ${i} state`,dataset:{id:a,concept:n}},[l,h,c]);u.addEventListener("click",(t=>{let e=function(t){const e=t=>t===u||t===l;return e(t)?t:(0,s.findAncestor)(t,(t=>e(t)),5)}(t.target);if(this.unhighlight(),e===l)this.removeState(a);else{let t=this.restore(r);this.removeState(a);let e=(0,s.getElement)(`.projection[data-concept="${t.id}"]`,this.body);e&&e.focus()}}));let d=`.projection[data-concept="${n}"]`;if(u.addEventListener("mouseenter",(t=>{let e=(0,s.getElement)(d,this.body);e&&this.highlight(e)})),u.addEventListener("mouseleave",(t=>{this.unhighlight()})),this.states.length>8){let{id:t}=this.stateList.lastChild.dataset;this.removeValue(t)}let p=Object.create({},{id:{value:a},object:{value:"value"},type:{value:"state"},element:{value:u},concept:{value:t},value:{value:r}});return this.addState(p),p},getState(t){if(!(0,s.isNullOrUndefined)(t)&&!(0,s.isEmpty)(this.states))return this.states[t]},addState(t){return this.stateList.append(t.element),this.states.push(t),this.refresh(),t},removeState(t){if((0,s.isNullOrUndefined)(t))return;const e=this.states.findIndex((e=>e.id===t));if(-1===e)return null;let n=this.states.splice(e,1)[0],{element:i}=n;return(0,s.removeChildren)(i).remove(),this.refresh(),this}},Vr={"delete:value":t=>{const{id:e}=t.dataset;(void 0).conceptModel.removeValue(e),(void 0).header._valueSelector.update()},"delete:resource":t=>{const{id:e}=t.dataset;(void 0).removeResource(e)},"change-view":t=>{const{value:e}=t.dataset;(void 0).status.changeView(e)},"add-group":t=>{(void 0).status.addGroup()},"export--copy":t=>{(void 0).export(!0)}};var zr=0;const Fr={conceptModel:null,projectionModel:null,concept:null,activeConcept:null,activeProjection:null,activeReceiver:null,activeInstance:null,container:null,header:null,body:null,instanceSection:null,designSection:null,navigationSection:null,valueWindow:null,valueList:null,breadcrumb:null,filter:null,home:null,exporter:null,style:null,logs:null,status:null,group:null,input:null,copyValue:null,states:null,activeElement:null,decoratedElements:null,config:null,active:!1,visible:!1,frozen:!1,handlers:null,actions:null,attached:null,instances:null,windows:null,values:null,resources:null,models:null,errors:null,init(t={}){const{conceptModel:e,projectionModel:n,toolbar:i=[],config:s={},handlers:a={},actions:r={}}=t;this.config=Object.assign({},s),this.handlers=new Map,this.actions=new Map,this.attached=[],this.instances=new Map,this.windows=new Map,this.values=new Map,this.resources=new Map,this.models=new Map,this.errors=[],Object.assign(this,O,C),this.states=[],this.decoratedElements=new Set;for(const t in a){const e=a[t];this.registerHandler(t,e)}return this.header=D.call(this).init(),this.home=P.call(this).init(),this.breadcrumb=H.call(this).init(),this.logs=B.call(this).init(),this.status=R.call(this).init(),this.exporter=V.call(this).init(),this.render(),Array.isArray(e)?this.loadConcepts(e):e&&this.loadConcept(e),Array.isArray(n)?this.loadProjections(n):n&&this.loadProjection(n),this.isReady?(this.conceptModel.getRootConcepts().forEach((t=>{this.createInstance(t)})),this.open()):(this.home.open(),this.refresh()),this},setConfig(t){return!(0,s.isNullOrUndefined)(t)&&(this.config=t,this.refresh(),this)},getConfig(t){return(0,s.isNullOrUndefined)(t)?this.config:this.config[t]},getName(){return(0,s.valOrDefault)(this.config.name,`editor${(new Date).getTime()}`)},createConcept(t){if((0,s.isNullOrUndefined)(t))throw new TypeError("Missing argument: The 'name' is required to create a concept");return this.conceptModel.isConcept(t)?this.conceptModel.createConcept(t):(this.notify(`The concept '${t}' is not defined in the model`,a.k$.ERROR),!1)},addConcept(t){let e=t.concept||t;Array.isArray(e)?this.conceptModel.schema.push(...e):this.conceptModel.schema.push(e),this.refresh()},createProjection(t,e){if((0,s.isNullOrUndefined)(t))throw new TypeError("Missing argument: The 'concept' is required to create a projection");return this.projectionModel.hasConceptProjection(t,e)?this.projectionModel.createProjection(t,e).init():(this.notify(`The projection for the concept '${t.name}' is not defined in the model`,a.k$.ERROR),!1)},addProjection(t){Array.isArray(t)?this.projectionModel.schema.projection.push(...t):this.projectionModel.addSchema(t),this.refresh()},download(t,e,n){let i;i=(0,s.isNullOrUndefined)(n)?a.n_.JSON:a.n_[n.toUpperCase()];const r=i.type;window.URL=window.webkitURL||window.URL;var o=(0,s.createAnchor)({class:["bare-link","download-item__link"]},"Download");(0,s.isNullOrWhitespace)(o.href)||window.URL.revokeObjectURL(o.href);var l=new Blob([JSON.stringify(t)],{type:r});return Object.assign(o,{download:e,href:window.URL.createObjectURL(l)}),o.dataset.downloadurl=[r,o.download,o.href].join(":"),o.click(),setTimeout((()=>{window.URL.revokeObjectURL(o.href),o.remove()}),1500),t},save(t,e){(0,s.isNullOrUndefined)(t)||(this.createState(t,e),this.refresh())},restore(t){let e=JSON.parse(t),n=this.conceptModel.getConcept(e.id);return n.restore(e),this.refresh(),n},undo(){if((0,s.isEmpty)(this.states))return void this.notify("There are no previous state",a.k$.NORMAL,2e3);let t=(0,s.last)(this.states);this.restore(t.value),this.removeState(t.id)},notify(t,e,n=4500){let i=(0,s.createParagraph)({class:["notify"],html:t});const a="open";e&&i.classList.add(e),this.container.append(i),setTimeout((()=>{i.classList.add(a)}),50),setTimeout((()=>{i.classList.remove(a),setTimeout((()=>{i.remove()}),500)}),n)},addResource(t,e){let n=(0,s.valOrDefault)(e,t.name.split(".")[0]);this.resources.set(n,t);let i=new FileReader;return i.onload=t=>{const e=JSON.parse(i.result);this.addModel(n,e)},i.readAsText(t),this.refresh(),t},getResource(t){return this.resources.get(t)},hasResource(t){return this.resources.has(t)},removeResource(t){return this.resources.delete(t),this.triggerEvent({name:"resource.removed"}),this.refresh(),!0},addError(t){return this.errors.push(t),this.refresh(),(0,a.lL)(this.status.editorstatusBadge),t},removeError(t){return this.errors.pop(),this.refresh(),!0},clearError(t){return this.errors=[],this.refresh(),!0},getModel(t){let e=this.models.get(t);return(0,s.isNullOrUndefined)(e)?null:JSON.parse(e)},addModel(t,e){this.models.set(t,e)},removeModel(t){return this.triggerEvent({name:"model.remove@pre",args:[t]},(()=>{this.models.delete(t),this.refresh(),this.triggerEvent({name:"model.remove@post"})}),!1),!0},hasModel(t){return this.models.has(t)},getValue(t){if(this.values.has(t))return this.values.get(t)},addValue(t){let e="value"+zr++,n=(0,s.createI)({class:["ico","ico-copy"]}),i=(0,s.createI)({class:["ico","ico-delete"]},"✖"),a=(0,s.createButton)({class:["btn","btn-copy","fit-content"],title:`Copy ${t.name}`},[n,t.name]),r=(0,s.createButton)({class:["btn","btn-delete"]},i),o=(0,s.createListItem)({class:["model-value"],dataset:{id:e}},[a,r]);if(a.addEventListener("click",(e=>{this.copy(t)})),r.addEventListener("click",(t=>{this.removeValue(e)})),this.values.size>5){let{id:t}=this.valueList.lastChild.dataset;this.removeValue(t)}return this.valueList.prepend(o),this.values.set(e,{element:o,value:t}),this.refresh(),t},removeValue(t){if((0,s.isNullOrUndefined)(t)||!this.values.has(t))return;let{element:e}=this.values.get(t);return(0,s.removeChildren)(e).remove(),this.values.delete(t),this.refresh(),this},copy(t,e=!1){return(0,s.isNullOrUndefined)(t)||(this.copyValue=t,(0,s.copytoClipboard)(JSON.stringify(t)),e&&this.addValue(t),this.notify(`${t.name} copied`,a.k$.NORMAL)),this},paste(t,e){let n=(0,s.valOrDefault)(e,this.copyValue);if(!(0,s.isNullOrUndefined)(n)){if((0,s.isNullOrUndefined)(t)){let t=this.createConcept(n.name).init();t.setValue(n),this.createInstance(t)}else"prototype"===n.nature?t.setValue(n.value):t.setValue(n);return this}},show(){return this.triggerEvent({name:"editor.show@pre"},(()=>{(0,a.$Z)(this.container),this.attached.forEach((t=>t.show())),this.visible=!0,this.triggerEvent({name:"editor.show@post"})}),!1),this},hide(){return this.triggerEvent({name:"editor.hide@pre"},(()=>{(0,a.Cp)(this.container),this.attached.forEach((t=>t.hide())),this.visible=!1,this.triggerEvent({name:"editor.hide@post"})}),!1),this},toggle(){return this.triggerEvent({name:"editor.toggle@pre"},(()=>{(0,a.ZN)(this.container),this.visible=!this.visible,this.triggerEvent({name:"editor.toggle@post"})}),!1),this},open(){return this.triggerEvent({name:"editor.open@pre"},(()=>{this.show(),this.active=!0,this.isReady&&this.home.close(),this.triggerEvent({name:"editor.open@post"})}),!1),this},close(){return this.triggerEvent({name:"editor.close@pre"},(()=>{this.hide(),this.active=!1,this.done(),this.clear(),this.triggerEvent({name:"editor.close@post"})}),!1),this},destroy(){return this.triggerEvent({name:"editor.destroy@pre"},(()=>{this.hide(),this.done(),this.instances.forEach((t=>t.delete())),(0,s.removeChildren)(this.container).remove()}),!1),!0},freeze(){return this.triggerEvent({name:"editor.freeze@pre"},(()=>{this.frozen=!0,this.refresh(),this.triggerEvent({name:"editor.freeze@post"})}),!1),this},unfreeze(){return this.frozen=!1,this.refresh(),this},done(){return this.conceptModel&&this.conceptModel.done(),this.projectionModel&&this.projectionModel.done(),this},highlight(t){return(0,s.isHTMLElement)(t)?((0,a.CH)(t),this.decoratedElements.add(t),this):this},unhighlight(t){return(0,s.isHTMLElement)(t)?((0,a.HW)(t),this.decoratedElements.delete(t),this):(this.decoratedElements.forEach((t=>(0,a.HW)(t))),this.decoratedElements.clear(),this)},createWindow(){let t=(0,s.createDiv)({class:["editor-window"],tabindex:0});this.body.append(t)},clear(){return this.triggerEvent({name:"editor.clear@pre"},(()=>{this.instances.forEach((t=>t.delete())),this.instances.clear(),this.resources.clear(),this.models.clear(),this.states.forEach((t=>t.element.remove())),this.states=[],this.activeElement=null,this.activeInstance=null,this.activeConcept=null,this.activeProjection=null,this.refresh(),this.triggerEvent({name:"editor.clear@post"})}),!1),this},update(t,e,n){this.triggerEvent({name:t})},attach(t){this.attached.push(t)},detach(t){let e=this.attached.findIndex((e=>e===t));if(-1===e)return null;this.attached.splice(e,1)},render(t){const e=(0,s.createDocFragment)();if(this.home.isRendered||e.append(this.home.render()),this.header.isRendered||e.append(this.header.render()),this.exporter.isRendered||e.append(this.exporter.render()),(0,s.isHTMLElement)(this.navigationSection)||(this.navigationSection=(0,s.createSection)({class:["model-navigation-section"]}),this.viewSection=(0,s.createAside)({class:["model-view-section"]}),this.navigationSection.append(this.viewSection),e.append(this.navigationSection)),!(0,s.isHTMLElement)(this.body)){this.body=(0,s.createDiv)({class:["editor-body"],tabindex:0});let t=(0,s.createDiv)({class:["editor-body-main"],tabindex:0});this.instanceSection=(0,s.createSection)({class:["model-concept-section"]}),t.append(this.instanceSection),this.body.append(t),e.append(this.body)}return(0,s.isHTMLElement)(this.timeline)||(this.timeline=(0,s.createDiv)({class:["editor-timeline"]}),this.stateList=(0,s.createUnorderedList)({class:["bare-list","model-state-list"]}),this.timeline.append(this.stateList),e.append(this.timeline)),this.logs.isRendered||e.append(this.logs.render()),this.breadcrumb.isRendered||this.navigationSection.append(this.breadcrumb.render()),(0,s.isHTMLElement)(this.valueSection)||(this.valueSection=(0,s.createDiv)({class:["model-value-window"]}),this.valueList=(0,s.createUnorderedList)({class:["bare-list","model-value-list"]}),this.valueSection.append(this.valueList),this.navigationSection.append(this.valueSection)),this.status.isRendered||e.append(this.status.render()),(0,s.isHTMLElement)(this.input)||(this.input=(0,s.createInput)({type:"file",class:["hidden"],accept:".json,.jsoncp"}),e.append(this.input)),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),(0,s.isHTMLElement)(t)&&t.append(this.container),this.refresh(),this.container},refresh(t=!1){return this.frozen&&!t||(this.home.isOpen?this.container.classList.add("unfocus"):this.container.classList.remove("unfocus"),this.hasValues?(0,a.$Z)(this.valueWindow):(0,a.Cp)(this.valueWindow),this.header.refresh(),this.breadcrumb.refresh(),this.home.refresh(),this.logs.refresh(),this.status.refresh(),this.instanceSection.dataset.view=this.status.view,["grid"].includes(this.status.view)?(0,a.Cp)(this.viewSection):["tab"].includes(this.status.view)&&(0,a.$Z)(this.viewSection),(0,s.isEmpty)(this.states)?(0,a.Cp)(this.timeline):((0,a.$Z)(this.timeline),this.states.forEach((t=>{this.conceptModel.hasConcept(t.concept.id)?this.hasActiveConcept&&this.activeConcept===t.concept?t.element.classList.add("active"):t.element.classList.remove("active"):this.removeState(t.id)})))),this},updateActiveElement(t){return this.activeElement&&this.activeElement===t||(this.activeElement=t,this.triggerEvent({name:"editor.element@active:updated"})),this},updateActiveConcept(t){return this.hasActiveConcept&&this.activeConcept===t||(this.activeConcept=t,this.triggerEvent({name:"editor.concept@active:updated"}),this.refresh()),this},updateActiveProjection(t){if(this.activeProjection&&this.activeProjection===t)return this;let e=(0,s.getElements)(".active-parent",this.body);for(let t=0;t<e.length;t++)e[t].classList.remove("active-parent");this.activeProjection=t;let n=this.activeProjection.parent;for(;n;)n.getContainer().classList.add("active-parent"),n=n.parent;return this.triggerEvent({name:"editor.projection@active:updated"}),this.refresh(),this},updateActiveInstance(t){if(this.activeInstance){if(this.activeInstance===t)return this;this.activeInstance,this.activeInstance.container.classList.remove("active")}return this.activeInstance=t,this.activeInstance.container.classList.add("active"),this.triggerEvent({name:"editor.instance@active:updated"}),this.refresh(),this},registerReceiver(t,e){(0,s.isNullOrUndefined)(this.receivers)&&(this.receivers={}),(0,s.isNullOrUndefined)(this.receivers[e])?this.receivers[e]={root:t,projections:[t]}:this.receivers[e].projections.push(t),this.setActiveReceiver(t,e)},setActiveReceiver(t,e){(0,s.isNullOrUndefined)(this.activeReceiver)&&(this.activeReceiver={}),this.activeReceiver[e]=t},getActiveReceiver(t){return this.activeReceiver[t]},getReceivers(t){return this.receivers[t].projections},getRootReceiver(t){return this.receivers[t].root},bindEvents(){var t=null,e=null;const n={[a.sr.up_arrow]:"up",[a.sr.right_arrow]:"right",[a.sr.down_arrow]:"down",[a.sr.left_arrow]:"left"};this.container.addEventListener("click",(t=>{var e=(0,a.NI)(t.target);const{action:n,context:i,id:r}=e.dataset;if("instance"===i)return void this.getInstance(r).actionHandler(n);if("menu"===i)return void this.home.actionHandler(n,e);if(this.activeElement&&this.activeElement.clickHandler(e),(0,s.isNullOrUndefined)(n))return;if(this.actions.has(n))return this.actions.get(n).call(this,e),void e.blur();const o=Vr[n];(0,s.isFunction)(o)?(o(e),e.blur()):n&&this.triggerEvent({name:n,args:e})}),!0),this.input.addEventListener("change",(t=>{let n=this.input.files[0];this.load(n,e),this.input.value=""})),this.body.addEventListener("copy",(t=>{if(!(0,a.QE)(t.target)){let e=this.activeConcept.copy(!1);this.copy(e,!0),t.preventDefault()}})),this.body.addEventListener("keydown",(e=>{const{target:i}=e,{nature:r}=i.dataset;var o=!1;switch(e.key){case a.sr.backspace:this.activeElement&&t!==a.sr.ctrl&&!0===this.activeElement.backspaceHandler(i)&&e.preventDefault();break;case a.sr.ctrl:case a.sr.shift:e.preventDefault(),o=!0;break;case a.sr.delete:this.activeElement&&t!==a.sr.ctrl&&!(0,a.QE)(i)&&this.activeElement.deleteHandler(i)&&e.preventDefault();break;case a.sr.spacebar:this.activeElement&&t!==a.sr.ctrl&&this.activeElement.spaceHandler(i)&&e.preventDefault();break;case a.sr.alt:e.preventDefault();break;case a.sr.enter:this.activeElement?!0===this.activeElement.enterHandler(i)&&e.preventDefault():"concept-container"===r?this.activeInstance.projection.focus():"editable"===r?i.blur():"BUTTON"===i.tagName?(i.click(),e.preventDefault()):e.preventDefault();break;case a.sr.escape:this.activeElement&&(!0===this.activeElement.escapeHandler(i)?e.preventDefault():(0,s.findAncestor)(i,(t=>0===t.tabIndex)).focus());break;case a.sr.insert:this.activeElement&&e.preventDefault();break;case a.sr.up_arrow:case a.sr.right_arrow:case a.sr.down_arrow:case a.sr.left_arrow:if(this.activeElement&&![a.sr.ctrl,a.sr.shift,a.sr.alt].includes(t))!0===this.activeElement.arrowHandler(n[e.key],i)&&e.preventDefault();else if("concept-container"===r&&![a.sr.ctrl,a.sr.shift,a.sr.alt].includes(t)){let t=(0,a.As)(i,n[e.key],this.instanceSection);if(!(0,s.isHTMLElement)(t))return!1;t.focus()}break;case"s":t===a.sr.ctrl&&(this.activeConcept.copy(),this.header.valueCount++,this.refresh(),e.preventDefault());break;case"c":if(t===a.sr.ctrl){let t=new ClipboardEvent("copy");this.body.dispatchEvent(t)}break;case"v":if(t===a.sr.ctrl){if((0,a.QE)(i))return;this.paste(this.activeConcept,this.copyValue)}break;case"e":t===a.sr.ctrl&&this.activeConcept&&(this.createInstance(this.activeConcept,this.activeProjection,{type:"projection",close:"DELETE-PROJECTION"}),e.preventDefault());break;case"f":break;case"z":t===a.sr.ctrl&&((0,a.QE)(i)||(this.undo(),e.preventDefault()))}o&&(t=e.key)}),!1),this.body.addEventListener("keyup",(e=>{var i=e.target;const{nature:r}=i.dataset;switch(e.key){case a.sr.spacebar:this.activeElement&&t===a.sr.ctrl&&this.activeElement._spaceHandler(i);break;case a.sr.delete:this.activeElement&&t===a.sr.ctrl&&this.activeElement.delete(i);break;case a.sr.alt:break;case a.sr.up_arrow:case a.sr.down_arrow:case a.sr.right_arrow:case a.sr.left_arrow:if(this.activeElement&&t===a.sr.ctrl)!0===this.activeElement._arrowHandler(n[e.key],i)&&e.preventDefault();else if("concept-container"===r&&t===a.sr.ctrl){let r=(0,a.As)(i,n[e.key],this.instanceSection);if(!(0,s.isHTMLElement)(r))return!1;this.swapInstance(i,r,!0),i.focus(),t=a.sr.ctrl}}t===e.key&&(t=-1)}),!1),this.body.addEventListener("focusin",(e=>{const{target:n}=e,i=this.resolveElement(n);if(t=-1,i?(this.activeElement&&this.activeElement!==i&&(this.activeElement.focusOut(),this.activeElement=null),this.updateActiveElement(i),this.activeElement.focusIn(n)):(this.activeElement&&this.activeElement.focusOut(n),this.activeElement=null),this.activeElement){let t=this.activeElement.projection;this.updateActiveProjection(t),this.updateActiveConcept(t.concept)}else this.activeConcept=null,this.activeProjection=null;this.refresh()})),this.registerHandler("value.changed",(()=>this.refresh())),this.registerHandler("value.added",(()=>this.refresh())),this.registerHandler("value.removed",(()=>this.refresh())),this.registerHandler("export.model",(()=>this.exporter.open())),this.registerHandler("home",(t=>{this.home.toggle()})),this.registerHandler("logs",(t=>{this.logs.toggle()})),this.registerHandler("export",(t=>{this.export()})),this.registerHandler("load",(t=>{let e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.input.dispatchEvent(e)})),this.registerHandler("load-resource",(t=>{let n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});e=t[0],this.input.dispatchEvent(n)})),this.registerHandler("load-concept",(t=>{let e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.input.dispatchEvent(e)})),this.registerHandler("load-projection",(t=>{let e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.input.dispatchEvent(e)})),this.registerHandler("unload",(t=>{this.unload()})),this.registerHandler("unload-concept",(t=>{this.unloadAllConcept()})),this.registerHandler("unload-projection",(t=>{this.unloadAllProjection()})),this.registerHandler("download-concept",(t=>{const{schema:e,values:n}=this.conceptModel;let i=this.getName().toLowerCase().replace(/\s+/g," ").replace(" ","_");this.download({concept:e},`${i}_model`,"JSON")})),this.registerHandler("open",(t=>{const{context:e}=t.dataset;e?this[e].open():this.open()})),this.registerHandler("close",(t=>{const{context:e,id:n,type:i}=t.dataset;e?this[e].close():this.close()})),this.registerHandler("collapse",(t=>{const{rel:e,target:n}=t.dataset;if("parent"===e){let e=(0,s.findAncestor)(t,(t=>t.dataset.name===n));if((0,s.isHTMLElement)(e)){const{alias:n=""}=e.dataset;e.classList.toggle("collapsed");let i=e.classList.contains("collapsed");t.dataset.state=i?"ON":"OFF",t.title=i?`Expand ${n.toLowerCase()}`:`Collapse ${n.toLowerCase()}`}}})),this.registerHandler("delete",(t=>{const{target:e}=t.dataset;if("parent"===e){let e=t.parentElement;(0,s.removeChildren)(e),e.remove()}})),this.registerHandler("create-instance",(t=>{const{concept:e}=t.dataset;let n=this.createConcept(e);this.createInstance(n)})),this.registerHandler("create-instance:value",(t=>{const{id:e}=t.dataset;let n=this.conceptModel.getValue(e),i=this.createConcept(n.name);i.initValue(n),this.createInstance(i)})),this.registerHandler("copy:value",(t=>{const{id:e}=t.dataset;let n=this.conceptModel.getValue(e);this.copy(n)}))}},qr=Object.assign(Br,Hr,Pr,z,Vr,Fr);Object.defineProperty(qr,"hasConceptModel",{get(){return!(0,s.isNullOrUndefined)(this.conceptModel)}}),Object.defineProperty(qr,"hasProjectionModel",{get(){return!(0,s.isNullOrUndefined)(this.projectionModel)}}),Object.defineProperty(qr,"hasInstances",{get(){return this.instances.size>0}}),Object.defineProperty(qr,"hasWindows",{get(){return this.windows.size>0}}),Object.defineProperty(qr,"hasValues",{get(){return this.values.size>0}}),Object.defineProperty(qr,"isReady",{get(){return this.hasConceptModel&&this.hasProjectionModel}}),Object.defineProperty(qr,"hasActiveConcept",{get(){return!(0,s.isNullOrUndefined)(this.activeConcept)}}),Object.defineProperty(qr,"hasActiveProjection",{get(){return!(0,s.isNullOrUndefined)(this.activeProjection)}}),Object.defineProperty(qr,"hasActiveInstance",{get(){return!(0,s.isNullOrUndefined)(this.activeInstance)}}),Object.defineProperty(qr,"hasError",{get(){return!(0,s.isEmpty)(this.errors)}});const $r="editor";function Wr(t){let e=(0,a.fP)(t);return(0,s.isHTMLElement)(t)||(e=(0,s.createDiv)({tabindex:-1})),e.classList.add("gentleman-editor"),e.dataset.gentleman=$r,Object.create(qr,{object:{value:"environment"},type:{value:$r},name:{value:"gentleman editor"},container:{value:e}})}},185:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AnchorHandler:()=>s});var i=n(835);const s={models:null,init(){this.models=new Map},create(t,e){return(0,i.isNullOrUndefined)(this.models)&&this.init(),(0,i.isNullOrUndefined)(this.models.get(e.id))?this.createModel(e.id,e.rtag,t):this.register(e.id,e.rtag,t),this.models.get(e.id)},createModel(t,e,n){const i=n.projection.environment.getActiveReceiver(e);let s=[];for(let e=0;e<i.items.length;e++)if(i.items[e].render.contains(n.container))return s.push({id:n.id,pId:i.items[e].render.dataset.id,holder:i.items[e].render,elem:n}),void this.models.set(t,{items:s,index:0})},register(t,e,n){let i=this.models.get(t);const s=n.projection.environment.getActiveReceiver(e);for(let t=0;t<s.items.length;t++)if(s.items[t].render.contains(n.container)){i.items.push({id:n.id,pId:s.items[t].render.dataset.id,holder:s.items[t].render,elem:n});break}for(let t=0;t<i.index;t++)n.nextAnchor(!1)},nextAnchor(t,e){let n=this.models.get(t);for(let t=0;t<n.items.length;t++){let i=n.items[t];i.id!==e&&i.elem.nextAnchor(!1)}n.index++},findSource(t,e){const n=this.models.get(t).items,s={};let a,r;for(a=0;a<n.length;a++){const t=n[a].elem,o=t.items;if(!(0,i.isNullOrUndefined)(o))for(r=0;r<o.length;r++)if(o[r].render.contains(e)){s.x=Number(o[r].render.getAttribute("x"))+Number(n[a].holder.getAttribute("x"))+Number((t.container||t.element).getAttribute("x")),s.y=Number(o[r].render.getAttribute("y"))+Number(n[a].holder.getAttribute("y"))+Number((t.container||t.element).getAttribute("y")),s.calc={projItems:{x:Number(o[r].render.getAttribute("x")),y:Number(o[r].render.getAttribute("y"))},holder:n[a].holder,proj:t};break}if(!(0,i.isNullOrUndefined)(s.x))break}let o=n[a].elem.anchors.indexes;const l=Number(n[a].elem.items[r].render.getAttribute("x")),c=Number(n[a].elem.items[r].render.getAttribute("y"));for(let t=0;t<o.length;t++)if(o[t].x===l&&o[t].y===c)return s.index=t,s},unregister(t,e){let n=this.models.get(t).listeners;for(let t=0;t<n.length;t++)if(n[t]===e)return void n.splice(t,1)},createSubModel(t,e){let n=this.models.get(t);(0,i.isNullOrUndefined)(n.subModels)&&(n.subModels=[]),n.subModels.push({elem:e,size:1})},registerSubModel(t,e,n){let s,a=this.models.get(t);for(let t=0;t<a.subModels.length;t++)a.subModels[t].elem===e&&(s=a.subModels[t]);(0,i.isNullOrUndefined)(s.start)&&(s.start=this.estimateStart(a,s.elem));const r=a.items;let o;for(let t=0;t<r.length;t++){const e=r[t].elem,s=e.items;if(!(0,i.isNullOrUndefined)(e.items)){for(let t=0;t<s.length;t++)if(s[t].render.contains(n.container||n.element)){o={},o.j=t,o.index=s[t].index;break}if(!(0,i.isNullOrUndefined)(o)){o.i=t;break}}}if(o.index>s.start+s.size){const t=r[o.i].elem.moveElemToAnchor(s.start+s.size,o.j);r.forEach((e=>{e.elem.increaseAnchors(s.start+s.size,o.index,t,a.forbiden)}))}else if(o.index<s.start+s.size){const t=r[o.i].elem.moveElemToAnchor(s.start+s.size-1,o.j);r.forEach((e=>{e.elem.decreaseAnchors(o.index,s.start+s.size,t,a.forbiden)})),s.start--}s.elem.increaseSize(),s.size++,(0,i.isNullOrUndefined)(a.listeners)||a.listeners.forEach((t=>{t.updateValue()}))},estimateStart(t,e){const n=t.items;for(let t=0;t<n.length;t++){const i=n[t].elem.items;for(let t=0;t<i.length;t++)if(i[t].render.contains(e.container))return t}},findTarget(t,e,n){const i=this.models.get(t).items;for(let t=0;t<i.length;t++){const s=i[t].elem,a=i[t].holder,r=s.anchors.indexes;if(a.dataset.concept===e)return{x:r[n].x+Number(a.getAttribute("x"))+Number((s.container||s.element).getAttribute("x")),y:r[n].y+Number(a.getAttribute("y"))+Number((s.container||s.element).getAttribute("y")),calc:{projItems:r[n],holder:a,proj:s}}}},estimatePositionCondamn(t,e){const n=this.models.get(t),s=n.items;for(let t=0;t<s.length;t++){const a=s[t].elem,r=a.items;if(!(0,i.isNullOrUndefined)(r))for(let o=0;o<r.length;o++)if(r[o].render.contains(e.container))return(0,i.isNullOrUndefined)(this.condamn)&&(n.condamn=[],n.forbiden=[]),n.condamn.push({index:o,elem:e}),n.forbiden.push(o),n.subModels.forEach((t=>{t.elem.container===e.container&&(t.start=r[o].index)})),{x:Number(r[o].render.getAttribute("x"))+Number(s[t].holder.getAttribute("x"))+Number((a.container||a.element).getAttribute("x")),y:Number(r[o].render.getAttribute("y"))+Number(s[t].holder.getAttribute("y"))+Number((a.container||a.element).getAttribute("y")),anchors:a.anchors.next}}},estimatePosition(t){const{projItems:e,holder:n,proj:i}=t;return{x:e.x+Number(n.getAttribute("x"))+Number((i.container||i.element).getAttribute("x")),y:e.y+Number(n.getAttribute("y"))+Number((i.container||i.element).getAttribute("y"))}},registerListener(t,e){let n=this.models.get(t);(0,i.isNullOrUndefined)(n.listeners)&&(n.listeners=[]),n.listeners.push(e)},deleteItem(t,e,n){const s=this.models.get(t);if(s.items.forEach((t=>{t.id!==e&&t.elem.removeAnchor(n)})),!(0,i.isNullOrUndefined)(s.condamn)){for(let t=0;t<s.subModels.length;t++)s.subModels[t].start<n&&s.subModels[t].start+s.subModels[t].size>n&&(s.subModels[t].size--,s.subModels[t].elem.decreaseSize());for(let t=0;t<s.condamn.length;t++){if(s.condamn[t].index>n){s.condamn[t].index--,s.condamn[t].elem.decreaseAnchor();for(let t=0;t<s.subModels.length;t++)s.subModels[t].elem===s.elem&&s.subModels[t].start--}s.condamn[t].index===n&&(s.condamn.splice(t,1),t--)}for(let t=0;t<s.forbiden.length;t++)s.forbiden[t]===n&&(s.forbiden.splice(t,1),t--)}s.index--,(0,i.isNullOrUndefined)(s.listeners)||s.listeners.forEach((t=>{t.updateValue()}))}}},127:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Simulation:()=>i});const i={notifyDimObservers(){isNullOrUndefined(this.observers)||this.observers.forEach((t=>{t.analyseContentDim()}))}}},241:(t,e,n)=>{"use strict";function i(t){let e=0;if(O(t))return t.selectionStart;if(0!==window.getSelection().rangeCount){const n=window.getSelection().getRangeAt(0),i=n.cloneRange();i.selectNodeContents(t),i.setEnd(n.endContainer,n.endOffset),e=i.toString().length}return e}n.d(e,{D3:()=>k,n_:()=>j,sr:()=>w,hi:()=>A,k$:()=>E,WV:()=>x,_b:()=>F,wo:()=>b,p$:()=>q,jn:()=>v,GV:()=>B,qO:()=>i,As:()=>D,NI:()=>N,EE:()=>P,GF:()=>R,Sd:()=>H,sB:()=>U,Cp:()=>u,CH:()=>m,xj:()=>_,u7:()=>O,QE:()=>L,n2:()=>z,a2:()=>M,fP:()=>V,Ys:()=>g,lL:()=>p,$Z:()=>h,ZN:()=>d,HW:()=>f,hF:()=>y});var s=n(835);const a="hidden",r="collapsed",o="highlighted",l="shake",c="selected";function h(t){return(0,s.isHTMLElement)(t)?(t.classList.remove(a),t):t}function u(t){return(0,s.isHTMLElement)(t)?(t.classList.add(a),t):t}function d(t){return(0,s.isHTMLElement)(t)?(t.classList.toggle(a),t):t}function p(t){t.classList.contains(l)||(t.classList.add(l),setTimeout((()=>{t.classList.remove(l)}),1e3))}function m(t){return(0,s.isHTMLElement)(t)?(t.classList.add(o),t):t}function f(t){return(0,s.isHTMLElement)(t)?(t.classList.remove(o),t):t}function g(t){return(0,s.isHTMLElement)(t)?(t.classList.add(c),t):t}function y(t){return(0,s.isHTMLElement)(t)?(t.classList.remove(c),t):t}function b(t){return(0,s.isHTMLElement)(t)&&t.classList.add(r),t}function v(t){return(0,s.isHTMLElement)(t)&&t.classList.remove(r),t}const x={STRING:"string",NUMBER:"number",BOOLEAN:"boolean",REFERENCE:"reference",SET:"set",list(){return[this.STRING,this.NUMBER,this.BOOLEAN,this.REFERENCE,this.SET]}},w={backspace:"Backspace",tab:"Tab",enter:"Enter",ctrl:"Control",shift:"Shift",alt:"Alt",escape:"Escape",spacebar:" ",page_up:"PageUp",page_down:"PageDown",insert:"Insert",end:"End",home:"Home",left_arrow:"ArrowLeft",up_arrow:"ArrowUp",right_arrow:"ArrowRight",down_arrow:"ArrowDown",delete:"Delete",period:"."},E={NORMAL:"normal",WARNING:"warning",SUCCESS:"success",ERROR:"error"},A={NORMAL:"normal",WARNING:"warning",SUCCESS:"success",ERROR:"error"},j={AAC:{type:"audio/aac",extension:"aac"},BIN:{type:"application/octet-stream",extension:"bin"},JPEG:{type:"image/jpeg",extension:"jpeg"},JSON:{type:"application/json",extension:"json"},JSONCP:{type:"application/json",extension:"jsoncp"},MP3:{type:"audio/mpeg",extension:"mp3"},PDF:{type:"application/pdf",extension:"pdf"},SVG:{type:"image/svg+xml",extension:"svg"},TEXT:{type:"text/plain",extension:"txt"},XML:{type:"text/xml",extension:"xml"},ZIP:{type:"application/zip",extension:"zip"}},k={"audio/aac":"aac","application/octet-stream":"bin","image/jpeg":"jpeg","application/json":"json","audio/mpeg":"mp3","application/pdf":"pdf","image/svg+xml":"svg","text/plain":"txt","text/xml":"xml","application/zip":"zip"};function N(t){const e=t=>!(0,s.hasOwn)(t.dataset,"ignore");return e(t)?t:(0,s.findAncestor)(t,e,10)}function _(t){if(!s.isHTMLElement)throw new TypeError("Bad parameter");return t.hidden||"none"===window.getComputedStyle(t).display}const O=t=>(0,s.isHTMLElement)(t,["input","textarea"]),L=t=>O(t)||"true"===t.contentEditable,M=t=>+t.substring(0,t.indexOf("px")),C={top:t=>t.marginTop,right:t=>t.marginRight,bottom:t=>t.marginBottom,left:t=>t.marginLeft},S={top:t=>t.paddingTop,right:t=>t.paddingRight,bottom:t=>t.paddingBottom,left:t=>t.paddingLeft},T={top:t=>t.borderTopWidth,right:t=>t.borderRightWidth,bottom:t=>t.borderBottomWidth,left:t=>t.borderLeftWidth};function I(t,e,n){const i=window.getComputedStyle(t),s=window.getComputedStyle(e),a=C[n](i),r=S[n](s),o=T[n](s);return l=t.getBoundingClientRect()[n]+M(a),c=e.getBoundingClientRect()[n]-M(r)-M(o),Math.abs(l-c)<2;var l,c}function U(t){for(let e=0;e<t.children.length;e++){const n=t.children[e];if(!_(n))return n}return null}function D(t,e,n,i){return"up"===e?function(t,e,n=!0){const i=e.children,{top:s,left:a}=t.getBoundingClientRect();if(n&&I(t,e,"top"))return null;let r=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const n=i[e];if(_(n)||n.classList.contains("badge")||n===t)continue;const{bottom:c,left:h}=n.getBoundingClientRect();let u=Math.abs(s-c),d=Math.abs(a-h);s>=c-1&&(u<o||u===o&&d<l)&&(r=n,o=u,l=d)}return r}(t,n,i):"down"===e?function(t,e,n=!0){const i=e.children,{bottom:s,left:a}=t.getBoundingClientRect();if(n&&I(t,e,"bottom"))return null;let r=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const n=i[e];if(_(n)||n.classList.contains("badge")||n===t)continue;const{top:c,left:h}=n.getBoundingClientRect();let u=Math.abs(s-c),d=Math.abs(a-h);s<=c+1&&(u<o||u===o&&d<l)&&(r=n,o=u,l=d)}return r}(t,n,i):"left"===e?function(t,e,n=!0){const i=e.children,{top:s,left:a}=t.getBoundingClientRect();if(n&&I(t,e,"left"))return null;let r=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const n=i[e];if(_(n)||n.classList.contains("badge")||n===t)continue;const{top:c,right:h}=n.getBoundingClientRect();let u=Math.abs(s-c),d=Math.abs(a-h);a>=h-1&&(d<l||d===l&&u<o)&&(r=n,o=u,l=d)}return r}(t,n,i):"right"===e?function(t,e,n=!0){const i=e.children,{top:s,right:a}=t.getBoundingClientRect();if(n&&I(t,e,"right"))return null;let r=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const n=i[e];if(_(n)||n.classList.contains("badge")||n===t)continue;const{top:c,left:h}=n.getBoundingClientRect();let u=Math.abs(s-c),d=Math.abs(a-h);a<=h+1&&(d<l||d===l&&u<o)&&(r=n,o=u,l=d)}return r}(t,n,i):(console.error("unknown direction",e),null)}function H(t,e){const n=t.children,{top:i,left:a}=t.getBoundingClientRect();if(0===n.length)return null;const r=(0,s.isFunction)(e);let o=null,l=99999,c=99999;for(let t=0;t<n.length;t++){const s=n[t];if(r&&!e(s))continue;if(_(s)||s.classList.contains("badge"))continue;const{top:h,left:u}=s.getBoundingClientRect();let d=Math.abs(i-h),p=Math.abs(a-u);i<=h+1&&(d<l||d===l&&p<c)&&(o=s,l=d,c=p)}return o}function P(t,e){const n=t.children,{top:i,left:a}=t.getBoundingClientRect();if(0===n.length)return null;const r=(0,s.isFunction)(e);let o=null,l=99999,c=99999;for(let t=0;t<n.length;t++){const s=n[t];if(r&&!e(s))continue;if(_(s)||s.classList.contains("badge"))continue;const{top:h,left:u}=s.getBoundingClientRect();let d=Math.abs(i-h),p=Math.abs(a-u);a<=u+1&&(p<c||p===c&&d<l)&&(o=s,l=d,c=p)}return o}function R(t,e){const n=t.children,{top:i,right:a}=t.getBoundingClientRect();if(0===n.length)return null;const r=(0,s.isFunction)(e);let o=null,l=99999,c=99999;for(let t=0;t<n.length;t++){const s=n[t];if(r&&!e(s))continue;if(_(s)||s.classList.contains("badge"))continue;const{top:h,right:u}=s.getBoundingClientRect();let d=Math.abs(i-h),p=Math.abs(a-u);a>=u-1&&(p<c||p===c&&d<l)&&(o=s,l=d,c=p)}return o}function B(t,e){const n=t.children,{bottom:i,left:a}=t.getBoundingClientRect();if(0===n.length)return null;const r=(0,s.isFunction)(e);let o=null,l=99999,c=99999;for(let t=0;t<n.length;t++){const s=n[t];if(r&&!e(s))continue;if(_(s)||s.classList.contains("badge"))continue;const{bottom:h,left:u}=s.getBoundingClientRect();let d=Math.abs(i-h),p=Math.abs(a-u);i>=h-1&&(d<l||d===l&&p<c)&&(o=s,l=d,c=p)}return o}function V(t){return(0,s.isHTMLElement)(t)?t:(0,s.isString)(t)&&!(0,s.isNullOrWhitespace)(t)?(0,s.getElement)(t):null}function z(t,e={}){const n=V(t);if(!(0,s.isHTMLElement)(n))return null;const i=Object.assign({horizontal:!0,vertical:!0,minWidth:60,minHeight:60},e),a=function(){let t=(0,s.createDiv)({class:["resizers"]});return["horizontal","vertical"].forEach((e=>{t.append((0,s.createDiv)({class:["resizer",`${e}`],dataset:{dir:e}}))})),t}();n.prepend(a),i.horizontal&&i.vertical?n.dataset.resizable="both":i.horizontal?n.dataset.resizable="horizontal":i.vertical&&(n.dataset.resizable="vertical");const{minWidth:r,minHeight:o}=getComputedStyle(n),l=(0,s.valOrDefault)(M(r),i.minWidth),c=(0,s.valOrDefault)(M(o),i.minHeight);let h=0,u=null;function d(t){const{dir:e}=u.dataset,{width:i,height:s}=getComputedStyle(n);let a="horizontal"===e?t.pageX:t.pageY;if("horizontal"===e){const t=M(i)+(a-h);t>l&&(n.style.width=`${t}px`)}else if("vertical"===e){const t=M(s)+(a-h);t>c&&(n.style.height=`${t}px`)}h=a}for(let t=0;t<a.childElementCount;t++){const e=a.children[t];e.addEventListener("mousedown",(function(t){t.preventDefault(),u=e;const{dir:n}=u.dataset;h="horizontal"===n?t.pageX:t.pageY,document.body.addEventListener("mousemove",d),document.body.addEventListener("mouseup",(()=>{document.body.removeEventListener("mousemove",d)}))}))}return n}const F=t=>(0,s.createStrong)({class:["text-bf"]},t).outerHTML,q=t=>JSON.parse(JSON.stringify(t));n(914)},914:(t,e,n)=>{"use strict";n.d(e,{h:()=>i});const i=function(){var t={},e=[];for(let t=0;t<256;t++)e[t]=t<16?"0"+t.toString(16):t.toString(16);return t.generate=function(){var t=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0,s=4294967296*Math.random()>>>0;return e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&i|128]+e[i>>8&255]+"-"+e[i>>16&255]+e[i>>24&255]+e[255&s]+e[s>>8&255]+e[s>>16&255]+e[s>>24&255]},t}()}},e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{const{App:t}=n(684),{Preview:e}=n(839),i=localStorage.getItem("gentleman.preview");i?(e.init(i),localStorage.removeItem("gentleman.preview")):t.init()})()})();